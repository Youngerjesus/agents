{
    "pdf_info": [
        {
            "preproc_blocks": [
                {
                    "type": "title",
                    "bbox": [
                        71,
                        78,
                        540,
                        119
                    ],
                    "lines": [
                        {
                            "bbox": [
                                73,
                                80,
                                540,
                                99
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        73,
                                        80,
                                        540,
                                        99
                                    ],
                                    "score": 1.0,
                                    "content": "TapeAgents: a Holistic Framework for Agent Development",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                71,
                                101,
                                209,
                                121
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        101,
                                        209,
                                        121
                                    ],
                                    "score": 1.0,
                                    "content": "and Optimization",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        }
                    ],
                    "index": 0.5
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        142,
                        399,
                        190
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                142,
                                156,
                                154
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        142,
                                        156,
                                        154
                                    ],
                                    "score": 1.0,
                                    "content": "Core contributors1:",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                69,
                                154,
                                364,
                                167
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        154,
                                        181,
                                        166
                                    ],
                                    "score": 1.0,
                                    "content": "Dzmitry Bahdanau†,*",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        190,
                                        154,
                                        364,
                                        167
                                    ],
                                    "score": 1.0,
                                    "content": "Nicolas Gontier† Gabriel Huang†",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                70,
                                167,
                                327,
                                178
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        167,
                                        158,
                                        177
                                    ],
                                    "score": 1.0,
                                    "content": "Ehsan Kamalloo†",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        169,
                                        167,
                                        255,
                                        178
                                    ],
                                    "score": 1.0,
                                    "content": "Rafael Pardinas†",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        265,
                                        167,
                                        327,
                                        178
                                    ],
                                    "score": 1.0,
                                    "content": "Alex Piché†",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                70,
                                178,
                                401,
                                191
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        178,
                                        156,
                                        189
                                    ],
                                    "score": 1.0,
                                    "content": "Torsten Scholak†",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        168,
                                        178,
                                        256,
                                        189
                                    ],
                                    "score": 1.0,
                                    "content": "Oleh Shliazhko†,*",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        265,
                                        178,
                                        401,
                                        191
                                    ],
                                    "score": 1.0,
                                    "content": "Jordan Prince Tremblay†,*",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        }
                    ],
                    "index": 3.5
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        195,
                        418,
                        220
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                196,
                                135,
                                208
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        196,
                                        135,
                                        208
                                    ],
                                    "score": 1.0,
                                    "content": "Contributors1:",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                70,
                                208,
                                417,
                                221
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        208,
                                        417,
                                        221
                                    ],
                                    "score": 1.0,
                                    "content": "Karam Ghanem2 Soham Parikh‡ Mitul Tiwari2 Quaizar Vohra‡",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        }
                    ],
                    "index": 6.5
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        226,
                        482,
                        256
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                225,
                                237,
                                240
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        225,
                                        180,
                                        240
                                    ],
                                    "score": 1.0,
                                    "content": "†ServiceNow Research",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        180,
                                        227,
                                        185,
                                        236
                                    ],
                                    "score": 0.28,
                                    "content": "^\\ddag",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 5
                                },
                                {
                                    "bbox": [
                                        185,
                                        225,
                                        237,
                                        239
                                    ],
                                    "score": 1.0,
                                    "content": "ServiceNow",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                70,
                                244,
                                483,
                                260
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        244,
                                        483,
                                        260
                                    ],
                                    "score": 1.0,
                                    "content": "Corresponding authors (*): {dzmitry.bahdanau,oleh.shliazhko,jordanprince.t}@servicenow.com",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        }
                    ],
                    "index": 8.5
                },
                {
                    "type": "title",
                    "bbox": [
                        282,
                        274,
                        329,
                        288
                    ],
                    "lines": [
                        {
                            "bbox": [
                                281,
                                275,
                                330,
                                288
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        281,
                                        275,
                                        330,
                                        288
                                    ],
                                    "score": 1.0,
                                    "content": "Abstract",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        }
                    ],
                    "index": 10
                },
                {
                    "type": "text",
                    "bbox": [
                        106,
                        304,
                        505,
                        532
                    ],
                    "lines": [
                        {
                            "bbox": [
                                107,
                                305,
                                504,
                                318
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        305,
                                        504,
                                        318
                                    ],
                                    "score": 1.0,
                                    "content": "We present TapeAgents,3 an agent framework built around a granular, structured log (tape)",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                106,
                                318,
                                505,
                                331
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        318,
                                        505,
                                        331
                                    ],
                                    "score": 1.0,
                                    "content": "of the agent session that also plays the role of the session’s resumable state. In TapeAgents",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                108,
                                330,
                                505,
                                342
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        108,
                                        330,
                                        505,
                                        342
                                    ],
                                    "score": 1.0,
                                    "content": "we leverage tapes to facilitate all stages of the LLM Agent development lifecycle. The agent",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                106,
                                342,
                                505,
                                354
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        342,
                                        505,
                                        354
                                    ],
                                    "score": 1.0,
                                    "content": "reasons by processing the tape and the LLM output to produce new thought and action",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                108,
                                355,
                                504,
                                365
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        108,
                                        355,
                                        504,
                                        365
                                    ],
                                    "score": 1.0,
                                    "content": "steps and append them to the tape. The environment then reacts to the agent’s actions",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                106,
                                366,
                                505,
                                379
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        366,
                                        505,
                                        379
                                    ],
                                    "score": 1.0,
                                    "content": "by likewise appending observation steps to the tape. By virtue of this tape-centred design,",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                106,
                                377,
                                506,
                                392
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        377,
                                        506,
                                        392
                                    ],
                                    "score": 1.0,
                                    "content": "TapeAgents can provide AI practitioners with holistic end-to-end support. At the devel-",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                106,
                                390,
                                505,
                                403
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        390,
                                        505,
                                        403
                                    ],
                                    "score": 1.0,
                                    "content": "opment stage, tapes facilitate session persistence, agent auditing, and step-by-step debug-",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                106,
                                402,
                                505,
                                415
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        402,
                                        505,
                                        415
                                    ],
                                    "score": 0.9946863055229187,
                                    "content": "ging. Post-deployment, one can reuse tapes for evaluation, fine-tuning, and prompt-tuning;",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                107,
                                414,
                                504,
                                426
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        414,
                                        504,
                                        426
                                    ],
                                    "score": 1.0,
                                    "content": "crucially, one can adapt tapes from other agents or use revised historical tapes. In this re-",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                106,
                                426,
                                506,
                                437
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        426,
                                        506,
                                        437
                                    ],
                                    "score": 1.0,
                                    "content": "port, we explain the TapeAgents design in detail. We demonstrate possible applications of",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                107,
                                438,
                                505,
                                451
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        438,
                                        505,
                                        451
                                    ],
                                    "score": 1.0,
                                    "content": "TapeAgents with several concrete examples of building monolithic agents and multi-agent",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                106,
                                450,
                                505,
                                463
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        450,
                                        505,
                                        463
                                    ],
                                    "score": 0.9928328394889832,
                                    "content": "teams, of optimizing agent prompts and finetuning the agent's LLM. We present tooling",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                107,
                                462,
                                505,
                                473
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        462,
                                        505,
                                        473
                                    ],
                                    "score": 0.9855465888977051,
                                    "content": "prototypes and report a case study where we use TapeAgents to finetune a Llama-3.1-8B",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                106,
                                473,
                                505,
                                486
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        473,
                                        505,
                                        486
                                    ],
                                    "score": 0.991401731967926,
                                    "content": "form-filling assistant to perform as well as GPT-4o while being orders of magnitude cheaper.",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                105,
                                484,
                                506,
                                499
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        484,
                                        506,
                                        499
                                    ],
                                    "score": 1.0,
                                    "content": "Lastly, our comparative analysis shows that TapeAgents’s advantages over prior frameworks",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                106,
                                498,
                                505,
                                509
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        498,
                                        505,
                                        509
                                    ],
                                    "score": 1.0,
                                    "content": "stem from our novel design of the LLM agent as a resumable, modular state machine with",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                106,
                                509,
                                504,
                                522
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        509,
                                        504,
                                        522
                                    ],
                                    "score": 0.9878513813018799,
                                    "content": "a structured configuration, that generates granular, structured logs and that can transform",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                106,
                                521,
                                498,
                                534
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        521,
                                        498,
                                        534
                                    ],
                                    "score": 1.0,
                                    "content": "these logs into training text — a unique combination of features absent in previous work.",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        }
                    ],
                    "index": 20
                },
                {
                    "type": "text",
                    "bbox": [
                        330,
                        537,
                        503,
                        548
                    ],
                    "lines": [
                        {
                            "bbox": [
                                330,
                                538,
                                505,
                                549
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        330,
                                        538,
                                        505,
                                        549
                                    ],
                                    "score": 1.0,
                                    "content": "Manuscript version: December 12, 2024",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        }
                    ],
                    "index": 30
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        573,
                        159,
                        587
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                573,
                                160,
                                588
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        574,
                                        79,
                                        586
                                    ],
                                    "score": 1.0,
                                    "content": "1",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        90,
                                        573,
                                        160,
                                        588
                                    ],
                                    "score": 1.0,
                                    "content": "Introduction",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        }
                    ],
                    "index": 31
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        599,
                        541,
                        695
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                600,
                                540,
                                613
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        600,
                                        540,
                                        613
                                    ],
                                    "score": 1.0,
                                    "content": "In the coming years, we will likely witness widespread deployments of Large Language Model (LLM) Agents:",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                72,
                                612,
                                540,
                                624
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        612,
                                        540,
                                        624
                                    ],
                                    "score": 0.9870533347129822,
                                    "content": "complex user-facing and background workfows that interleave traditional programming with LLM-based",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                70,
                                624,
                                541,
                                637
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        624,
                                        541,
                                        637
                                    ],
                                    "score": 1.0,
                                    "content": "intelligence. This big paradigm shift in software architecture will greatly challenge AI practitioners who put",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                70,
                                635,
                                541,
                                649
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        635,
                                        541,
                                        649
                                    ],
                                    "score": 1.0,
                                    "content": "LLM agents to work. The agent developers and applied scientists will have to troubleshoot and improve",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                70,
                                649,
                                541,
                                660
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        649,
                                        541,
                                        660
                                    ],
                                    "score": 1.0,
                                    "content": "systems that operate in non-stationary environments and deal with non-deterministic LLM behavior and",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                70,
                                659,
                                541,
                                673
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        659,
                                        541,
                                        673
                                    ],
                                    "score": 1.0,
                                    "content": "the LLM’s often fragile instruction following. For the LLM agent adoption to go smoothly and lead to",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                70,
                                672,
                                541,
                                685
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        672,
                                        541,
                                        685
                                    ],
                                    "score": 1.0,
                                    "content": "good outcomes, it is crucial that agent developers and applied scientists operate in appropriate frameworks",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                70,
                                684,
                                541,
                                697
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        684,
                                        541,
                                        697
                                    ],
                                    "score": 0.9894618391990662,
                                    "content": "that enable effective tooling. Developers and researchers have recently proposed many agentic frameworks",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        }
                    ],
                    "index": 35.5
                }
            ],
            "layout_bboxes": [],
            "page_idx": 0,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        81,
                        703,
                        254,
                        732
                    ],
                    "lines": [
                        {
                            "bbox": [
                                81,
                                702,
                                213,
                                715
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        81,
                                        702,
                                        213,
                                        715
                                    ],
                                    "score": 1.0,
                                    "content": "1Authors are in alphabetical order.",
                                    "type": "text"
                                }
                            ]
                        },
                        {
                            "bbox": [
                                81,
                                711,
                                228,
                                725
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        81,
                                        711,
                                        228,
                                        725
                                    ],
                                    "score": 1.0,
                                    "content": "2Work performed while at ServiceNow",
                                    "type": "text"
                                }
                            ]
                        },
                        {
                            "bbox": [
                                81,
                                720,
                                254,
                                735
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        81,
                                        720,
                                        254,
                                        735
                                    ],
                                    "score": 1.0,
                                    "content": "3https://github.com/ServiceNow/TapeAgents",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        71,
                        27,
                        143,
                        37
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                26,
                                144,
                                38
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        26,
                                        144,
                                        38
                                    ],
                                    "score": 1.0,
                                    "content": "Technical report",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        14,
                        213,
                        38,
                        561
                    ],
                    "lines": [
                        {
                            "bbox": [
                                16,
                                214,
                                37,
                                563
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        16,
                                        214,
                                        37,
                                        563
                                    ],
                                    "score": 1.0,
                                    "content": "arXiv:2412.08445v1  [cs.AI]  11 Dec 2024",
                                    "type": "text",
                                    "height": 349,
                                    "width": 21
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        302,
                        752,
                        308,
                        760
                    ],
                    "lines": [
                        {
                            "bbox": [
                                302,
                                752,
                                309,
                                762
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        302,
                                        752,
                                        309,
                                        762
                                    ],
                                    "score": 1.0,
                                    "content": "1",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "title",
                    "bbox": [
                        71,
                        78,
                        540,
                        119
                    ],
                    "lines": [
                        {
                            "bbox": [
                                73,
                                80,
                                540,
                                99
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        73,
                                        80,
                                        540,
                                        99
                                    ],
                                    "score": 1.0,
                                    "content": "TapeAgents: a Holistic Framework for Agent Development",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                71,
                                101,
                                209,
                                121
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        101,
                                        209,
                                        121
                                    ],
                                    "score": 1.0,
                                    "content": "and Optimization",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        }
                    ],
                    "index": 0.5,
                    "page_num": "page_0",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        142,
                        399,
                        190
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                142,
                                156,
                                154
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        142,
                                        156,
                                        154
                                    ],
                                    "score": 1.0,
                                    "content": "Core contributors1:",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                69,
                                154,
                                364,
                                167
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        154,
                                        181,
                                        166
                                    ],
                                    "score": 1.0,
                                    "content": "Dzmitry Bahdanau†,*",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        190,
                                        154,
                                        364,
                                        167
                                    ],
                                    "score": 1.0,
                                    "content": "Nicolas Gontier† Gabriel Huang†",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                70,
                                167,
                                327,
                                178
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        167,
                                        158,
                                        177
                                    ],
                                    "score": 1.0,
                                    "content": "Ehsan Kamalloo†",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        169,
                                        167,
                                        255,
                                        178
                                    ],
                                    "score": 1.0,
                                    "content": "Rafael Pardinas†",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        265,
                                        167,
                                        327,
                                        178
                                    ],
                                    "score": 1.0,
                                    "content": "Alex Piché†",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                70,
                                178,
                                401,
                                191
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        178,
                                        156,
                                        189
                                    ],
                                    "score": 1.0,
                                    "content": "Torsten Scholak†",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        168,
                                        178,
                                        256,
                                        189
                                    ],
                                    "score": 1.0,
                                    "content": "Oleh Shliazhko†,*",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        265,
                                        178,
                                        401,
                                        191
                                    ],
                                    "score": 1.0,
                                    "content": "Jordan Prince Tremblay†,*",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        }
                    ],
                    "index": 3.5,
                    "page_num": "page_0",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        142,
                        401,
                        191
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        195,
                        418,
                        220
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                196,
                                135,
                                208
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        196,
                                        135,
                                        208
                                    ],
                                    "score": 1.0,
                                    "content": "Contributors1:",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                70,
                                208,
                                417,
                                221
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        208,
                                        417,
                                        221
                                    ],
                                    "score": 1.0,
                                    "content": "Karam Ghanem2 Soham Parikh‡ Mitul Tiwari2 Quaizar Vohra‡",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                70,
                                225,
                                237,
                                240
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        225,
                                        180,
                                        240
                                    ],
                                    "score": 1.0,
                                    "content": "†ServiceNow Research",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        180,
                                        227,
                                        185,
                                        236
                                    ],
                                    "score": 0.28,
                                    "content": "^\\ddag",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 5
                                },
                                {
                                    "bbox": [
                                        185,
                                        225,
                                        237,
                                        239
                                    ],
                                    "score": 1.0,
                                    "content": "ServiceNow",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                70,
                                244,
                                483,
                                260
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        244,
                                        483,
                                        260
                                    ],
                                    "score": 1.0,
                                    "content": "Corresponding authors (*): {dzmitry.bahdanau,oleh.shliazhko,jordanprince.t}@servicenow.com",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        }
                    ],
                    "index": 6.5,
                    "page_num": "page_0",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        196,
                        417,
                        221
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        226,
                        482,
                        256
                    ],
                    "lines": [],
                    "index": 8.5,
                    "page_num": "page_0",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        225,
                        483,
                        260
                    ],
                    "lines_deleted": true
                },
                {
                    "type": "title",
                    "bbox": [
                        282,
                        274,
                        329,
                        288
                    ],
                    "lines": [
                        {
                            "bbox": [
                                281,
                                275,
                                330,
                                288
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        281,
                                        275,
                                        330,
                                        288
                                    ],
                                    "score": 1.0,
                                    "content": "Abstract",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        }
                    ],
                    "index": 10,
                    "page_num": "page_0",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        106,
                        304,
                        505,
                        532
                    ],
                    "lines": [
                        {
                            "bbox": [
                                107,
                                305,
                                504,
                                318
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        305,
                                        504,
                                        318
                                    ],
                                    "score": 1.0,
                                    "content": "We present TapeAgents,3 an agent framework built around a granular, structured log (tape)",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                106,
                                318,
                                505,
                                331
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        318,
                                        505,
                                        331
                                    ],
                                    "score": 1.0,
                                    "content": "of the agent session that also plays the role of the session’s resumable state. In TapeAgents",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                108,
                                330,
                                505,
                                342
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        108,
                                        330,
                                        505,
                                        342
                                    ],
                                    "score": 1.0,
                                    "content": "we leverage tapes to facilitate all stages of the LLM Agent development lifecycle. The agent",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                106,
                                342,
                                505,
                                354
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        342,
                                        505,
                                        354
                                    ],
                                    "score": 1.0,
                                    "content": "reasons by processing the tape and the LLM output to produce new thought and action",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                108,
                                355,
                                504,
                                365
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        108,
                                        355,
                                        504,
                                        365
                                    ],
                                    "score": 1.0,
                                    "content": "steps and append them to the tape. The environment then reacts to the agent’s actions",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                106,
                                366,
                                505,
                                379
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        366,
                                        505,
                                        379
                                    ],
                                    "score": 1.0,
                                    "content": "by likewise appending observation steps to the tape. By virtue of this tape-centred design,",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                106,
                                377,
                                506,
                                392
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        377,
                                        506,
                                        392
                                    ],
                                    "score": 1.0,
                                    "content": "TapeAgents can provide AI practitioners with holistic end-to-end support. At the devel-",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                106,
                                390,
                                505,
                                403
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        390,
                                        505,
                                        403
                                    ],
                                    "score": 1.0,
                                    "content": "opment stage, tapes facilitate session persistence, agent auditing, and step-by-step debug-",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                106,
                                402,
                                505,
                                415
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        402,
                                        505,
                                        415
                                    ],
                                    "score": 0.9946863055229187,
                                    "content": "ging. Post-deployment, one can reuse tapes for evaluation, fine-tuning, and prompt-tuning;",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                107,
                                414,
                                504,
                                426
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        414,
                                        504,
                                        426
                                    ],
                                    "score": 1.0,
                                    "content": "crucially, one can adapt tapes from other agents or use revised historical tapes. In this re-",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                106,
                                426,
                                506,
                                437
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        426,
                                        506,
                                        437
                                    ],
                                    "score": 1.0,
                                    "content": "port, we explain the TapeAgents design in detail. We demonstrate possible applications of",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                107,
                                438,
                                505,
                                451
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        438,
                                        505,
                                        451
                                    ],
                                    "score": 1.0,
                                    "content": "TapeAgents with several concrete examples of building monolithic agents and multi-agent",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                106,
                                450,
                                505,
                                463
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        450,
                                        505,
                                        463
                                    ],
                                    "score": 0.9928328394889832,
                                    "content": "teams, of optimizing agent prompts and finetuning the agent's LLM. We present tooling",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                107,
                                462,
                                505,
                                473
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        462,
                                        505,
                                        473
                                    ],
                                    "score": 0.9855465888977051,
                                    "content": "prototypes and report a case study where we use TapeAgents to finetune a Llama-3.1-8B",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                106,
                                473,
                                505,
                                486
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        473,
                                        505,
                                        486
                                    ],
                                    "score": 0.991401731967926,
                                    "content": "form-filling assistant to perform as well as GPT-4o while being orders of magnitude cheaper.",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                105,
                                484,
                                506,
                                499
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        484,
                                        506,
                                        499
                                    ],
                                    "score": 1.0,
                                    "content": "Lastly, our comparative analysis shows that TapeAgents’s advantages over prior frameworks",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                106,
                                498,
                                505,
                                509
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        498,
                                        505,
                                        509
                                    ],
                                    "score": 1.0,
                                    "content": "stem from our novel design of the LLM agent as a resumable, modular state machine with",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                106,
                                509,
                                504,
                                522
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        509,
                                        504,
                                        522
                                    ],
                                    "score": 0.9878513813018799,
                                    "content": "a structured configuration, that generates granular, structured logs and that can transform",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                106,
                                521,
                                498,
                                534
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        521,
                                        498,
                                        534
                                    ],
                                    "score": 1.0,
                                    "content": "these logs into training text — a unique combination of features absent in previous work.",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        }
                    ],
                    "index": 20,
                    "page_num": "page_0",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        105,
                        305,
                        506,
                        534
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        330,
                        537,
                        503,
                        548
                    ],
                    "lines": [
                        {
                            "bbox": [
                                330,
                                538,
                                505,
                                549
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        330,
                                        538,
                                        505,
                                        549
                                    ],
                                    "score": 1.0,
                                    "content": "Manuscript version: December 12, 2024",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        }
                    ],
                    "index": 30,
                    "page_num": "page_0",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        330,
                        538,
                        505,
                        549
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        573,
                        159,
                        587
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                573,
                                160,
                                588
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        574,
                                        79,
                                        586
                                    ],
                                    "score": 1.0,
                                    "content": "1",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        90,
                                        573,
                                        160,
                                        588
                                    ],
                                    "score": 1.0,
                                    "content": "Introduction",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        }
                    ],
                    "index": 31,
                    "page_num": "page_0",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        599,
                        541,
                        695
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                600,
                                540,
                                613
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        600,
                                        540,
                                        613
                                    ],
                                    "score": 1.0,
                                    "content": "In the coming years, we will likely witness widespread deployments of Large Language Model (LLM) Agents:",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                72,
                                612,
                                540,
                                624
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        612,
                                        540,
                                        624
                                    ],
                                    "score": 0.9870533347129822,
                                    "content": "complex user-facing and background workfows that interleave traditional programming with LLM-based",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                70,
                                624,
                                541,
                                637
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        624,
                                        541,
                                        637
                                    ],
                                    "score": 1.0,
                                    "content": "intelligence. This big paradigm shift in software architecture will greatly challenge AI practitioners who put",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                70,
                                635,
                                541,
                                649
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        635,
                                        541,
                                        649
                                    ],
                                    "score": 1.0,
                                    "content": "LLM agents to work. The agent developers and applied scientists will have to troubleshoot and improve",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                70,
                                649,
                                541,
                                660
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        649,
                                        541,
                                        660
                                    ],
                                    "score": 1.0,
                                    "content": "systems that operate in non-stationary environments and deal with non-deterministic LLM behavior and",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                70,
                                659,
                                541,
                                673
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        659,
                                        541,
                                        673
                                    ],
                                    "score": 1.0,
                                    "content": "the LLM’s often fragile instruction following. For the LLM agent adoption to go smoothly and lead to",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                70,
                                672,
                                541,
                                685
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        672,
                                        541,
                                        685
                                    ],
                                    "score": 1.0,
                                    "content": "good outcomes, it is crucial that agent developers and applied scientists operate in appropriate frameworks",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                70,
                                684,
                                541,
                                697
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        684,
                                        541,
                                        697
                                    ],
                                    "score": 0.9894618391990662,
                                    "content": "that enable effective tooling. Developers and researchers have recently proposed many agentic frameworks",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                71,
                                83,
                                541,
                                96
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        83,
                                        541,
                                        96
                                    ],
                                    "score": 0.9912135601043701,
                                    "content": "that support practitioners at different stages of the agent development lifecycle. Several frameworks, like",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                70,
                                94,
                                540,
                                108
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        94,
                                        540,
                                        108
                                    ],
                                    "score": 1.0,
                                    "content": "LangChain (Chase, 2022), CrewAI and AutoGen (Wu et al., 2024a), help developers quickly build an agent",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                70,
                                106,
                                540,
                                120
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        106,
                                        540,
                                        120
                                    ],
                                    "score": 1.0,
                                    "content": "using low-code paradigms, such as prompt-chaining or multi-agent teams. Others, like LangGraph (Chase,",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                70,
                                118,
                                540,
                                132
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        118,
                                        540,
                                        132
                                    ],
                                    "score": 0.9955849051475525,
                                    "content": "2023), offer low-level support in achieving resumability, asynchronous execution, concurrency and instru-",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                71,
                                131,
                                540,
                                143
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        131,
                                        540,
                                        143
                                    ],
                                    "score": 1.0,
                                    "content": "mentation. At the other end of the spectrum are frameworks built by researchers like DSPy (Khattab et al.,",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                70,
                                142,
                                540,
                                156
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        142,
                                        540,
                                        156
                                    ],
                                    "score": 1.0,
                                    "content": "2023a), TextGrad (Yuksekgonul et al., 2024) and Agents (Zhou et al., 2023a), that usually focus on data-",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                71,
                                155,
                                541,
                                168
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        155,
                                        541,
                                        168
                                    ],
                                    "score": 0.9940109252929688,
                                    "content": "driven optimization of the agent performance with model finetuning and prompt-tuning algorithms, while",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                70,
                                168,
                                330,
                                180
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        168,
                                        330,
                                        180
                                    ],
                                    "score": 1.0,
                                    "content": "putting less emphasis on the needs of the agent developers.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 7
                        }
                    ],
                    "index": 35.5,
                    "page_num": "page_0",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        600,
                        541,
                        697
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        71,
                        82,
                        541,
                        178
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                83,
                                541,
                                96
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        83,
                                        541,
                                        96
                                    ],
                                    "score": 0.9912135601043701,
                                    "content": "that support practitioners at different stages of the agent development lifecycle. Several frameworks, like",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                70,
                                94,
                                540,
                                108
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        94,
                                        540,
                                        108
                                    ],
                                    "score": 1.0,
                                    "content": "LangChain (Chase, 2022), CrewAI and AutoGen (Wu et al., 2024a), help developers quickly build an agent",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                70,
                                106,
                                540,
                                120
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        106,
                                        540,
                                        120
                                    ],
                                    "score": 1.0,
                                    "content": "using low-code paradigms, such as prompt-chaining or multi-agent teams. Others, like LangGraph (Chase,",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                70,
                                118,
                                540,
                                132
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        118,
                                        540,
                                        132
                                    ],
                                    "score": 0.9955849051475525,
                                    "content": "2023), offer low-level support in achieving resumability, asynchronous execution, concurrency and instru-",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                71,
                                131,
                                540,
                                143
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        131,
                                        540,
                                        143
                                    ],
                                    "score": 1.0,
                                    "content": "mentation. At the other end of the spectrum are frameworks built by researchers like DSPy (Khattab et al.,",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                70,
                                142,
                                540,
                                156
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        142,
                                        540,
                                        156
                                    ],
                                    "score": 1.0,
                                    "content": "2023a), TextGrad (Yuksekgonul et al., 2024) and Agents (Zhou et al., 2023a), that usually focus on data-",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                71,
                                155,
                                541,
                                168
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        155,
                                        541,
                                        168
                                    ],
                                    "score": 0.9940109252929688,
                                    "content": "driven optimization of the agent performance with model finetuning and prompt-tuning algorithms, while",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                70,
                                168,
                                330,
                                180
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        168,
                                        330,
                                        180
                                    ],
                                    "score": 1.0,
                                    "content": "putting less emphasis on the needs of the agent developers.",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        }
                    ],
                    "index": 3.5
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        184,
                        540,
                        387
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                186,
                                540,
                                197
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        186,
                                        540,
                                        197
                                    ],
                                    "score": 1.0,
                                    "content": "In this technical report, we present TapeAgents — a new holistic agent framework that supports practition-",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                70,
                                197,
                                540,
                                210
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        197,
                                        540,
                                        210
                                    ],
                                    "score": 1.0,
                                    "content": "ers at both the agent development and data-driven agent optimization stages. We achieve both objectives by",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                70,
                                208,
                                540,
                                221
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        208,
                                        540,
                                        221
                                    ],
                                    "score": 1.0,
                                    "content": "building the framework around a comprehensive, structured, granular, semantic-level log of the agent session",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                71,
                                221,
                                541,
                                233
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        221,
                                        541,
                                        233
                                    ],
                                    "score": 1.0,
                                    "content": "that we call a tape, a term that also gives the framework its name (see Figure 1 for an illustration). The",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                70,
                                232,
                                541,
                                246
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        232,
                                        541,
                                        246
                                    ],
                                    "score": 1.0,
                                    "content": "agents in TapeAgents read the tape to make the LLM prompt and then process the LLM output to append",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                71,
                                245,
                                540,
                                257
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        245,
                                        540,
                                        257
                                    ],
                                    "score": 1.0,
                                    "content": "new steps to the tape: thought steps to express reasoning and action steps to request external inputs. The",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                70,
                                257,
                                541,
                                269
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        257,
                                        541,
                                        269
                                    ],
                                    "score": 1.0,
                                    "content": "environment responds to the action steps at the end of the tape with observation steps that it likewise",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                71,
                                269,
                                541,
                                280
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        269,
                                        541,
                                        280
                                    ],
                                    "score": 1.0,
                                    "content": "appends to the tape. The orchestrator invokes the agent and the environment in an alternate fashion and",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                71,
                                281,
                                540,
                                293
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        281,
                                        540,
                                        293
                                    ],
                                    "score": 1.0,
                                    "content": "maintains full control over their interactions. By design, the orchestrator can resume from any intermediate",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                70,
                                291,
                                541,
                                306
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        291,
                                        541,
                                        306
                                    ],
                                    "score": 1.0,
                                    "content": "tape, which enables session persistence and step-by-step debugging, both key developer requirements for an",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                71,
                                304,
                                540,
                                316
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        304,
                                        540,
                                        316
                                    ],
                                    "score": 1.0,
                                    "content": "agent framework. For data-driven algorithms, tapes record the attribution of each step to the respective part",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                70,
                                316,
                                540,
                                329
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        316,
                                        540,
                                        329
                                    ],
                                    "score": 0.988277018070221,
                                    "content": "of the agent configuration, which facilitates training, data generation and automatic prompt-tuning. Cru-",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                71,
                                329,
                                541,
                                340
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        329,
                                        541,
                                        340
                                    ],
                                    "score": 1.0,
                                    "content": "cially, for both manual debugging and algorithms, agents can reuse lightly adapted tapes from other agents",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                71,
                                340,
                                541,
                                353
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        340,
                                        541,
                                        353
                                    ],
                                    "score": 0.9872367978096008,
                                    "content": "and revise their own tapes. This allows practitioners to maximally benefit from imperfect historical tapes by",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                70,
                                351,
                                541,
                                365
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        351,
                                        541,
                                        365
                                    ],
                                    "score": 1.0,
                                    "content": "earlier versions of the agent, both for evaluating the newer versions and for improving them algorithmically.",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                70,
                                363,
                                542,
                                377
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        363,
                                        542,
                                        377
                                    ],
                                    "score": 1.0,
                                    "content": "Last but not least, agents stream their intermediate events to the orchestrator to enable delightful interactive",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                71,
                                378,
                                124,
                                389
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        378,
                                        124,
                                        389
                                    ],
                                    "score": 1.0,
                                    "content": "experiences.",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        }
                    ],
                    "index": 16
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        393,
                        541,
                        525
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                393,
                                541,
                                407
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        393,
                                        541,
                                        407
                                    ],
                                    "score": 1.0,
                                    "content": "We invite the reader to start their TapeAgents journey with the technical presentation of the framework in",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                71,
                                407,
                                541,
                                418
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        407,
                                        541,
                                        418
                                    ],
                                    "score": 1.0,
                                    "content": "Section 2. There, we cover the details of agent architecture, agent-environment orchestration, tape content",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                70,
                                418,
                                540,
                                430
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        418,
                                        540,
                                        430
                                    ],
                                    "score": 1.0,
                                    "content": "and structure. Section 3 describes three low-code agent-building framework prototypes on top of TapeAgents:",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                70,
                                430,
                                541,
                                443
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        430,
                                        541,
                                        443
                                    ],
                                    "score": 1.0,
                                    "content": "one for monolithic agents, another for multi-agent teams and the third one with easy-to-tune function-like",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                70,
                                441,
                                541,
                                455
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        441,
                                        541,
                                        455
                                    ],
                                    "score": 1.0,
                                    "content": "prompts. The same section also covers early versions of our Studio toolsuite for development and debugging",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                70,
                                454,
                                541,
                                467
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        454,
                                        541,
                                        467
                                    ],
                                    "score": 1.0,
                                    "content": "and our Optimize toolsuite for agent optimization. In Section 4, we present diverse examples of building and",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                71,
                                465,
                                540,
                                478
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        465,
                                        540,
                                        478
                                    ],
                                    "score": 1.0,
                                    "content": "optimizing agents using TapeAgents framework and tooling. Section 5 presents a deeper case study of a key",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                71,
                                478,
                                540,
                                491
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        478,
                                        540,
                                        491
                                    ],
                                    "score": 0.9931238889694214,
                                    "content": "practical TapeAgents use case: optimizing the quality of a cost-effective conversational assistant using tapes",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                70,
                                490,
                                541,
                                503
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        490,
                                        541,
                                        503
                                    ],
                                    "score": 0.9906154274940491,
                                    "content": "from an expensive multi-node Teacher agent. After presenting the framework and the examples we offer the",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                70,
                                501,
                                541,
                                514
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        501,
                                        541,
                                        514
                                    ],
                                    "score": 1.0,
                                    "content": "reader a detailed comparison of TapeAgents with prior work in Section 6. Lastly, Section 7 discusses possible",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                72,
                                514,
                                260,
                                526
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        514,
                                        260,
                                        526
                                    ],
                                    "score": 1.0,
                                    "content": "extensions and applications of TapeAgents.",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        }
                    ],
                    "index": 30
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        539,
                        230,
                        554
                    ],
                    "lines": [
                        {
                            "bbox": [
                                69,
                                539,
                                230,
                                555
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        539,
                                        230,
                                        555
                                    ],
                                    "score": 1.0,
                                    "content": "2 TapeAgents: foundations",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        }
                    ],
                    "index": 36
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        565,
                        540,
                        625
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                566,
                                540,
                                580
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        566,
                                        540,
                                        580
                                    ],
                                    "score": 1.0,
                                    "content": "Our TapeAgents framework proposes an agent-building paradigm that facilitates all stages of the AI Agent",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                71,
                                579,
                                541,
                                591
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        579,
                                        541,
                                        591
                                    ],
                                    "score": 1.0,
                                    "content": "development lifecycle. This section presents the framework in a detailed bottom-up approach. First, we",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                70,
                                590,
                                540,
                                603
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        590,
                                        540,
                                        603
                                    ],
                                    "score": 1.0,
                                    "content": "introduce the building blocks: the nodes, the agents, and the environment. Then, we explore how these",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                71,
                                603,
                                540,
                                614
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        603,
                                        540,
                                        614
                                    ],
                                    "score": 1.0,
                                    "content": "parts can be composed and orchestrated to build a tape-centered system. In this section, we also describe",
                                    "type": "text"
                                }
                            ],
                            "index": 40
                        },
                        {
                            "bbox": [
                                70,
                                615,
                                217,
                                627
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        615,
                                        217,
                                        627
                                    ],
                                    "score": 1.0,
                                    "content": "the tape structure and metadata.",
                                    "type": "text"
                                }
                            ],
                            "index": 41
                        }
                    ],
                    "index": 39
                },
                {
                    "type": "title",
                    "bbox": [
                        72,
                        639,
                        174,
                        651
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                639,
                                174,
                                652
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        640,
                                        87,
                                        650
                                    ],
                                    "score": 1.0,
                                    "content": "2.1",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        94,
                                        639,
                                        174,
                                        652
                                    ],
                                    "score": 1.0,
                                    "content": "Nodes and Steps",
                                    "type": "text"
                                }
                            ],
                            "index": 42
                        }
                    ],
                    "index": 42
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        660,
                        540,
                        732
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                661,
                                540,
                                675
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        661,
                                        540,
                                        675
                                    ],
                                    "score": 1.0,
                                    "content": "As outlined in Figure 1, in TapeAgents, one builds the agent from nodes: the basic atoms of intelligence.",
                                    "type": "text"
                                }
                            ],
                            "index": 43
                        },
                        {
                            "bbox": [
                                71,
                                674,
                                540,
                                686
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        674,
                                        540,
                                        686
                                    ],
                                    "score": 1.0,
                                    "content": "A node describes one LLM call and the classical symbolic processing of the call’s output. The agent will",
                                    "type": "text"
                                }
                            ],
                            "index": 44
                        },
                        {
                            "bbox": [
                                70,
                                685,
                                541,
                                699
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        685,
                                        541,
                                        699
                                    ],
                                    "score": 1.0,
                                    "content": "dynamically determine which node to run next based on the tape. Nodes generate new tape entries that we",
                                    "type": "text"
                                }
                            ],
                            "index": 45
                        },
                        {
                            "bbox": [
                                70,
                                697,
                                540,
                                711
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        697,
                                        540,
                                        711
                                    ],
                                    "score": 1.0,
                                    "content": "call steps: basic atoms of the agent’s memory. Examples of what an agent can do in a step include making",
                                    "type": "text"
                                }
                            ],
                            "index": 46
                        },
                        {
                            "bbox": [
                                70,
                                709,
                                541,
                                723
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        709,
                                        541,
                                        723
                                    ],
                                    "score": 0.9768171906471252,
                                    "content": "a long-term plan, reasoning about how to fulfill the plan or how to use a tool, requesting a tool call. Among",
                                    "type": "text"
                                }
                            ],
                            "index": 47
                        },
                        {
                            "bbox": [
                                70,
                                720,
                                542,
                                735
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        720,
                                        542,
                                        735
                                    ],
                                    "score": 1.0,
                                    "content": "these examples, the last one is an action step as it requests interaction with or has an impact on the agent’s",
                                    "type": "text"
                                }
                            ],
                            "index": 48
                        }
                    ],
                    "index": 45.5
                }
            ],
            "layout_bboxes": [],
            "page_idx": 1,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        72,
                        27,
                        143,
                        37
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                26,
                                144,
                                38
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        26,
                                        144,
                                        38
                                    ],
                                    "score": 1.0,
                                    "content": "Technical report",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        302,
                        752,
                        309,
                        760
                    ],
                    "lines": [
                        {
                            "bbox": [
                                302,
                                751,
                                310,
                                763
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        302,
                                        751,
                                        310,
                                        763
                                    ],
                                    "score": 1.0,
                                    "content": "2",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        71,
                        82,
                        541,
                        178
                    ],
                    "lines": [],
                    "index": 3.5,
                    "page_num": "page_1",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        83,
                        541,
                        180
                    ],
                    "lines_deleted": true
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        184,
                        540,
                        387
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                186,
                                540,
                                197
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        186,
                                        540,
                                        197
                                    ],
                                    "score": 1.0,
                                    "content": "In this technical report, we present TapeAgents — a new holistic agent framework that supports practition-",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                70,
                                197,
                                540,
                                210
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        197,
                                        540,
                                        210
                                    ],
                                    "score": 1.0,
                                    "content": "ers at both the agent development and data-driven agent optimization stages. We achieve both objectives by",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                70,
                                208,
                                540,
                                221
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        208,
                                        540,
                                        221
                                    ],
                                    "score": 1.0,
                                    "content": "building the framework around a comprehensive, structured, granular, semantic-level log of the agent session",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                71,
                                221,
                                541,
                                233
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        221,
                                        541,
                                        233
                                    ],
                                    "score": 1.0,
                                    "content": "that we call a tape, a term that also gives the framework its name (see Figure 1 for an illustration). The",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                70,
                                232,
                                541,
                                246
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        232,
                                        541,
                                        246
                                    ],
                                    "score": 1.0,
                                    "content": "agents in TapeAgents read the tape to make the LLM prompt and then process the LLM output to append",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                71,
                                245,
                                540,
                                257
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        245,
                                        540,
                                        257
                                    ],
                                    "score": 1.0,
                                    "content": "new steps to the tape: thought steps to express reasoning and action steps to request external inputs. The",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                70,
                                257,
                                541,
                                269
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        257,
                                        541,
                                        269
                                    ],
                                    "score": 1.0,
                                    "content": "environment responds to the action steps at the end of the tape with observation steps that it likewise",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                71,
                                269,
                                541,
                                280
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        269,
                                        541,
                                        280
                                    ],
                                    "score": 1.0,
                                    "content": "appends to the tape. The orchestrator invokes the agent and the environment in an alternate fashion and",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                71,
                                281,
                                540,
                                293
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        281,
                                        540,
                                        293
                                    ],
                                    "score": 1.0,
                                    "content": "maintains full control over their interactions. By design, the orchestrator can resume from any intermediate",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                70,
                                291,
                                541,
                                306
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        291,
                                        541,
                                        306
                                    ],
                                    "score": 1.0,
                                    "content": "tape, which enables session persistence and step-by-step debugging, both key developer requirements for an",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                71,
                                304,
                                540,
                                316
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        304,
                                        540,
                                        316
                                    ],
                                    "score": 1.0,
                                    "content": "agent framework. For data-driven algorithms, tapes record the attribution of each step to the respective part",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                70,
                                316,
                                540,
                                329
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        316,
                                        540,
                                        329
                                    ],
                                    "score": 0.988277018070221,
                                    "content": "of the agent configuration, which facilitates training, data generation and automatic prompt-tuning. Cru-",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                71,
                                329,
                                541,
                                340
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        329,
                                        541,
                                        340
                                    ],
                                    "score": 1.0,
                                    "content": "cially, for both manual debugging and algorithms, agents can reuse lightly adapted tapes from other agents",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                71,
                                340,
                                541,
                                353
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        340,
                                        541,
                                        353
                                    ],
                                    "score": 0.9872367978096008,
                                    "content": "and revise their own tapes. This allows practitioners to maximally benefit from imperfect historical tapes by",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                70,
                                351,
                                541,
                                365
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        351,
                                        541,
                                        365
                                    ],
                                    "score": 1.0,
                                    "content": "earlier versions of the agent, both for evaluating the newer versions and for improving them algorithmically.",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                70,
                                363,
                                542,
                                377
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        363,
                                        542,
                                        377
                                    ],
                                    "score": 1.0,
                                    "content": "Last but not least, agents stream their intermediate events to the orchestrator to enable delightful interactive",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                71,
                                378,
                                124,
                                389
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        378,
                                        124,
                                        389
                                    ],
                                    "score": 1.0,
                                    "content": "experiences.",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        }
                    ],
                    "index": 16,
                    "page_num": "page_1",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        186,
                        542,
                        389
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        393,
                        541,
                        525
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                393,
                                541,
                                407
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        393,
                                        541,
                                        407
                                    ],
                                    "score": 1.0,
                                    "content": "We invite the reader to start their TapeAgents journey with the technical presentation of the framework in",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                71,
                                407,
                                541,
                                418
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        407,
                                        541,
                                        418
                                    ],
                                    "score": 1.0,
                                    "content": "Section 2. There, we cover the details of agent architecture, agent-environment orchestration, tape content",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                70,
                                418,
                                540,
                                430
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        418,
                                        540,
                                        430
                                    ],
                                    "score": 1.0,
                                    "content": "and structure. Section 3 describes three low-code agent-building framework prototypes on top of TapeAgents:",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                70,
                                430,
                                541,
                                443
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        430,
                                        541,
                                        443
                                    ],
                                    "score": 1.0,
                                    "content": "one for monolithic agents, another for multi-agent teams and the third one with easy-to-tune function-like",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                70,
                                441,
                                541,
                                455
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        441,
                                        541,
                                        455
                                    ],
                                    "score": 1.0,
                                    "content": "prompts. The same section also covers early versions of our Studio toolsuite for development and debugging",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                70,
                                454,
                                541,
                                467
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        454,
                                        541,
                                        467
                                    ],
                                    "score": 1.0,
                                    "content": "and our Optimize toolsuite for agent optimization. In Section 4, we present diverse examples of building and",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                71,
                                465,
                                540,
                                478
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        465,
                                        540,
                                        478
                                    ],
                                    "score": 1.0,
                                    "content": "optimizing agents using TapeAgents framework and tooling. Section 5 presents a deeper case study of a key",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                71,
                                478,
                                540,
                                491
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        478,
                                        540,
                                        491
                                    ],
                                    "score": 0.9931238889694214,
                                    "content": "practical TapeAgents use case: optimizing the quality of a cost-effective conversational assistant using tapes",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                70,
                                490,
                                541,
                                503
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        490,
                                        541,
                                        503
                                    ],
                                    "score": 0.9906154274940491,
                                    "content": "from an expensive multi-node Teacher agent. After presenting the framework and the examples we offer the",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                70,
                                501,
                                541,
                                514
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        501,
                                        541,
                                        514
                                    ],
                                    "score": 1.0,
                                    "content": "reader a detailed comparison of TapeAgents with prior work in Section 6. Lastly, Section 7 discusses possible",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                72,
                                514,
                                260,
                                526
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        514,
                                        260,
                                        526
                                    ],
                                    "score": 1.0,
                                    "content": "extensions and applications of TapeAgents.",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        }
                    ],
                    "index": 30,
                    "page_num": "page_1",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        393,
                        541,
                        526
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        539,
                        230,
                        554
                    ],
                    "lines": [
                        {
                            "bbox": [
                                69,
                                539,
                                230,
                                555
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        539,
                                        230,
                                        555
                                    ],
                                    "score": 1.0,
                                    "content": "2 TapeAgents: foundations",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        }
                    ],
                    "index": 36,
                    "page_num": "page_1",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        565,
                        540,
                        625
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                566,
                                540,
                                580
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        566,
                                        540,
                                        580
                                    ],
                                    "score": 1.0,
                                    "content": "Our TapeAgents framework proposes an agent-building paradigm that facilitates all stages of the AI Agent",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                71,
                                579,
                                541,
                                591
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        579,
                                        541,
                                        591
                                    ],
                                    "score": 1.0,
                                    "content": "development lifecycle. This section presents the framework in a detailed bottom-up approach. First, we",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                70,
                                590,
                                540,
                                603
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        590,
                                        540,
                                        603
                                    ],
                                    "score": 1.0,
                                    "content": "introduce the building blocks: the nodes, the agents, and the environment. Then, we explore how these",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                71,
                                603,
                                540,
                                614
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        603,
                                        540,
                                        614
                                    ],
                                    "score": 1.0,
                                    "content": "parts can be composed and orchestrated to build a tape-centered system. In this section, we also describe",
                                    "type": "text"
                                }
                            ],
                            "index": 40
                        },
                        {
                            "bbox": [
                                70,
                                615,
                                217,
                                627
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        615,
                                        217,
                                        627
                                    ],
                                    "score": 1.0,
                                    "content": "the tape structure and metadata.",
                                    "type": "text"
                                }
                            ],
                            "index": 41
                        }
                    ],
                    "index": 39,
                    "page_num": "page_1",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        566,
                        541,
                        627
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        72,
                        639,
                        174,
                        651
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                639,
                                174,
                                652
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        640,
                                        87,
                                        650
                                    ],
                                    "score": 1.0,
                                    "content": "2.1",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        94,
                                        639,
                                        174,
                                        652
                                    ],
                                    "score": 1.0,
                                    "content": "Nodes and Steps",
                                    "type": "text"
                                }
                            ],
                            "index": 42
                        }
                    ],
                    "index": 42,
                    "page_num": "page_1",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        660,
                        540,
                        732
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                661,
                                540,
                                675
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        661,
                                        540,
                                        675
                                    ],
                                    "score": 1.0,
                                    "content": "As outlined in Figure 1, in TapeAgents, one builds the agent from nodes: the basic atoms of intelligence.",
                                    "type": "text"
                                }
                            ],
                            "index": 43
                        },
                        {
                            "bbox": [
                                71,
                                674,
                                540,
                                686
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        674,
                                        540,
                                        686
                                    ],
                                    "score": 1.0,
                                    "content": "A node describes one LLM call and the classical symbolic processing of the call’s output. The agent will",
                                    "type": "text"
                                }
                            ],
                            "index": 44
                        },
                        {
                            "bbox": [
                                70,
                                685,
                                541,
                                699
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        685,
                                        541,
                                        699
                                    ],
                                    "score": 1.0,
                                    "content": "dynamically determine which node to run next based on the tape. Nodes generate new tape entries that we",
                                    "type": "text"
                                }
                            ],
                            "index": 45
                        },
                        {
                            "bbox": [
                                70,
                                697,
                                540,
                                711
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        697,
                                        540,
                                        711
                                    ],
                                    "score": 1.0,
                                    "content": "call steps: basic atoms of the agent’s memory. Examples of what an agent can do in a step include making",
                                    "type": "text"
                                }
                            ],
                            "index": 46
                        },
                        {
                            "bbox": [
                                70,
                                709,
                                541,
                                723
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        709,
                                        541,
                                        723
                                    ],
                                    "score": 0.9768171906471252,
                                    "content": "a long-term plan, reasoning about how to fulfill the plan or how to use a tool, requesting a tool call. Among",
                                    "type": "text"
                                }
                            ],
                            "index": 47
                        },
                        {
                            "bbox": [
                                70,
                                720,
                                542,
                                735
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        720,
                                        542,
                                        735
                                    ],
                                    "score": 1.0,
                                    "content": "these examples, the last one is an action step as it requests interaction with or has an impact on the agent’s",
                                    "type": "text"
                                }
                            ],
                            "index": 48
                        },
                        {
                            "bbox": [
                                70,
                                446,
                                541,
                                460
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        446,
                                        541,
                                        460
                                    ],
                                    "score": 0.9859452843666077,
                                    "content": "environment. The first three examples are thoughts: the agent's inner reasoning steps. The remaining step",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                71,
                                459,
                                541,
                                471
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        459,
                                        541,
                                        471
                                    ],
                                    "score": 1.0,
                                    "content": "type in TapeAgents is the observations that the agent receives from its environment in response to the",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                71,
                                471,
                                541,
                                483
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        471,
                                        541,
                                        483
                                    ],
                                    "score": 0.990005612373352,
                                    "content": "agent's actions. The reader can find an example tape with color-coded actions, thoughts and observations",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                69,
                                482,
                                542,
                                496
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        482,
                                        542,
                                        496
                                    ],
                                    "score": 0.9750307202339172,
                                    "content": " in Figure 3. In TapeAgents we often define a tape type by specifying what specific actions, thoughts, and",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                71,
                                495,
                                540,
                                507
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        495,
                                        540,
                                        507
                                    ],
                                    "score": 1.0,
                                    "content": "observations classes it can contain, though all such tapes are currently merely aliases for the one and only",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                70,
                                507,
                                194,
                                519
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        507,
                                        194,
                                        519
                                    ],
                                    "score": 1.0,
                                    "content": "tapeagents.core.Tape class.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 14
                        }
                    ],
                    "index": 45.5,
                    "page_num": "page_1",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        661,
                        542,
                        735
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "image",
                    "bbox": [
                        71,
                        81,
                        537,
                        353
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                71,
                                81,
                                537,
                                353
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        71,
                                        81,
                                        537,
                                        353
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                81,
                                                537,
                                                353
                                            ],
                                            "score": 0.974,
                                            "type": "image",
                                            "image_path": "5bb8e338f1a40fbd4bdb8120e9b28a4a2b2aaeef4cc19cfc21f21aeaef9b9ddc.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        71,
                                        81,
                                        537,
                                        171.66666666666669
                                    ],
                                    "spans": [],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        71,
                                        171.66666666666669,
                                        537,
                                        262.33333333333337
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        71,
                                        262.33333333333337,
                                        537,
                                        353.00000000000006
                                    ],
                                    "spans": [],
                                    "index": 2
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                70,
                                359,
                                541,
                                425
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        70,
                                        359,
                                        541,
                                        373
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                359,
                                                541,
                                                373
                                            ],
                                            "score": 1.0,
                                            "content": "Figure 1: TapeAgents at a glance. The orchestrator alternates between running the agent and the environment",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        70,
                                        371,
                                        542,
                                        384
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                371,
                                                542,
                                                384
                                            ],
                                            "score": 1.0,
                                            "content": "interacting with each other via adding steps to the tape: a comprehensive, replayable semantic-level log. Agents are",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                },
                                {
                                    "bbox": [
                                        71,
                                        383,
                                        541,
                                        393
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                383,
                                                541,
                                                393
                                            ],
                                            "score": 1.0,
                                            "content": "composed of basic reasoning units that we call nodes. The agents are organized in hierarchical teams, with one agent",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 5
                                },
                                {
                                    "bbox": [
                                        72,
                                        393,
                                        541,
                                        405
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                72,
                                                393,
                                                541,
                                                405
                                            ],
                                            "score": 0.9856423735618591,
                                            "content": "being active at a time. The tape and the agent configurations are highly structured and linked with rich metadata",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 6
                                },
                                {
                                    "bbox": [
                                        71,
                                        404,
                                        541,
                                        417
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                404,
                                                541,
                                                417
                                            ],
                                            "score": 1.0,
                                            "content": "that supports the implementation of broadly usable developer tools (collectively called Studio) and optimization",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 7
                                },
                                {
                                    "bbox": [
                                        72,
                                        415,
                                        229,
                                        427
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                72,
                                                415,
                                                229,
                                                427
                                            ],
                                            "score": 1.0,
                                            "content": "methods (collectively called Optimize).",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 8
                                }
                            ],
                            "index": 5.5
                        }
                    ],
                    "index": 3.25
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        445,
                        540,
                        517
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                446,
                                541,
                                460
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        446,
                                        541,
                                        460
                                    ],
                                    "score": 0.9859452843666077,
                                    "content": "environment. The first three examples are thoughts: the agent's inner reasoning steps. The remaining step",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                71,
                                459,
                                541,
                                471
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        459,
                                        541,
                                        471
                                    ],
                                    "score": 1.0,
                                    "content": "type in TapeAgents is the observations that the agent receives from its environment in response to the",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                71,
                                471,
                                541,
                                483
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        471,
                                        541,
                                        483
                                    ],
                                    "score": 0.990005612373352,
                                    "content": "agent's actions. The reader can find an example tape with color-coded actions, thoughts and observations",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                69,
                                482,
                                542,
                                496
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        482,
                                        542,
                                        496
                                    ],
                                    "score": 0.9750307202339172,
                                    "content": " in Figure 3. In TapeAgents we often define a tape type by specifying what specific actions, thoughts, and",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                71,
                                495,
                                540,
                                507
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        495,
                                        540,
                                        507
                                    ],
                                    "score": 1.0,
                                    "content": "observations classes it can contain, though all such tapes are currently merely aliases for the one and only",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                70,
                                507,
                                194,
                                519
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        507,
                                        194,
                                        519
                                    ],
                                    "score": 1.0,
                                    "content": "tapeagents.core.Tape class.",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        }
                    ],
                    "index": 11.5
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        523,
                        540,
                        559
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                524,
                                540,
                                538
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        524,
                                        540,
                                        538
                                    ],
                                    "score": 0.9891968369483948,
                                    "content": "A typical node uses an LLM to generate tape steps. One defines this process with two node methods:",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                70,
                                536,
                                541,
                                550
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        536,
                                        541,
                                        550
                                    ],
                                    "score": 1.0,
                                    "content": "make_prompt and generate_steps. First, the node constructs the LLM prompt through its make_prompt",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                70,
                                548,
                                286,
                                561
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        548,
                                        286,
                                        561
                                    ],
                                    "score": 1.0,
                                    "content": "method that has the following Python signature:",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        }
                    ],
                    "index": 16
                },
                {
                    "type": "text",
                    "bbox": [
                        199,
                        569,
                        412,
                        580
                    ],
                    "lines": [
                        {
                            "bbox": [
                                199,
                                569,
                                412,
                                582
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        199,
                                        569,
                                        412,
                                        582
                                    ],
                                    "score": 1.0,
                                    "content": "def make_prompt(self, agent, tape) -> Prompt",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        }
                    ],
                    "index": 18
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        589,
                        540,
                        636
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                590,
                                541,
                                603
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        590,
                                        541,
                                        603
                                    ],
                                    "score": 1.0,
                                    "content": "Some nodes perform only the conventional non-neural computation, like taking a branching decision. These",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                72,
                                602,
                                540,
                                614
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        602,
                                        540,
                                        614
                                    ],
                                    "score": 1.0,
                                    "content": "nodes can use the default make_prompt implementation that produces a null prompt. Note that the node",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                70,
                                614,
                                541,
                                627
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        614,
                                        541,
                                        627
                                    ],
                                    "score": 1.0,
                                    "content": "does not call the LLM directly but only makes a prompt. This is a deliberate design decision to keep all",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                71,
                                626,
                                411,
                                638
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        626,
                                        411,
                                        638
                                    ],
                                    "score": 0.9907721281051636,
                                    "content": "node methods pure functions, i.e. deterministic functions with no side effects.",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        }
                    ],
                    "index": 20.5
                },
                {
                    "type": "text",
                    "bbox": [
                        68,
                        642,
                        541,
                        667
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                644,
                                541,
                                655
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        644,
                                        541,
                                        655
                                    ],
                                    "score": 1.0,
                                    "content": "Second, the node generates steps based on the stream of tokens that it receives from the last LLM call. One",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                70,
                                655,
                                453,
                                669
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        655,
                                        453,
                                        669
                                    ],
                                    "score": 0.9914286136627197,
                                    "content": "defines the step-generating behavior of a new node class in its generate_steps method:",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        }
                    ],
                    "index": 23.5
                },
                {
                    "type": "text",
                    "bbox": [
                        105,
                        676,
                        502,
                        687
                    ],
                    "lines": [
                        {
                            "bbox": [
                                108,
                                676,
                                502,
                                690
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        108,
                                        676,
                                        502,
                                        690
                                    ],
                                    "score": 1.0,
                                    "content": "def generate_steps(self, agent, tape, llm_stream) -> Generator[Step | PartialStep]",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        }
                    ],
                    "index": 25
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        696,
                        541,
                        732
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                697,
                                541,
                                711
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        697,
                                        541,
                                        711
                                    ],
                                    "score": 1.0,
                                    "content": "If a node produced a null prompt in its make_prompt method above, the llm_stream will also be null. All",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                69,
                                708,
                                541,
                                723
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        708,
                                        541,
                                        723
                                    ],
                                    "score": 1.0,
                                    "content": "nodes must generate Step objects; some can also parse the LLM token stream incrementally to produce",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                70,
                                721,
                                542,
                                734
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        721,
                                        542,
                                        734
                                    ],
                                    "score": 1.0,
                                    "content": "partial steps which the agent will pass through to the application without adding them to the tape. Figure 2",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        }
                    ],
                    "index": 27
                }
            ],
            "layout_bboxes": [],
            "page_idx": 2,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [
                {
                    "type": "image",
                    "bbox": [
                        71,
                        81,
                        537,
                        353
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                71,
                                81,
                                537,
                                353
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        71,
                                        81,
                                        537,
                                        353
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                81,
                                                537,
                                                353
                                            ],
                                            "score": 0.974,
                                            "type": "image",
                                            "image_path": "5bb8e338f1a40fbd4bdb8120e9b28a4a2b2aaeef4cc19cfc21f21aeaef9b9ddc.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        71,
                                        81,
                                        537,
                                        171.66666666666669
                                    ],
                                    "spans": [],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        71,
                                        171.66666666666669,
                                        537,
                                        262.33333333333337
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        71,
                                        262.33333333333337,
                                        537,
                                        353.00000000000006
                                    ],
                                    "spans": [],
                                    "index": 2
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                70,
                                359,
                                541,
                                425
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        70,
                                        359,
                                        541,
                                        373
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                359,
                                                541,
                                                373
                                            ],
                                            "score": 1.0,
                                            "content": "Figure 1: TapeAgents at a glance. The orchestrator alternates between running the agent and the environment",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        70,
                                        371,
                                        542,
                                        384
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                371,
                                                542,
                                                384
                                            ],
                                            "score": 1.0,
                                            "content": "interacting with each other via adding steps to the tape: a comprehensive, replayable semantic-level log. Agents are",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                },
                                {
                                    "bbox": [
                                        71,
                                        383,
                                        541,
                                        393
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                383,
                                                541,
                                                393
                                            ],
                                            "score": 1.0,
                                            "content": "composed of basic reasoning units that we call nodes. The agents are organized in hierarchical teams, with one agent",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 5
                                },
                                {
                                    "bbox": [
                                        72,
                                        393,
                                        541,
                                        405
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                72,
                                                393,
                                                541,
                                                405
                                            ],
                                            "score": 0.9856423735618591,
                                            "content": "being active at a time. The tape and the agent configurations are highly structured and linked with rich metadata",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 6
                                },
                                {
                                    "bbox": [
                                        71,
                                        404,
                                        541,
                                        417
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                404,
                                                541,
                                                417
                                            ],
                                            "score": 1.0,
                                            "content": "that supports the implementation of broadly usable developer tools (collectively called Studio) and optimization",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 7
                                },
                                {
                                    "bbox": [
                                        72,
                                        415,
                                        229,
                                        427
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                72,
                                                415,
                                                229,
                                                427
                                            ],
                                            "score": 1.0,
                                            "content": "methods (collectively called Optimize).",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 8
                                }
                            ],
                            "index": 5.5
                        }
                    ],
                    "index": 3.25
                }
            ],
            "tables": [],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        72,
                        27,
                        143,
                        37
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                25,
                                144,
                                38
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        25,
                                        144,
                                        38
                                    ],
                                    "score": 1.0,
                                    "content": "Technical report",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        302,
                        751,
                        309,
                        760
                    ],
                    "lines": [
                        {
                            "bbox": [
                                303,
                                752,
                                309,
                                762
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        303,
                                        752,
                                        309,
                                        762
                                    ],
                                    "score": 1.0,
                                    "content": "3",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "image",
                    "bbox": [
                        71,
                        81,
                        537,
                        353
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                71,
                                81,
                                537,
                                353
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        71,
                                        81,
                                        537,
                                        353
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                81,
                                                537,
                                                353
                                            ],
                                            "score": 0.974,
                                            "type": "image",
                                            "image_path": "5bb8e338f1a40fbd4bdb8120e9b28a4a2b2aaeef4cc19cfc21f21aeaef9b9ddc.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        71,
                                        81,
                                        537,
                                        171.66666666666669
                                    ],
                                    "spans": [],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        71,
                                        171.66666666666669,
                                        537,
                                        262.33333333333337
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        71,
                                        262.33333333333337,
                                        537,
                                        353.00000000000006
                                    ],
                                    "spans": [],
                                    "index": 2
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                70,
                                359,
                                541,
                                425
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        70,
                                        359,
                                        541,
                                        373
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                359,
                                                541,
                                                373
                                            ],
                                            "score": 1.0,
                                            "content": "Figure 1: TapeAgents at a glance. The orchestrator alternates between running the agent and the environment",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        70,
                                        371,
                                        542,
                                        384
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                371,
                                                542,
                                                384
                                            ],
                                            "score": 1.0,
                                            "content": "interacting with each other via adding steps to the tape: a comprehensive, replayable semantic-level log. Agents are",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                },
                                {
                                    "bbox": [
                                        71,
                                        383,
                                        541,
                                        393
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                383,
                                                541,
                                                393
                                            ],
                                            "score": 1.0,
                                            "content": "composed of basic reasoning units that we call nodes. The agents are organized in hierarchical teams, with one agent",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 5
                                },
                                {
                                    "bbox": [
                                        72,
                                        393,
                                        541,
                                        405
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                72,
                                                393,
                                                541,
                                                405
                                            ],
                                            "score": 0.9856423735618591,
                                            "content": "being active at a time. The tape and the agent configurations are highly structured and linked with rich metadata",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 6
                                },
                                {
                                    "bbox": [
                                        71,
                                        404,
                                        541,
                                        417
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                404,
                                                541,
                                                417
                                            ],
                                            "score": 1.0,
                                            "content": "that supports the implementation of broadly usable developer tools (collectively called Studio) and optimization",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 7
                                },
                                {
                                    "bbox": [
                                        72,
                                        415,
                                        229,
                                        427
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                72,
                                                415,
                                                229,
                                                427
                                            ],
                                            "score": 1.0,
                                            "content": "methods (collectively called Optimize).",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 8
                                }
                            ],
                            "index": 5.5
                        }
                    ],
                    "index": 3.25,
                    "page_num": "page_2",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        445,
                        540,
                        517
                    ],
                    "lines": [],
                    "index": 11.5,
                    "page_num": "page_2",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        446,
                        542,
                        519
                    ],
                    "lines_deleted": true
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        523,
                        540,
                        559
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                524,
                                540,
                                538
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        524,
                                        540,
                                        538
                                    ],
                                    "score": 0.9891968369483948,
                                    "content": "A typical node uses an LLM to generate tape steps. One defines this process with two node methods:",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                70,
                                536,
                                541,
                                550
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        536,
                                        541,
                                        550
                                    ],
                                    "score": 1.0,
                                    "content": "make_prompt and generate_steps. First, the node constructs the LLM prompt through its make_prompt",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                70,
                                548,
                                286,
                                561
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        548,
                                        286,
                                        561
                                    ],
                                    "score": 1.0,
                                    "content": "method that has the following Python signature:",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        }
                    ],
                    "index": 16,
                    "page_num": "page_2",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        524,
                        541,
                        561
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        199,
                        569,
                        412,
                        580
                    ],
                    "lines": [
                        {
                            "bbox": [
                                199,
                                569,
                                412,
                                582
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        199,
                                        569,
                                        412,
                                        582
                                    ],
                                    "score": 1.0,
                                    "content": "def make_prompt(self, agent, tape) -> Prompt",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        }
                    ],
                    "index": 18,
                    "page_num": "page_2",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        199,
                        569,
                        412,
                        582
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        589,
                        540,
                        636
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                590,
                                541,
                                603
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        590,
                                        541,
                                        603
                                    ],
                                    "score": 1.0,
                                    "content": "Some nodes perform only the conventional non-neural computation, like taking a branching decision. These",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                72,
                                602,
                                540,
                                614
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        602,
                                        540,
                                        614
                                    ],
                                    "score": 1.0,
                                    "content": "nodes can use the default make_prompt implementation that produces a null prompt. Note that the node",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                70,
                                614,
                                541,
                                627
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        614,
                                        541,
                                        627
                                    ],
                                    "score": 1.0,
                                    "content": "does not call the LLM directly but only makes a prompt. This is a deliberate design decision to keep all",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                71,
                                626,
                                411,
                                638
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        626,
                                        411,
                                        638
                                    ],
                                    "score": 0.9907721281051636,
                                    "content": "node methods pure functions, i.e. deterministic functions with no side effects.",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        }
                    ],
                    "index": 20.5,
                    "page_num": "page_2",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        590,
                        541,
                        638
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        68,
                        642,
                        541,
                        667
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                644,
                                541,
                                655
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        644,
                                        541,
                                        655
                                    ],
                                    "score": 1.0,
                                    "content": "Second, the node generates steps based on the stream of tokens that it receives from the last LLM call. One",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                70,
                                655,
                                453,
                                669
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        655,
                                        453,
                                        669
                                    ],
                                    "score": 0.9914286136627197,
                                    "content": "defines the step-generating behavior of a new node class in its generate_steps method:",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        }
                    ],
                    "index": 23.5,
                    "page_num": "page_2",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        644,
                        541,
                        669
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        105,
                        676,
                        502,
                        687
                    ],
                    "lines": [
                        {
                            "bbox": [
                                108,
                                676,
                                502,
                                690
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        108,
                                        676,
                                        502,
                                        690
                                    ],
                                    "score": 1.0,
                                    "content": "def generate_steps(self, agent, tape, llm_stream) -> Generator[Step | PartialStep]",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        }
                    ],
                    "index": 25,
                    "page_num": "page_2",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        108,
                        676,
                        502,
                        690
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        696,
                        541,
                        732
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                697,
                                541,
                                711
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        697,
                                        541,
                                        711
                                    ],
                                    "score": 1.0,
                                    "content": "If a node produced a null prompt in its make_prompt method above, the llm_stream will also be null. All",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                69,
                                708,
                                541,
                                723
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        708,
                                        541,
                                        723
                                    ],
                                    "score": 1.0,
                                    "content": "nodes must generate Step objects; some can also parse the LLM token stream incrementally to produce",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                70,
                                721,
                                542,
                                734
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        721,
                                        542,
                                        734
                                    ],
                                    "score": 1.0,
                                    "content": "partial steps which the agent will pass through to the application without adding them to the tape. Figure 2",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                71,
                                83,
                                541,
                                96
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        83,
                                        541,
                                        96
                                    ],
                                    "score": 1.0,
                                    "content": "shows how the agent runs one node and adds the resulting steps to the tape, along with the relationship",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                70,
                                95,
                                256,
                                108
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        95,
                                        256,
                                        108
                                    ],
                                    "score": 1.0,
                                    "content": "between make_prompt and generate_steps.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 1
                        }
                    ],
                    "index": 27,
                    "page_num": "page_2",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        697,
                        542,
                        734
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        73,
                        82,
                        541,
                        106
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                83,
                                541,
                                96
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        83,
                                        541,
                                        96
                                    ],
                                    "score": 1.0,
                                    "content": "shows how the agent runs one node and adds the resulting steps to the tape, along with the relationship",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                70,
                                95,
                                256,
                                108
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        95,
                                        256,
                                        108
                                    ],
                                    "score": 1.0,
                                    "content": "between make_prompt and generate_steps.",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        }
                    ],
                    "index": 0.5
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        112,
                        541,
                        148
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                113,
                                541,
                                127
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        113,
                                        541,
                                        127
                                    ],
                                    "score": 1.0,
                                    "content": "By default, the agent calls its nodes sequentially and appends the steps they create to the tape that the agent",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                71,
                                126,
                                541,
                                138
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        126,
                                        541,
                                        138
                                    ],
                                    "score": 1.0,
                                    "content": "is asked to continue. A code example of a node implementing these two methods can be seen in Appendix A",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                71,
                                138,
                                223,
                                150
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        138,
                                        223,
                                        150
                                    ],
                                    "score": 1.0,
                                    "content": "under class SearchAgentMainNode.",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        }
                    ],
                    "index": 3
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        160,
                        277,
                        173
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                161,
                                277,
                                174
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        161,
                                        277,
                                        174
                                    ],
                                    "score": 1.0,
                                    "content": "2.1.1 Nodes That Can Make Training Data",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        }
                    ],
                    "index": 5
                },
                {
                    "type": "text",
                    "bbox": [
                        73,
                        181,
                        540,
                        205
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                182,
                                541,
                                196
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        182,
                                        541,
                                        196
                                    ],
                                    "score": 1.0,
                                    "content": "Some nodes also implement the reverse direction — make the LLM output that would be required to produce",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                71,
                                195,
                                379,
                                207
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        195,
                                        379,
                                        207
                                    ],
                                    "score": 1.0,
                                    "content": "the steps at a given index in the tape. The respective node method is",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        }
                    ],
                    "index": 6.5
                },
                {
                    "type": "text",
                    "bbox": [
                        164,
                        216,
                        444,
                        228
                    ],
                    "lines": [
                        {
                            "bbox": [
                                167,
                                218,
                                444,
                                228
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        167,
                                        218,
                                        444,
                                        228
                                    ],
                                    "score": 1.0,
                                    "content": "def make_llm_output(self, agent, tape, index) -> LLMOutput",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        }
                    ],
                    "index": 8
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        238,
                        295,
                        250
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                239,
                                295,
                                252
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        239,
                                        295,
                                        252
                                    ],
                                    "score": 0.9964486956596375,
                                    "content": "This method is crucial for making fine-tuning data.",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        }
                    ],
                    "index": 9
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        264,
                        128,
                        277
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                264,
                                129,
                                277
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        264,
                                        129,
                                        277
                                    ],
                                    "score": 1.0,
                                    "content": "2.2 Agents",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        }
                    ],
                    "index": 10
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        286,
                        343,
                        465
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                287,
                                344,
                                300
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        287,
                                        344,
                                        300
                                    ],
                                    "score": 1.0,
                                    "content": "Like nodes, a TapeAgent agent generates steps and makes a",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                71,
                                300,
                                342,
                                311
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        300,
                                        342,
                                        311
                                    ],
                                    "score": 1.0,
                                    "content": "new tape by appending the generated steps to the input tape.",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                71,
                                312,
                                343,
                                323
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        312,
                                        343,
                                        323
                                    ],
                                    "score": 0.9987324476242065,
                                    "content": "Specifically, agent.run(tape) runs an iterative reasoning loop",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                71,
                                323,
                                343,
                                335
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        323,
                                        343,
                                        335
                                    ],
                                    "score": 1.0,
                                    "content": "that, at every iteration, selects a node, lets it make the prompt",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                71,
                                336,
                                343,
                                346
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        336,
                                        343,
                                        346
                                    ],
                                    "score": 1.0,
                                    "content": "and generates the next steps (see Figure 2). By default, the",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                71,
                                348,
                                344,
                                358
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        348,
                                        344,
                                        358
                                    ],
                                    "score": 1.0,
                                    "content": "agent will run its nodes sequentially, unless the previous node",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                70,
                                359,
                                343,
                                371
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        359,
                                        343,
                                        371
                                    ],
                                    "score": 1.0,
                                    "content": "produced a special SetNextNode step that explicitly the de-",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                70,
                                371,
                                344,
                                383
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        371,
                                        344,
                                        383
                                    ],
                                    "score": 1.0,
                                    "content": "termines the next that will run next. The loop continues as",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                70,
                                383,
                                344,
                                395
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        383,
                                        344,
                                        395
                                    ],
                                    "score": 1.0,
                                    "content": "long as the nodes only generate thoughts. When a node pro-",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                71,
                                394,
                                344,
                                407
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        394,
                                        344,
                                        407
                                    ],
                                    "score": 1.0,
                                    "content": "duces an action, the agent stops and returns a new tape with",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                71,
                                407,
                                344,
                                419
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        407,
                                        344,
                                        419
                                    ],
                                    "score": 1.0,
                                    "content": "the generated steps from all iterations appended to it. More",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                71,
                                420,
                                343,
                                430
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        420,
                                        343,
                                        430
                                    ],
                                    "score": 1.0,
                                    "content": "precisely, agent.run(tape) returns an AgentStream object for",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                71,
                                431,
                                344,
                                442
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        431,
                                        344,
                                        442
                                    ],
                                    "score": 0.9915620684623718,
                                    "content": "streaming events like partial tapes and steps, but the final",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                70,
                                443,
                                344,
                                455
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        443,
                                        344,
                                        455
                                    ],
                                    "score": 1.0,
                                    "content": "new agent tape is easy to extract from the stream object using",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                71,
                                455,
                                245,
                                466
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        455,
                                        245,
                                        466
                                    ],
                                    "score": 1.0,
                                    "content": "AgentStream.get_final_tape() method.",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        }
                    ],
                    "index": 18
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        472,
                        343,
                        579
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                473,
                                343,
                                484
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        473,
                                        343,
                                        484
                                    ],
                                    "score": 1.0,
                                    "content": "An agent may have subagents for whom this agent is the",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                71,
                                485,
                                343,
                                497
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        485,
                                        343,
                                        497
                                    ],
                                    "score": 1.0,
                                    "content": "manager. The subagents can have further subagents, which",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                71,
                                497,
                                343,
                                509
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        497,
                                        343,
                                        509
                                    ],
                                    "score": 1.0,
                                    "content": "gives rise to a hierarchical agent organization with a single",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                71,
                                509,
                                343,
                                520
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        509,
                                        343,
                                        520
                                    ],
                                    "score": 1.0,
                                    "content": "manager-free root agent on top. Given an input tape, the",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                71,
                                522,
                                343,
                                532
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        522,
                                        343,
                                        532
                                    ],
                                    "score": 1.0,
                                    "content": "root agent determines the next active organization member to",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                71,
                                533,
                                343,
                                544
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        533,
                                        343,
                                        544
                                    ],
                                    "score": 1.0,
                                    "content": "which it will delegate the generation of next steps. By de-",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                71,
                                545,
                                342,
                                556
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        545,
                                        342,
                                        556
                                    ],
                                    "score": 1.0,
                                    "content": "fault, the root agent makes the delegation decision by look-",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                70,
                                557,
                                343,
                                568
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        557,
                                        343,
                                        568
                                    ],
                                    "score": 1.0,
                                    "content": "ing at the special Call and Respond thoughts. When an agent",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                70,
                                567,
                                344,
                                581
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        567,
                                        344,
                                        581
                                    ],
                                    "score": 1.0,
                                    "content": "A wants the root to delegate to an agent B, A will append",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        }
                    ],
                    "index": 30
                },
                {
                    "type": "image",
                    "bbox": [
                        353,
                        276,
                        534,
                        473
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                353,
                                276,
                                534,
                                473
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        353,
                                        276,
                                        534,
                                        473
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                353,
                                                276,
                                                534,
                                                473
                                            ],
                                            "score": 0.971,
                                            "type": "image",
                                            "image_path": "cfe206fd2bd2955ca904a5b76ea6b894fe730132f7689539f5ce72364885eaba.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 43,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        353,
                                        276,
                                        534,
                                        288.0
                                    ],
                                    "spans": [],
                                    "index": 35
                                },
                                {
                                    "bbox": [
                                        353,
                                        288.0,
                                        534,
                                        300.0
                                    ],
                                    "spans": [],
                                    "index": 36
                                },
                                {
                                    "bbox": [
                                        353,
                                        300.0,
                                        534,
                                        312.0
                                    ],
                                    "spans": [],
                                    "index": 37
                                },
                                {
                                    "bbox": [
                                        353,
                                        312.0,
                                        534,
                                        324.0
                                    ],
                                    "spans": [],
                                    "index": 38
                                },
                                {
                                    "bbox": [
                                        353,
                                        324.0,
                                        534,
                                        336.0
                                    ],
                                    "spans": [],
                                    "index": 39
                                },
                                {
                                    "bbox": [
                                        353,
                                        336.0,
                                        534,
                                        348.0
                                    ],
                                    "spans": [],
                                    "index": 40
                                },
                                {
                                    "bbox": [
                                        353,
                                        348.0,
                                        534,
                                        360.0
                                    ],
                                    "spans": [],
                                    "index": 41
                                },
                                {
                                    "bbox": [
                                        353,
                                        360.0,
                                        534,
                                        372.0
                                    ],
                                    "spans": [],
                                    "index": 42
                                },
                                {
                                    "bbox": [
                                        353,
                                        372.0,
                                        534,
                                        384.0
                                    ],
                                    "spans": [],
                                    "index": 43
                                },
                                {
                                    "bbox": [
                                        353,
                                        384.0,
                                        534,
                                        396.0
                                    ],
                                    "spans": [],
                                    "index": 44
                                },
                                {
                                    "bbox": [
                                        353,
                                        396.0,
                                        534,
                                        408.0
                                    ],
                                    "spans": [],
                                    "index": 45
                                },
                                {
                                    "bbox": [
                                        353,
                                        408.0,
                                        534,
                                        420.0
                                    ],
                                    "spans": [],
                                    "index": 46
                                },
                                {
                                    "bbox": [
                                        353,
                                        420.0,
                                        534,
                                        432.0
                                    ],
                                    "spans": [],
                                    "index": 47
                                },
                                {
                                    "bbox": [
                                        353,
                                        432.0,
                                        534,
                                        444.0
                                    ],
                                    "spans": [],
                                    "index": 48
                                },
                                {
                                    "bbox": [
                                        353,
                                        444.0,
                                        534,
                                        456.0
                                    ],
                                    "spans": [],
                                    "index": 49
                                },
                                {
                                    "bbox": [
                                        353,
                                        456.0,
                                        534,
                                        468.0
                                    ],
                                    "spans": [],
                                    "index": 50
                                },
                                {
                                    "bbox": [
                                        353,
                                        468.0,
                                        534,
                                        480.0
                                    ],
                                    "spans": [],
                                    "index": 51
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                352,
                                479,
                                541,
                                567
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        352,
                                        480,
                                        541,
                                        491
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                352,
                                                480,
                                                403,
                                                491
                                            ],
                                            "score": 1.0,
                                            "content": "Figure 2:",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                403,
                                                480,
                                                411,
                                                489
                                            ],
                                            "score": 0.32,
                                            "content": "A",
                                            "type": "inline_equation",
                                            "height": 9,
                                            "width": 8
                                        },
                                        {
                                            "bbox": [
                                                411,
                                                480,
                                                541,
                                                491
                                            ],
                                            "score": 1.0,
                                            "content": " reasoning loop of an agent in",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 52
                                },
                                {
                                    "bbox": [
                                        353,
                                        491,
                                        541,
                                        502
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                353,
                                                491,
                                                541,
                                                502
                                            ],
                                            "score": 1.0,
                                            "content": "TapeAgents. The root agent delegates to a",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 53
                                },
                                {
                                    "bbox": [
                                        352,
                                        502,
                                        541,
                                        513
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                352,
                                                502,
                                                541,
                                                513
                                            ],
                                            "score": 1.0,
                                            "content": "subagent, the subagent selects the node, the",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 54
                                },
                                {
                                    "bbox": [
                                        352,
                                        513,
                                        541,
                                        524
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                352,
                                                513,
                                                541,
                                                524
                                            ],
                                            "score": 1.0,
                                            "content": "node makes the prompt. The subagent calls",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 55
                                },
                                {
                                    "bbox": [
                                        352,
                                        524,
                                        541,
                                        535
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                352,
                                                524,
                                                541,
                                                535
                                            ],
                                            "score": 1.0,
                                            "content": "the LLM with the prompt and lets the node",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 56
                                },
                                {
                                    "bbox": [
                                        351,
                                        535,
                                        541,
                                        545
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                351,
                                                535,
                                                541,
                                                545
                                            ],
                                            "score": 1.0,
                                            "content": "process the resulting stream of tokens (LLM-",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 57
                                },
                                {
                                    "bbox": [
                                        352,
                                        546,
                                        541,
                                        557
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                352,
                                                546,
                                                541,
                                                557
                                            ],
                                            "score": 1.0,
                                            "content": "Stream) that the root agent will then append",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 58
                                },
                                {
                                    "bbox": [
                                        352,
                                        558,
                                        400,
                                        568
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                352,
                                                558,
                                                400,
                                                568
                                            ],
                                            "score": 1.0,
                                            "content": "to the tape.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 59
                                }
                            ],
                            "index": 55.5
                        }
                    ],
                    "index": 49.25
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        580,
                        541,
                        651
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                581,
                                540,
                                593
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        581,
                                        142,
                                        593
                                    ],
                                    "score": 1.0,
                                    "content": "Call(agent_name",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        143,
                                        581,
                                        160,
                                        590
                                    ],
                                    "score": 0.28,
                                    "content": "\\mathbf{\\tau}=\\mathbf{\\tau}^{\\prime\\prime}\\mathsf{B}^{\\prime\\prime}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 17
                                },
                                {
                                    "bbox": [
                                        161,
                                        581,
                                        204,
                                        593
                                    ],
                                    "score": 1.0,
                                    "content": ", content",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        205,
                                        582,
                                        211,
                                        589
                                    ],
                                    "score": 0.43,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        211,
                                        581,
                                        540,
                                        593
                                    ],
                                    "score": 1.0,
                                    "content": "...) thought to the tape with an optional free-form message in the content",
                                    "type": "text"
                                }
                            ],
                            "index": 60
                        },
                        {
                            "bbox": [
                                70,
                                592,
                                541,
                                606
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        592,
                                        541,
                                        606
                                    ],
                                    "score": 0.9745988845825195,
                                    "content": "field. When B responds by appending Respond(content=...), A becomes active again. Note that both Call",
                                    "type": "text"
                                }
                            ],
                            "index": 61
                        },
                        {
                            "bbox": [
                                71,
                                605,
                                540,
                                617
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        605,
                                        540,
                                        617
                                    ],
                                    "score": 0.9934819340705872,
                                    "content": "and Respond will affect the delegation logic at the nert agent iteration. To sum up the delegation description,",
                                    "type": "text"
                                }
                            ],
                            "index": 62
                        },
                        {
                            "bbox": [
                                71,
                                617,
                                541,
                                629
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        617,
                                        541,
                                        629
                                    ],
                                    "score": 1.0,
                                    "content": "the root delegates to the agent that was called last and has not responded yet. See Figure 3 for an example",
                                    "type": "text"
                                }
                            ],
                            "index": 63
                        },
                        {
                            "bbox": [
                                71,
                                629,
                                541,
                                641
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        629,
                                        541,
                                        641
                                    ],
                                    "score": 0.995770275592804,
                                    "content": "of communication between a financial analyst agent and its web search helper. See Appendix A for a listing",
                                    "type": "text"
                                }
                            ],
                            "index": 64
                        },
                        {
                            "bbox": [
                                71,
                                640,
                                239,
                                652
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        640,
                                        239,
                                        652
                                    ],
                                    "score": 1.0,
                                    "content": "of the complete code for this example.",
                                    "type": "text"
                                }
                            ],
                            "index": 65
                        }
                    ],
                    "index": 62.5
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        663,
                        159,
                        676
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                664,
                                159,
                                676
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        664,
                                        96,
                                        676
                                    ],
                                    "score": 1.0,
                                    "content": "2.2.1",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        104,
                                        664,
                                        159,
                                        676
                                    ],
                                    "score": 1.0,
                                    "content": "Tape Views",
                                    "type": "text"
                                }
                            ],
                            "index": 66
                        }
                    ],
                    "index": 66
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        685,
                        540,
                        732
                    ],
                    "lines": [
                        {
                            "bbox": [
                                69,
                                685,
                                540,
                                698
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        685,
                                        540,
                                        698
                                    ],
                                    "score": 0.9924373626708984,
                                    "content": " In a multi-agent system different agents usually are expected to maintain their respective different states.",
                                    "type": "text"
                                }
                            ],
                            "index": 67
                        },
                        {
                            "bbox": [
                                70,
                                698,
                                540,
                                709
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        698,
                                        540,
                                        709
                                    ],
                                    "score": 1.0,
                                    "content": "In TapeAgents the tape combines the states of all agents in the team. To determine what they should base",
                                    "type": "text"
                                }
                            ],
                            "index": 68
                        },
                        {
                            "bbox": [
                                70,
                                709,
                                539,
                                722
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        709,
                                        539,
                                        722
                                    ],
                                    "score": 1.0,
                                    "content": "their acting and reasoning on, most agents use tape view stack. For each agent that has not responded yet,",
                                    "type": "text"
                                }
                            ],
                            "index": 69
                        },
                        {
                            "bbox": [
                                71,
                                722,
                                541,
                                734
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        722,
                                        541,
                                        734
                                    ],
                                    "score": 0.9952885508537292,
                                    "content": "the view contains the steps that this agent can see. Specifically, for an agent A the view contains the tape's",
                                    "type": "text"
                                }
                            ],
                            "index": 70
                        }
                    ],
                    "index": 68.5
                }
            ],
            "layout_bboxes": [],
            "page_idx": 3,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [
                {
                    "type": "image",
                    "bbox": [
                        353,
                        276,
                        534,
                        473
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                353,
                                276,
                                534,
                                473
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        353,
                                        276,
                                        534,
                                        473
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                353,
                                                276,
                                                534,
                                                473
                                            ],
                                            "score": 0.971,
                                            "type": "image",
                                            "image_path": "cfe206fd2bd2955ca904a5b76ea6b894fe730132f7689539f5ce72364885eaba.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 43,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        353,
                                        276,
                                        534,
                                        288.0
                                    ],
                                    "spans": [],
                                    "index": 35
                                },
                                {
                                    "bbox": [
                                        353,
                                        288.0,
                                        534,
                                        300.0
                                    ],
                                    "spans": [],
                                    "index": 36
                                },
                                {
                                    "bbox": [
                                        353,
                                        300.0,
                                        534,
                                        312.0
                                    ],
                                    "spans": [],
                                    "index": 37
                                },
                                {
                                    "bbox": [
                                        353,
                                        312.0,
                                        534,
                                        324.0
                                    ],
                                    "spans": [],
                                    "index": 38
                                },
                                {
                                    "bbox": [
                                        353,
                                        324.0,
                                        534,
                                        336.0
                                    ],
                                    "spans": [],
                                    "index": 39
                                },
                                {
                                    "bbox": [
                                        353,
                                        336.0,
                                        534,
                                        348.0
                                    ],
                                    "spans": [],
                                    "index": 40
                                },
                                {
                                    "bbox": [
                                        353,
                                        348.0,
                                        534,
                                        360.0
                                    ],
                                    "spans": [],
                                    "index": 41
                                },
                                {
                                    "bbox": [
                                        353,
                                        360.0,
                                        534,
                                        372.0
                                    ],
                                    "spans": [],
                                    "index": 42
                                },
                                {
                                    "bbox": [
                                        353,
                                        372.0,
                                        534,
                                        384.0
                                    ],
                                    "spans": [],
                                    "index": 43
                                },
                                {
                                    "bbox": [
                                        353,
                                        384.0,
                                        534,
                                        396.0
                                    ],
                                    "spans": [],
                                    "index": 44
                                },
                                {
                                    "bbox": [
                                        353,
                                        396.0,
                                        534,
                                        408.0
                                    ],
                                    "spans": [],
                                    "index": 45
                                },
                                {
                                    "bbox": [
                                        353,
                                        408.0,
                                        534,
                                        420.0
                                    ],
                                    "spans": [],
                                    "index": 46
                                },
                                {
                                    "bbox": [
                                        353,
                                        420.0,
                                        534,
                                        432.0
                                    ],
                                    "spans": [],
                                    "index": 47
                                },
                                {
                                    "bbox": [
                                        353,
                                        432.0,
                                        534,
                                        444.0
                                    ],
                                    "spans": [],
                                    "index": 48
                                },
                                {
                                    "bbox": [
                                        353,
                                        444.0,
                                        534,
                                        456.0
                                    ],
                                    "spans": [],
                                    "index": 49
                                },
                                {
                                    "bbox": [
                                        353,
                                        456.0,
                                        534,
                                        468.0
                                    ],
                                    "spans": [],
                                    "index": 50
                                },
                                {
                                    "bbox": [
                                        353,
                                        468.0,
                                        534,
                                        480.0
                                    ],
                                    "spans": [],
                                    "index": 51
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                352,
                                479,
                                541,
                                567
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        352,
                                        480,
                                        541,
                                        491
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                352,
                                                480,
                                                403,
                                                491
                                            ],
                                            "score": 1.0,
                                            "content": "Figure 2:",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                403,
                                                480,
                                                411,
                                                489
                                            ],
                                            "score": 0.32,
                                            "content": "A",
                                            "type": "inline_equation",
                                            "height": 9,
                                            "width": 8
                                        },
                                        {
                                            "bbox": [
                                                411,
                                                480,
                                                541,
                                                491
                                            ],
                                            "score": 1.0,
                                            "content": " reasoning loop of an agent in",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 52
                                },
                                {
                                    "bbox": [
                                        353,
                                        491,
                                        541,
                                        502
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                353,
                                                491,
                                                541,
                                                502
                                            ],
                                            "score": 1.0,
                                            "content": "TapeAgents. The root agent delegates to a",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 53
                                },
                                {
                                    "bbox": [
                                        352,
                                        502,
                                        541,
                                        513
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                352,
                                                502,
                                                541,
                                                513
                                            ],
                                            "score": 1.0,
                                            "content": "subagent, the subagent selects the node, the",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 54
                                },
                                {
                                    "bbox": [
                                        352,
                                        513,
                                        541,
                                        524
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                352,
                                                513,
                                                541,
                                                524
                                            ],
                                            "score": 1.0,
                                            "content": "node makes the prompt. The subagent calls",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 55
                                },
                                {
                                    "bbox": [
                                        352,
                                        524,
                                        541,
                                        535
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                352,
                                                524,
                                                541,
                                                535
                                            ],
                                            "score": 1.0,
                                            "content": "the LLM with the prompt and lets the node",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 56
                                },
                                {
                                    "bbox": [
                                        351,
                                        535,
                                        541,
                                        545
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                351,
                                                535,
                                                541,
                                                545
                                            ],
                                            "score": 1.0,
                                            "content": "process the resulting stream of tokens (LLM-",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 57
                                },
                                {
                                    "bbox": [
                                        352,
                                        546,
                                        541,
                                        557
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                352,
                                                546,
                                                541,
                                                557
                                            ],
                                            "score": 1.0,
                                            "content": "Stream) that the root agent will then append",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 58
                                },
                                {
                                    "bbox": [
                                        352,
                                        558,
                                        400,
                                        568
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                352,
                                                558,
                                                400,
                                                568
                                            ],
                                            "score": 1.0,
                                            "content": "to the tape.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 59
                                }
                            ],
                            "index": 55.5
                        }
                    ],
                    "index": 49.25
                }
            ],
            "tables": [],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        71,
                        27,
                        143,
                        37
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                25,
                                144,
                                38
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        25,
                                        144,
                                        38
                                    ],
                                    "score": 1.0,
                                    "content": "Technical report",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        302,
                        752,
                        309,
                        760
                    ],
                    "lines": [
                        {
                            "bbox": [
                                302,
                                751,
                                309,
                                762
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        302,
                                        751,
                                        309,
                                        762
                                    ],
                                    "score": 1.0,
                                    "content": "4",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        73,
                        82,
                        541,
                        106
                    ],
                    "lines": [],
                    "index": 0.5,
                    "page_num": "page_3",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        83,
                        541,
                        108
                    ],
                    "lines_deleted": true
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        112,
                        541,
                        148
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                113,
                                541,
                                127
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        113,
                                        541,
                                        127
                                    ],
                                    "score": 1.0,
                                    "content": "By default, the agent calls its nodes sequentially and appends the steps they create to the tape that the agent",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                71,
                                126,
                                541,
                                138
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        126,
                                        541,
                                        138
                                    ],
                                    "score": 1.0,
                                    "content": "is asked to continue. A code example of a node implementing these two methods can be seen in Appendix A",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                71,
                                138,
                                223,
                                150
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        138,
                                        223,
                                        150
                                    ],
                                    "score": 1.0,
                                    "content": "under class SearchAgentMainNode.",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        }
                    ],
                    "index": 3,
                    "page_num": "page_3",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        113,
                        541,
                        150
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        160,
                        277,
                        173
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                161,
                                277,
                                174
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        161,
                                        277,
                                        174
                                    ],
                                    "score": 1.0,
                                    "content": "2.1.1 Nodes That Can Make Training Data",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        }
                    ],
                    "index": 5,
                    "page_num": "page_3",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        73,
                        181,
                        540,
                        205
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                182,
                                541,
                                196
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        182,
                                        541,
                                        196
                                    ],
                                    "score": 1.0,
                                    "content": "Some nodes also implement the reverse direction — make the LLM output that would be required to produce",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                71,
                                195,
                                379,
                                207
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        195,
                                        379,
                                        207
                                    ],
                                    "score": 1.0,
                                    "content": "the steps at a given index in the tape. The respective node method is",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        }
                    ],
                    "index": 6.5,
                    "page_num": "page_3",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        71,
                        182,
                        541,
                        207
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        164,
                        216,
                        444,
                        228
                    ],
                    "lines": [
                        {
                            "bbox": [
                                167,
                                218,
                                444,
                                228
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        167,
                                        218,
                                        444,
                                        228
                                    ],
                                    "score": 1.0,
                                    "content": "def make_llm_output(self, agent, tape, index) -> LLMOutput",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        }
                    ],
                    "index": 8,
                    "page_num": "page_3",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        167,
                        218,
                        444,
                        228
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        238,
                        295,
                        250
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                239,
                                295,
                                252
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        239,
                                        295,
                                        252
                                    ],
                                    "score": 0.9964486956596375,
                                    "content": "This method is crucial for making fine-tuning data.",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        }
                    ],
                    "index": 9,
                    "page_num": "page_3",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        71,
                        239,
                        295,
                        252
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        264,
                        128,
                        277
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                264,
                                129,
                                277
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        264,
                                        129,
                                        277
                                    ],
                                    "score": 1.0,
                                    "content": "2.2 Agents",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        }
                    ],
                    "index": 10,
                    "page_num": "page_3",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        286,
                        343,
                        465
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                287,
                                344,
                                300
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        287,
                                        344,
                                        300
                                    ],
                                    "score": 1.0,
                                    "content": "Like nodes, a TapeAgent agent generates steps and makes a",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                71,
                                300,
                                342,
                                311
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        300,
                                        342,
                                        311
                                    ],
                                    "score": 1.0,
                                    "content": "new tape by appending the generated steps to the input tape.",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                71,
                                312,
                                343,
                                323
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        312,
                                        343,
                                        323
                                    ],
                                    "score": 0.9987324476242065,
                                    "content": "Specifically, agent.run(tape) runs an iterative reasoning loop",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                71,
                                323,
                                343,
                                335
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        323,
                                        343,
                                        335
                                    ],
                                    "score": 1.0,
                                    "content": "that, at every iteration, selects a node, lets it make the prompt",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                71,
                                336,
                                343,
                                346
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        336,
                                        343,
                                        346
                                    ],
                                    "score": 1.0,
                                    "content": "and generates the next steps (see Figure 2). By default, the",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                71,
                                348,
                                344,
                                358
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        348,
                                        344,
                                        358
                                    ],
                                    "score": 1.0,
                                    "content": "agent will run its nodes sequentially, unless the previous node",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                70,
                                359,
                                343,
                                371
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        359,
                                        343,
                                        371
                                    ],
                                    "score": 1.0,
                                    "content": "produced a special SetNextNode step that explicitly the de-",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                70,
                                371,
                                344,
                                383
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        371,
                                        344,
                                        383
                                    ],
                                    "score": 1.0,
                                    "content": "termines the next that will run next. The loop continues as",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                70,
                                383,
                                344,
                                395
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        383,
                                        344,
                                        395
                                    ],
                                    "score": 1.0,
                                    "content": "long as the nodes only generate thoughts. When a node pro-",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                71,
                                394,
                                344,
                                407
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        394,
                                        344,
                                        407
                                    ],
                                    "score": 1.0,
                                    "content": "duces an action, the agent stops and returns a new tape with",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                71,
                                407,
                                344,
                                419
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        407,
                                        344,
                                        419
                                    ],
                                    "score": 1.0,
                                    "content": "the generated steps from all iterations appended to it. More",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                71,
                                420,
                                343,
                                430
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        420,
                                        343,
                                        430
                                    ],
                                    "score": 1.0,
                                    "content": "precisely, agent.run(tape) returns an AgentStream object for",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                71,
                                431,
                                344,
                                442
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        431,
                                        344,
                                        442
                                    ],
                                    "score": 0.9915620684623718,
                                    "content": "streaming events like partial tapes and steps, but the final",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                70,
                                443,
                                344,
                                455
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        443,
                                        344,
                                        455
                                    ],
                                    "score": 1.0,
                                    "content": "new agent tape is easy to extract from the stream object using",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                71,
                                455,
                                245,
                                466
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        455,
                                        245,
                                        466
                                    ],
                                    "score": 1.0,
                                    "content": "AgentStream.get_final_tape() method.",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        }
                    ],
                    "index": 18,
                    "page_num": "page_3",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        287,
                        344,
                        466
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        472,
                        343,
                        579
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                473,
                                343,
                                484
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        473,
                                        343,
                                        484
                                    ],
                                    "score": 1.0,
                                    "content": "An agent may have subagents for whom this agent is the",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                71,
                                485,
                                343,
                                497
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        485,
                                        343,
                                        497
                                    ],
                                    "score": 1.0,
                                    "content": "manager. The subagents can have further subagents, which",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                71,
                                497,
                                343,
                                509
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        497,
                                        343,
                                        509
                                    ],
                                    "score": 1.0,
                                    "content": "gives rise to a hierarchical agent organization with a single",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                71,
                                509,
                                343,
                                520
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        509,
                                        343,
                                        520
                                    ],
                                    "score": 1.0,
                                    "content": "manager-free root agent on top. Given an input tape, the",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                71,
                                522,
                                343,
                                532
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        522,
                                        343,
                                        532
                                    ],
                                    "score": 1.0,
                                    "content": "root agent determines the next active organization member to",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                71,
                                533,
                                343,
                                544
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        533,
                                        343,
                                        544
                                    ],
                                    "score": 1.0,
                                    "content": "which it will delegate the generation of next steps. By de-",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                71,
                                545,
                                342,
                                556
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        545,
                                        342,
                                        556
                                    ],
                                    "score": 1.0,
                                    "content": "fault, the root agent makes the delegation decision by look-",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                70,
                                557,
                                343,
                                568
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        557,
                                        343,
                                        568
                                    ],
                                    "score": 1.0,
                                    "content": "ing at the special Call and Respond thoughts. When an agent",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                70,
                                567,
                                344,
                                581
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        567,
                                        344,
                                        581
                                    ],
                                    "score": 1.0,
                                    "content": "A wants the root to delegate to an agent B, A will append",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        }
                    ],
                    "index": 30,
                    "page_num": "page_3",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        473,
                        344,
                        581
                    ]
                },
                {
                    "type": "image",
                    "bbox": [
                        353,
                        276,
                        534,
                        473
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                353,
                                276,
                                534,
                                473
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        353,
                                        276,
                                        534,
                                        473
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                353,
                                                276,
                                                534,
                                                473
                                            ],
                                            "score": 0.971,
                                            "type": "image",
                                            "image_path": "cfe206fd2bd2955ca904a5b76ea6b894fe730132f7689539f5ce72364885eaba.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 43,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        353,
                                        276,
                                        534,
                                        288.0
                                    ],
                                    "spans": [],
                                    "index": 35
                                },
                                {
                                    "bbox": [
                                        353,
                                        288.0,
                                        534,
                                        300.0
                                    ],
                                    "spans": [],
                                    "index": 36
                                },
                                {
                                    "bbox": [
                                        353,
                                        300.0,
                                        534,
                                        312.0
                                    ],
                                    "spans": [],
                                    "index": 37
                                },
                                {
                                    "bbox": [
                                        353,
                                        312.0,
                                        534,
                                        324.0
                                    ],
                                    "spans": [],
                                    "index": 38
                                },
                                {
                                    "bbox": [
                                        353,
                                        324.0,
                                        534,
                                        336.0
                                    ],
                                    "spans": [],
                                    "index": 39
                                },
                                {
                                    "bbox": [
                                        353,
                                        336.0,
                                        534,
                                        348.0
                                    ],
                                    "spans": [],
                                    "index": 40
                                },
                                {
                                    "bbox": [
                                        353,
                                        348.0,
                                        534,
                                        360.0
                                    ],
                                    "spans": [],
                                    "index": 41
                                },
                                {
                                    "bbox": [
                                        353,
                                        360.0,
                                        534,
                                        372.0
                                    ],
                                    "spans": [],
                                    "index": 42
                                },
                                {
                                    "bbox": [
                                        353,
                                        372.0,
                                        534,
                                        384.0
                                    ],
                                    "spans": [],
                                    "index": 43
                                },
                                {
                                    "bbox": [
                                        353,
                                        384.0,
                                        534,
                                        396.0
                                    ],
                                    "spans": [],
                                    "index": 44
                                },
                                {
                                    "bbox": [
                                        353,
                                        396.0,
                                        534,
                                        408.0
                                    ],
                                    "spans": [],
                                    "index": 45
                                },
                                {
                                    "bbox": [
                                        353,
                                        408.0,
                                        534,
                                        420.0
                                    ],
                                    "spans": [],
                                    "index": 46
                                },
                                {
                                    "bbox": [
                                        353,
                                        420.0,
                                        534,
                                        432.0
                                    ],
                                    "spans": [],
                                    "index": 47
                                },
                                {
                                    "bbox": [
                                        353,
                                        432.0,
                                        534,
                                        444.0
                                    ],
                                    "spans": [],
                                    "index": 48
                                },
                                {
                                    "bbox": [
                                        353,
                                        444.0,
                                        534,
                                        456.0
                                    ],
                                    "spans": [],
                                    "index": 49
                                },
                                {
                                    "bbox": [
                                        353,
                                        456.0,
                                        534,
                                        468.0
                                    ],
                                    "spans": [],
                                    "index": 50
                                },
                                {
                                    "bbox": [
                                        353,
                                        468.0,
                                        534,
                                        480.0
                                    ],
                                    "spans": [],
                                    "index": 51
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                352,
                                479,
                                541,
                                567
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        352,
                                        480,
                                        541,
                                        491
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                352,
                                                480,
                                                403,
                                                491
                                            ],
                                            "score": 1.0,
                                            "content": "Figure 2:",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                403,
                                                480,
                                                411,
                                                489
                                            ],
                                            "score": 0.32,
                                            "content": "A",
                                            "type": "inline_equation",
                                            "height": 9,
                                            "width": 8
                                        },
                                        {
                                            "bbox": [
                                                411,
                                                480,
                                                541,
                                                491
                                            ],
                                            "score": 1.0,
                                            "content": " reasoning loop of an agent in",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 52
                                },
                                {
                                    "bbox": [
                                        353,
                                        491,
                                        541,
                                        502
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                353,
                                                491,
                                                541,
                                                502
                                            ],
                                            "score": 1.0,
                                            "content": "TapeAgents. The root agent delegates to a",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 53
                                },
                                {
                                    "bbox": [
                                        352,
                                        502,
                                        541,
                                        513
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                352,
                                                502,
                                                541,
                                                513
                                            ],
                                            "score": 1.0,
                                            "content": "subagent, the subagent selects the node, the",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 54
                                },
                                {
                                    "bbox": [
                                        352,
                                        513,
                                        541,
                                        524
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                352,
                                                513,
                                                541,
                                                524
                                            ],
                                            "score": 1.0,
                                            "content": "node makes the prompt. The subagent calls",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 55
                                },
                                {
                                    "bbox": [
                                        352,
                                        524,
                                        541,
                                        535
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                352,
                                                524,
                                                541,
                                                535
                                            ],
                                            "score": 1.0,
                                            "content": "the LLM with the prompt and lets the node",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 56
                                },
                                {
                                    "bbox": [
                                        351,
                                        535,
                                        541,
                                        545
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                351,
                                                535,
                                                541,
                                                545
                                            ],
                                            "score": 1.0,
                                            "content": "process the resulting stream of tokens (LLM-",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 57
                                },
                                {
                                    "bbox": [
                                        352,
                                        546,
                                        541,
                                        557
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                352,
                                                546,
                                                541,
                                                557
                                            ],
                                            "score": 1.0,
                                            "content": "Stream) that the root agent will then append",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 58
                                },
                                {
                                    "bbox": [
                                        352,
                                        558,
                                        400,
                                        568
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                352,
                                                558,
                                                400,
                                                568
                                            ],
                                            "score": 1.0,
                                            "content": "to the tape.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 59
                                }
                            ],
                            "index": 55.5
                        }
                    ],
                    "index": 49.25,
                    "page_num": "page_3",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        580,
                        541,
                        651
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                581,
                                540,
                                593
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        581,
                                        142,
                                        593
                                    ],
                                    "score": 1.0,
                                    "content": "Call(agent_name",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        143,
                                        581,
                                        160,
                                        590
                                    ],
                                    "score": 0.28,
                                    "content": "\\mathbf{\\tau}=\\mathbf{\\tau}^{\\prime\\prime}\\mathsf{B}^{\\prime\\prime}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 17
                                },
                                {
                                    "bbox": [
                                        161,
                                        581,
                                        204,
                                        593
                                    ],
                                    "score": 1.0,
                                    "content": ", content",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        205,
                                        582,
                                        211,
                                        589
                                    ],
                                    "score": 0.43,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        211,
                                        581,
                                        540,
                                        593
                                    ],
                                    "score": 1.0,
                                    "content": "...) thought to the tape with an optional free-form message in the content",
                                    "type": "text"
                                }
                            ],
                            "index": 60
                        },
                        {
                            "bbox": [
                                70,
                                592,
                                541,
                                606
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        592,
                                        541,
                                        606
                                    ],
                                    "score": 0.9745988845825195,
                                    "content": "field. When B responds by appending Respond(content=...), A becomes active again. Note that both Call",
                                    "type": "text"
                                }
                            ],
                            "index": 61
                        },
                        {
                            "bbox": [
                                71,
                                605,
                                540,
                                617
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        605,
                                        540,
                                        617
                                    ],
                                    "score": 0.9934819340705872,
                                    "content": "and Respond will affect the delegation logic at the nert agent iteration. To sum up the delegation description,",
                                    "type": "text"
                                }
                            ],
                            "index": 62
                        },
                        {
                            "bbox": [
                                71,
                                617,
                                541,
                                629
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        617,
                                        541,
                                        629
                                    ],
                                    "score": 1.0,
                                    "content": "the root delegates to the agent that was called last and has not responded yet. See Figure 3 for an example",
                                    "type": "text"
                                }
                            ],
                            "index": 63
                        },
                        {
                            "bbox": [
                                71,
                                629,
                                541,
                                641
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        629,
                                        541,
                                        641
                                    ],
                                    "score": 0.995770275592804,
                                    "content": "of communication between a financial analyst agent and its web search helper. See Appendix A for a listing",
                                    "type": "text"
                                }
                            ],
                            "index": 64
                        },
                        {
                            "bbox": [
                                71,
                                640,
                                239,
                                652
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        640,
                                        239,
                                        652
                                    ],
                                    "score": 1.0,
                                    "content": "of the complete code for this example.",
                                    "type": "text"
                                }
                            ],
                            "index": 65
                        }
                    ],
                    "index": 62.5,
                    "page_num": "page_3",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        581,
                        541,
                        652
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        663,
                        159,
                        676
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                664,
                                159,
                                676
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        664,
                                        96,
                                        676
                                    ],
                                    "score": 1.0,
                                    "content": "2.2.1",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        104,
                                        664,
                                        159,
                                        676
                                    ],
                                    "score": 1.0,
                                    "content": "Tape Views",
                                    "type": "text"
                                }
                            ],
                            "index": 66
                        }
                    ],
                    "index": 66,
                    "page_num": "page_3",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        685,
                        540,
                        732
                    ],
                    "lines": [
                        {
                            "bbox": [
                                69,
                                685,
                                540,
                                698
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        685,
                                        540,
                                        698
                                    ],
                                    "score": 0.9924373626708984,
                                    "content": " In a multi-agent system different agents usually are expected to maintain their respective different states.",
                                    "type": "text"
                                }
                            ],
                            "index": 67
                        },
                        {
                            "bbox": [
                                70,
                                698,
                                540,
                                709
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        698,
                                        540,
                                        709
                                    ],
                                    "score": 1.0,
                                    "content": "In TapeAgents the tape combines the states of all agents in the team. To determine what they should base",
                                    "type": "text"
                                }
                            ],
                            "index": 68
                        },
                        {
                            "bbox": [
                                70,
                                709,
                                539,
                                722
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        709,
                                        539,
                                        722
                                    ],
                                    "score": 1.0,
                                    "content": "their acting and reasoning on, most agents use tape view stack. For each agent that has not responded yet,",
                                    "type": "text"
                                }
                            ],
                            "index": 69
                        },
                        {
                            "bbox": [
                                71,
                                722,
                                541,
                                734
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        722,
                                        541,
                                        734
                                    ],
                                    "score": 0.9952885508537292,
                                    "content": "the view contains the steps that this agent can see. Specifically, for an agent A the view contains the tape's",
                                    "type": "text"
                                }
                            ],
                            "index": 70
                        },
                        {
                            "bbox": [
                                70,
                                84,
                                540,
                                97
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        84,
                                        540,
                                        97
                                    ],
                                    "score": 1.0,
                                    "content": "steps starting from the Call step that initiated A’s activity and excluding the inner steps of the subagents",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                71,
                                95,
                                540,
                                108
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        95,
                                        540,
                                        108
                                    ],
                                    "score": 1.0,
                                    "content": "that A called (see Figure 3). Note that the default tape view stack is only one possible way to determine",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                72,
                                108,
                                540,
                                119
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        108,
                                        540,
                                        119
                                    ],
                                    "score": 1.0,
                                    "content": "what parts of the tape each agent should see. For example, one can let an agent see all its prior Call steps",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                70,
                                118,
                                270,
                                133
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        118,
                                        270,
                                        133
                                    ],
                                    "score": 1.0,
                                    "content": "to enable an inter-agent conversation history.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 3
                        }
                    ],
                    "index": 68.5,
                    "page_num": "page_3",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        685,
                        541,
                        734
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        71,
                        82,
                        540,
                        130
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                84,
                                540,
                                97
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        84,
                                        540,
                                        97
                                    ],
                                    "score": 1.0,
                                    "content": "steps starting from the Call step that initiated A’s activity and excluding the inner steps of the subagents",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                71,
                                95,
                                540,
                                108
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        95,
                                        540,
                                        108
                                    ],
                                    "score": 1.0,
                                    "content": "that A called (see Figure 3). Note that the default tape view stack is only one possible way to determine",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                72,
                                108,
                                540,
                                119
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        108,
                                        540,
                                        119
                                    ],
                                    "score": 1.0,
                                    "content": "what parts of the tape each agent should see. For example, one can let an agent see all its prior Call steps",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                70,
                                118,
                                270,
                                133
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        118,
                                        270,
                                        133
                                    ],
                                    "score": 1.0,
                                    "content": "to enable an inter-agent conversation history.",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        }
                    ],
                    "index": 1.5
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        136,
                        540,
                        172
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                137,
                                541,
                                150
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        137,
                                        541,
                                        150
                                    ],
                                    "score": 0.9928669929504395,
                                    "content": "A reader familiar with how Python interpreter works can find agents similar to Python functions, node",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                70,
                                148,
                                541,
                                163
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        148,
                                        541,
                                        163
                                    ],
                                    "score": 1.0,
                                    "content": "similar to lines of Python code, steps similar to Python bytecode instructions, the tape view stack similar",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                71,
                                161,
                                362,
                                173
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        161,
                                        362,
                                        173
                                    ],
                                    "score": 1.0,
                                    "content": "to the Python call stack and tape views similar to Python frames.",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        }
                    ],
                    "index": 5
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        185,
                        196,
                        198
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                186,
                                195,
                                199
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        186,
                                        195,
                                        199
                                    ],
                                    "score": 1.0,
                                    "content": "2.2.2 Optimizable Agents",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        }
                    ],
                    "index": 7
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        206,
                        540,
                        278
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                207,
                                539,
                                221
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        207,
                                        539,
                                        221
                                    ],
                                    "score": 1.0,
                                    "content": "Agent optimization algorithms tune agent prompts (Khattab et al., 2023a; Pryzant et al., 2023; Zhou et al.,",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                70,
                                219,
                                541,
                                233
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        219,
                                        541,
                                        233
                                    ],
                                    "score": 1.0,
                                    "content": "2023b) or alter agent structure (Hu et al., 2024) in order to maximize the agent’s performance. To make such",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                70,
                                231,
                                539,
                                245
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        231,
                                        539,
                                        245
                                    ],
                                    "score": 0.9876230955123901,
                                    "content": "algorithms applicable to as many agents as possible, we standardize the structure of the agent configuration.",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                70,
                                243,
                                540,
                                257
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        243,
                                        540,
                                        257
                                    ],
                                    "score": 0.9824298620223999,
                                    "content": "We achieve this by making tapeagents .agent.Agent a Pydantic model4 with the following mandatory fields:",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                72,
                                254,
                                541,
                                269
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        254,
                                        541,
                                        269
                                    ],
                                    "score": 0.9902187585830688,
                                    "content": ".1lms for the LLM configurations, .templates for the prompt templates, .nodes for the nodes, and .subagents",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                71,
                                268,
                                150,
                                280
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        268,
                                        150,
                                        280
                                    ],
                                    "score": 1.0,
                                    "content": "for the subagents.",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        }
                    ],
                    "index": 10.5
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        284,
                        540,
                        333
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                285,
                                540,
                                298
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        285,
                                        540,
                                        298
                                    ],
                                    "score": 1.0,
                                    "content": "Agents can also make training data for the LLM that they use. An agent’s agent.make_training_text(tape)",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                70,
                                297,
                                541,
                                311
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        297,
                                        541,
                                        311
                                    ],
                                    "score": 1.0,
                                    "content": "method reconstructs the LLM calls from a given tape, validates the reconstruction by replaying the step gener-",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                70,
                                309,
                                541,
                                322
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        309,
                                        541,
                                        322
                                    ],
                                    "score": 1.0,
                                    "content": "ation and returns training text characters. Internally, agent.make_training_text uses node.make_llm_output",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                72,
                                322,
                                540,
                                334
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        322,
                                        540,
                                        334
                                    ],
                                    "score": 1.0,
                                    "content": "method introduced in Section 2.1.1; hence all nodes must implement this method for the agent to be trainable.",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        }
                    ],
                    "index": 15.5
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        347,
                        155,
                        360
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                348,
                                155,
                                359
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        348,
                                        88,
                                        359
                                    ],
                                    "score": 1.0,
                                    "content": "2.3",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        95,
                                        348,
                                        155,
                                        359
                                    ],
                                    "score": 1.0,
                                    "content": "Environment",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        }
                    ],
                    "index": 18
                },
                {
                    "type": "text",
                    "bbox": [
                        73,
                        369,
                        541,
                        394
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                370,
                                541,
                                384
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        370,
                                        541,
                                        384
                                    ],
                                    "score": 1.0,
                                    "content": "Just like nodes and agents, the environment in TapeAgents makes a new tape by adding steps to an existing",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                71,
                                383,
                                303,
                                395
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        383,
                                        303,
                                        395
                                    ],
                                    "score": 1.0,
                                    "content": "tape. The main method of an environment object is:",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        }
                    ],
                    "index": 19.5
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        428,
                        541,
                        489
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                430,
                                540,
                                442
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        430,
                                        540,
                                        442
                                    ],
                                    "score": 0.9857066869735718,
                                    "content": " The environment .react searches for the unfulfilled actions in the tape and adds the corresponding observa-",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                70,
                                442,
                                541,
                                453
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        442,
                                        541,
                                        453
                                    ],
                                    "score": 1.0,
                                    "content": "tion steps to the tape. Unlike nodes and agents, the environment may be non-deterministic and have side",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                70,
                                454,
                                540,
                                466
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        454,
                                        540,
                                        466
                                    ],
                                    "score": 0.9875059127807617,
                                    "content": "effects. We encourage agent developers to put all the deterministic and pure-function aspects of the system",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                69,
                                466,
                                541,
                                479
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        466,
                                        541,
                                        479
                                    ],
                                    "score": 1.0,
                                    "content": "in the agent part, isolating only non-deterministic, computationally heavy or transactional aspects in the",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                71,
                                478,
                                151,
                                491
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        478,
                                        151,
                                        491
                                    ],
                                    "score": 1.0,
                                    "content": "environment part.",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        }
                    ],
                    "index": 23
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        504,
                        159,
                        516
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                503,
                                160,
                                516
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        503,
                                        160,
                                        516
                                    ],
                                    "score": 1.0,
                                    "content": "2.4 Orchestration",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        }
                    ],
                    "index": 26
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        526,
                        541,
                        586
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                527,
                                540,
                                540
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        527,
                                        540,
                                        540
                                    ],
                                    "score": 1.0,
                                    "content": "To run a TapeAgent-based agentic application, one must alternate between running the root agent (which",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                72,
                                540,
                                539,
                                551
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        540,
                                        539,
                                        551
                                    ],
                                    "score": 1.0,
                                    "content": "handles the delegation internally) and calling the environment to react to the agent’s actions (see Figure 1).",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                70,
                                550,
                                541,
                                565
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        550,
                                        541,
                                        565
                                    ],
                                    "score": 1.0,
                                    "content": "While we provide a default tapeagents.orchestrator.main_loop orchestrator for this purpose, we expect",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                70,
                                563,
                                542,
                                576
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        563,
                                        542,
                                        576
                                    ],
                                    "score": 1.0,
                                    "content": "many application developers to build their custom orchestrators to closely control the agent-environment",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                70,
                                575,
                                333,
                                587
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        575,
                                        333,
                                        587
                                    ],
                                    "score": 1.0,
                                    "content": "communication and ensure safety or enhance iteration logic.",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        }
                    ],
                    "index": 29
                },
                {
                    "type": "title",
                    "bbox": [
                        72,
                        599,
                        213,
                        612
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                600,
                                213,
                                614
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        600,
                                        213,
                                        614
                                    ],
                                    "score": 1.0,
                                    "content": "2.4.1 Resumption and Replay",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        }
                    ],
                    "index": 32
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        621,
                        541,
                        693
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                621,
                                541,
                                635
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        621,
                                        541,
                                        635
                                    ],
                                    "score": 1.0,
                                    "content": "We designed TapeAgents with resumption and replay as key priorities. To resume, one can just restart",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                70,
                                633,
                                540,
                                648
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        633,
                                        540,
                                        648
                                    ],
                                    "score": 1.0,
                                    "content": "the orchestration from an intermediate tape. For testing purposes, one can run an agent with replayed",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                70,
                                645,
                                540,
                                659
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        645,
                                        540,
                                        659
                                    ],
                                    "score": 0.9951456189155579,
                                    "content": "observations and LLM outputs and verify that this process leads to the same tape or print the diff otherwise.",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                70,
                                657,
                                541,
                                671
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        657,
                                        541,
                                        671
                                    ],
                                    "score": 1.0,
                                    "content": "We found the replay tests to be incredibly helpful in our development work. When applicable, one can also",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                71,
                                670,
                                540,
                                682
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        670,
                                        540,
                                        682
                                    ],
                                    "score": 1.0,
                                    "content": "replay the tape’s observations (or even some of the agent’s steps) in a new session to evaluate a new agent,",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                71,
                                681,
                                509,
                                694
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        681,
                                        509,
                                        694
                                    ],
                                    "score": 1.0,
                                    "content": "though the old observations can be implausible if the new tape deviates too much from the old one.",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        }
                    ],
                    "index": 35.5
                }
            ],
            "layout_bboxes": [],
            "page_idx": 4,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        70,
                        703,
                        541,
                        732
                    ],
                    "lines": [
                        {
                            "bbox": [
                                81,
                                701,
                                542,
                                717
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        81,
                                        701,
                                        542,
                                        717
                                    ],
                                    "score": 1.0,
                                    "content": "4Pydantic models, from the Python pydantic package, provide robust data validation and parsing, ensuring that input",
                                    "type": "text"
                                }
                            ]
                        },
                        {
                            "bbox": [
                                71,
                                713,
                                541,
                                724
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        713,
                                        541,
                                        724
                                    ],
                                    "score": 0.9860478043556213,
                                    "content": "data is properly structured and typed. This not only improves reliability by catching errors early but also simplifies code by",
                                    "type": "text"
                                }
                            ]
                        },
                        {
                            "bbox": [
                                71,
                                723,
                                347,
                                733
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        723,
                                        347,
                                        733
                                    ],
                                    "score": 1.0,
                                    "content": "automatically handling serialization, deserialization, and type conversions.",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        72,
                        27,
                        143,
                        37
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                26,
                                144,
                                38
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        26,
                                        144,
                                        38
                                    ],
                                    "score": 1.0,
                                    "content": "Technical report",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        302,
                        751,
                        308,
                        760
                    ],
                    "lines": [
                        {
                            "bbox": [
                                303,
                                752,
                                309,
                                761
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        303,
                                        752,
                                        309,
                                        761
                                    ],
                                    "score": 1.0,
                                    "content": "5",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        71,
                        82,
                        540,
                        130
                    ],
                    "lines": [],
                    "index": 1.5,
                    "page_num": "page_4",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        84,
                        540,
                        133
                    ],
                    "lines_deleted": true
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        136,
                        540,
                        172
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                137,
                                541,
                                150
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        137,
                                        541,
                                        150
                                    ],
                                    "score": 0.9928669929504395,
                                    "content": "A reader familiar with how Python interpreter works can find agents similar to Python functions, node",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                70,
                                148,
                                541,
                                163
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        148,
                                        541,
                                        163
                                    ],
                                    "score": 1.0,
                                    "content": "similar to lines of Python code, steps similar to Python bytecode instructions, the tape view stack similar",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                71,
                                161,
                                362,
                                173
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        161,
                                        362,
                                        173
                                    ],
                                    "score": 1.0,
                                    "content": "to the Python call stack and tape views similar to Python frames.",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        }
                    ],
                    "index": 5,
                    "page_num": "page_4",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        137,
                        541,
                        173
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        185,
                        196,
                        198
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                186,
                                195,
                                199
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        186,
                                        195,
                                        199
                                    ],
                                    "score": 1.0,
                                    "content": "2.2.2 Optimizable Agents",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        }
                    ],
                    "index": 7,
                    "page_num": "page_4",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        206,
                        540,
                        278
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                207,
                                539,
                                221
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        207,
                                        539,
                                        221
                                    ],
                                    "score": 1.0,
                                    "content": "Agent optimization algorithms tune agent prompts (Khattab et al., 2023a; Pryzant et al., 2023; Zhou et al.,",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                70,
                                219,
                                541,
                                233
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        219,
                                        541,
                                        233
                                    ],
                                    "score": 1.0,
                                    "content": "2023b) or alter agent structure (Hu et al., 2024) in order to maximize the agent’s performance. To make such",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                70,
                                231,
                                539,
                                245
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        231,
                                        539,
                                        245
                                    ],
                                    "score": 0.9876230955123901,
                                    "content": "algorithms applicable to as many agents as possible, we standardize the structure of the agent configuration.",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                70,
                                243,
                                540,
                                257
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        243,
                                        540,
                                        257
                                    ],
                                    "score": 0.9824298620223999,
                                    "content": "We achieve this by making tapeagents .agent.Agent a Pydantic model4 with the following mandatory fields:",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                72,
                                254,
                                541,
                                269
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        254,
                                        541,
                                        269
                                    ],
                                    "score": 0.9902187585830688,
                                    "content": ".1lms for the LLM configurations, .templates for the prompt templates, .nodes for the nodes, and .subagents",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                71,
                                268,
                                150,
                                280
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        268,
                                        150,
                                        280
                                    ],
                                    "score": 1.0,
                                    "content": "for the subagents.",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        }
                    ],
                    "index": 10.5,
                    "page_num": "page_4",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        207,
                        541,
                        280
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        284,
                        540,
                        333
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                285,
                                540,
                                298
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        285,
                                        540,
                                        298
                                    ],
                                    "score": 1.0,
                                    "content": "Agents can also make training data for the LLM that they use. An agent’s agent.make_training_text(tape)",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                70,
                                297,
                                541,
                                311
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        297,
                                        541,
                                        311
                                    ],
                                    "score": 1.0,
                                    "content": "method reconstructs the LLM calls from a given tape, validates the reconstruction by replaying the step gener-",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                70,
                                309,
                                541,
                                322
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        309,
                                        541,
                                        322
                                    ],
                                    "score": 1.0,
                                    "content": "ation and returns training text characters. Internally, agent.make_training_text uses node.make_llm_output",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                72,
                                322,
                                540,
                                334
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        322,
                                        540,
                                        334
                                    ],
                                    "score": 1.0,
                                    "content": "method introduced in Section 2.1.1; hence all nodes must implement this method for the agent to be trainable.",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        }
                    ],
                    "index": 15.5,
                    "page_num": "page_4",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        285,
                        541,
                        334
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        347,
                        155,
                        360
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                348,
                                155,
                                359
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        348,
                                        88,
                                        359
                                    ],
                                    "score": 1.0,
                                    "content": "2.3",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        95,
                                        348,
                                        155,
                                        359
                                    ],
                                    "score": 1.0,
                                    "content": "Environment",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        }
                    ],
                    "index": 18,
                    "page_num": "page_4",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        73,
                        369,
                        541,
                        394
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                370,
                                541,
                                384
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        370,
                                        541,
                                        384
                                    ],
                                    "score": 1.0,
                                    "content": "Just like nodes and agents, the environment in TapeAgents makes a new tape by adding steps to an existing",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                71,
                                383,
                                303,
                                395
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        383,
                                        303,
                                        395
                                    ],
                                    "score": 1.0,
                                    "content": "tape. The main method of an environment object is:",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        }
                    ],
                    "index": 19.5,
                    "page_num": "page_4",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        71,
                        370,
                        541,
                        395
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        428,
                        541,
                        489
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                430,
                                540,
                                442
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        430,
                                        540,
                                        442
                                    ],
                                    "score": 0.9857066869735718,
                                    "content": " The environment .react searches for the unfulfilled actions in the tape and adds the corresponding observa-",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                70,
                                442,
                                541,
                                453
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        442,
                                        541,
                                        453
                                    ],
                                    "score": 1.0,
                                    "content": "tion steps to the tape. Unlike nodes and agents, the environment may be non-deterministic and have side",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                70,
                                454,
                                540,
                                466
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        454,
                                        540,
                                        466
                                    ],
                                    "score": 0.9875059127807617,
                                    "content": "effects. We encourage agent developers to put all the deterministic and pure-function aspects of the system",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                69,
                                466,
                                541,
                                479
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        466,
                                        541,
                                        479
                                    ],
                                    "score": 1.0,
                                    "content": "in the agent part, isolating only non-deterministic, computationally heavy or transactional aspects in the",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                71,
                                478,
                                151,
                                491
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        478,
                                        151,
                                        491
                                    ],
                                    "score": 1.0,
                                    "content": "environment part.",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        }
                    ],
                    "index": 23,
                    "page_num": "page_4",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        430,
                        541,
                        491
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        504,
                        159,
                        516
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                503,
                                160,
                                516
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        503,
                                        160,
                                        516
                                    ],
                                    "score": 1.0,
                                    "content": "2.4 Orchestration",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        }
                    ],
                    "index": 26,
                    "page_num": "page_4",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        526,
                        541,
                        586
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                527,
                                540,
                                540
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        527,
                                        540,
                                        540
                                    ],
                                    "score": 1.0,
                                    "content": "To run a TapeAgent-based agentic application, one must alternate between running the root agent (which",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                72,
                                540,
                                539,
                                551
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        540,
                                        539,
                                        551
                                    ],
                                    "score": 1.0,
                                    "content": "handles the delegation internally) and calling the environment to react to the agent’s actions (see Figure 1).",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                70,
                                550,
                                541,
                                565
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        550,
                                        541,
                                        565
                                    ],
                                    "score": 1.0,
                                    "content": "While we provide a default tapeagents.orchestrator.main_loop orchestrator for this purpose, we expect",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                70,
                                563,
                                542,
                                576
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        563,
                                        542,
                                        576
                                    ],
                                    "score": 1.0,
                                    "content": "many application developers to build their custom orchestrators to closely control the agent-environment",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                70,
                                575,
                                333,
                                587
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        575,
                                        333,
                                        587
                                    ],
                                    "score": 1.0,
                                    "content": "communication and ensure safety or enhance iteration logic.",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        }
                    ],
                    "index": 29,
                    "page_num": "page_4",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        527,
                        542,
                        587
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        72,
                        599,
                        213,
                        612
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                600,
                                213,
                                614
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        600,
                                        213,
                                        614
                                    ],
                                    "score": 1.0,
                                    "content": "2.4.1 Resumption and Replay",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        }
                    ],
                    "index": 32,
                    "page_num": "page_4",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        621,
                        541,
                        693
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                621,
                                541,
                                635
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        621,
                                        541,
                                        635
                                    ],
                                    "score": 1.0,
                                    "content": "We designed TapeAgents with resumption and replay as key priorities. To resume, one can just restart",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                70,
                                633,
                                540,
                                648
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        633,
                                        540,
                                        648
                                    ],
                                    "score": 1.0,
                                    "content": "the orchestration from an intermediate tape. For testing purposes, one can run an agent with replayed",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                70,
                                645,
                                540,
                                659
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        645,
                                        540,
                                        659
                                    ],
                                    "score": 0.9951456189155579,
                                    "content": "observations and LLM outputs and verify that this process leads to the same tape or print the diff otherwise.",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                70,
                                657,
                                541,
                                671
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        657,
                                        541,
                                        671
                                    ],
                                    "score": 1.0,
                                    "content": "We found the replay tests to be incredibly helpful in our development work. When applicable, one can also",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                71,
                                670,
                                540,
                                682
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        670,
                                        540,
                                        682
                                    ],
                                    "score": 1.0,
                                    "content": "replay the tape’s observations (or even some of the agent’s steps) in a new session to evaluate a new agent,",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                71,
                                681,
                                509,
                                694
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        681,
                                        509,
                                        694
                                    ],
                                    "score": 1.0,
                                    "content": "though the old observations can be implausible if the new tape deviates too much from the old one.",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        }
                    ],
                    "index": 35.5,
                    "page_num": "page_4",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        621,
                        541,
                        694
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "title",
                    "bbox": [
                        71,
                        81,
                        280,
                        95
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                83,
                                280,
                                96
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        83,
                                        280,
                                        96
                                    ],
                                    "score": 1.0,
                                    "content": "2.5 Tape Metadata and LLM Call Database",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        }
                    ],
                    "index": 0
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        104,
                        542,
                        128
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                106,
                                541,
                                117
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        106,
                                        541,
                                        117
                                    ],
                                    "score": 1.0,
                                    "content": "Regardless of the orchestration method, the implementations of agent.run() and environment.react() ensure",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                71,
                                117,
                                389,
                                129
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        117,
                                        389,
                                        129
                                    ],
                                    "score": 0.9936821460723877,
                                    "content": "that the tape and its steps contain rich metadata, including these fields:",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        }
                    ],
                    "index": 1.5
                },
                {
                    "type": "text",
                    "bbox": [
                        95,
                        143,
                        542,
                        282
                    ],
                    "lines": [
                        {
                            "bbox": [
                                95,
                                145,
                                541,
                                158
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        145,
                                        541,
                                        158
                                    ],
                                    "score": 1.0,
                                    "content": "• tape.metadata.author: which agent or environment made this tape; either by authoring it, or by",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                106,
                                155,
                                366,
                                169
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        155,
                                        366,
                                        169
                                    ],
                                    "score": 1.0,
                                    "content": "adding steps to it, or by making a revision of another tape.",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                97,
                                180,
                                540,
                                192
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        97,
                                        180,
                                        540,
                                        192
                                    ],
                                    "score": 1.0,
                                    "content": "• tape.metadata.parent_id: the ID of the parent tape of which the current tape is a continuation",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                106,
                                190,
                                189,
                                204
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        190,
                                        189,
                                        204
                                    ],
                                    "score": 1.0,
                                    "content": "(when applicable).",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                94,
                                213,
                                463,
                                228
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        94,
                                        213,
                                        463,
                                        228
                                    ],
                                    "score": 1.0,
                                    "content": "• step.metadata.agent: the hierarchical name of the agent that generated the step.",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                94,
                                235,
                                402,
                                250
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        94,
                                        235,
                                        402,
                                        250
                                    ],
                                    "score": 1.0,
                                    "content": "• step.metadata.node: the name of the node that generated the step.",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                95,
                                259,
                                540,
                                273
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        259,
                                        540,
                                        273
                                    ],
                                    "score": 0.9856149554252625,
                                    "content": "· step.metadata.prompt-id: the identifier (id) of the prompt that led to the generation of this step,",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                105,
                                271,
                                224,
                                285
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        271,
                                        224,
                                        285
                                    ],
                                    "score": 1.0,
                                    "content": "see the explanation below.",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        }
                    ],
                    "index": 6.5
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        298,
                        541,
                        370
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                298,
                                541,
                                312
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        298,
                                        541,
                                        312
                                    ],
                                    "score": 1.0,
                                    "content": "When an agent runs a node, the node generates a unique ID for the prompt that it builds at this iteration.",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                71,
                                311,
                                540,
                                324
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        311,
                                        540,
                                        324
                                    ],
                                    "score": 0.9733691811561584,
                                    "content": "The prompt ID thus serves as the unique identifier of a node execution, i.e., of a specific iteration when the",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                71,
                                323,
                                542,
                                335
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        323,
                                        542,
                                        335
                                    ],
                                    "score": 1.0,
                                    "content": "node was active. The ID also links the step to the LLM call from the node run so we can trace the origin of",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                71,
                                335,
                                541,
                                348
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        335,
                                        541,
                                        348
                                    ],
                                    "score": 0.9906222820281982,
                                    "content": "each step down to the specific prompt and LLM output. We store the prompt and the output for all LLM",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                71,
                                347,
                                542,
                                361
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        347,
                                        542,
                                        361
                                    ],
                                    "score": 0.9919792413711548,
                                    "content": "calls in an SQLite database. One can view LLM calls as an effective part of the tape in that they are always",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                71,
                                359,
                                429,
                                371
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        359,
                                        429,
                                        371
                                    ],
                                    "score": 1.0,
                                    "content": "easily accessible; we don’t include them in the tape to keep the latter lightweight.",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        }
                    ],
                    "index": 13.5
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        375,
                        536,
                        399
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                376,
                                538,
                                389
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        376,
                                        538,
                                        389
                                    ],
                                    "score": 1.0,
                                    "content": "The metadata is crucial for building the tooling and the algorithms that empower the agent developer.",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                71,
                                389,
                                312,
                                400
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        389,
                                        312,
                                        400
                                    ],
                                    "score": 0.9940663576126099,
                                    "content": "Figure 3 shows a visualization of some metadata fields.",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        }
                    ],
                    "index": 17.5
                },
                {
                    "type": "title",
                    "bbox": [
                        72,
                        415,
                        205,
                        430
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                416,
                                204,
                                432
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        418,
                                        80,
                                        429
                                    ],
                                    "score": 1.0,
                                    "content": "3",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        89,
                                        416,
                                        204,
                                        432
                                    ],
                                    "score": 1.0,
                                    "content": "TapeAgents: tooling",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        }
                    ],
                    "index": 19
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        443,
                        541,
                        490
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                444,
                                541,
                                457
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        444,
                                        541,
                                        457
                                    ],
                                    "score": 1.0,
                                    "content": "The TapeAgents foundation that we covered in Section 2 allows the creation of a wide range of reusable",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                71,
                                456,
                                540,
                                468
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        456,
                                        540,
                                        468
                                    ],
                                    "score": 1.0,
                                    "content": "agent components, tooling and learning algorithms. What the right building blocks and tooling are often",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                70,
                                467,
                                541,
                                480
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        467,
                                        541,
                                        480
                                    ],
                                    "score": 1.0,
                                    "content": "depends on the application area. In our initial release, we provide several prototypes to jump-start future",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                70,
                                480,
                                191,
                                492
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        480,
                                        191,
                                        492
                                    ],
                                    "score": 1.0,
                                    "content": "open-source collaborations.",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        }
                    ],
                    "index": 21.5
                },
                {
                    "type": "title",
                    "bbox": [
                        72,
                        505,
                        222,
                        518
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                506,
                                222,
                                518
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        506,
                                        222,
                                        518
                                    ],
                                    "score": 1.0,
                                    "content": "3.1 Low-code Mini-Frameworks",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        }
                    ],
                    "index": 24
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        528,
                        541,
                        564
                    ],
                    "lines": [
                        {
                            "bbox": [
                                69,
                                527,
                                542,
                                543
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        527,
                                        542,
                                        543
                                    ],
                                    "score": 1.0,
                                    "content": "Building agents requires implementing many similar template rendering (node.make_prompt) and text parsing",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                72,
                                541,
                                540,
                                555
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        541,
                                        540,
                                        555
                                    ],
                                    "score": 1.0,
                                    "content": "(node.generate_steps) routines. As a part of TapeAgents, we provide three examples of low-code mini-",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                70,
                                552,
                                453,
                                565
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        552,
                                        453,
                                        565
                                    ],
                                    "score": 0.993519127368927,
                                    "content": "frameworks for building agents by composing and configuring off-the-shelf components:",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        }
                    ],
                    "index": 26
                },
                {
                    "type": "text",
                    "bbox": [
                        94,
                        578,
                        541,
                        639
                    ],
                    "lines": [
                        {
                            "bbox": [
                                93,
                                579,
                                541,
                                593
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        93,
                                        579,
                                        541,
                                        593
                                    ],
                                    "score": 0.9931896328926086,
                                    "content": "1. MonoAgent exemplifies the most straightforward way to implement a monolithic agent: make a",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                108,
                                593,
                                540,
                                604
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        108,
                                        593,
                                        540,
                                        604
                                    ],
                                    "score": 1.0,
                                    "content": "comprehensive prompt from all the data from the tape and the possible step schemas, then parse the",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                105,
                                603,
                                541,
                                618
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        603,
                                        541,
                                        618
                                    ],
                                    "score": 1.0,
                                    "content": "LLM output using the schemas. One creates a MonoAgent from MonoNode nodes whose prompts",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                106,
                                616,
                                541,
                                628
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        616,
                                        541,
                                        628
                                    ],
                                    "score": 0.9872633218765259,
                                    "content": "are the same except for the final user message instruction. A MonoAgent also requires the agent",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                107,
                                627,
                                491,
                                641
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        627,
                                        491,
                                        641
                                    ],
                                    "score": 1.0,
                                    "content": "developer to provide Pydantic models for all possible steps that the agent can generate.",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        }
                    ],
                    "index": 30
                },
                {
                    "type": "text",
                    "bbox": [
                        93,
                        649,
                        542,
                        686
                    ],
                    "lines": [
                        {
                            "bbox": [
                                93,
                                651,
                                541,
                                663
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        93,
                                        651,
                                        541,
                                        663
                                    ],
                                    "score": 1.0,
                                    "content": "2. TeamAgent shows how an AutoGen-style agent team can work in one tape. One can create three",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                105,
                                661,
                                541,
                                676
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        661,
                                        541,
                                        676
                                    ],
                                    "score": 0.987693727016449,
                                    "content": " different kinds of team agents: (a) an initiator that send the first Call message, (b) a manager that",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                107,
                                675,
                                496,
                                687
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        675,
                                        496,
                                        687
                                    ],
                                    "score": 1.0,
                                    "content": "chooses the next active agent, (c) a worker agent that responds using its system prompt.",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        }
                    ],
                    "index": 34
                },
                {
                    "type": "text",
                    "bbox": [
                        94,
                        696,
                        541,
                        732
                    ],
                    "lines": [
                        {
                            "bbox": [
                                92,
                                696,
                                540,
                                711
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        92,
                                        696,
                                        540,
                                        711
                                    ],
                                    "score": 1.0,
                                    "content": "3. LLMFunction demonstrates how one can build agents using function-style prompt templates, akin",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                106,
                                709,
                                540,
                                723
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        709,
                                        540,
                                        723
                                    ],
                                    "score": 1.0,
                                    "content": "to DSPy signatures. These prompt templates are particularly easy to optimize by adding demon-",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                107,
                                722,
                                148,
                                733
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        722,
                                        148,
                                        733
                                    ],
                                    "score": 1.0,
                                    "content": "strations.",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        }
                    ],
                    "index": 37
                }
            ],
            "layout_bboxes": [],
            "page_idx": 5,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        71,
                        27,
                        143,
                        37
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                25,
                                144,
                                38
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        25,
                                        144,
                                        38
                                    ],
                                    "score": 1.0,
                                    "content": "Technical report",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        302,
                        751,
                        309,
                        760
                    ],
                    "lines": [
                        {
                            "bbox": [
                                302,
                                752,
                                309,
                                762
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        302,
                                        752,
                                        309,
                                        762
                                    ],
                                    "score": 1.0,
                                    "content": "6",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "title",
                    "bbox": [
                        71,
                        81,
                        280,
                        95
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                83,
                                280,
                                96
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        83,
                                        280,
                                        96
                                    ],
                                    "score": 1.0,
                                    "content": "2.5 Tape Metadata and LLM Call Database",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        }
                    ],
                    "index": 0,
                    "page_num": "page_5",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        104,
                        542,
                        128
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                106,
                                541,
                                117
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        106,
                                        541,
                                        117
                                    ],
                                    "score": 1.0,
                                    "content": "Regardless of the orchestration method, the implementations of agent.run() and environment.react() ensure",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                71,
                                117,
                                389,
                                129
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        117,
                                        389,
                                        129
                                    ],
                                    "score": 0.9936821460723877,
                                    "content": "that the tape and its steps contain rich metadata, including these fields:",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        }
                    ],
                    "index": 1.5,
                    "page_num": "page_5",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        71,
                        106,
                        541,
                        129
                    ]
                },
                {
                    "type": "list",
                    "bbox": [
                        95,
                        143,
                        542,
                        282
                    ],
                    "lines": [
                        {
                            "bbox": [
                                95,
                                145,
                                541,
                                158
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        145,
                                        541,
                                        158
                                    ],
                                    "score": 1.0,
                                    "content": "• tape.metadata.author: which agent or environment made this tape; either by authoring it, or by",
                                    "type": "text"
                                }
                            ],
                            "index": 3,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                106,
                                155,
                                366,
                                169
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        155,
                                        366,
                                        169
                                    ],
                                    "score": 1.0,
                                    "content": "adding steps to it, or by making a revision of another tape.",
                                    "type": "text"
                                }
                            ],
                            "index": 4,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                97,
                                180,
                                540,
                                192
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        97,
                                        180,
                                        540,
                                        192
                                    ],
                                    "score": 1.0,
                                    "content": "• tape.metadata.parent_id: the ID of the parent tape of which the current tape is a continuation",
                                    "type": "text"
                                }
                            ],
                            "index": 5,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                106,
                                190,
                                189,
                                204
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        190,
                                        189,
                                        204
                                    ],
                                    "score": 1.0,
                                    "content": "(when applicable).",
                                    "type": "text"
                                }
                            ],
                            "index": 6,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                94,
                                213,
                                463,
                                228
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        94,
                                        213,
                                        463,
                                        228
                                    ],
                                    "score": 1.0,
                                    "content": "• step.metadata.agent: the hierarchical name of the agent that generated the step.",
                                    "type": "text"
                                }
                            ],
                            "index": 7,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                94,
                                235,
                                402,
                                250
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        94,
                                        235,
                                        402,
                                        250
                                    ],
                                    "score": 1.0,
                                    "content": "• step.metadata.node: the name of the node that generated the step.",
                                    "type": "text"
                                }
                            ],
                            "index": 8,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                95,
                                259,
                                540,
                                273
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        259,
                                        540,
                                        273
                                    ],
                                    "score": 0.9856149554252625,
                                    "content": "· step.metadata.prompt-id: the identifier (id) of the prompt that led to the generation of this step,",
                                    "type": "text"
                                }
                            ],
                            "index": 9,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                105,
                                271,
                                224,
                                285
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        271,
                                        224,
                                        285
                                    ],
                                    "score": 1.0,
                                    "content": "see the explanation below.",
                                    "type": "text"
                                }
                            ],
                            "index": 10,
                            "is_list_end_line": true
                        }
                    ],
                    "index": 6.5,
                    "page_num": "page_5",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        94,
                        145,
                        541,
                        285
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        298,
                        541,
                        370
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                298,
                                541,
                                312
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        298,
                                        541,
                                        312
                                    ],
                                    "score": 1.0,
                                    "content": "When an agent runs a node, the node generates a unique ID for the prompt that it builds at this iteration.",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                71,
                                311,
                                540,
                                324
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        311,
                                        540,
                                        324
                                    ],
                                    "score": 0.9733691811561584,
                                    "content": "The prompt ID thus serves as the unique identifier of a node execution, i.e., of a specific iteration when the",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                71,
                                323,
                                542,
                                335
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        323,
                                        542,
                                        335
                                    ],
                                    "score": 1.0,
                                    "content": "node was active. The ID also links the step to the LLM call from the node run so we can trace the origin of",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                71,
                                335,
                                541,
                                348
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        335,
                                        541,
                                        348
                                    ],
                                    "score": 0.9906222820281982,
                                    "content": "each step down to the specific prompt and LLM output. We store the prompt and the output for all LLM",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                71,
                                347,
                                542,
                                361
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        347,
                                        542,
                                        361
                                    ],
                                    "score": 0.9919792413711548,
                                    "content": "calls in an SQLite database. One can view LLM calls as an effective part of the tape in that they are always",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                71,
                                359,
                                429,
                                371
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        359,
                                        429,
                                        371
                                    ],
                                    "score": 1.0,
                                    "content": "easily accessible; we don’t include them in the tape to keep the latter lightweight.",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        }
                    ],
                    "index": 13.5,
                    "page_num": "page_5",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        298,
                        542,
                        371
                    ]
                },
                {
                    "type": "list",
                    "bbox": [
                        71,
                        375,
                        536,
                        399
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                376,
                                538,
                                389
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        376,
                                        538,
                                        389
                                    ],
                                    "score": 1.0,
                                    "content": "The metadata is crucial for building the tooling and the algorithms that empower the agent developer.",
                                    "type": "text"
                                }
                            ],
                            "index": 17,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                389,
                                312,
                                400
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        389,
                                        312,
                                        400
                                    ],
                                    "score": 0.9940663576126099,
                                    "content": "Figure 3 shows a visualization of some metadata fields.",
                                    "type": "text"
                                }
                            ],
                            "index": 18,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        }
                    ],
                    "index": 17.5,
                    "page_num": "page_5",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        376,
                        538,
                        400
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        72,
                        415,
                        205,
                        430
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                416,
                                204,
                                432
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        418,
                                        80,
                                        429
                                    ],
                                    "score": 1.0,
                                    "content": "3",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        89,
                                        416,
                                        204,
                                        432
                                    ],
                                    "score": 1.0,
                                    "content": "TapeAgents: tooling",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        }
                    ],
                    "index": 19,
                    "page_num": "page_5",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        443,
                        541,
                        490
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                444,
                                541,
                                457
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        444,
                                        541,
                                        457
                                    ],
                                    "score": 1.0,
                                    "content": "The TapeAgents foundation that we covered in Section 2 allows the creation of a wide range of reusable",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                71,
                                456,
                                540,
                                468
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        456,
                                        540,
                                        468
                                    ],
                                    "score": 1.0,
                                    "content": "agent components, tooling and learning algorithms. What the right building blocks and tooling are often",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                70,
                                467,
                                541,
                                480
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        467,
                                        541,
                                        480
                                    ],
                                    "score": 1.0,
                                    "content": "depends on the application area. In our initial release, we provide several prototypes to jump-start future",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                70,
                                480,
                                191,
                                492
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        480,
                                        191,
                                        492
                                    ],
                                    "score": 1.0,
                                    "content": "open-source collaborations.",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        }
                    ],
                    "index": 21.5,
                    "page_num": "page_5",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        444,
                        541,
                        492
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        72,
                        505,
                        222,
                        518
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                506,
                                222,
                                518
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        506,
                                        222,
                                        518
                                    ],
                                    "score": 1.0,
                                    "content": "3.1 Low-code Mini-Frameworks",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        }
                    ],
                    "index": 24,
                    "page_num": "page_5",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        528,
                        541,
                        564
                    ],
                    "lines": [
                        {
                            "bbox": [
                                69,
                                527,
                                542,
                                543
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        527,
                                        542,
                                        543
                                    ],
                                    "score": 1.0,
                                    "content": "Building agents requires implementing many similar template rendering (node.make_prompt) and text parsing",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                72,
                                541,
                                540,
                                555
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        541,
                                        540,
                                        555
                                    ],
                                    "score": 1.0,
                                    "content": "(node.generate_steps) routines. As a part of TapeAgents, we provide three examples of low-code mini-",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                70,
                                552,
                                453,
                                565
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        552,
                                        453,
                                        565
                                    ],
                                    "score": 0.993519127368927,
                                    "content": "frameworks for building agents by composing and configuring off-the-shelf components:",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        }
                    ],
                    "index": 26,
                    "page_num": "page_5",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        527,
                        542,
                        565
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        94,
                        578,
                        541,
                        639
                    ],
                    "lines": [
                        {
                            "bbox": [
                                93,
                                579,
                                541,
                                593
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        93,
                                        579,
                                        541,
                                        593
                                    ],
                                    "score": 0.9931896328926086,
                                    "content": "1. MonoAgent exemplifies the most straightforward way to implement a monolithic agent: make a",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                108,
                                593,
                                540,
                                604
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        108,
                                        593,
                                        540,
                                        604
                                    ],
                                    "score": 1.0,
                                    "content": "comprehensive prompt from all the data from the tape and the possible step schemas, then parse the",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                105,
                                603,
                                541,
                                618
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        603,
                                        541,
                                        618
                                    ],
                                    "score": 1.0,
                                    "content": "LLM output using the schemas. One creates a MonoAgent from MonoNode nodes whose prompts",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                106,
                                616,
                                541,
                                628
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        616,
                                        541,
                                        628
                                    ],
                                    "score": 0.9872633218765259,
                                    "content": "are the same except for the final user message instruction. A MonoAgent also requires the agent",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                107,
                                627,
                                491,
                                641
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        627,
                                        491,
                                        641
                                    ],
                                    "score": 1.0,
                                    "content": "developer to provide Pydantic models for all possible steps that the agent can generate.",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        }
                    ],
                    "index": 30,
                    "page_num": "page_5",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        93,
                        579,
                        541,
                        641
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        93,
                        649,
                        542,
                        686
                    ],
                    "lines": [
                        {
                            "bbox": [
                                93,
                                651,
                                541,
                                663
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        93,
                                        651,
                                        541,
                                        663
                                    ],
                                    "score": 1.0,
                                    "content": "2. TeamAgent shows how an AutoGen-style agent team can work in one tape. One can create three",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                105,
                                661,
                                541,
                                676
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        661,
                                        541,
                                        676
                                    ],
                                    "score": 0.987693727016449,
                                    "content": " different kinds of team agents: (a) an initiator that send the first Call message, (b) a manager that",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                107,
                                675,
                                496,
                                687
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        675,
                                        496,
                                        687
                                    ],
                                    "score": 1.0,
                                    "content": "chooses the next active agent, (c) a worker agent that responds using its system prompt.",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        }
                    ],
                    "index": 34,
                    "page_num": "page_5",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        93,
                        651,
                        541,
                        687
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        94,
                        696,
                        541,
                        732
                    ],
                    "lines": [
                        {
                            "bbox": [
                                92,
                                696,
                                540,
                                711
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        92,
                                        696,
                                        540,
                                        711
                                    ],
                                    "score": 1.0,
                                    "content": "3. LLMFunction demonstrates how one can build agents using function-style prompt templates, akin",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                106,
                                709,
                                540,
                                723
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        709,
                                        540,
                                        723
                                    ],
                                    "score": 1.0,
                                    "content": "to DSPy signatures. These prompt templates are particularly easy to optimize by adding demon-",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                107,
                                722,
                                148,
                                733
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        722,
                                        148,
                                        733
                                    ],
                                    "score": 1.0,
                                    "content": "strations.",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        }
                    ],
                    "index": 37,
                    "page_num": "page_5",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        92,
                        696,
                        540,
                        733
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "image",
                    "bbox": [
                        200,
                        82,
                        486,
                        627
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                200,
                                82,
                                486,
                                627
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        200,
                                        82,
                                        486,
                                        627
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                200,
                                                82,
                                                486,
                                                627
                                            ],
                                            "score": 0.944,
                                            "type": "image",
                                            "image_path": "98274b20301e0b990ad044ba3c1d7aebae891bdd9e94a0f9b9d0a67526f06ebe.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 20.5,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        200,
                                        82,
                                        486,
                                        95.0
                                    ],
                                    "spans": [],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        200,
                                        95.0,
                                        486,
                                        108.0
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        200,
                                        108.0,
                                        486,
                                        121.0
                                    ],
                                    "spans": [],
                                    "index": 2
                                },
                                {
                                    "bbox": [
                                        200,
                                        121.0,
                                        486,
                                        134.0
                                    ],
                                    "spans": [],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        200,
                                        134.0,
                                        486,
                                        147.0
                                    ],
                                    "spans": [],
                                    "index": 4
                                },
                                {
                                    "bbox": [
                                        200,
                                        147.0,
                                        486,
                                        160.0
                                    ],
                                    "spans": [],
                                    "index": 5
                                },
                                {
                                    "bbox": [
                                        200,
                                        160.0,
                                        486,
                                        173.0
                                    ],
                                    "spans": [],
                                    "index": 6
                                },
                                {
                                    "bbox": [
                                        200,
                                        173.0,
                                        486,
                                        186.0
                                    ],
                                    "spans": [],
                                    "index": 7
                                },
                                {
                                    "bbox": [
                                        200,
                                        186.0,
                                        486,
                                        199.0
                                    ],
                                    "spans": [],
                                    "index": 8
                                },
                                {
                                    "bbox": [
                                        200,
                                        199.0,
                                        486,
                                        212.0
                                    ],
                                    "spans": [],
                                    "index": 9
                                },
                                {
                                    "bbox": [
                                        200,
                                        212.0,
                                        486,
                                        225.0
                                    ],
                                    "spans": [],
                                    "index": 10
                                },
                                {
                                    "bbox": [
                                        200,
                                        225.0,
                                        486,
                                        238.0
                                    ],
                                    "spans": [],
                                    "index": 11
                                },
                                {
                                    "bbox": [
                                        200,
                                        238.0,
                                        486,
                                        251.0
                                    ],
                                    "spans": [],
                                    "index": 12
                                },
                                {
                                    "bbox": [
                                        200,
                                        251.0,
                                        486,
                                        264.0
                                    ],
                                    "spans": [],
                                    "index": 13
                                },
                                {
                                    "bbox": [
                                        200,
                                        264.0,
                                        486,
                                        277.0
                                    ],
                                    "spans": [],
                                    "index": 14
                                },
                                {
                                    "bbox": [
                                        200,
                                        277.0,
                                        486,
                                        290.0
                                    ],
                                    "spans": [],
                                    "index": 15
                                },
                                {
                                    "bbox": [
                                        200,
                                        290.0,
                                        486,
                                        303.0
                                    ],
                                    "spans": [],
                                    "index": 16
                                },
                                {
                                    "bbox": [
                                        200,
                                        303.0,
                                        486,
                                        316.0
                                    ],
                                    "spans": [],
                                    "index": 17
                                },
                                {
                                    "bbox": [
                                        200,
                                        316.0,
                                        486,
                                        329.0
                                    ],
                                    "spans": [],
                                    "index": 18
                                },
                                {
                                    "bbox": [
                                        200,
                                        329.0,
                                        486,
                                        342.0
                                    ],
                                    "spans": [],
                                    "index": 19
                                },
                                {
                                    "bbox": [
                                        200,
                                        342.0,
                                        486,
                                        355.0
                                    ],
                                    "spans": [],
                                    "index": 20
                                },
                                {
                                    "bbox": [
                                        200,
                                        355.0,
                                        486,
                                        368.0
                                    ],
                                    "spans": [],
                                    "index": 21
                                },
                                {
                                    "bbox": [
                                        200,
                                        368.0,
                                        486,
                                        381.0
                                    ],
                                    "spans": [],
                                    "index": 22
                                },
                                {
                                    "bbox": [
                                        200,
                                        381.0,
                                        486,
                                        394.0
                                    ],
                                    "spans": [],
                                    "index": 23
                                },
                                {
                                    "bbox": [
                                        200,
                                        394.0,
                                        486,
                                        407.0
                                    ],
                                    "spans": [],
                                    "index": 24
                                },
                                {
                                    "bbox": [
                                        200,
                                        407.0,
                                        486,
                                        420.0
                                    ],
                                    "spans": [],
                                    "index": 25
                                },
                                {
                                    "bbox": [
                                        200,
                                        420.0,
                                        486,
                                        433.0
                                    ],
                                    "spans": [],
                                    "index": 26
                                },
                                {
                                    "bbox": [
                                        200,
                                        433.0,
                                        486,
                                        446.0
                                    ],
                                    "spans": [],
                                    "index": 27
                                },
                                {
                                    "bbox": [
                                        200,
                                        446.0,
                                        486,
                                        459.0
                                    ],
                                    "spans": [],
                                    "index": 28
                                },
                                {
                                    "bbox": [
                                        200,
                                        459.0,
                                        486,
                                        472.0
                                    ],
                                    "spans": [],
                                    "index": 29
                                },
                                {
                                    "bbox": [
                                        200,
                                        472.0,
                                        486,
                                        485.0
                                    ],
                                    "spans": [],
                                    "index": 30
                                },
                                {
                                    "bbox": [
                                        200,
                                        485.0,
                                        486,
                                        498.0
                                    ],
                                    "spans": [],
                                    "index": 31
                                },
                                {
                                    "bbox": [
                                        200,
                                        498.0,
                                        486,
                                        511.0
                                    ],
                                    "spans": [],
                                    "index": 32
                                },
                                {
                                    "bbox": [
                                        200,
                                        511.0,
                                        486,
                                        524.0
                                    ],
                                    "spans": [],
                                    "index": 33
                                },
                                {
                                    "bbox": [
                                        200,
                                        524.0,
                                        486,
                                        537.0
                                    ],
                                    "spans": [],
                                    "index": 34
                                },
                                {
                                    "bbox": [
                                        200,
                                        537.0,
                                        486,
                                        550.0
                                    ],
                                    "spans": [],
                                    "index": 35
                                },
                                {
                                    "bbox": [
                                        200,
                                        550.0,
                                        486,
                                        563.0
                                    ],
                                    "spans": [],
                                    "index": 36
                                },
                                {
                                    "bbox": [
                                        200,
                                        563.0,
                                        486,
                                        576.0
                                    ],
                                    "spans": [],
                                    "index": 37
                                },
                                {
                                    "bbox": [
                                        200,
                                        576.0,
                                        486,
                                        589.0
                                    ],
                                    "spans": [],
                                    "index": 38
                                },
                                {
                                    "bbox": [
                                        200,
                                        589.0,
                                        486,
                                        602.0
                                    ],
                                    "spans": [],
                                    "index": 39
                                },
                                {
                                    "bbox": [
                                        200,
                                        602.0,
                                        486,
                                        615.0
                                    ],
                                    "spans": [],
                                    "index": 40
                                },
                                {
                                    "bbox": [
                                        200,
                                        615.0,
                                        486,
                                        628.0
                                    ],
                                    "spans": [],
                                    "index": 41
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                70,
                                635,
                                541,
                                701
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        70,
                                        635,
                                        540,
                                        648
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                635,
                                                540,
                                                648
                                            ],
                                            "score": 1.0,
                                            "content": "Figure 3: A multi-agent tree structure (left) and a tape resulting from their work (middle) with the TapeViewStack",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 42
                                },
                                {
                                    "bbox": [
                                        69,
                                        646,
                                        541,
                                        659
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                646,
                                                541,
                                                659
                                            ],
                                            "score": 0.9870115518569946,
                                            "content": " at specific steps (right). At step 16 the stack's top view is the SearchAgent's tape view. At step 19, only the Analyst's",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 43
                                },
                                {
                                    "bbox": [
                                        71,
                                        658,
                                        541,
                                        669
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                658,
                                                541,
                                                669
                                            ],
                                            "score": 1.0,
                                            "content": "view exists. Note how the Analyst’s view does not include the Search Agent’s steps except for its response. Steps",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 44
                                },
                                {
                                    "bbox": [
                                        70,
                                        668,
                                        541,
                                        681
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                668,
                                                541,
                                                681
                                            ],
                                            "score": 1.0,
                                            "content": "are color-coded: yellow for communication thoughts, purple for internal agent thoughts, blue for actions, and green",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 45
                                },
                                {
                                    "bbox": [
                                        70,
                                        679,
                                        542,
                                        692
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                679,
                                                542,
                                                692
                                            ],
                                            "score": 1.0,
                                            "content": "for observations. The step’s author is indicated in grey using the “agent.node” format. Appendix A shows the code",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 46
                                },
                                {
                                    "bbox": [
                                        71,
                                        691,
                                        236,
                                        702
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                691,
                                                236,
                                                702
                                            ],
                                            "score": 1.0,
                                            "content": "implementation that produced this tape.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 47
                                }
                            ],
                            "index": 44.5
                        }
                    ],
                    "index": 32.5
                }
            ],
            "layout_bboxes": [],
            "page_idx": 6,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [
                {
                    "type": "image",
                    "bbox": [
                        200,
                        82,
                        486,
                        627
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                200,
                                82,
                                486,
                                627
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        200,
                                        82,
                                        486,
                                        627
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                200,
                                                82,
                                                486,
                                                627
                                            ],
                                            "score": 0.944,
                                            "type": "image",
                                            "image_path": "98274b20301e0b990ad044ba3c1d7aebae891bdd9e94a0f9b9d0a67526f06ebe.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 20.5,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        200,
                                        82,
                                        486,
                                        95.0
                                    ],
                                    "spans": [],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        200,
                                        95.0,
                                        486,
                                        108.0
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        200,
                                        108.0,
                                        486,
                                        121.0
                                    ],
                                    "spans": [],
                                    "index": 2
                                },
                                {
                                    "bbox": [
                                        200,
                                        121.0,
                                        486,
                                        134.0
                                    ],
                                    "spans": [],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        200,
                                        134.0,
                                        486,
                                        147.0
                                    ],
                                    "spans": [],
                                    "index": 4
                                },
                                {
                                    "bbox": [
                                        200,
                                        147.0,
                                        486,
                                        160.0
                                    ],
                                    "spans": [],
                                    "index": 5
                                },
                                {
                                    "bbox": [
                                        200,
                                        160.0,
                                        486,
                                        173.0
                                    ],
                                    "spans": [],
                                    "index": 6
                                },
                                {
                                    "bbox": [
                                        200,
                                        173.0,
                                        486,
                                        186.0
                                    ],
                                    "spans": [],
                                    "index": 7
                                },
                                {
                                    "bbox": [
                                        200,
                                        186.0,
                                        486,
                                        199.0
                                    ],
                                    "spans": [],
                                    "index": 8
                                },
                                {
                                    "bbox": [
                                        200,
                                        199.0,
                                        486,
                                        212.0
                                    ],
                                    "spans": [],
                                    "index": 9
                                },
                                {
                                    "bbox": [
                                        200,
                                        212.0,
                                        486,
                                        225.0
                                    ],
                                    "spans": [],
                                    "index": 10
                                },
                                {
                                    "bbox": [
                                        200,
                                        225.0,
                                        486,
                                        238.0
                                    ],
                                    "spans": [],
                                    "index": 11
                                },
                                {
                                    "bbox": [
                                        200,
                                        238.0,
                                        486,
                                        251.0
                                    ],
                                    "spans": [],
                                    "index": 12
                                },
                                {
                                    "bbox": [
                                        200,
                                        251.0,
                                        486,
                                        264.0
                                    ],
                                    "spans": [],
                                    "index": 13
                                },
                                {
                                    "bbox": [
                                        200,
                                        264.0,
                                        486,
                                        277.0
                                    ],
                                    "spans": [],
                                    "index": 14
                                },
                                {
                                    "bbox": [
                                        200,
                                        277.0,
                                        486,
                                        290.0
                                    ],
                                    "spans": [],
                                    "index": 15
                                },
                                {
                                    "bbox": [
                                        200,
                                        290.0,
                                        486,
                                        303.0
                                    ],
                                    "spans": [],
                                    "index": 16
                                },
                                {
                                    "bbox": [
                                        200,
                                        303.0,
                                        486,
                                        316.0
                                    ],
                                    "spans": [],
                                    "index": 17
                                },
                                {
                                    "bbox": [
                                        200,
                                        316.0,
                                        486,
                                        329.0
                                    ],
                                    "spans": [],
                                    "index": 18
                                },
                                {
                                    "bbox": [
                                        200,
                                        329.0,
                                        486,
                                        342.0
                                    ],
                                    "spans": [],
                                    "index": 19
                                },
                                {
                                    "bbox": [
                                        200,
                                        342.0,
                                        486,
                                        355.0
                                    ],
                                    "spans": [],
                                    "index": 20
                                },
                                {
                                    "bbox": [
                                        200,
                                        355.0,
                                        486,
                                        368.0
                                    ],
                                    "spans": [],
                                    "index": 21
                                },
                                {
                                    "bbox": [
                                        200,
                                        368.0,
                                        486,
                                        381.0
                                    ],
                                    "spans": [],
                                    "index": 22
                                },
                                {
                                    "bbox": [
                                        200,
                                        381.0,
                                        486,
                                        394.0
                                    ],
                                    "spans": [],
                                    "index": 23
                                },
                                {
                                    "bbox": [
                                        200,
                                        394.0,
                                        486,
                                        407.0
                                    ],
                                    "spans": [],
                                    "index": 24
                                },
                                {
                                    "bbox": [
                                        200,
                                        407.0,
                                        486,
                                        420.0
                                    ],
                                    "spans": [],
                                    "index": 25
                                },
                                {
                                    "bbox": [
                                        200,
                                        420.0,
                                        486,
                                        433.0
                                    ],
                                    "spans": [],
                                    "index": 26
                                },
                                {
                                    "bbox": [
                                        200,
                                        433.0,
                                        486,
                                        446.0
                                    ],
                                    "spans": [],
                                    "index": 27
                                },
                                {
                                    "bbox": [
                                        200,
                                        446.0,
                                        486,
                                        459.0
                                    ],
                                    "spans": [],
                                    "index": 28
                                },
                                {
                                    "bbox": [
                                        200,
                                        459.0,
                                        486,
                                        472.0
                                    ],
                                    "spans": [],
                                    "index": 29
                                },
                                {
                                    "bbox": [
                                        200,
                                        472.0,
                                        486,
                                        485.0
                                    ],
                                    "spans": [],
                                    "index": 30
                                },
                                {
                                    "bbox": [
                                        200,
                                        485.0,
                                        486,
                                        498.0
                                    ],
                                    "spans": [],
                                    "index": 31
                                },
                                {
                                    "bbox": [
                                        200,
                                        498.0,
                                        486,
                                        511.0
                                    ],
                                    "spans": [],
                                    "index": 32
                                },
                                {
                                    "bbox": [
                                        200,
                                        511.0,
                                        486,
                                        524.0
                                    ],
                                    "spans": [],
                                    "index": 33
                                },
                                {
                                    "bbox": [
                                        200,
                                        524.0,
                                        486,
                                        537.0
                                    ],
                                    "spans": [],
                                    "index": 34
                                },
                                {
                                    "bbox": [
                                        200,
                                        537.0,
                                        486,
                                        550.0
                                    ],
                                    "spans": [],
                                    "index": 35
                                },
                                {
                                    "bbox": [
                                        200,
                                        550.0,
                                        486,
                                        563.0
                                    ],
                                    "spans": [],
                                    "index": 36
                                },
                                {
                                    "bbox": [
                                        200,
                                        563.0,
                                        486,
                                        576.0
                                    ],
                                    "spans": [],
                                    "index": 37
                                },
                                {
                                    "bbox": [
                                        200,
                                        576.0,
                                        486,
                                        589.0
                                    ],
                                    "spans": [],
                                    "index": 38
                                },
                                {
                                    "bbox": [
                                        200,
                                        589.0,
                                        486,
                                        602.0
                                    ],
                                    "spans": [],
                                    "index": 39
                                },
                                {
                                    "bbox": [
                                        200,
                                        602.0,
                                        486,
                                        615.0
                                    ],
                                    "spans": [],
                                    "index": 40
                                },
                                {
                                    "bbox": [
                                        200,
                                        615.0,
                                        486,
                                        628.0
                                    ],
                                    "spans": [],
                                    "index": 41
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                70,
                                635,
                                541,
                                701
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        70,
                                        635,
                                        540,
                                        648
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                635,
                                                540,
                                                648
                                            ],
                                            "score": 1.0,
                                            "content": "Figure 3: A multi-agent tree structure (left) and a tape resulting from their work (middle) with the TapeViewStack",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 42
                                },
                                {
                                    "bbox": [
                                        69,
                                        646,
                                        541,
                                        659
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                646,
                                                541,
                                                659
                                            ],
                                            "score": 0.9870115518569946,
                                            "content": " at specific steps (right). At step 16 the stack's top view is the SearchAgent's tape view. At step 19, only the Analyst's",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 43
                                },
                                {
                                    "bbox": [
                                        71,
                                        658,
                                        541,
                                        669
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                658,
                                                541,
                                                669
                                            ],
                                            "score": 1.0,
                                            "content": "view exists. Note how the Analyst’s view does not include the Search Agent’s steps except for its response. Steps",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 44
                                },
                                {
                                    "bbox": [
                                        70,
                                        668,
                                        541,
                                        681
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                668,
                                                541,
                                                681
                                            ],
                                            "score": 1.0,
                                            "content": "are color-coded: yellow for communication thoughts, purple for internal agent thoughts, blue for actions, and green",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 45
                                },
                                {
                                    "bbox": [
                                        70,
                                        679,
                                        542,
                                        692
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                679,
                                                542,
                                                692
                                            ],
                                            "score": 1.0,
                                            "content": "for observations. The step’s author is indicated in grey using the “agent.node” format. Appendix A shows the code",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 46
                                },
                                {
                                    "bbox": [
                                        71,
                                        691,
                                        236,
                                        702
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                691,
                                                236,
                                                702
                                            ],
                                            "score": 1.0,
                                            "content": "implementation that produced this tape.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 47
                                }
                            ],
                            "index": 44.5
                        }
                    ],
                    "index": 32.5
                }
            ],
            "tables": [],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        71,
                        27,
                        143,
                        36
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                26,
                                144,
                                37
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        26,
                                        144,
                                        37
                                    ],
                                    "score": 1.0,
                                    "content": "Technical report",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        302,
                        751,
                        308,
                        760
                    ],
                    "lines": [
                        {
                            "bbox": [
                                302,
                                751,
                                309,
                                762
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        302,
                                        751,
                                        309,
                                        762
                                    ],
                                    "score": 1.0,
                                    "content": "7",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "image",
                    "bbox": [
                        200,
                        82,
                        486,
                        627
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                200,
                                82,
                                486,
                                627
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        200,
                                        82,
                                        486,
                                        627
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                200,
                                                82,
                                                486,
                                                627
                                            ],
                                            "score": 0.944,
                                            "type": "image",
                                            "image_path": "98274b20301e0b990ad044ba3c1d7aebae891bdd9e94a0f9b9d0a67526f06ebe.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 20.5,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        200,
                                        82,
                                        486,
                                        95.0
                                    ],
                                    "spans": [],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        200,
                                        95.0,
                                        486,
                                        108.0
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        200,
                                        108.0,
                                        486,
                                        121.0
                                    ],
                                    "spans": [],
                                    "index": 2
                                },
                                {
                                    "bbox": [
                                        200,
                                        121.0,
                                        486,
                                        134.0
                                    ],
                                    "spans": [],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        200,
                                        134.0,
                                        486,
                                        147.0
                                    ],
                                    "spans": [],
                                    "index": 4
                                },
                                {
                                    "bbox": [
                                        200,
                                        147.0,
                                        486,
                                        160.0
                                    ],
                                    "spans": [],
                                    "index": 5
                                },
                                {
                                    "bbox": [
                                        200,
                                        160.0,
                                        486,
                                        173.0
                                    ],
                                    "spans": [],
                                    "index": 6
                                },
                                {
                                    "bbox": [
                                        200,
                                        173.0,
                                        486,
                                        186.0
                                    ],
                                    "spans": [],
                                    "index": 7
                                },
                                {
                                    "bbox": [
                                        200,
                                        186.0,
                                        486,
                                        199.0
                                    ],
                                    "spans": [],
                                    "index": 8
                                },
                                {
                                    "bbox": [
                                        200,
                                        199.0,
                                        486,
                                        212.0
                                    ],
                                    "spans": [],
                                    "index": 9
                                },
                                {
                                    "bbox": [
                                        200,
                                        212.0,
                                        486,
                                        225.0
                                    ],
                                    "spans": [],
                                    "index": 10
                                },
                                {
                                    "bbox": [
                                        200,
                                        225.0,
                                        486,
                                        238.0
                                    ],
                                    "spans": [],
                                    "index": 11
                                },
                                {
                                    "bbox": [
                                        200,
                                        238.0,
                                        486,
                                        251.0
                                    ],
                                    "spans": [],
                                    "index": 12
                                },
                                {
                                    "bbox": [
                                        200,
                                        251.0,
                                        486,
                                        264.0
                                    ],
                                    "spans": [],
                                    "index": 13
                                },
                                {
                                    "bbox": [
                                        200,
                                        264.0,
                                        486,
                                        277.0
                                    ],
                                    "spans": [],
                                    "index": 14
                                },
                                {
                                    "bbox": [
                                        200,
                                        277.0,
                                        486,
                                        290.0
                                    ],
                                    "spans": [],
                                    "index": 15
                                },
                                {
                                    "bbox": [
                                        200,
                                        290.0,
                                        486,
                                        303.0
                                    ],
                                    "spans": [],
                                    "index": 16
                                },
                                {
                                    "bbox": [
                                        200,
                                        303.0,
                                        486,
                                        316.0
                                    ],
                                    "spans": [],
                                    "index": 17
                                },
                                {
                                    "bbox": [
                                        200,
                                        316.0,
                                        486,
                                        329.0
                                    ],
                                    "spans": [],
                                    "index": 18
                                },
                                {
                                    "bbox": [
                                        200,
                                        329.0,
                                        486,
                                        342.0
                                    ],
                                    "spans": [],
                                    "index": 19
                                },
                                {
                                    "bbox": [
                                        200,
                                        342.0,
                                        486,
                                        355.0
                                    ],
                                    "spans": [],
                                    "index": 20
                                },
                                {
                                    "bbox": [
                                        200,
                                        355.0,
                                        486,
                                        368.0
                                    ],
                                    "spans": [],
                                    "index": 21
                                },
                                {
                                    "bbox": [
                                        200,
                                        368.0,
                                        486,
                                        381.0
                                    ],
                                    "spans": [],
                                    "index": 22
                                },
                                {
                                    "bbox": [
                                        200,
                                        381.0,
                                        486,
                                        394.0
                                    ],
                                    "spans": [],
                                    "index": 23
                                },
                                {
                                    "bbox": [
                                        200,
                                        394.0,
                                        486,
                                        407.0
                                    ],
                                    "spans": [],
                                    "index": 24
                                },
                                {
                                    "bbox": [
                                        200,
                                        407.0,
                                        486,
                                        420.0
                                    ],
                                    "spans": [],
                                    "index": 25
                                },
                                {
                                    "bbox": [
                                        200,
                                        420.0,
                                        486,
                                        433.0
                                    ],
                                    "spans": [],
                                    "index": 26
                                },
                                {
                                    "bbox": [
                                        200,
                                        433.0,
                                        486,
                                        446.0
                                    ],
                                    "spans": [],
                                    "index": 27
                                },
                                {
                                    "bbox": [
                                        200,
                                        446.0,
                                        486,
                                        459.0
                                    ],
                                    "spans": [],
                                    "index": 28
                                },
                                {
                                    "bbox": [
                                        200,
                                        459.0,
                                        486,
                                        472.0
                                    ],
                                    "spans": [],
                                    "index": 29
                                },
                                {
                                    "bbox": [
                                        200,
                                        472.0,
                                        486,
                                        485.0
                                    ],
                                    "spans": [],
                                    "index": 30
                                },
                                {
                                    "bbox": [
                                        200,
                                        485.0,
                                        486,
                                        498.0
                                    ],
                                    "spans": [],
                                    "index": 31
                                },
                                {
                                    "bbox": [
                                        200,
                                        498.0,
                                        486,
                                        511.0
                                    ],
                                    "spans": [],
                                    "index": 32
                                },
                                {
                                    "bbox": [
                                        200,
                                        511.0,
                                        486,
                                        524.0
                                    ],
                                    "spans": [],
                                    "index": 33
                                },
                                {
                                    "bbox": [
                                        200,
                                        524.0,
                                        486,
                                        537.0
                                    ],
                                    "spans": [],
                                    "index": 34
                                },
                                {
                                    "bbox": [
                                        200,
                                        537.0,
                                        486,
                                        550.0
                                    ],
                                    "spans": [],
                                    "index": 35
                                },
                                {
                                    "bbox": [
                                        200,
                                        550.0,
                                        486,
                                        563.0
                                    ],
                                    "spans": [],
                                    "index": 36
                                },
                                {
                                    "bbox": [
                                        200,
                                        563.0,
                                        486,
                                        576.0
                                    ],
                                    "spans": [],
                                    "index": 37
                                },
                                {
                                    "bbox": [
                                        200,
                                        576.0,
                                        486,
                                        589.0
                                    ],
                                    "spans": [],
                                    "index": 38
                                },
                                {
                                    "bbox": [
                                        200,
                                        589.0,
                                        486,
                                        602.0
                                    ],
                                    "spans": [],
                                    "index": 39
                                },
                                {
                                    "bbox": [
                                        200,
                                        602.0,
                                        486,
                                        615.0
                                    ],
                                    "spans": [],
                                    "index": 40
                                },
                                {
                                    "bbox": [
                                        200,
                                        615.0,
                                        486,
                                        628.0
                                    ],
                                    "spans": [],
                                    "index": 41
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                70,
                                635,
                                541,
                                701
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        70,
                                        635,
                                        540,
                                        648
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                635,
                                                540,
                                                648
                                            ],
                                            "score": 1.0,
                                            "content": "Figure 3: A multi-agent tree structure (left) and a tape resulting from their work (middle) with the TapeViewStack",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 42
                                },
                                {
                                    "bbox": [
                                        69,
                                        646,
                                        541,
                                        659
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                646,
                                                541,
                                                659
                                            ],
                                            "score": 0.9870115518569946,
                                            "content": " at specific steps (right). At step 16 the stack's top view is the SearchAgent's tape view. At step 19, only the Analyst's",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 43
                                },
                                {
                                    "bbox": [
                                        71,
                                        658,
                                        541,
                                        669
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                658,
                                                541,
                                                669
                                            ],
                                            "score": 1.0,
                                            "content": "view exists. Note how the Analyst’s view does not include the Search Agent’s steps except for its response. Steps",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 44
                                },
                                {
                                    "bbox": [
                                        70,
                                        668,
                                        541,
                                        681
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                668,
                                                541,
                                                681
                                            ],
                                            "score": 1.0,
                                            "content": "are color-coded: yellow for communication thoughts, purple for internal agent thoughts, blue for actions, and green",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 45
                                },
                                {
                                    "bbox": [
                                        70,
                                        679,
                                        542,
                                        692
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                679,
                                                542,
                                                692
                                            ],
                                            "score": 1.0,
                                            "content": "for observations. The step’s author is indicated in grey using the “agent.node” format. Appendix A shows the code",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 46
                                },
                                {
                                    "bbox": [
                                        71,
                                        691,
                                        236,
                                        702
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                691,
                                                236,
                                                702
                                            ],
                                            "score": 1.0,
                                            "content": "implementation that produced this tape.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 47
                                }
                            ],
                            "index": 44.5
                        }
                    ],
                    "index": 32.5,
                    "page_num": "page_6",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        71,
                        82,
                        540,
                        130
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                83,
                                539,
                                97
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        83,
                                        539,
                                        97
                                    ],
                                    "score": 0.9915122985839844,
                                    "content": "We include the mini-frameworks mostly for demonstration purposes, as it is hard to offer a high-level program-",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                71,
                                96,
                                540,
                                107
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        96,
                                        540,
                                        107
                                    ],
                                    "score": 1.0,
                                    "content": "ming paradigm without a good knowledge of the intended application domain. The TapeAgents paradigm",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                70,
                                106,
                                541,
                                120
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        106,
                                        541,
                                        120
                                    ],
                                    "score": 1.0,
                                    "content": "makes it easy to build such mini-frameworks thanks to the agent’s double compositionality (agents and",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                71,
                                119,
                                104,
                                132
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        119,
                                        104,
                                        132
                                    ],
                                    "score": 1.0,
                                    "content": "nodes).",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        }
                    ],
                    "index": 1.5
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        144,
                        131,
                        156
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                143,
                                132,
                                157
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        145,
                                        89,
                                        155
                                    ],
                                    "score": 1.0,
                                    "content": "3.2",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        94,
                                        143,
                                        132,
                                        157
                                    ],
                                    "score": 1.0,
                                    "content": "Tooling",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        }
                    ],
                    "index": 4
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        165,
                        540,
                        285
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                167,
                                541,
                                178
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        167,
                                        541,
                                        178
                                    ],
                                    "score": 0.9955015182495117,
                                    "content": "In TapeAgents, the agent confguration and the tape are highly structured and linked with metadata. This",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                71,
                                178,
                                541,
                                191
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        178,
                                        541,
                                        191
                                    ],
                                    "score": 0.9931870102882385,
                                    "content": "allows us to offer developer tooling for a broad range of possible TapeAgents. In the initial release, we include",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                70,
                                190,
                                541,
                                204
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        190,
                                        541,
                                        204
                                    ],
                                    "score": 0.9950997233390808,
                                    "content": "several app prototypes. We offer TapeAgents Studio (see Figure 8 in Appendix D), an app to interact with",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                70,
                                202,
                                540,
                                216
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        202,
                                        540,
                                        216
                                    ],
                                    "score": 1.0,
                                    "content": "the agent and its tape, Tape Browser (Figure 9 in Appendix D), an app to inspect a batch of tapes, and",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                72,
                                215,
                                540,
                                227
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        215,
                                        540,
                                        227
                                    ],
                                    "score": 0.9931821227073669,
                                    "content": "Tape Dif (Figure 10 in Appendix D), which compares two batches of tape. Furthermore, for agent optimiza-",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                70,
                                226,
                                541,
                                239
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        226,
                                        541,
                                        239
                                    ],
                                    "score": 0.9937955737113953,
                                    "content": "tion, we provide algorithms for auto-prompting, LLM fine-tuning, and a modular Reinforcement Learning",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                70,
                                237,
                                540,
                                252
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        237,
                                        540,
                                        252
                                    ],
                                    "score": 0.9850265979766846,
                                    "content": "orchestrator. The finetuning component uses Accelerate (Gugger et al., 2022) and DeepSpeed (Rasley et al.,",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                70,
                                249,
                                540,
                                263
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        249,
                                        540,
                                        263
                                    ],
                                    "score": 1.0,
                                    "content": "2020) libraries and supports tuning resumption, experiment tracking, reproducibility, LoRA tuning, and dis-",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                70,
                                261,
                                541,
                                276
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        261,
                                        541,
                                        276
                                    ],
                                    "score": 0.9930936098098755,
                                    "content": "tributed training. The above apps and algorithms represent the first steps towards the fully fedged Studio",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                71,
                                275,
                                300,
                                286
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        275,
                                        300,
                                        286
                                    ],
                                    "score": 1.0,
                                    "content": "and Optimize modules that we envision in Figure 1.",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        }
                    ],
                    "index": 9.5
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        300,
                        143,
                        314
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                301,
                                144,
                                315
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        302,
                                        79,
                                        312
                                    ],
                                    "score": 1.0,
                                    "content": "4",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        90,
                                        301,
                                        144,
                                        315
                                    ],
                                    "score": 1.0,
                                    "content": "Examples",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        }
                    ],
                    "index": 15
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        327,
                        542,
                        350
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                327,
                                541,
                                341
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        327,
                                        541,
                                        341
                                    ],
                                    "score": 0.986038088798523,
                                    "content": "In an initial set of examples, we demonstrate agents that represent different agent-building paradigms, as",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                72,
                                339,
                                348,
                                351
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        339,
                                        348,
                                        351
                                    ],
                                    "score": 0.9909699559211731,
                                    "content": "well case-studies of using different agent optimization methods.",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        }
                    ],
                    "index": 16.5
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        363,
                        315,
                        376
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                365,
                                314,
                                378
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        365,
                                        314,
                                        378
                                    ],
                                    "score": 1.0,
                                    "content": "4.1 Financial Analyst and Their Web Search Helper",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        }
                    ],
                    "index": 18
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        385,
                        540,
                        433
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                386,
                                540,
                                399
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        386,
                                        540,
                                        399
                                    ],
                                    "score": 0.9923545122146606,
                                    "content": "To offer an example with the maximal educational value, we have implemented a user-facing financial analyst",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                70,
                                398,
                                541,
                                411
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        398,
                                        541,
                                        411
                                    ],
                                    "score": 1.0,
                                    "content": "agent that can delegate searching the web to its subagent. We show the structure of the analyst agent and",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                71,
                                410,
                                539,
                                422
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        410,
                                        359,
                                        422
                                    ],
                                    "score": 1.0,
                                    "content": "an example tape in Figure 3. Our introductory hands-on notebook",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        360,
                                        411,
                                        363,
                                        419
                                    ],
                                    "score": 0.6,
                                    "content": "^5",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 3
                                },
                                {
                                    "bbox": [
                                        364,
                                        410,
                                        539,
                                        422
                                    ],
                                    "score": 1.0,
                                    "content": " takes the reader through a journey from",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                70,
                                421,
                                290,
                                436
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        421,
                                        290,
                                        436
                                    ],
                                    "score": 1.0,
                                    "content": "TapeAgents basic concepts to building this agent.",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        }
                    ],
                    "index": 20.5
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        439,
                        540,
                        559
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                440,
                                540,
                                453
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        440,
                                        540,
                                        453
                                    ],
                                    "score": 1.0,
                                    "content": "For illustrative purposes, we implemented the nodes in this example from scratch, without using mini-",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                70,
                                452,
                                541,
                                464
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        452,
                                        541,
                                        464
                                    ],
                                    "score": 0.9967592358589172,
                                    "content": "frameworks from Section 3.1. We offered the analyst agent an environment with several tools: one to get",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                71,
                                464,
                                541,
                                476
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        464,
                                        541,
                                        476
                                    ],
                                    "score": 1.0,
                                    "content": "the company ticker, another to download stock data, as well as several tools to search and browse the",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                70,
                                476,
                                540,
                                489
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        476,
                                        540,
                                        489
                                    ],
                                    "score": 1.0,
                                    "content": "web. We inform the analyst and their web search helper of the tools that they can use by including their",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                70,
                                488,
                                541,
                                502
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        488,
                                        541,
                                        502
                                    ],
                                    "score": 1.0,
                                    "content": "tools’ schemas in the prompts that the respective agent’s nodes make. The agent operates on a tape type",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                71,
                                500,
                                540,
                                511
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        500,
                                        540,
                                        511
                                    ],
                                    "score": 1.0,
                                    "content": "called DialogTape, which can only contain two kinds of actions: ToolCalls to call one or more tools and",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                71,
                                513,
                                541,
                                524
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        513,
                                        541,
                                        524
                                    ],
                                    "score": 0.9881742000579834,
                                    "content": "AssistantStep to respond to the user. The agent uses the same Toolcalls step with different content to",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                71,
                                523,
                                541,
                                537
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        523,
                                        541,
                                        537
                                    ],
                                    "score": 0.9928784966468811,
                                    "content": "call different tools. This is the use we intend for DialogTape: quick agent prototyping without declaring",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                71,
                                537,
                                541,
                                548
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        537,
                                        541,
                                        548
                                    ],
                                    "score": 0.9779401421546936,
                                    "content": "usecase-specific step schemas, though we believe most TapeAgents users will find it useful to declare their",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                71,
                                547,
                                205,
                                561
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        547,
                                        205,
                                        561
                                    ],
                                    "score": 1.0,
                                    "content": "own action and thought types.",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        }
                    ],
                    "index": 27.5
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        572,
                        456,
                        585
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                573,
                                456,
                                588
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        573,
                                        456,
                                        588
                                    ],
                                    "score": 1.0,
                                    "content": "4.2 Open-domain Question Answering and Web Browsing With Monolithic Agents",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        }
                    ],
                    "index": 33
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        594,
                        541,
                        714
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                596,
                                541,
                                608
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        596,
                                        541,
                                        608
                                    ],
                                    "score": 0.992671549320221,
                                    "content": "To validate TapeAgents quantitatively, we build two agents that target existing benchmarks. The first one",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                69,
                                606,
                                541,
                                619
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        606,
                                        541,
                                        619
                                    ],
                                    "score": 1.0,
                                    "content": "is a question-answering (QA) agent that targets the GAIA benchmark (Mialon et al., 2024). The QA agent",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                70,
                                618,
                                541,
                                632
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        618,
                                        541,
                                        632
                                    ],
                                    "score": 0.9833837151527405,
                                    "content": "can search the web, run Python code, read multiple file types. To meet the GAIA evaluation requirements,",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                71,
                                631,
                                540,
                                643
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        631,
                                        540,
                                        643
                                    ],
                                    "score": 1.0,
                                    "content": "we prompt the agent to output the precise short answer only. We build the QA agent from MonoNode nodes,",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                71,
                                643,
                                541,
                                655
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        643,
                                        541,
                                        655
                                    ],
                                    "score": 1.0,
                                    "content": "with two planning nodes and one acting node in which the agent loops (see Figure 4). Table 1 shows that",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                71,
                                655,
                                541,
                                667
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        655,
                                        541,
                                        667
                                    ],
                                    "score": 1.0,
                                    "content": "the agent performs quite well for such a simple agent. Our agent beats the more complicated Magentic-1",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                70,
                                667,
                                541,
                                680
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        667,
                                        541,
                                        680
                                    ],
                                    "score": 1.0,
                                    "content": "agent (Fourney et al., 2024) which incorporates Orchestrator and multiple executor agents and also progress",
                                    "type": "text"
                                }
                            ],
                            "index": 40
                        },
                        {
                            "bbox": [
                                69,
                                678,
                                541,
                                692
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        678,
                                        541,
                                        692
                                    ],
                                    "score": 1.0,
                                    "content": "ledger. For comparison implementing our agent only requires gathering the tools, declaring corresponding",
                                    "type": "text"
                                }
                            ],
                            "index": 41
                        },
                        {
                            "bbox": [
                                70,
                                691,
                                541,
                                705
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        691,
                                        541,
                                        705
                                    ],
                                    "score": 0.9943662881851196,
                                    "content": "action steps (like ReadDocumentAction and UseCalculatorAction) and declaring usecase-specific thoughts for",
                                    "type": "text"
                                }
                            ],
                            "index": 42
                        },
                        {
                            "bbox": [
                                70,
                                703,
                                542,
                                716
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        703,
                                        542,
                                        716
                                    ],
                                    "score": 1.0,
                                    "content": "reasoning (like ListOfFactsThought and NewFactThought). There is a lot of room for further improvement of",
                                    "type": "text"
                                }
                            ],
                            "index": 43
                        }
                    ],
                    "index": 38.5
                }
            ],
            "layout_bboxes": [],
            "page_idx": 7,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        81,
                        723,
                        325,
                        731
                    ],
                    "lines": [
                        {
                            "bbox": [
                                81,
                                721,
                                325,
                                734
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        81,
                                        721,
                                        325,
                                        734
                                    ],
                                    "score": 1.0,
                                    "content": "5https://github.com/ServiceNow/TapeAgents/blob/main/intro.ipynb",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        72,
                        27,
                        143,
                        37
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                26,
                                144,
                                38
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        26,
                                        144,
                                        38
                                    ],
                                    "score": 1.0,
                                    "content": "Technical report",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        302,
                        752,
                        308,
                        760
                    ],
                    "lines": [
                        {
                            "bbox": [
                                303,
                                752,
                                309,
                                762
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        303,
                                        752,
                                        309,
                                        762
                                    ],
                                    "score": 1.0,
                                    "content": "8",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        71,
                        82,
                        540,
                        130
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                83,
                                539,
                                97
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        83,
                                        539,
                                        97
                                    ],
                                    "score": 0.9915122985839844,
                                    "content": "We include the mini-frameworks mostly for demonstration purposes, as it is hard to offer a high-level program-",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                71,
                                96,
                                540,
                                107
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        96,
                                        540,
                                        107
                                    ],
                                    "score": 1.0,
                                    "content": "ming paradigm without a good knowledge of the intended application domain. The TapeAgents paradigm",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                70,
                                106,
                                541,
                                120
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        106,
                                        541,
                                        120
                                    ],
                                    "score": 1.0,
                                    "content": "makes it easy to build such mini-frameworks thanks to the agent’s double compositionality (agents and",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                71,
                                119,
                                104,
                                132
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        119,
                                        104,
                                        132
                                    ],
                                    "score": 1.0,
                                    "content": "nodes).",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        }
                    ],
                    "index": 1.5,
                    "page_num": "page_7",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        83,
                        541,
                        132
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        144,
                        131,
                        156
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                143,
                                132,
                                157
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        145,
                                        89,
                                        155
                                    ],
                                    "score": 1.0,
                                    "content": "3.2",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        94,
                                        143,
                                        132,
                                        157
                                    ],
                                    "score": 1.0,
                                    "content": "Tooling",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        }
                    ],
                    "index": 4,
                    "page_num": "page_7",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        165,
                        540,
                        285
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                167,
                                541,
                                178
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        167,
                                        541,
                                        178
                                    ],
                                    "score": 0.9955015182495117,
                                    "content": "In TapeAgents, the agent confguration and the tape are highly structured and linked with metadata. This",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                71,
                                178,
                                541,
                                191
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        178,
                                        541,
                                        191
                                    ],
                                    "score": 0.9931870102882385,
                                    "content": "allows us to offer developer tooling for a broad range of possible TapeAgents. In the initial release, we include",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                70,
                                190,
                                541,
                                204
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        190,
                                        541,
                                        204
                                    ],
                                    "score": 0.9950997233390808,
                                    "content": "several app prototypes. We offer TapeAgents Studio (see Figure 8 in Appendix D), an app to interact with",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                70,
                                202,
                                540,
                                216
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        202,
                                        540,
                                        216
                                    ],
                                    "score": 1.0,
                                    "content": "the agent and its tape, Tape Browser (Figure 9 in Appendix D), an app to inspect a batch of tapes, and",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                72,
                                215,
                                540,
                                227
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        215,
                                        540,
                                        227
                                    ],
                                    "score": 0.9931821227073669,
                                    "content": "Tape Dif (Figure 10 in Appendix D), which compares two batches of tape. Furthermore, for agent optimiza-",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                70,
                                226,
                                541,
                                239
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        226,
                                        541,
                                        239
                                    ],
                                    "score": 0.9937955737113953,
                                    "content": "tion, we provide algorithms for auto-prompting, LLM fine-tuning, and a modular Reinforcement Learning",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                70,
                                237,
                                540,
                                252
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        237,
                                        540,
                                        252
                                    ],
                                    "score": 0.9850265979766846,
                                    "content": "orchestrator. The finetuning component uses Accelerate (Gugger et al., 2022) and DeepSpeed (Rasley et al.,",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                70,
                                249,
                                540,
                                263
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        249,
                                        540,
                                        263
                                    ],
                                    "score": 1.0,
                                    "content": "2020) libraries and supports tuning resumption, experiment tracking, reproducibility, LoRA tuning, and dis-",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                70,
                                261,
                                541,
                                276
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        261,
                                        541,
                                        276
                                    ],
                                    "score": 0.9930936098098755,
                                    "content": "tributed training. The above apps and algorithms represent the first steps towards the fully fedged Studio",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                71,
                                275,
                                300,
                                286
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        275,
                                        300,
                                        286
                                    ],
                                    "score": 1.0,
                                    "content": "and Optimize modules that we envision in Figure 1.",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        }
                    ],
                    "index": 9.5,
                    "page_num": "page_7",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        167,
                        541,
                        286
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        300,
                        143,
                        314
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                301,
                                144,
                                315
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        302,
                                        79,
                                        312
                                    ],
                                    "score": 1.0,
                                    "content": "4",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        90,
                                        301,
                                        144,
                                        315
                                    ],
                                    "score": 1.0,
                                    "content": "Examples",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        }
                    ],
                    "index": 15,
                    "page_num": "page_7",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        327,
                        542,
                        350
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                327,
                                541,
                                341
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        327,
                                        541,
                                        341
                                    ],
                                    "score": 0.986038088798523,
                                    "content": "In an initial set of examples, we demonstrate agents that represent different agent-building paradigms, as",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                72,
                                339,
                                348,
                                351
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        339,
                                        348,
                                        351
                                    ],
                                    "score": 0.9909699559211731,
                                    "content": "well case-studies of using different agent optimization methods.",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        }
                    ],
                    "index": 16.5,
                    "page_num": "page_7",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        327,
                        541,
                        351
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        363,
                        315,
                        376
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                365,
                                314,
                                378
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        365,
                                        314,
                                        378
                                    ],
                                    "score": 1.0,
                                    "content": "4.1 Financial Analyst and Their Web Search Helper",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        }
                    ],
                    "index": 18,
                    "page_num": "page_7",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        385,
                        540,
                        433
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                386,
                                540,
                                399
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        386,
                                        540,
                                        399
                                    ],
                                    "score": 0.9923545122146606,
                                    "content": "To offer an example with the maximal educational value, we have implemented a user-facing financial analyst",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                70,
                                398,
                                541,
                                411
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        398,
                                        541,
                                        411
                                    ],
                                    "score": 1.0,
                                    "content": "agent that can delegate searching the web to its subagent. We show the structure of the analyst agent and",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                71,
                                410,
                                539,
                                422
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        410,
                                        359,
                                        422
                                    ],
                                    "score": 1.0,
                                    "content": "an example tape in Figure 3. Our introductory hands-on notebook",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        360,
                                        411,
                                        363,
                                        419
                                    ],
                                    "score": 0.6,
                                    "content": "^5",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 3
                                },
                                {
                                    "bbox": [
                                        364,
                                        410,
                                        539,
                                        422
                                    ],
                                    "score": 1.0,
                                    "content": " takes the reader through a journey from",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                70,
                                421,
                                290,
                                436
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        421,
                                        290,
                                        436
                                    ],
                                    "score": 1.0,
                                    "content": "TapeAgents basic concepts to building this agent.",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        }
                    ],
                    "index": 20.5,
                    "page_num": "page_7",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        386,
                        541,
                        436
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        439,
                        540,
                        559
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                440,
                                540,
                                453
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        440,
                                        540,
                                        453
                                    ],
                                    "score": 1.0,
                                    "content": "For illustrative purposes, we implemented the nodes in this example from scratch, without using mini-",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                70,
                                452,
                                541,
                                464
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        452,
                                        541,
                                        464
                                    ],
                                    "score": 0.9967592358589172,
                                    "content": "frameworks from Section 3.1. We offered the analyst agent an environment with several tools: one to get",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                71,
                                464,
                                541,
                                476
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        464,
                                        541,
                                        476
                                    ],
                                    "score": 1.0,
                                    "content": "the company ticker, another to download stock data, as well as several tools to search and browse the",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                70,
                                476,
                                540,
                                489
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        476,
                                        540,
                                        489
                                    ],
                                    "score": 1.0,
                                    "content": "web. We inform the analyst and their web search helper of the tools that they can use by including their",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                70,
                                488,
                                541,
                                502
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        488,
                                        541,
                                        502
                                    ],
                                    "score": 1.0,
                                    "content": "tools’ schemas in the prompts that the respective agent’s nodes make. The agent operates on a tape type",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                71,
                                500,
                                540,
                                511
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        500,
                                        540,
                                        511
                                    ],
                                    "score": 1.0,
                                    "content": "called DialogTape, which can only contain two kinds of actions: ToolCalls to call one or more tools and",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                71,
                                513,
                                541,
                                524
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        513,
                                        541,
                                        524
                                    ],
                                    "score": 0.9881742000579834,
                                    "content": "AssistantStep to respond to the user. The agent uses the same Toolcalls step with different content to",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                71,
                                523,
                                541,
                                537
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        523,
                                        541,
                                        537
                                    ],
                                    "score": 0.9928784966468811,
                                    "content": "call different tools. This is the use we intend for DialogTape: quick agent prototyping without declaring",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                71,
                                537,
                                541,
                                548
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        537,
                                        541,
                                        548
                                    ],
                                    "score": 0.9779401421546936,
                                    "content": "usecase-specific step schemas, though we believe most TapeAgents users will find it useful to declare their",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                71,
                                547,
                                205,
                                561
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        547,
                                        205,
                                        561
                                    ],
                                    "score": 1.0,
                                    "content": "own action and thought types.",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        }
                    ],
                    "index": 27.5,
                    "page_num": "page_7",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        440,
                        541,
                        561
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        572,
                        456,
                        585
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                573,
                                456,
                                588
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        573,
                                        456,
                                        588
                                    ],
                                    "score": 1.0,
                                    "content": "4.2 Open-domain Question Answering and Web Browsing With Monolithic Agents",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        }
                    ],
                    "index": 33,
                    "page_num": "page_7",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        594,
                        541,
                        714
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                596,
                                541,
                                608
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        596,
                                        541,
                                        608
                                    ],
                                    "score": 0.992671549320221,
                                    "content": "To validate TapeAgents quantitatively, we build two agents that target existing benchmarks. The first one",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                69,
                                606,
                                541,
                                619
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        606,
                                        541,
                                        619
                                    ],
                                    "score": 1.0,
                                    "content": "is a question-answering (QA) agent that targets the GAIA benchmark (Mialon et al., 2024). The QA agent",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                70,
                                618,
                                541,
                                632
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        618,
                                        541,
                                        632
                                    ],
                                    "score": 0.9833837151527405,
                                    "content": "can search the web, run Python code, read multiple file types. To meet the GAIA evaluation requirements,",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                71,
                                631,
                                540,
                                643
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        631,
                                        540,
                                        643
                                    ],
                                    "score": 1.0,
                                    "content": "we prompt the agent to output the precise short answer only. We build the QA agent from MonoNode nodes,",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                71,
                                643,
                                541,
                                655
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        643,
                                        541,
                                        655
                                    ],
                                    "score": 1.0,
                                    "content": "with two planning nodes and one acting node in which the agent loops (see Figure 4). Table 1 shows that",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                71,
                                655,
                                541,
                                667
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        655,
                                        541,
                                        667
                                    ],
                                    "score": 1.0,
                                    "content": "the agent performs quite well for such a simple agent. Our agent beats the more complicated Magentic-1",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                70,
                                667,
                                541,
                                680
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        667,
                                        541,
                                        680
                                    ],
                                    "score": 1.0,
                                    "content": "agent (Fourney et al., 2024) which incorporates Orchestrator and multiple executor agents and also progress",
                                    "type": "text"
                                }
                            ],
                            "index": 40
                        },
                        {
                            "bbox": [
                                69,
                                678,
                                541,
                                692
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        678,
                                        541,
                                        692
                                    ],
                                    "score": 1.0,
                                    "content": "ledger. For comparison implementing our agent only requires gathering the tools, declaring corresponding",
                                    "type": "text"
                                }
                            ],
                            "index": 41
                        },
                        {
                            "bbox": [
                                70,
                                691,
                                541,
                                705
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        691,
                                        541,
                                        705
                                    ],
                                    "score": 0.9943662881851196,
                                    "content": "action steps (like ReadDocumentAction and UseCalculatorAction) and declaring usecase-specific thoughts for",
                                    "type": "text"
                                }
                            ],
                            "index": 42
                        },
                        {
                            "bbox": [
                                70,
                                703,
                                542,
                                716
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        703,
                                        542,
                                        716
                                    ],
                                    "score": 1.0,
                                    "content": "reasoning (like ListOfFactsThought and NewFactThought). There is a lot of room for further improvement of",
                                    "type": "text"
                                }
                            ],
                            "index": 43
                        },
                        {
                            "bbox": [
                                71,
                                419,
                                540,
                                433
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        419,
                                        540,
                                        433
                                    ],
                                    "score": 0.9944871068000793,
                                    "content": "the agent, starting from the obviously beneficial majority voting ensembling of runs and up to the multiagents,",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                72,
                                432,
                                326,
                                444
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        432,
                                        326,
                                        444
                                    ],
                                    "score": 1.0,
                                    "content": "self-critic techniques, search over the tree of thoughts, etc.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 10
                        }
                    ],
                    "index": 38.5,
                    "page_num": "page_7",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        596,
                        542,
                        716
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "image",
                    "bbox": [
                        149,
                        83,
                        462,
                        247
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                149,
                                83,
                                462,
                                247
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        149,
                                        83,
                                        462,
                                        247
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                149,
                                                83,
                                                462,
                                                247
                                            ],
                                            "score": 0.97,
                                            "type": "image",
                                            "image_path": "adfb2480281ae38cf0c55c4968cc701ac90b8f86615d82f8b131d4f7c904ed10.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        149,
                                        83,
                                        462,
                                        137.66666666666666
                                    ],
                                    "spans": [],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        149,
                                        137.66666666666666,
                                        462,
                                        192.33333333333331
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        149,
                                        192.33333333333331,
                                        462,
                                        246.99999999999997
                                    ],
                                    "spans": [],
                                    "index": 2
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                71,
                                257,
                                541,
                                279
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        258,
                                        542,
                                        271
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                258,
                                                542,
                                                271
                                            ],
                                            "score": 1.0,
                                            "content": "Figure 4: Agent structures for GAIA, WorkArena and Agentic RAG experiments (see sections 4.2 and 4.5 for",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        70,
                                        269,
                                        105,
                                        281
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                269,
                                                105,
                                                281
                                            ],
                                            "score": 1.0,
                                            "content": "details).",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                }
                            ],
                            "index": 3.5
                        }
                    ],
                    "index": 2.25
                },
                {
                    "type": "table",
                    "bbox": [
                        95,
                        306,
                        515,
                        397
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                220,
                                293,
                                391,
                                304
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        221,
                                        294,
                                        390,
                                        304
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                221,
                                                294,
                                                390,
                                                304
                                            ],
                                            "score": 1.0,
                                            "content": "Table 1: GAIA Agent evaluation results.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 5
                                }
                            ],
                            "index": 5
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                95,
                                306,
                                515,
                                397
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        95,
                                        306,
                                        515,
                                        397
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                95,
                                                306,
                                                515,
                                                397
                                            ],
                                            "score": 0.976,
                                            "html": "<html><body><table><tr><td>Framework&Model</td><td>Val accuracy, %</td><td>Testaccuracy, %</td></tr><tr><td>Langfun Agent v2.0, (Gemini, Claude Sonnet 3.5)</td><td>54.5</td><td>49.3</td></tr><tr><td>HuggingFace Agents, GPT-4o</td><td>44.2</td><td>33.3</td></tr><tr><td>TapeAgent, GPT-40</td><td>37.0</td><td>33.2</td></tr><tr><td>MSR Magentic-1, GPT-40</td><td>36.9</td><td>32.3</td></tr><tr><td>TapeAgent, GPT-4o-mini</td><td>27.3</td><td>21.9</td></tr><tr><td>GPT-4 + manually selected plugins</td><td>14.6</td><td>14.6</td></tr></table></body></html>",
                                            "type": "table",
                                            "image_path": "9cc3c7dac52fc6ef3e7f17ffba320a3cacf809bd33faa06fa1f9b2c82fc626d4.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 7,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        95,
                                        306,
                                        515,
                                        336.3333333333333
                                    ],
                                    "spans": [],
                                    "index": 6
                                },
                                {
                                    "bbox": [
                                        95,
                                        336.3333333333333,
                                        515,
                                        366.66666666666663
                                    ],
                                    "spans": [],
                                    "index": 7
                                },
                                {
                                    "bbox": [
                                        95,
                                        366.66666666666663,
                                        515,
                                        396.99999999999994
                                    ],
                                    "spans": [],
                                    "index": 8
                                }
                            ]
                        }
                    ],
                    "index": 6.0
                },
                {
                    "type": "text",
                    "bbox": [
                        73,
                        419,
                        541,
                        443
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                419,
                                540,
                                433
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        419,
                                        540,
                                        433
                                    ],
                                    "score": 0.9944871068000793,
                                    "content": "the agent, starting from the obviously beneficial majority voting ensembling of runs and up to the multiagents,",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                72,
                                432,
                                326,
                                444
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        432,
                                        326,
                                        444
                                    ],
                                    "score": 1.0,
                                    "content": "self-critic techniques, search over the tree of thoughts, etc.",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        }
                    ],
                    "index": 9.5
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        448,
                        540,
                        521
                    ],
                    "lines": [
                        {
                            "bbox": [
                                69,
                                448,
                                540,
                                463
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        448,
                                        540,
                                        463
                                    ],
                                    "score": 1.0,
                                    "content": "We used a similar approach to build a web-browsing agent that targets the WorkArena benchmark (Drouin",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                70,
                                461,
                                539,
                                474
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        461,
                                        539,
                                        474
                                    ],
                                    "score": 1.0,
                                    "content": "et al., 2024). The BrowserGym environment has been used for the evaluation, with a convenient inter-",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                70,
                                473,
                                541,
                                486
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        473,
                                        541,
                                        486
                                    ],
                                    "score": 0.9970919489860535,
                                    "content": "face to the real browser. We declared action classes for different browser actions like HoverAction and",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                69,
                                484,
                                540,
                                499
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        484,
                                        540,
                                        499
                                    ],
                                    "score": 1.0,
                                    "content": "PressAction and so on. Figure 4 illustrates the exact agent structure, which is following ReAct (Yao et al.,",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                70,
                                497,
                                541,
                                511
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        497,
                                        100,
                                        511
                                    ],
                                    "score": 1.0,
                                    "content": "2023b)",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        101,
                                        500,
                                        109,
                                        507
                                    ],
                                    "score": 0.52,
                                    "content": "^+",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        109,
                                        497,
                                        541,
                                        511
                                    ],
                                    "score": 0.9936704039573669,
                                    "content": "Planning approach, with goal-setting, refection and acting nodes. We benchmark our web agent",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                70,
                                509,
                                306,
                                523
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        509,
                                        306,
                                        523
                                    ],
                                    "score": 0.9935985803604126,
                                    "content": "and find that it performs competitively (see Table 2).",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        }
                    ],
                    "index": 13.5
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        535,
                        270,
                        548
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                536,
                                269,
                                549
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        536,
                                        269,
                                        549
                                    ],
                                    "score": 1.0,
                                    "content": "4.3 Data Science With a Team of Agents",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        }
                    ],
                    "index": 17
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        558,
                        541,
                        630
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                559,
                                540,
                                573
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        559,
                                        540,
                                        573
                                    ],
                                    "score": 1.0,
                                    "content": "To demonstrate that TapeAgents natively supports the multi-agent paradigm, we implement a “data science”",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                70,
                                570,
                                541,
                                583
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        570,
                                        541,
                                        583
                                    ],
                                    "score": 1.0,
                                    "content": "agent team that consists of the Requestor, Manager, Software Engineer, Code Executor and Asset Reviewer",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                70,
                                582,
                                541,
                                596
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        582,
                                        541,
                                        596
                                    ],
                                    "score": 1.0,
                                    "content": "agent. Figure 7 (in Appendix C) shows the team in action as it builds a stock price comparison plot. We",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                71,
                                595,
                                541,
                                607
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        595,
                                        541,
                                        607
                                    ],
                                    "score": 1.0,
                                    "content": "drew inspiration from the popular AutoGen framework for the multi-agent communication pattern in this",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                71,
                                607,
                                540,
                                620
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        607,
                                        540,
                                        620
                                    ],
                                    "score": 0.9885431528091431,
                                    "content": "example. Benefits of the TapeAgents implementation of this agent team include that one can easily resume",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                70,
                                618,
                                536,
                                632
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        618,
                                        536,
                                        632
                                    ],
                                    "score": 1.0,
                                    "content": "the team from an intermediate tape or use tapes to optimize the entire agent organization algorithmically.",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        }
                    ],
                    "index": 20.5
                },
                {
                    "type": "table",
                    "bbox": [
                        205,
                        663,
                        405,
                        730
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                163,
                                650,
                                446,
                                661
                            ],
                            "group_id": 1,
                            "lines": [
                                {
                                    "bbox": [
                                        164,
                                        650,
                                        447,
                                        662
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                164,
                                                650,
                                                447,
                                                662
                                            ],
                                            "score": 1.0,
                                            "content": "Table 2: Workarena Agent evaluation result on Workarena L1 tasks.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 24
                                }
                            ],
                            "index": 24
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                205,
                                663,
                                405,
                                730
                            ],
                            "group_id": 1,
                            "lines": [
                                {
                                    "bbox": [
                                        205,
                                        663,
                                        405,
                                        730
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                205,
                                                663,
                                                405,
                                                730
                                            ],
                                            "score": 0.979,
                                            "html": "<html><body><table><tr><td>Framework & Model</td><td>Accuracy, %</td></tr><tr><td>TapeAgents GPT-4o</td><td>44.2</td></tr><tr><td>Agentlab GPT-4o</td><td>42.7</td></tr><tr><td>TapeAgents sGPT-4o-mini</td><td>29.1</td></tr><tr><td>Agentlab GPT-4o-mini</td><td>23.0</td></tr></table></body></html>",
                                            "type": "table",
                                            "image_path": "0f45785b968526bb500235da3638cae2eee9424b2aee4e353faa0775de703084.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 27.5,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        205,
                                        663,
                                        405,
                                        676
                                    ],
                                    "spans": [],
                                    "index": 25
                                },
                                {
                                    "bbox": [
                                        205,
                                        676,
                                        405,
                                        689
                                    ],
                                    "spans": [],
                                    "index": 26
                                },
                                {
                                    "bbox": [
                                        205,
                                        689,
                                        405,
                                        702
                                    ],
                                    "spans": [],
                                    "index": 27
                                },
                                {
                                    "bbox": [
                                        205,
                                        702,
                                        405,
                                        715
                                    ],
                                    "spans": [],
                                    "index": 28
                                },
                                {
                                    "bbox": [
                                        205,
                                        715,
                                        405,
                                        728
                                    ],
                                    "spans": [],
                                    "index": 29
                                },
                                {
                                    "bbox": [
                                        205,
                                        728,
                                        405,
                                        741
                                    ],
                                    "spans": [],
                                    "index": 30
                                }
                            ]
                        }
                    ],
                    "index": 25.75
                }
            ],
            "layout_bboxes": [],
            "page_idx": 8,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [
                {
                    "type": "image",
                    "bbox": [
                        149,
                        83,
                        462,
                        247
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                149,
                                83,
                                462,
                                247
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        149,
                                        83,
                                        462,
                                        247
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                149,
                                                83,
                                                462,
                                                247
                                            ],
                                            "score": 0.97,
                                            "type": "image",
                                            "image_path": "adfb2480281ae38cf0c55c4968cc701ac90b8f86615d82f8b131d4f7c904ed10.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        149,
                                        83,
                                        462,
                                        137.66666666666666
                                    ],
                                    "spans": [],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        149,
                                        137.66666666666666,
                                        462,
                                        192.33333333333331
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        149,
                                        192.33333333333331,
                                        462,
                                        246.99999999999997
                                    ],
                                    "spans": [],
                                    "index": 2
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                71,
                                257,
                                541,
                                279
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        258,
                                        542,
                                        271
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                258,
                                                542,
                                                271
                                            ],
                                            "score": 1.0,
                                            "content": "Figure 4: Agent structures for GAIA, WorkArena and Agentic RAG experiments (see sections 4.2 and 4.5 for",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        70,
                                        269,
                                        105,
                                        281
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                269,
                                                105,
                                                281
                                            ],
                                            "score": 1.0,
                                            "content": "details).",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                }
                            ],
                            "index": 3.5
                        }
                    ],
                    "index": 2.25
                }
            ],
            "tables": [
                {
                    "type": "table",
                    "bbox": [
                        95,
                        306,
                        515,
                        397
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                220,
                                293,
                                391,
                                304
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        221,
                                        294,
                                        390,
                                        304
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                221,
                                                294,
                                                390,
                                                304
                                            ],
                                            "score": 1.0,
                                            "content": "Table 1: GAIA Agent evaluation results.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 5
                                }
                            ],
                            "index": 5
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                95,
                                306,
                                515,
                                397
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        95,
                                        306,
                                        515,
                                        397
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                95,
                                                306,
                                                515,
                                                397
                                            ],
                                            "score": 0.976,
                                            "html": "<html><body><table><tr><td>Framework&Model</td><td>Val accuracy, %</td><td>Testaccuracy, %</td></tr><tr><td>Langfun Agent v2.0, (Gemini, Claude Sonnet 3.5)</td><td>54.5</td><td>49.3</td></tr><tr><td>HuggingFace Agents, GPT-4o</td><td>44.2</td><td>33.3</td></tr><tr><td>TapeAgent, GPT-40</td><td>37.0</td><td>33.2</td></tr><tr><td>MSR Magentic-1, GPT-40</td><td>36.9</td><td>32.3</td></tr><tr><td>TapeAgent, GPT-4o-mini</td><td>27.3</td><td>21.9</td></tr><tr><td>GPT-4 + manually selected plugins</td><td>14.6</td><td>14.6</td></tr></table></body></html>",
                                            "type": "table",
                                            "image_path": "9cc3c7dac52fc6ef3e7f17ffba320a3cacf809bd33faa06fa1f9b2c82fc626d4.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 7,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        95,
                                        306,
                                        515,
                                        336.3333333333333
                                    ],
                                    "spans": [],
                                    "index": 6
                                },
                                {
                                    "bbox": [
                                        95,
                                        336.3333333333333,
                                        515,
                                        366.66666666666663
                                    ],
                                    "spans": [],
                                    "index": 7
                                },
                                {
                                    "bbox": [
                                        95,
                                        366.66666666666663,
                                        515,
                                        396.99999999999994
                                    ],
                                    "spans": [],
                                    "index": 8
                                }
                            ]
                        }
                    ],
                    "index": 6.0
                },
                {
                    "type": "table",
                    "bbox": [
                        205,
                        663,
                        405,
                        730
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                163,
                                650,
                                446,
                                661
                            ],
                            "group_id": 1,
                            "lines": [
                                {
                                    "bbox": [
                                        164,
                                        650,
                                        447,
                                        662
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                164,
                                                650,
                                                447,
                                                662
                                            ],
                                            "score": 1.0,
                                            "content": "Table 2: Workarena Agent evaluation result on Workarena L1 tasks.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 24
                                }
                            ],
                            "index": 24
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                205,
                                663,
                                405,
                                730
                            ],
                            "group_id": 1,
                            "lines": [
                                {
                                    "bbox": [
                                        205,
                                        663,
                                        405,
                                        730
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                205,
                                                663,
                                                405,
                                                730
                                            ],
                                            "score": 0.979,
                                            "html": "<html><body><table><tr><td>Framework & Model</td><td>Accuracy, %</td></tr><tr><td>TapeAgents GPT-4o</td><td>44.2</td></tr><tr><td>Agentlab GPT-4o</td><td>42.7</td></tr><tr><td>TapeAgents sGPT-4o-mini</td><td>29.1</td></tr><tr><td>Agentlab GPT-4o-mini</td><td>23.0</td></tr></table></body></html>",
                                            "type": "table",
                                            "image_path": "0f45785b968526bb500235da3638cae2eee9424b2aee4e353faa0775de703084.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 27.5,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        205,
                                        663,
                                        405,
                                        676
                                    ],
                                    "spans": [],
                                    "index": 25
                                },
                                {
                                    "bbox": [
                                        205,
                                        676,
                                        405,
                                        689
                                    ],
                                    "spans": [],
                                    "index": 26
                                },
                                {
                                    "bbox": [
                                        205,
                                        689,
                                        405,
                                        702
                                    ],
                                    "spans": [],
                                    "index": 27
                                },
                                {
                                    "bbox": [
                                        205,
                                        702,
                                        405,
                                        715
                                    ],
                                    "spans": [],
                                    "index": 28
                                },
                                {
                                    "bbox": [
                                        205,
                                        715,
                                        405,
                                        728
                                    ],
                                    "spans": [],
                                    "index": 29
                                },
                                {
                                    "bbox": [
                                        205,
                                        728,
                                        405,
                                        741
                                    ],
                                    "spans": [],
                                    "index": 30
                                }
                            ]
                        }
                    ],
                    "index": 25.75
                }
            ],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        71,
                        27,
                        143,
                        37
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                25,
                                144,
                                38
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        25,
                                        144,
                                        38
                                    ],
                                    "score": 1.0,
                                    "content": "Technical report",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        302,
                        751,
                        309,
                        760
                    ],
                    "lines": [
                        {
                            "bbox": [
                                302,
                                752,
                                309,
                                762
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        302,
                                        752,
                                        309,
                                        762
                                    ],
                                    "score": 1.0,
                                    "content": "9",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "image",
                    "bbox": [
                        149,
                        83,
                        462,
                        247
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                149,
                                83,
                                462,
                                247
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        149,
                                        83,
                                        462,
                                        247
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                149,
                                                83,
                                                462,
                                                247
                                            ],
                                            "score": 0.97,
                                            "type": "image",
                                            "image_path": "adfb2480281ae38cf0c55c4968cc701ac90b8f86615d82f8b131d4f7c904ed10.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        149,
                                        83,
                                        462,
                                        137.66666666666666
                                    ],
                                    "spans": [],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        149,
                                        137.66666666666666,
                                        462,
                                        192.33333333333331
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        149,
                                        192.33333333333331,
                                        462,
                                        246.99999999999997
                                    ],
                                    "spans": [],
                                    "index": 2
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                71,
                                257,
                                541,
                                279
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        258,
                                        542,
                                        271
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                258,
                                                542,
                                                271
                                            ],
                                            "score": 1.0,
                                            "content": "Figure 4: Agent structures for GAIA, WorkArena and Agentic RAG experiments (see sections 4.2 and 4.5 for",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        70,
                                        269,
                                        105,
                                        281
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                269,
                                                105,
                                                281
                                            ],
                                            "score": 1.0,
                                            "content": "details).",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                }
                            ],
                            "index": 3.5
                        }
                    ],
                    "index": 2.25,
                    "page_num": "page_8",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "table",
                    "bbox": [
                        95,
                        306,
                        515,
                        397
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                220,
                                293,
                                391,
                                304
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        221,
                                        294,
                                        390,
                                        304
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                221,
                                                294,
                                                390,
                                                304
                                            ],
                                            "score": 1.0,
                                            "content": "Table 1: GAIA Agent evaluation results.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 5
                                }
                            ],
                            "index": 5
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                95,
                                306,
                                515,
                                397
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        95,
                                        306,
                                        515,
                                        397
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                95,
                                                306,
                                                515,
                                                397
                                            ],
                                            "score": 0.976,
                                            "html": "<html><body><table><tr><td>Framework&Model</td><td>Val accuracy, %</td><td>Testaccuracy, %</td></tr><tr><td>Langfun Agent v2.0, (Gemini, Claude Sonnet 3.5)</td><td>54.5</td><td>49.3</td></tr><tr><td>HuggingFace Agents, GPT-4o</td><td>44.2</td><td>33.3</td></tr><tr><td>TapeAgent, GPT-40</td><td>37.0</td><td>33.2</td></tr><tr><td>MSR Magentic-1, GPT-40</td><td>36.9</td><td>32.3</td></tr><tr><td>TapeAgent, GPT-4o-mini</td><td>27.3</td><td>21.9</td></tr><tr><td>GPT-4 + manually selected plugins</td><td>14.6</td><td>14.6</td></tr></table></body></html>",
                                            "type": "table",
                                            "image_path": "9cc3c7dac52fc6ef3e7f17ffba320a3cacf809bd33faa06fa1f9b2c82fc626d4.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 7,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        95,
                                        306,
                                        515,
                                        336.3333333333333
                                    ],
                                    "spans": [],
                                    "index": 6
                                },
                                {
                                    "bbox": [
                                        95,
                                        336.3333333333333,
                                        515,
                                        366.66666666666663
                                    ],
                                    "spans": [],
                                    "index": 7
                                },
                                {
                                    "bbox": [
                                        95,
                                        366.66666666666663,
                                        515,
                                        396.99999999999994
                                    ],
                                    "spans": [],
                                    "index": 8
                                }
                            ]
                        }
                    ],
                    "index": 6.0,
                    "page_num": "page_8",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        73,
                        419,
                        541,
                        443
                    ],
                    "lines": [],
                    "index": 9.5,
                    "page_num": "page_8",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        71,
                        419,
                        540,
                        444
                    ],
                    "lines_deleted": true
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        448,
                        540,
                        521
                    ],
                    "lines": [
                        {
                            "bbox": [
                                69,
                                448,
                                540,
                                463
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        448,
                                        540,
                                        463
                                    ],
                                    "score": 1.0,
                                    "content": "We used a similar approach to build a web-browsing agent that targets the WorkArena benchmark (Drouin",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                70,
                                461,
                                539,
                                474
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        461,
                                        539,
                                        474
                                    ],
                                    "score": 1.0,
                                    "content": "et al., 2024). The BrowserGym environment has been used for the evaluation, with a convenient inter-",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                70,
                                473,
                                541,
                                486
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        473,
                                        541,
                                        486
                                    ],
                                    "score": 0.9970919489860535,
                                    "content": "face to the real browser. We declared action classes for different browser actions like HoverAction and",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                69,
                                484,
                                540,
                                499
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        484,
                                        540,
                                        499
                                    ],
                                    "score": 1.0,
                                    "content": "PressAction and so on. Figure 4 illustrates the exact agent structure, which is following ReAct (Yao et al.,",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                70,
                                497,
                                541,
                                511
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        497,
                                        100,
                                        511
                                    ],
                                    "score": 1.0,
                                    "content": "2023b)",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        101,
                                        500,
                                        109,
                                        507
                                    ],
                                    "score": 0.52,
                                    "content": "^+",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        109,
                                        497,
                                        541,
                                        511
                                    ],
                                    "score": 0.9936704039573669,
                                    "content": "Planning approach, with goal-setting, refection and acting nodes. We benchmark our web agent",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                70,
                                509,
                                306,
                                523
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        509,
                                        306,
                                        523
                                    ],
                                    "score": 0.9935985803604126,
                                    "content": "and find that it performs competitively (see Table 2).",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        }
                    ],
                    "index": 13.5,
                    "page_num": "page_8",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        448,
                        541,
                        523
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        535,
                        270,
                        548
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                536,
                                269,
                                549
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        536,
                                        269,
                                        549
                                    ],
                                    "score": 1.0,
                                    "content": "4.3 Data Science With a Team of Agents",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        }
                    ],
                    "index": 17,
                    "page_num": "page_8",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        558,
                        541,
                        630
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                559,
                                540,
                                573
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        559,
                                        540,
                                        573
                                    ],
                                    "score": 1.0,
                                    "content": "To demonstrate that TapeAgents natively supports the multi-agent paradigm, we implement a “data science”",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                70,
                                570,
                                541,
                                583
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        570,
                                        541,
                                        583
                                    ],
                                    "score": 1.0,
                                    "content": "agent team that consists of the Requestor, Manager, Software Engineer, Code Executor and Asset Reviewer",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                70,
                                582,
                                541,
                                596
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        582,
                                        541,
                                        596
                                    ],
                                    "score": 1.0,
                                    "content": "agent. Figure 7 (in Appendix C) shows the team in action as it builds a stock price comparison plot. We",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                71,
                                595,
                                541,
                                607
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        595,
                                        541,
                                        607
                                    ],
                                    "score": 1.0,
                                    "content": "drew inspiration from the popular AutoGen framework for the multi-agent communication pattern in this",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                71,
                                607,
                                540,
                                620
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        607,
                                        540,
                                        620
                                    ],
                                    "score": 0.9885431528091431,
                                    "content": "example. Benefits of the TapeAgents implementation of this agent team include that one can easily resume",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                70,
                                618,
                                536,
                                632
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        618,
                                        536,
                                        632
                                    ],
                                    "score": 1.0,
                                    "content": "the team from an intermediate tape or use tapes to optimize the entire agent organization algorithmically.",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        }
                    ],
                    "index": 20.5,
                    "page_num": "page_8",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        559,
                        541,
                        632
                    ]
                },
                {
                    "type": "table",
                    "bbox": [
                        205,
                        663,
                        405,
                        730
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                163,
                                650,
                                446,
                                661
                            ],
                            "group_id": 1,
                            "lines": [
                                {
                                    "bbox": [
                                        164,
                                        650,
                                        447,
                                        662
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                164,
                                                650,
                                                447,
                                                662
                                            ],
                                            "score": 1.0,
                                            "content": "Table 2: Workarena Agent evaluation result on Workarena L1 tasks.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 24
                                }
                            ],
                            "index": 24
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                205,
                                663,
                                405,
                                730
                            ],
                            "group_id": 1,
                            "lines": [
                                {
                                    "bbox": [
                                        205,
                                        663,
                                        405,
                                        730
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                205,
                                                663,
                                                405,
                                                730
                                            ],
                                            "score": 0.979,
                                            "html": "<html><body><table><tr><td>Framework & Model</td><td>Accuracy, %</td></tr><tr><td>TapeAgents GPT-4o</td><td>44.2</td></tr><tr><td>Agentlab GPT-4o</td><td>42.7</td></tr><tr><td>TapeAgents sGPT-4o-mini</td><td>29.1</td></tr><tr><td>Agentlab GPT-4o-mini</td><td>23.0</td></tr></table></body></html>",
                                            "type": "table",
                                            "image_path": "0f45785b968526bb500235da3638cae2eee9424b2aee4e353faa0775de703084.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 27.5,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        205,
                                        663,
                                        405,
                                        676
                                    ],
                                    "spans": [],
                                    "index": 25
                                },
                                {
                                    "bbox": [
                                        205,
                                        676,
                                        405,
                                        689
                                    ],
                                    "spans": [],
                                    "index": 26
                                },
                                {
                                    "bbox": [
                                        205,
                                        689,
                                        405,
                                        702
                                    ],
                                    "spans": [],
                                    "index": 27
                                },
                                {
                                    "bbox": [
                                        205,
                                        702,
                                        405,
                                        715
                                    ],
                                    "spans": [],
                                    "index": 28
                                },
                                {
                                    "bbox": [
                                        205,
                                        715,
                                        405,
                                        728
                                    ],
                                    "spans": [],
                                    "index": 29
                                },
                                {
                                    "bbox": [
                                        205,
                                        728,
                                        405,
                                        741
                                    ],
                                    "spans": [],
                                    "index": 30
                                }
                            ]
                        }
                    ],
                    "index": 25.75,
                    "page_num": "page_8",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "table",
                    "bbox": [
                        78,
                        93,
                        533,
                        195
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                199,
                                81,
                                411,
                                92
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        200,
                                        81,
                                        410,
                                        93
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                200,
                                                81,
                                                410,
                                                93
                                            ],
                                            "score": 1.0,
                                            "content": "Table 3: Agent optimization results on HotpotQA.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 0
                                }
                            ],
                            "index": 0
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                78,
                                93,
                                533,
                                195
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        78,
                                        93,
                                        533,
                                        195
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                93,
                                                533,
                                                195
                                            ],
                                            "score": 0.983,
                                            "html": "<html><body><table><tr><td>Model</td><td>Agent</td><td>Retrieval (%)</td><td>Answer (%)</td><td>MeanAccuracy (%)</td></tr><tr><td>GPT-3.5-Turbo</td><td>Non-optimized</td><td>42.7</td><td>44.7</td><td>43.7</td></tr><tr><td></td><td>Optimized</td><td>56.7</td><td>47.0</td><td>51.8</td></tr><tr><td>GPT-4o-mini</td><td>Non-optimized</td><td>50.3</td><td>47.3</td><td>48.8</td></tr><tr><td></td><td>Optimized</td><td>57.0</td><td>50.7</td><td>53.8</td></tr><tr><td>Llama-3.3-70B-Instruct</td><td>Non-optimized</td><td>53.7</td><td>35.0</td><td>44.3</td></tr><tr><td></td><td>Optimized</td><td>57.7</td><td>48.3</td><td>53.0</td></tr></table></body></html>",
                                            "type": "table",
                                            "image_path": "375af56c27d38e21831296a2f909c7d8d6db4ef112dbe6ed5cd53b0e444d4679.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 2,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        78,
                                        93,
                                        533,
                                        127.0
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        78,
                                        127.0,
                                        533,
                                        161.0
                                    ],
                                    "spans": [],
                                    "index": 2
                                },
                                {
                                    "bbox": [
                                        78,
                                        161.0,
                                        533,
                                        195.0
                                    ],
                                    "spans": [],
                                    "index": 3
                                }
                            ]
                        }
                    ],
                    "index": 1.0
                },
                {
                    "type": "title",
                    "bbox": [
                        72,
                        226,
                        245,
                        239
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                227,
                                246,
                                240
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        227,
                                        246,
                                        240
                                    ],
                                    "score": 1.0,
                                    "content": "4.4 Finetuning a Cheap Math Agent",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        }
                    ],
                    "index": 4
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        253,
                        540,
                        313
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                254,
                                540,
                                267
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        254,
                                        540,
                                        267
                                    ],
                                    "score": 0.9876342415809631,
                                    "content": "We test-drive TapeAgents fine-tuning component with a distillation example. We train a LLAMA3.1-8B-",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                71,
                                266,
                                540,
                                279
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        266,
                                        540,
                                        279
                                    ],
                                    "score": 1.0,
                                    "content": "based math agent using tapes by its teacher counterpart with LLAMA3.1-70B under the hood. We equip",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                70,
                                277,
                                541,
                                292
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        277,
                                        541,
                                        292
                                    ],
                                    "score": 0.9883108139038086,
                                    "content": "each agent with a reasoning node and run the environment with a calculator tool. After finetuning on 3,000",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                70,
                                290,
                                540,
                                303
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        290,
                                        476,
                                        303
                                    ],
                                    "score": 0.9901904463768005,
                                    "content": "samples from 1,000 teacher tapes, the student performance rises significantly from 66.2% to",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        477,
                                        291,
                                        503,
                                        300
                                    ],
                                    "score": 0.59,
                                    "content": "77.5\\%",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 26
                                },
                                {
                                    "bbox": [
                                        504,
                                        290,
                                        540,
                                        303
                                    ],
                                    "score": 1.0,
                                    "content": ", though",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                70,
                                301,
                                348,
                                314
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        301,
                                        201,
                                        314
                                    ],
                                    "score": 1.0,
                                    "content": "the teacher’s performance, at ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        201,
                                        302,
                                        228,
                                        312
                                    ],
                                    "score": 0.65,
                                    "content": "93.1\\%",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 27
                                },
                                {
                                    "bbox": [
                                        228,
                                        301,
                                        348,
                                        314
                                    ],
                                    "score": 1.0,
                                    "content": ", remains much higher still.",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        }
                    ],
                    "index": 7
                },
                {
                    "type": "title",
                    "bbox": [
                        72,
                        339,
                        245,
                        352
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                340,
                                245,
                                353
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        340,
                                        245,
                                        353
                                    ],
                                    "score": 1.0,
                                    "content": "4.5 Prompt-Tuning for Agentic RAG",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        }
                    ],
                    "index": 10
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        366,
                        541,
                        449
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                366,
                                541,
                                380
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        366,
                                        541,
                                        380
                                    ],
                                    "score": 0.9764429926872253,
                                    "content": " In our last example, we show how the tape, the agent configuration and the metadata linking them, can serve",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                70,
                                380,
                                540,
                                392
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        380,
                                        540,
                                        392
                                    ],
                                    "score": 1.0,
                                    "content": "as a medium to implement data-driven agent optimization algorithms. In this example, we use LLMFunction",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                70,
                                392,
                                541,
                                403
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        392,
                                        541,
                                        403
                                    ],
                                    "score": 1.0,
                                    "content": "prompt templates (see examples in Appendix B) that describe the intended behavior of a transformation that",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                71,
                                404,
                                539,
                                415
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        404,
                                        539,
                                        415
                                    ],
                                    "score": 1.0,
                                    "content": "the LLM should perform, including the instruction, the input/output format, and optionally, a few demon-",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                70,
                                414,
                                540,
                                428
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        414,
                                        540,
                                        428
                                    ],
                                    "score": 1.0,
                                    "content": "strations. We designed LLMFunction to make it possible to implement DSPy-like algorithms in TapeAgents.",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                70,
                                425,
                                541,
                                440
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        425,
                                        541,
                                        440
                                    ],
                                    "score": 1.0,
                                    "content": "Below we describe how we used TapeAgents components to closely reimplement the DSPy introductory",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                71,
                                440,
                                114,
                                451
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        440,
                                        114,
                                        451
                                    ],
                                    "score": 1.0,
                                    "content": "notebook.",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        }
                    ],
                    "index": 14
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        455,
                        540,
                        634
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                456,
                                541,
                                469
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        456,
                                        541,
                                        469
                                    ],
                                    "score": 1.0,
                                    "content": "We compose a Retrieval-Augmented Generation (RAG) agent. Figure 4 illustrates the structure where the",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                70,
                                468,
                                541,
                                481
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        468,
                                        541,
                                        481
                                    ],
                                    "score": 1.0,
                                    "content": "agent performs two rounds of query generation and Wikipedia retrieval and then produces a short factual",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                71,
                                481,
                                541,
                                493
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        481,
                                        541,
                                        493
                                    ],
                                    "score": 0.9789544343948364,
                                    "content": "answer. We build this agent mostly from LlMFunctionNode nodes that describe how the input fields in",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                71,
                                493,
                                540,
                                505
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        493,
                                        540,
                                        505
                                    ],
                                    "score": 0.9832031726837158,
                                    "content": "their respective LLMFunction templates should be filled with the steps from the tape. The only different",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                69,
                                503,
                                542,
                                518
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        503,
                                        542,
                                        518
                                    ],
                                    "score": 1.0,
                                    "content": "kind of a node is a null-prompt node that deduplicates the retrieved paragraphs. We tune the prompts",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                70,
                                515,
                                541,
                                529
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        515,
                                        541,
                                        529
                                    ],
                                    "score": 1.0,
                                    "content": "of the resulting 5-node agent by adding demonstrations to the function prompt templates. We obtain",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                70,
                                529,
                                541,
                                542
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        529,
                                        541,
                                        542
                                    ],
                                    "score": 0.996548593044281,
                                    "content": "demonstrations by running the agent on 50 HotpotQA training examples and filtering the tapes with the",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                70,
                                541,
                                541,
                                554
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        541,
                                        541,
                                        554
                                    ],
                                    "score": 0.9952962398529053,
                                    "content": "wrong answer or duplicate queries. We try 10 different combinations of 4 randomly selected good tapes,",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                71,
                                553,
                                540,
                                564
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        553,
                                        540,
                                        564
                                    ],
                                    "score": 1.0,
                                    "content": "extract demonstrations from them, add them to the agent’s prompt template and measure the validation",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                71,
                                565,
                                541,
                                576
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        565,
                                        541,
                                        576
                                    ],
                                    "score": 1.0,
                                    "content": "set performance, namely the sum of retrieval and answer accuracies. We select the best agent and evaluate",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                70,
                                576,
                                541,
                                588
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        576,
                                        541,
                                        588
                                    ],
                                    "score": 0.983268141746521,
                                    "content": "on a set of 300 examples. Results in Table 3 show that prompt-tuning leads to significant gains in both",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                71,
                                589,
                                540,
                                600
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        589,
                                        540,
                                        600
                                    ],
                                    "score": 1.0,
                                    "content": "retrieval and answer accuracy. The optimized agent is still a TapeAgent that can be resumed from any",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                70,
                                600,
                                541,
                                613
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        600,
                                        541,
                                        613
                                    ],
                                    "score": 1.0,
                                    "content": "intermediate tape, unlike a free-form Python program that uses DSPy. Notably, the implementation of the",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                70,
                                612,
                                540,
                                624
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        612,
                                        540,
                                        624
                                    ],
                                    "score": 1.0,
                                    "content": "actual demonstration selection algorithm took just 12 lines of code (see Appendix B), highlighting how the",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                70,
                                623,
                                391,
                                637
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        623,
                                        391,
                                        637
                                    ],
                                    "score": 1.0,
                                    "content": "TapeAgent structures and metadata facilitate algorithm implementation.",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        }
                    ],
                    "index": 25
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        662,
                        481,
                        677
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                664,
                                483,
                                680
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        664,
                                        483,
                                        680
                                    ],
                                    "score": 0.9860485792160034,
                                    "content": "5 Case Study: Building a Cost-Effective Enterprise Form-Filling Assistant",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        }
                    ],
                    "index": 33
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        696,
                        541,
                        732
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                697,
                                541,
                                711
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        697,
                                        541,
                                        711
                                    ],
                                    "score": 0.9907333850860596,
                                    "content": "A key use case of TapeAgents is optimizing LLM Agents to offer great quality services at a fraction of the",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                71,
                                709,
                                541,
                                723
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        709,
                                        541,
                                        723
                                    ],
                                    "score": 0.9973127841949463,
                                    "content": "cost. In this section, we present a feshed-out example of how these goals can be achieved for a conversational",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                72,
                                722,
                                360,
                                733
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        722,
                                        360,
                                        733
                                    ],
                                    "score": 0.9918021559715271,
                                    "content": "assistant that can help fill a request form and submit the request.",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        }
                    ],
                    "index": 35
                }
            ],
            "layout_bboxes": [],
            "page_idx": 9,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [
                {
                    "type": "table",
                    "bbox": [
                        78,
                        93,
                        533,
                        195
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                199,
                                81,
                                411,
                                92
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        200,
                                        81,
                                        410,
                                        93
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                200,
                                                81,
                                                410,
                                                93
                                            ],
                                            "score": 1.0,
                                            "content": "Table 3: Agent optimization results on HotpotQA.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 0
                                }
                            ],
                            "index": 0
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                78,
                                93,
                                533,
                                195
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        78,
                                        93,
                                        533,
                                        195
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                93,
                                                533,
                                                195
                                            ],
                                            "score": 0.983,
                                            "html": "<html><body><table><tr><td>Model</td><td>Agent</td><td>Retrieval (%)</td><td>Answer (%)</td><td>MeanAccuracy (%)</td></tr><tr><td>GPT-3.5-Turbo</td><td>Non-optimized</td><td>42.7</td><td>44.7</td><td>43.7</td></tr><tr><td></td><td>Optimized</td><td>56.7</td><td>47.0</td><td>51.8</td></tr><tr><td>GPT-4o-mini</td><td>Non-optimized</td><td>50.3</td><td>47.3</td><td>48.8</td></tr><tr><td></td><td>Optimized</td><td>57.0</td><td>50.7</td><td>53.8</td></tr><tr><td>Llama-3.3-70B-Instruct</td><td>Non-optimized</td><td>53.7</td><td>35.0</td><td>44.3</td></tr><tr><td></td><td>Optimized</td><td>57.7</td><td>48.3</td><td>53.0</td></tr></table></body></html>",
                                            "type": "table",
                                            "image_path": "375af56c27d38e21831296a2f909c7d8d6db4ef112dbe6ed5cd53b0e444d4679.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 2,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        78,
                                        93,
                                        533,
                                        127.0
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        78,
                                        127.0,
                                        533,
                                        161.0
                                    ],
                                    "spans": [],
                                    "index": 2
                                },
                                {
                                    "bbox": [
                                        78,
                                        161.0,
                                        533,
                                        195.0
                                    ],
                                    "spans": [],
                                    "index": 3
                                }
                            ]
                        }
                    ],
                    "index": 1.0
                }
            ],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        71,
                        27,
                        143,
                        37
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                26,
                                144,
                                38
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        26,
                                        144,
                                        38
                                    ],
                                    "score": 1.0,
                                    "content": "Technical report",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        751,
                        311,
                        760
                    ],
                    "lines": [
                        {
                            "bbox": [
                                299,
                                751,
                                312,
                                762
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        299,
                                        751,
                                        312,
                                        762
                                    ],
                                    "score": 1.0,
                                    "content": "10",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "table",
                    "bbox": [
                        78,
                        93,
                        533,
                        195
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                199,
                                81,
                                411,
                                92
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        200,
                                        81,
                                        410,
                                        93
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                200,
                                                81,
                                                410,
                                                93
                                            ],
                                            "score": 1.0,
                                            "content": "Table 3: Agent optimization results on HotpotQA.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 0
                                }
                            ],
                            "index": 0
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                78,
                                93,
                                533,
                                195
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        78,
                                        93,
                                        533,
                                        195
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                93,
                                                533,
                                                195
                                            ],
                                            "score": 0.983,
                                            "html": "<html><body><table><tr><td>Model</td><td>Agent</td><td>Retrieval (%)</td><td>Answer (%)</td><td>MeanAccuracy (%)</td></tr><tr><td>GPT-3.5-Turbo</td><td>Non-optimized</td><td>42.7</td><td>44.7</td><td>43.7</td></tr><tr><td></td><td>Optimized</td><td>56.7</td><td>47.0</td><td>51.8</td></tr><tr><td>GPT-4o-mini</td><td>Non-optimized</td><td>50.3</td><td>47.3</td><td>48.8</td></tr><tr><td></td><td>Optimized</td><td>57.0</td><td>50.7</td><td>53.8</td></tr><tr><td>Llama-3.3-70B-Instruct</td><td>Non-optimized</td><td>53.7</td><td>35.0</td><td>44.3</td></tr><tr><td></td><td>Optimized</td><td>57.7</td><td>48.3</td><td>53.0</td></tr></table></body></html>",
                                            "type": "table",
                                            "image_path": "375af56c27d38e21831296a2f909c7d8d6db4ef112dbe6ed5cd53b0e444d4679.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 2,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        78,
                                        93,
                                        533,
                                        127.0
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        78,
                                        127.0,
                                        533,
                                        161.0
                                    ],
                                    "spans": [],
                                    "index": 2
                                },
                                {
                                    "bbox": [
                                        78,
                                        161.0,
                                        533,
                                        195.0
                                    ],
                                    "spans": [],
                                    "index": 3
                                }
                            ]
                        }
                    ],
                    "index": 1.0,
                    "page_num": "page_9",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        72,
                        226,
                        245,
                        239
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                227,
                                246,
                                240
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        227,
                                        246,
                                        240
                                    ],
                                    "score": 1.0,
                                    "content": "4.4 Finetuning a Cheap Math Agent",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        }
                    ],
                    "index": 4,
                    "page_num": "page_9",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        253,
                        540,
                        313
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                254,
                                540,
                                267
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        254,
                                        540,
                                        267
                                    ],
                                    "score": 0.9876342415809631,
                                    "content": "We test-drive TapeAgents fine-tuning component with a distillation example. We train a LLAMA3.1-8B-",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                71,
                                266,
                                540,
                                279
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        266,
                                        540,
                                        279
                                    ],
                                    "score": 1.0,
                                    "content": "based math agent using tapes by its teacher counterpart with LLAMA3.1-70B under the hood. We equip",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                70,
                                277,
                                541,
                                292
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        277,
                                        541,
                                        292
                                    ],
                                    "score": 0.9883108139038086,
                                    "content": "each agent with a reasoning node and run the environment with a calculator tool. After finetuning on 3,000",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                70,
                                290,
                                540,
                                303
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        290,
                                        476,
                                        303
                                    ],
                                    "score": 0.9901904463768005,
                                    "content": "samples from 1,000 teacher tapes, the student performance rises significantly from 66.2% to",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        477,
                                        291,
                                        503,
                                        300
                                    ],
                                    "score": 0.59,
                                    "content": "77.5\\%",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 26
                                },
                                {
                                    "bbox": [
                                        504,
                                        290,
                                        540,
                                        303
                                    ],
                                    "score": 1.0,
                                    "content": ", though",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                70,
                                301,
                                348,
                                314
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        301,
                                        201,
                                        314
                                    ],
                                    "score": 1.0,
                                    "content": "the teacher’s performance, at ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        201,
                                        302,
                                        228,
                                        312
                                    ],
                                    "score": 0.65,
                                    "content": "93.1\\%",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 27
                                },
                                {
                                    "bbox": [
                                        228,
                                        301,
                                        348,
                                        314
                                    ],
                                    "score": 1.0,
                                    "content": ", remains much higher still.",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        }
                    ],
                    "index": 7,
                    "page_num": "page_9",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        254,
                        541,
                        314
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        72,
                        339,
                        245,
                        352
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                340,
                                245,
                                353
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        340,
                                        245,
                                        353
                                    ],
                                    "score": 1.0,
                                    "content": "4.5 Prompt-Tuning for Agentic RAG",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        }
                    ],
                    "index": 10,
                    "page_num": "page_9",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        366,
                        541,
                        449
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                366,
                                541,
                                380
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        366,
                                        541,
                                        380
                                    ],
                                    "score": 0.9764429926872253,
                                    "content": " In our last example, we show how the tape, the agent configuration and the metadata linking them, can serve",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                70,
                                380,
                                540,
                                392
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        380,
                                        540,
                                        392
                                    ],
                                    "score": 1.0,
                                    "content": "as a medium to implement data-driven agent optimization algorithms. In this example, we use LLMFunction",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                70,
                                392,
                                541,
                                403
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        392,
                                        541,
                                        403
                                    ],
                                    "score": 1.0,
                                    "content": "prompt templates (see examples in Appendix B) that describe the intended behavior of a transformation that",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                71,
                                404,
                                539,
                                415
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        404,
                                        539,
                                        415
                                    ],
                                    "score": 1.0,
                                    "content": "the LLM should perform, including the instruction, the input/output format, and optionally, a few demon-",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                70,
                                414,
                                540,
                                428
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        414,
                                        540,
                                        428
                                    ],
                                    "score": 1.0,
                                    "content": "strations. We designed LLMFunction to make it possible to implement DSPy-like algorithms in TapeAgents.",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                70,
                                425,
                                541,
                                440
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        425,
                                        541,
                                        440
                                    ],
                                    "score": 1.0,
                                    "content": "Below we describe how we used TapeAgents components to closely reimplement the DSPy introductory",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                71,
                                440,
                                114,
                                451
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        440,
                                        114,
                                        451
                                    ],
                                    "score": 1.0,
                                    "content": "notebook.",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        }
                    ],
                    "index": 14,
                    "page_num": "page_9",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        366,
                        541,
                        451
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        455,
                        540,
                        634
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                456,
                                541,
                                469
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        456,
                                        541,
                                        469
                                    ],
                                    "score": 1.0,
                                    "content": "We compose a Retrieval-Augmented Generation (RAG) agent. Figure 4 illustrates the structure where the",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                70,
                                468,
                                541,
                                481
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        468,
                                        541,
                                        481
                                    ],
                                    "score": 1.0,
                                    "content": "agent performs two rounds of query generation and Wikipedia retrieval and then produces a short factual",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                71,
                                481,
                                541,
                                493
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        481,
                                        541,
                                        493
                                    ],
                                    "score": 0.9789544343948364,
                                    "content": "answer. We build this agent mostly from LlMFunctionNode nodes that describe how the input fields in",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                71,
                                493,
                                540,
                                505
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        493,
                                        540,
                                        505
                                    ],
                                    "score": 0.9832031726837158,
                                    "content": "their respective LLMFunction templates should be filled with the steps from the tape. The only different",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                69,
                                503,
                                542,
                                518
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        503,
                                        542,
                                        518
                                    ],
                                    "score": 1.0,
                                    "content": "kind of a node is a null-prompt node that deduplicates the retrieved paragraphs. We tune the prompts",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                70,
                                515,
                                541,
                                529
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        515,
                                        541,
                                        529
                                    ],
                                    "score": 1.0,
                                    "content": "of the resulting 5-node agent by adding demonstrations to the function prompt templates. We obtain",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                70,
                                529,
                                541,
                                542
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        529,
                                        541,
                                        542
                                    ],
                                    "score": 0.996548593044281,
                                    "content": "demonstrations by running the agent on 50 HotpotQA training examples and filtering the tapes with the",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                70,
                                541,
                                541,
                                554
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        541,
                                        541,
                                        554
                                    ],
                                    "score": 0.9952962398529053,
                                    "content": "wrong answer or duplicate queries. We try 10 different combinations of 4 randomly selected good tapes,",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                71,
                                553,
                                540,
                                564
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        553,
                                        540,
                                        564
                                    ],
                                    "score": 1.0,
                                    "content": "extract demonstrations from them, add them to the agent’s prompt template and measure the validation",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                71,
                                565,
                                541,
                                576
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        565,
                                        541,
                                        576
                                    ],
                                    "score": 1.0,
                                    "content": "set performance, namely the sum of retrieval and answer accuracies. We select the best agent and evaluate",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                70,
                                576,
                                541,
                                588
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        576,
                                        541,
                                        588
                                    ],
                                    "score": 0.983268141746521,
                                    "content": "on a set of 300 examples. Results in Table 3 show that prompt-tuning leads to significant gains in both",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                71,
                                589,
                                540,
                                600
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        589,
                                        540,
                                        600
                                    ],
                                    "score": 1.0,
                                    "content": "retrieval and answer accuracy. The optimized agent is still a TapeAgent that can be resumed from any",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                70,
                                600,
                                541,
                                613
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        600,
                                        541,
                                        613
                                    ],
                                    "score": 1.0,
                                    "content": "intermediate tape, unlike a free-form Python program that uses DSPy. Notably, the implementation of the",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                70,
                                612,
                                540,
                                624
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        612,
                                        540,
                                        624
                                    ],
                                    "score": 1.0,
                                    "content": "actual demonstration selection algorithm took just 12 lines of code (see Appendix B), highlighting how the",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                70,
                                623,
                                391,
                                637
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        623,
                                        391,
                                        637
                                    ],
                                    "score": 1.0,
                                    "content": "TapeAgent structures and metadata facilitate algorithm implementation.",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        }
                    ],
                    "index": 25,
                    "page_num": "page_9",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        456,
                        542,
                        637
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        662,
                        481,
                        677
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                664,
                                483,
                                680
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        664,
                                        483,
                                        680
                                    ],
                                    "score": 0.9860485792160034,
                                    "content": "5 Case Study: Building a Cost-Effective Enterprise Form-Filling Assistant",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        }
                    ],
                    "index": 33,
                    "page_num": "page_9",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        696,
                        541,
                        732
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                697,
                                541,
                                711
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        697,
                                        541,
                                        711
                                    ],
                                    "score": 0.9907333850860596,
                                    "content": "A key use case of TapeAgents is optimizing LLM Agents to offer great quality services at a fraction of the",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                71,
                                709,
                                541,
                                723
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        709,
                                        541,
                                        723
                                    ],
                                    "score": 0.9973127841949463,
                                    "content": "cost. In this section, we present a feshed-out example of how these goals can be achieved for a conversational",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                72,
                                722,
                                360,
                                733
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        722,
                                        360,
                                        733
                                    ],
                                    "score": 0.9918021559715271,
                                    "content": "assistant that can help fill a request form and submit the request.",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        }
                    ],
                    "index": 35,
                    "page_num": "page_9",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        697,
                        541,
                        733
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "title",
                    "bbox": [
                        71,
                        82,
                        172,
                        95
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                81,
                                172,
                                95
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        82,
                                        88,
                                        93
                                    ],
                                    "score": 1.0,
                                    "content": "5.1",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        93,
                                        81,
                                        172,
                                        95
                                    ],
                                    "score": 1.0,
                                    "content": "Problem Setting",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        }
                    ],
                    "index": 0
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        104,
                        541,
                        200
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                105,
                                541,
                                118
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        105,
                                        541,
                                        118
                                    ],
                                    "score": 0.9971920847892761,
                                    "content": "Employees in large enterprises often fill forms to request resources, assistance or access. A conversational",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                70,
                                117,
                                541,
                                130
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        117,
                                        541,
                                        130
                                    ],
                                    "score": 0.990318775177002,
                                    "content": "assistant can make the form-filling experience smoother by guiding its user to the right form, by accepting",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                71,
                                129,
                                542,
                                141
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        129,
                                        542,
                                        141
                                    ],
                                    "score": 1.0,
                                    "content": "the user’s free-form inputs, and by answering the questions that the user may have in the process. For a",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                70,
                                141,
                                541,
                                154
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        141,
                                        541,
                                        154
                                    ],
                                    "score": 1.0,
                                    "content": "great experience, the assistant must also gracefully handle the “unhappy-path” situations, such as when the",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                71,
                                154,
                                540,
                                165
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        154,
                                        540,
                                        165
                                    ],
                                    "score": 0.9909162521362305,
                                    "content": "user's ask is impossible to fulfill or when the assistant cannot answer the user's question. In this case study,",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                70,
                                165,
                                541,
                                178
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        165,
                                        541,
                                        178
                                    ],
                                    "score": 0.9840446710586548,
                                    "content": "we show one can use TapeAgents to train a cost-effective assistant that scores high according to a formal",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                70,
                                176,
                                540,
                                190
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        176,
                                        254,
                                        190
                                    ],
                                    "score": 1.0,
                                    "content": "metric of user experience that we call the ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        254,
                                        178,
                                        306,
                                        186
                                    ],
                                    "score": 0.55,
                                    "content": "G R E A D T H",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 52
                                },
                                {
                                    "bbox": [
                                        306,
                                        176,
                                        540,
                                        190
                                    ],
                                    "score": 1.0,
                                    "content": " score. GREADTH stands for Grounded, REsponsive,",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                71,
                                189,
                                482,
                                202
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        189,
                                        482,
                                        202
                                    ],
                                    "score": 1.0,
                                    "content": "Accurate, Disciplined, Transparent, and Helpful. We will explain these metrics in Section 5.2.",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        }
                    ],
                    "index": 4.5
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        205,
                        323,
                        217
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                207,
                                322,
                                218
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        207,
                                        322,
                                        218
                                    ],
                                    "score": 1.0,
                                    "content": "For simplicity, we consider building a restricted assistant:",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        }
                    ],
                    "index": 9
                },
                {
                    "type": "text",
                    "bbox": [
                        95,
                        232,
                        542,
                        417
                    ],
                    "lines": [
                        {
                            "bbox": [
                                94,
                                234,
                                542,
                                248
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        94,
                                        234,
                                        542,
                                        248
                                    ],
                                    "score": 1.0,
                                    "content": "• The assistant should answer questions solely based on the form documentation; it does not have to",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                106,
                                246,
                                260,
                                258
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        246,
                                        260,
                                        258
                                    ],
                                    "score": 1.0,
                                    "content": "retrieve any additional documents.",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                96,
                                269,
                                338,
                                280
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        96,
                                        269,
                                        338,
                                        280
                                    ],
                                    "score": 1.0,
                                    "content": "• The assistant can only help with one form at a time.",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                95,
                                290,
                                542,
                                303
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        290,
                                        542,
                                        303
                                    ],
                                    "score": 1.0,
                                    "content": "• At the start of the conversation the assistant converses with the user to guide them to the correct",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                106,
                                303,
                                132,
                                315
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        303,
                                        132,
                                        315
                                    ],
                                    "score": 1.0,
                                    "content": "form.",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                94,
                                324,
                                542,
                                338
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        94,
                                        324,
                                        542,
                                        338
                                    ],
                                    "score": 0.9917749762535095,
                                    "content": "· After the form is chosen, the assistant will help the user fll out the form correctly. The agent will",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                105,
                                337,
                                385,
                                349
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        337,
                                        385,
                                        349
                                    ],
                                    "score": 0.9821987748146057,
                                    "content": " not allow the user to switch to a different form after this point.",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                95,
                                359,
                                541,
                                372
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        359,
                                        541,
                                        372
                                    ],
                                    "score": 0.9877789616584778,
                                    "content": "· During the form-filling process, the assistant maintains the field values that the user has provided",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                106,
                                371,
                                135,
                                383
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        371,
                                        135,
                                        383
                                    ],
                                    "score": 1.0,
                                    "content": "so far.",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                95,
                                393,
                                541,
                                406
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        393,
                                        541,
                                        406
                                    ],
                                    "score": 1.0,
                                    "content": "• The interaction ends with either the form submission or the agent exiting the conversation after the",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                107,
                                406,
                                194,
                                418
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        406,
                                        194,
                                        418
                                    ],
                                    "score": 0.9859415888786316,
                                    "content": "user's confirmation.",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        }
                    ],
                    "index": 15
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        432,
                        541,
                        468
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                433,
                                540,
                                446
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        433,
                                        540,
                                        446
                                    ],
                                    "score": 0.9911963939666748,
                                    "content": "The resulting form-filling setup is reminiscent of the Task-Oriented Dialogue setting that has been widely",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                71,
                                445,
                                541,
                                459
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        445,
                                        541,
                                        459
                                    ],
                                    "score": 1.0,
                                    "content": "discussed in the literature (Rastogi et al., 2020; Budzianowski et al., 2018). Following this body of work, we",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                71,
                                457,
                                209,
                                469
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        457,
                                        209,
                                        469
                                    ],
                                    "score": 0.9942922592163086,
                                    "content": "will refer to form fields as slots.",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        }
                    ],
                    "index": 22
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        482,
                        295,
                        495
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                483,
                                294,
                                496
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        483,
                                        294,
                                        496
                                    ],
                                    "score": 1.0,
                                    "content": "5.2 Evaluation Criteria: GREADTH Experience",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        }
                    ],
                    "index": 24
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        504,
                        541,
                        564
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                505,
                                541,
                                519
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        505,
                                        541,
                                        519
                                    ],
                                    "score": 0.9895479679107666,
                                    "content": " Despite the apparent simplicity of the form-filling setup, it can be non-trivial to develop a form-filler assistant",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                71,
                                518,
                                540,
                                529
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        518,
                                        540,
                                        529
                                    ],
                                    "score": 1.0,
                                    "content": "that balances an excellent conversational experience with low hallucination rate and reasonable cost. To",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                70,
                                529,
                                541,
                                542
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        529,
                                        541,
                                        542
                                    ],
                                    "score": 0.993168294429779,
                                    "content": "balance these desiderata, one must first define them in a measurable way. In our case study, we design our",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                70,
                                541,
                                540,
                                554
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        541,
                                        540,
                                        554
                                    ],
                                    "score": 1.0,
                                    "content": "assistant to have maximum GREADTH: Grounded, REsponsive, Accurate, Disciplined, Transparent,",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                71,
                                553,
                                282,
                                566
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        553,
                                        282,
                                        566
                                    ],
                                    "score": 0.9932180047035217,
                                    "content": "and Helpful. We define these aspects as follows:",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        }
                    ],
                    "index": 27
                },
                {
                    "type": "text",
                    "bbox": [
                        91,
                        579,
                        542,
                        732
                    ],
                    "lines": [
                        {
                            "bbox": [
                                95,
                                580,
                                541,
                                594
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        580,
                                        541,
                                        594
                                    ],
                                    "score": 1.0,
                                    "content": "• Everything a Grounded assistant says must be fully supported by the form documentation, the",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                106,
                                593,
                                541,
                                605
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        593,
                                        541,
                                        605
                                    ],
                                    "score": 0.9875746369361877,
                                    "content": "conversation history and the grounding statement. The latter defines the assistant's identity and",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                105,
                                605,
                                498,
                                618
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        605,
                                        498,
                                        618
                                    ],
                                    "score": 0.996829092502594,
                                    "content": " purpose and constrains the assistant to form-filling. Small talk is considered ungrounded.",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                95,
                                626,
                                541,
                                640
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        626,
                                        541,
                                        640
                                    ],
                                    "score": 1.0,
                                    "content": "• A Helpful assistant must actively take the conversation forward by asking for the user’s intent,",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                106,
                                639,
                                541,
                                651
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        639,
                                        541,
                                        651
                                    ],
                                    "score": 0.9883611798286438,
                                    "content": "requesting the next slot to fill, or asking for confirmation before making the request once all slots",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                106,
                                651,
                                542,
                                663
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        651,
                                        542,
                                        663
                                    ],
                                    "score": 0.9843450784683228,
                                    "content": "have been filled. It should also (a) provide all relevant information regarding a slot when asking for it ",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                107,
                                663,
                                541,
                                676
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        663,
                                        541,
                                        676
                                    ],
                                    "score": 1.0,
                                    "content": "(default value, allowed values, optionality), (b) answer any user question if the form documentation",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                106,
                                676,
                                514,
                                687
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        676,
                                        514,
                                        687
                                    ],
                                    "score": 1.0,
                                    "content": "provides the relevant information, (c) exit the conversation at any time if the user desires so.",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                96,
                                698,
                                540,
                                710
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        96,
                                        698,
                                        540,
                                        710
                                    ],
                                    "score": 1.0,
                                    "content": "• An Accurate assistant must correctly identify the user’s intent and import the relevant form docu-",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                106,
                                708,
                                541,
                                722
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        708,
                                        541,
                                        722
                                    ],
                                    "score": 0.9974597692489624,
                                    "content": "mentation, fll the slots correctly based on user messages, update the slots if the user changes their",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                108,
                                722,
                                255,
                                733
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        108,
                                        722,
                                        255,
                                        733
                                    ],
                                    "score": 1.0,
                                    "content": "mind, or skip the slots if relevant.",
                                    "type": "text"
                                }
                            ],
                            "index": 40
                        }
                    ],
                    "index": 35
                }
            ],
            "layout_bboxes": [],
            "page_idx": 10,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        71,
                        27,
                        143,
                        37
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                26,
                                144,
                                38
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        26,
                                        144,
                                        38
                                    ],
                                    "score": 1.0,
                                    "content": "Technical report",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        751,
                        310,
                        760
                    ],
                    "lines": [
                        {
                            "bbox": [
                                299,
                                751,
                                312,
                                762
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        299,
                                        751,
                                        312,
                                        762
                                    ],
                                    "score": 1.0,
                                    "content": "11",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "title",
                    "bbox": [
                        71,
                        82,
                        172,
                        95
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                81,
                                172,
                                95
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        82,
                                        88,
                                        93
                                    ],
                                    "score": 1.0,
                                    "content": "5.1",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        93,
                                        81,
                                        172,
                                        95
                                    ],
                                    "score": 1.0,
                                    "content": "Problem Setting",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        }
                    ],
                    "index": 0,
                    "page_num": "page_10",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        104,
                        541,
                        200
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                105,
                                541,
                                118
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        105,
                                        541,
                                        118
                                    ],
                                    "score": 0.9971920847892761,
                                    "content": "Employees in large enterprises often fill forms to request resources, assistance or access. A conversational",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                70,
                                117,
                                541,
                                130
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        117,
                                        541,
                                        130
                                    ],
                                    "score": 0.990318775177002,
                                    "content": "assistant can make the form-filling experience smoother by guiding its user to the right form, by accepting",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                71,
                                129,
                                542,
                                141
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        129,
                                        542,
                                        141
                                    ],
                                    "score": 1.0,
                                    "content": "the user’s free-form inputs, and by answering the questions that the user may have in the process. For a",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                70,
                                141,
                                541,
                                154
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        141,
                                        541,
                                        154
                                    ],
                                    "score": 1.0,
                                    "content": "great experience, the assistant must also gracefully handle the “unhappy-path” situations, such as when the",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                71,
                                154,
                                540,
                                165
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        154,
                                        540,
                                        165
                                    ],
                                    "score": 0.9909162521362305,
                                    "content": "user's ask is impossible to fulfill or when the assistant cannot answer the user's question. In this case study,",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                70,
                                165,
                                541,
                                178
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        165,
                                        541,
                                        178
                                    ],
                                    "score": 0.9840446710586548,
                                    "content": "we show one can use TapeAgents to train a cost-effective assistant that scores high according to a formal",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                70,
                                176,
                                540,
                                190
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        176,
                                        254,
                                        190
                                    ],
                                    "score": 1.0,
                                    "content": "metric of user experience that we call the ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        254,
                                        178,
                                        306,
                                        186
                                    ],
                                    "score": 0.55,
                                    "content": "G R E A D T H",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 52
                                },
                                {
                                    "bbox": [
                                        306,
                                        176,
                                        540,
                                        190
                                    ],
                                    "score": 1.0,
                                    "content": " score. GREADTH stands for Grounded, REsponsive,",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                71,
                                189,
                                482,
                                202
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        189,
                                        482,
                                        202
                                    ],
                                    "score": 1.0,
                                    "content": "Accurate, Disciplined, Transparent, and Helpful. We will explain these metrics in Section 5.2.",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        }
                    ],
                    "index": 4.5,
                    "page_num": "page_10",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        105,
                        542,
                        202
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        205,
                        323,
                        217
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                207,
                                322,
                                218
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        207,
                                        322,
                                        218
                                    ],
                                    "score": 1.0,
                                    "content": "For simplicity, we consider building a restricted assistant:",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        }
                    ],
                    "index": 9,
                    "page_num": "page_10",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        71,
                        207,
                        322,
                        218
                    ]
                },
                {
                    "type": "list",
                    "bbox": [
                        95,
                        232,
                        542,
                        417
                    ],
                    "lines": [
                        {
                            "bbox": [
                                94,
                                234,
                                542,
                                248
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        94,
                                        234,
                                        542,
                                        248
                                    ],
                                    "score": 1.0,
                                    "content": "• The assistant should answer questions solely based on the form documentation; it does not have to",
                                    "type": "text"
                                }
                            ],
                            "index": 10,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                106,
                                246,
                                260,
                                258
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        246,
                                        260,
                                        258
                                    ],
                                    "score": 1.0,
                                    "content": "retrieve any additional documents.",
                                    "type": "text"
                                }
                            ],
                            "index": 11,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                96,
                                269,
                                338,
                                280
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        96,
                                        269,
                                        338,
                                        280
                                    ],
                                    "score": 1.0,
                                    "content": "• The assistant can only help with one form at a time.",
                                    "type": "text"
                                }
                            ],
                            "index": 12,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                95,
                                290,
                                542,
                                303
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        290,
                                        542,
                                        303
                                    ],
                                    "score": 1.0,
                                    "content": "• At the start of the conversation the assistant converses with the user to guide them to the correct",
                                    "type": "text"
                                }
                            ],
                            "index": 13,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                106,
                                303,
                                132,
                                315
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        303,
                                        132,
                                        315
                                    ],
                                    "score": 1.0,
                                    "content": "form.",
                                    "type": "text"
                                }
                            ],
                            "index": 14,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                94,
                                324,
                                542,
                                338
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        94,
                                        324,
                                        542,
                                        338
                                    ],
                                    "score": 0.9917749762535095,
                                    "content": "· After the form is chosen, the assistant will help the user fll out the form correctly. The agent will",
                                    "type": "text"
                                }
                            ],
                            "index": 15,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                105,
                                337,
                                385,
                                349
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        337,
                                        385,
                                        349
                                    ],
                                    "score": 0.9821987748146057,
                                    "content": " not allow the user to switch to a different form after this point.",
                                    "type": "text"
                                }
                            ],
                            "index": 16,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                95,
                                359,
                                541,
                                372
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        359,
                                        541,
                                        372
                                    ],
                                    "score": 0.9877789616584778,
                                    "content": "· During the form-filling process, the assistant maintains the field values that the user has provided",
                                    "type": "text"
                                }
                            ],
                            "index": 17,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                106,
                                371,
                                135,
                                383
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        371,
                                        135,
                                        383
                                    ],
                                    "score": 1.0,
                                    "content": "so far.",
                                    "type": "text"
                                }
                            ],
                            "index": 18,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                95,
                                393,
                                541,
                                406
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        393,
                                        541,
                                        406
                                    ],
                                    "score": 1.0,
                                    "content": "• The interaction ends with either the form submission or the agent exiting the conversation after the",
                                    "type": "text"
                                }
                            ],
                            "index": 19,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                107,
                                406,
                                194,
                                418
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        406,
                                        194,
                                        418
                                    ],
                                    "score": 0.9859415888786316,
                                    "content": "user's confirmation.",
                                    "type": "text"
                                }
                            ],
                            "index": 20,
                            "is_list_end_line": true
                        }
                    ],
                    "index": 15,
                    "page_num": "page_10",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        94,
                        234,
                        542,
                        418
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        432,
                        541,
                        468
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                433,
                                540,
                                446
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        433,
                                        540,
                                        446
                                    ],
                                    "score": 0.9911963939666748,
                                    "content": "The resulting form-filling setup is reminiscent of the Task-Oriented Dialogue setting that has been widely",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                71,
                                445,
                                541,
                                459
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        445,
                                        541,
                                        459
                                    ],
                                    "score": 1.0,
                                    "content": "discussed in the literature (Rastogi et al., 2020; Budzianowski et al., 2018). Following this body of work, we",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                71,
                                457,
                                209,
                                469
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        457,
                                        209,
                                        469
                                    ],
                                    "score": 0.9942922592163086,
                                    "content": "will refer to form fields as slots.",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        }
                    ],
                    "index": 22,
                    "page_num": "page_10",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        71,
                        433,
                        541,
                        469
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        482,
                        295,
                        495
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                483,
                                294,
                                496
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        483,
                                        294,
                                        496
                                    ],
                                    "score": 1.0,
                                    "content": "5.2 Evaluation Criteria: GREADTH Experience",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        }
                    ],
                    "index": 24,
                    "page_num": "page_10",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        504,
                        541,
                        564
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                505,
                                541,
                                519
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        505,
                                        541,
                                        519
                                    ],
                                    "score": 0.9895479679107666,
                                    "content": " Despite the apparent simplicity of the form-filling setup, it can be non-trivial to develop a form-filler assistant",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                71,
                                518,
                                540,
                                529
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        518,
                                        540,
                                        529
                                    ],
                                    "score": 1.0,
                                    "content": "that balances an excellent conversational experience with low hallucination rate and reasonable cost. To",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                70,
                                529,
                                541,
                                542
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        529,
                                        541,
                                        542
                                    ],
                                    "score": 0.993168294429779,
                                    "content": "balance these desiderata, one must first define them in a measurable way. In our case study, we design our",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                70,
                                541,
                                540,
                                554
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        541,
                                        540,
                                        554
                                    ],
                                    "score": 1.0,
                                    "content": "assistant to have maximum GREADTH: Grounded, REsponsive, Accurate, Disciplined, Transparent,",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                71,
                                553,
                                282,
                                566
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        553,
                                        282,
                                        566
                                    ],
                                    "score": 0.9932180047035217,
                                    "content": "and Helpful. We define these aspects as follows:",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        }
                    ],
                    "index": 27,
                    "page_num": "page_10",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        505,
                        541,
                        566
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        91,
                        579,
                        542,
                        732
                    ],
                    "lines": [
                        {
                            "bbox": [
                                95,
                                580,
                                541,
                                594
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        580,
                                        541,
                                        594
                                    ],
                                    "score": 1.0,
                                    "content": "• Everything a Grounded assistant says must be fully supported by the form documentation, the",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                106,
                                593,
                                541,
                                605
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        593,
                                        541,
                                        605
                                    ],
                                    "score": 0.9875746369361877,
                                    "content": "conversation history and the grounding statement. The latter defines the assistant's identity and",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                105,
                                605,
                                498,
                                618
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        605,
                                        498,
                                        618
                                    ],
                                    "score": 0.996829092502594,
                                    "content": " purpose and constrains the assistant to form-filling. Small talk is considered ungrounded.",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                95,
                                626,
                                541,
                                640
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        626,
                                        541,
                                        640
                                    ],
                                    "score": 1.0,
                                    "content": "• A Helpful assistant must actively take the conversation forward by asking for the user’s intent,",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                106,
                                639,
                                541,
                                651
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        639,
                                        541,
                                        651
                                    ],
                                    "score": 0.9883611798286438,
                                    "content": "requesting the next slot to fill, or asking for confirmation before making the request once all slots",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                106,
                                651,
                                542,
                                663
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        651,
                                        542,
                                        663
                                    ],
                                    "score": 0.9843450784683228,
                                    "content": "have been filled. It should also (a) provide all relevant information regarding a slot when asking for it ",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                107,
                                663,
                                541,
                                676
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        663,
                                        541,
                                        676
                                    ],
                                    "score": 1.0,
                                    "content": "(default value, allowed values, optionality), (b) answer any user question if the form documentation",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                106,
                                676,
                                514,
                                687
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        676,
                                        514,
                                        687
                                    ],
                                    "score": 1.0,
                                    "content": "provides the relevant information, (c) exit the conversation at any time if the user desires so.",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                96,
                                698,
                                540,
                                710
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        96,
                                        698,
                                        540,
                                        710
                                    ],
                                    "score": 1.0,
                                    "content": "• An Accurate assistant must correctly identify the user’s intent and import the relevant form docu-",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                106,
                                708,
                                541,
                                722
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        708,
                                        541,
                                        722
                                    ],
                                    "score": 0.9974597692489624,
                                    "content": "mentation, fll the slots correctly based on user messages, update the slots if the user changes their",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                108,
                                722,
                                255,
                                733
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        108,
                                        722,
                                        255,
                                        733
                                    ],
                                    "score": 1.0,
                                    "content": "mind, or skip the slots if relevant.",
                                    "type": "text"
                                }
                            ],
                            "index": 40
                        }
                    ],
                    "index": 35,
                    "page_num": "page_10",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        95,
                        580,
                        542,
                        733
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        97,
                        82,
                        541,
                        142
                    ],
                    "lines": [
                        {
                            "bbox": [
                                95,
                                83,
                                541,
                                96
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        83,
                                        541,
                                        96
                                    ],
                                    "score": 0.9853880405426025,
                                    "content": "· A Transparent assistant acknowledges all changes made to the partially filled form. This includes",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                107,
                                94,
                                541,
                                108
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        94,
                                        541,
                                        108
                                    ],
                                    "score": 0.9862092137336731,
                                    "content": "slot-filling or skipping slots that are optional or have a default value. The summary of slots changes",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                107,
                                107,
                                541,
                                119
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        107,
                                        541,
                                        119
                                    ],
                                    "score": 0.9913851022720337,
                                    "content": "can be concise, yet the user must be able to understand how the slots were affected. While in a",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                107,
                                119,
                                541,
                                132
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        119,
                                        541,
                                        132
                                    ],
                                    "score": 1.0,
                                    "content": "mixed modality interaction the user may visually see the form changes, in a purely voice interaction",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                106,
                                131,
                                405,
                                144
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        131,
                                        405,
                                        144
                                    ],
                                    "score": 1.0,
                                    "content": "such as talking over the phone the transparent behavior is essential.",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        }
                    ],
                    "index": 2
                },
                {
                    "type": "text",
                    "bbox": [
                        96,
                        152,
                        541,
                        187
                    ],
                    "lines": [
                        {
                            "bbox": [
                                96,
                                153,
                                540,
                                167
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        96,
                                        153,
                                        540,
                                        167
                                    ],
                                    "score": 0.9810242056846619,
                                    "content": "· A Disciplined assistant must follow its planning thoughts, such as requesting a slot, asking for confir-",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                106,
                                165,
                                541,
                                178
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        165,
                                        541,
                                        178
                                    ],
                                    "score": 0.9941822290420532,
                                    "content": "mation, answering a question, rejecting incorrect slot values (as defined by the form documentation),",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                106,
                                176,
                                225,
                                190
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        176,
                                        225,
                                        190
                                    ],
                                    "score": 1.0,
                                    "content": "or rejecting an invalid ask.",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        }
                    ],
                    "index": 6
                },
                {
                    "type": "text",
                    "bbox": [
                        96,
                        198,
                        541,
                        245
                    ],
                    "lines": [
                        {
                            "bbox": [
                                95,
                                199,
                                541,
                                212
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        199,
                                        541,
                                        212
                                    ],
                                    "score": 1.0,
                                    "content": "• We require the assistant to be REsponsive to address a common experience issue with AI assistants:",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                106,
                                210,
                                541,
                                224
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        210,
                                        541,
                                        224
                                    ],
                                    "score": 0.990431010723114,
                                    "content": "the robotic and opaque behavior when the user goes off the expected conversational path. We wish",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                106,
                                222,
                                541,
                                236
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        222,
                                        541,
                                        236
                                    ],
                                    "score": 1.0,
                                    "content": "that AI assistant infers and acknowledges what the user had in mind, while explaining that their",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                106,
                                235,
                                504,
                                248
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        235,
                                        504,
                                        248
                                    ],
                                    "score": 1.0,
                                    "content": "request or question is not possible. In particular, we want to cover the following scenarios:",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        }
                    ],
                    "index": 9.5
                },
                {
                    "type": "text",
                    "bbox": [
                        114,
                        253,
                        542,
                        380
                    ],
                    "lines": [
                        {
                            "bbox": [
                                115,
                                254,
                                540,
                                267
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        115,
                                        254,
                                        540,
                                        267
                                    ],
                                    "score": 0.9811933040618896,
                                    "content": "- if the user tries to fill a slot with an invalid value, the assistant should acknowledge the value",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                127,
                                267,
                                258,
                                279
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        127,
                                        267,
                                        258,
                                        279
                                    ],
                                    "score": 1.0,
                                    "content": "and respond that it is invalid;",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                115,
                                280,
                                541,
                                293
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        115,
                                        280,
                                        541,
                                        293
                                    ],
                                    "score": 0.9898064136505127,
                                    "content": "- if the user offers information that looks like a value for a nonexistent but plausible slot, the",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                126,
                                292,
                                541,
                                306
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        126,
                                        292,
                                        541,
                                        306
                                    ],
                                    "score": 1.0,
                                    "content": "assistant should acknowledge the value and the inferred name of the slot and respond that such",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                126,
                                304,
                                275,
                                317
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        126,
                                        304,
                                        275,
                                        317
                                    ],
                                    "score": 1.0,
                                    "content": "slots is not available in this form;",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                115,
                                319,
                                541,
                                332
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        115,
                                        319,
                                        541,
                                        332
                                    ],
                                    "score": 0.9771039485931396,
                                    "content": "- if at the form-flling stage the user's ask looks like a request for another form, the agent should",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                126,
                                331,
                                541,
                                344
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        126,
                                        331,
                                        541,
                                        344
                                    ],
                                    "score": 0.9904865026473999,
                                    "content": "acknowledge their ask and say that it can not fulfll it right now (note that in our setup the",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                126,
                                344,
                                367,
                                356
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        126,
                                        344,
                                        367,
                                        356
                                    ],
                                    "score": 0.9889202117919922,
                                    "content": "user must either finish filling the current form or exit);",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                115,
                                357,
                                541,
                                370
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        115,
                                        357,
                                        541,
                                        370
                                    ],
                                    "score": 1.0,
                                    "content": "– if the user asks a plausible question that the form documentation does not answer, the agent",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                127,
                                370,
                                434,
                                381
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        127,
                                        370,
                                        434,
                                        381
                                    ],
                                    "score": 1.0,
                                    "content": "should acknowledge the question and say that it can not be answered.",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        }
                    ],
                    "index": 16.5
                },
                {
                    "type": "text",
                    "bbox": [
                        106,
                        388,
                        541,
                        459
                    ],
                    "lines": [
                        {
                            "bbox": [
                                106,
                                388,
                                540,
                                401
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        388,
                                        540,
                                        401
                                    ],
                                    "score": 0.9919794797897339,
                                    "content": "The user may ask other requests that have nothing to do with form-filling (i.e. weather requests).",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                106,
                                401,
                                541,
                                413
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        401,
                                        541,
                                        413
                                    ],
                                    "score": 1.0,
                                    "content": "In that case, the agent must politely decline the request and keep moving the conversation towards",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                107,
                                413,
                                541,
                                425
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        413,
                                        541,
                                        425
                                    ],
                                    "score": 0.9929166436195374,
                                    "content": "either submitting or aborting the request. To align our definition of responsiveness with the common",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                106,
                                425,
                                540,
                                437
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        425,
                                        540,
                                        437
                                    ],
                                    "score": 1.0,
                                    "content": "sense meaning of this word, we also require a REsponsive assistant to acknowledge all valid slot",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                107,
                                437,
                                540,
                                449
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        437,
                                        540,
                                        449
                                    ],
                                    "score": 1.0,
                                    "content": "values and valid questions. Thus we often deem a response that is not Transparent, or not Helpful",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                106,
                                448,
                                201,
                                461
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        448,
                                        201,
                                        461
                                    ],
                                    "score": 1.0,
                                    "content": "also not REsponsive.",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        }
                    ],
                    "index": 24.5
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        474,
                        540,
                        534
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                476,
                                540,
                                487
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        476,
                                        540,
                                        487
                                    ],
                                    "score": 1.0,
                                    "content": "The GREADTH criteria above are binary, a conscious choice that we made to simplify the evaluation and the",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                70,
                                487,
                                541,
                                500
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        487,
                                        541,
                                        500
                                    ],
                                    "score": 1.0,
                                    "content": "analysis. We acknowledge that this makes them somewhat crude, as e.g. two assistant answers can be both",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                71,
                                500,
                                541,
                                512
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        500,
                                        541,
                                        512
                                    ],
                                    "score": 0.9856508374214172,
                                    "content": "technically correct but can widely differ in readability and in the choice of the information to present. One",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                70,
                                511,
                                540,
                                525
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        511,
                                        540,
                                        525
                                    ],
                                    "score": 0.9899897575378418,
                                    "content": "can complement these criteria with a preference-based experience evaluation that implicitly covers fuency,",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                70,
                                523,
                                313,
                                536
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        523,
                                        313,
                                        536
                                    ],
                                    "score": 1.0,
                                    "content": "verbosity, and other aspects of the assistant’s response.",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        }
                    ],
                    "index": 30
                },
                {
                    "type": "title",
                    "bbox": [
                        72,
                        549,
                        262,
                        561
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                549,
                                261,
                                563
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        549,
                                        261,
                                        563
                                    ],
                                    "score": 1.0,
                                    "content": "5.3 Design of a Form Filling TapeAgent",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        }
                    ],
                    "index": 33
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        570,
                        541,
                        655
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                571,
                                541,
                                585
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        571,
                                        541,
                                        585
                                    ],
                                    "score": 1.0,
                                    "content": "Tape Structure To build an agent that provides a GREADTH experience, we decompose the conver-",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                70,
                                583,
                                542,
                                597
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        583,
                                        542,
                                        597
                                    ],
                                    "score": 0.9877321124076843,
                                    "content": "sational form-filling task into smaller reasoning steps before each agent message. Having the GREADTH",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                71,
                                596,
                                541,
                                608
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        596,
                                        541,
                                        608
                                    ],
                                    "score": 0.9855294227600098,
                                    "content": "metrics in mind, we define the agent's thoughts to help it plan its response. The thoughts are used to",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                70,
                                608,
                                541,
                                621
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        608,
                                        541,
                                        621
                                    ],
                                    "score": 1.0,
                                    "content": "represent a chain-of-thought of the agent, which includes (a) analyzing the user’s intent (e.g. the form that",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                70,
                                619,
                                540,
                                632
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        619,
                                        540,
                                        632
                                    ],
                                    "score": 1.0,
                                    "content": "is requested, the provided slot values, a question being asked); (b) updating the internal state of the conver-",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                71,
                                632,
                                541,
                                644
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        632,
                                        541,
                                        644
                                    ],
                                    "score": 0.9960423111915588,
                                    "content": "sation (e.g. slot-filling); and (c) planning the next actions (e.g. requesting a specific slot value or requesting",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                70,
                                644,
                                502,
                                657
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        644,
                                        502,
                                        657
                                    ],
                                    "score": 0.9892570972442627,
                                    "content": "a user confirmation). In particular, after each user message or observation, the agent must return:",
                                    "type": "text"
                                }
                            ],
                            "index": 40
                        }
                    ],
                    "index": 37
                },
                {
                    "type": "text",
                    "bbox": [
                        91,
                        669,
                        538,
                        694
                    ],
                    "lines": [
                        {
                            "bbox": [
                                93,
                                670,
                                541,
                                683
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        93,
                                        670,
                                        230,
                                        683
                                    ],
                                    "score": 1.0,
                                    "content": "1. A list of thoughts:",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        255,
                                        670,
                                        541,
                                        683
                                    ],
                                    "score": 0.8812819123268127,
                                    "content": "these include  slot-filling related　thoughts   such as",
                                    "type": "text"
                                }
                            ],
                            "index": 41
                        },
                        {
                            "bbox": [
                                105,
                                681,
                                541,
                                696
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        681,
                                        255,
                                        696
                                    ],
                                    "score": 1.0,
                                    "content": "UpdateFunctionParametersThought",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        255,
                                        683,
                                        260,
                                        691
                                    ],
                                    "score": 0.26,
                                    "content": "^6",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 5
                                },
                                {
                                    "bbox": [
                                        261,
                                        681,
                                        541,
                                        696
                                    ],
                                    "score": 1.0,
                                    "content": "; and message planning thoughts specifying the next",
                                    "type": "text"
                                }
                            ],
                            "index": 42
                        }
                    ],
                    "index": 41.5
                }
            ],
            "layout_bboxes": [],
            "page_idx": 11,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        70,
                        703,
                        541,
                        731
                    ],
                    "lines": [
                        {
                            "bbox": [
                                80,
                                701,
                                542,
                                717
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        701,
                                        542,
                                        717
                                    ],
                                    "score": 0.9674603343009949,
                                    "content": "6While working on the form-flling case-study we interchangeably used the terms form / request / function and the terms",
                                    "type": "text"
                                }
                            ]
                        },
                        {
                            "bbox": [
                                70,
                                712,
                                541,
                                725
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        712,
                                        541,
                                        725
                                    ],
                                    "score": 0.985264241695404,
                                    "content": "slot / field / parameter. In this report we use the original technical names for the tape's steps to maximize the coherence",
                                    "type": "text"
                                }
                            ]
                        },
                        {
                            "bbox": [
                                70,
                                722,
                                188,
                                733
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        722,
                                        188,
                                        733
                                    ],
                                    "score": 1.0,
                                    "content": "between the text and the code.",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        72,
                        27,
                        143,
                        37
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                25,
                                144,
                                38
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        25,
                                        144,
                                        38
                                    ],
                                    "score": 1.0,
                                    "content": "Technical report",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        751,
                        311,
                        760
                    ],
                    "lines": [
                        {
                            "bbox": [
                                299,
                                751,
                                312,
                                762
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        299,
                                        751,
                                        312,
                                        762
                                    ],
                                    "score": 1.0,
                                    "content": "12",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        97,
                        82,
                        541,
                        142
                    ],
                    "lines": [
                        {
                            "bbox": [
                                95,
                                83,
                                541,
                                96
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        83,
                                        541,
                                        96
                                    ],
                                    "score": 0.9853880405426025,
                                    "content": "· A Transparent assistant acknowledges all changes made to the partially filled form. This includes",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                107,
                                94,
                                541,
                                108
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        94,
                                        541,
                                        108
                                    ],
                                    "score": 0.9862092137336731,
                                    "content": "slot-filling or skipping slots that are optional or have a default value. The summary of slots changes",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                107,
                                107,
                                541,
                                119
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        107,
                                        541,
                                        119
                                    ],
                                    "score": 0.9913851022720337,
                                    "content": "can be concise, yet the user must be able to understand how the slots were affected. While in a",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                107,
                                119,
                                541,
                                132
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        119,
                                        541,
                                        132
                                    ],
                                    "score": 1.0,
                                    "content": "mixed modality interaction the user may visually see the form changes, in a purely voice interaction",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                106,
                                131,
                                405,
                                144
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        131,
                                        405,
                                        144
                                    ],
                                    "score": 1.0,
                                    "content": "such as talking over the phone the transparent behavior is essential.",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        }
                    ],
                    "index": 2,
                    "page_num": "page_11",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        95,
                        83,
                        541,
                        144
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        96,
                        152,
                        541,
                        187
                    ],
                    "lines": [
                        {
                            "bbox": [
                                96,
                                153,
                                540,
                                167
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        96,
                                        153,
                                        540,
                                        167
                                    ],
                                    "score": 0.9810242056846619,
                                    "content": "· A Disciplined assistant must follow its planning thoughts, such as requesting a slot, asking for confir-",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                106,
                                165,
                                541,
                                178
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        165,
                                        541,
                                        178
                                    ],
                                    "score": 0.9941822290420532,
                                    "content": "mation, answering a question, rejecting incorrect slot values (as defined by the form documentation),",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                106,
                                176,
                                225,
                                190
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        176,
                                        225,
                                        190
                                    ],
                                    "score": 1.0,
                                    "content": "or rejecting an invalid ask.",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        }
                    ],
                    "index": 6,
                    "page_num": "page_11",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        96,
                        153,
                        541,
                        190
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        96,
                        198,
                        541,
                        245
                    ],
                    "lines": [
                        {
                            "bbox": [
                                95,
                                199,
                                541,
                                212
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        199,
                                        541,
                                        212
                                    ],
                                    "score": 1.0,
                                    "content": "• We require the assistant to be REsponsive to address a common experience issue with AI assistants:",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                106,
                                210,
                                541,
                                224
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        210,
                                        541,
                                        224
                                    ],
                                    "score": 0.990431010723114,
                                    "content": "the robotic and opaque behavior when the user goes off the expected conversational path. We wish",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                106,
                                222,
                                541,
                                236
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        222,
                                        541,
                                        236
                                    ],
                                    "score": 1.0,
                                    "content": "that AI assistant infers and acknowledges what the user had in mind, while explaining that their",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                106,
                                235,
                                504,
                                248
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        235,
                                        504,
                                        248
                                    ],
                                    "score": 1.0,
                                    "content": "request or question is not possible. In particular, we want to cover the following scenarios:",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        }
                    ],
                    "index": 9.5,
                    "page_num": "page_11",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        95,
                        199,
                        541,
                        248
                    ]
                },
                {
                    "type": "list",
                    "bbox": [
                        114,
                        253,
                        542,
                        380
                    ],
                    "lines": [
                        {
                            "bbox": [
                                115,
                                254,
                                540,
                                267
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        115,
                                        254,
                                        540,
                                        267
                                    ],
                                    "score": 0.9811933040618896,
                                    "content": "- if the user tries to fill a slot with an invalid value, the assistant should acknowledge the value",
                                    "type": "text"
                                }
                            ],
                            "index": 12,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                127,
                                267,
                                258,
                                279
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        127,
                                        267,
                                        258,
                                        279
                                    ],
                                    "score": 1.0,
                                    "content": "and respond that it is invalid;",
                                    "type": "text"
                                }
                            ],
                            "index": 13,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                115,
                                280,
                                541,
                                293
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        115,
                                        280,
                                        541,
                                        293
                                    ],
                                    "score": 0.9898064136505127,
                                    "content": "- if the user offers information that looks like a value for a nonexistent but plausible slot, the",
                                    "type": "text"
                                }
                            ],
                            "index": 14,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                126,
                                292,
                                541,
                                306
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        126,
                                        292,
                                        541,
                                        306
                                    ],
                                    "score": 1.0,
                                    "content": "assistant should acknowledge the value and the inferred name of the slot and respond that such",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                126,
                                304,
                                275,
                                317
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        126,
                                        304,
                                        275,
                                        317
                                    ],
                                    "score": 1.0,
                                    "content": "slots is not available in this form;",
                                    "type": "text"
                                }
                            ],
                            "index": 16,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                115,
                                319,
                                541,
                                332
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        115,
                                        319,
                                        541,
                                        332
                                    ],
                                    "score": 0.9771039485931396,
                                    "content": "- if at the form-flling stage the user's ask looks like a request for another form, the agent should",
                                    "type": "text"
                                }
                            ],
                            "index": 17,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                126,
                                331,
                                541,
                                344
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        126,
                                        331,
                                        541,
                                        344
                                    ],
                                    "score": 0.9904865026473999,
                                    "content": "acknowledge their ask and say that it can not fulfll it right now (note that in our setup the",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                126,
                                344,
                                367,
                                356
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        126,
                                        344,
                                        367,
                                        356
                                    ],
                                    "score": 0.9889202117919922,
                                    "content": "user must either finish filling the current form or exit);",
                                    "type": "text"
                                }
                            ],
                            "index": 19,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                115,
                                357,
                                541,
                                370
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        115,
                                        357,
                                        541,
                                        370
                                    ],
                                    "score": 1.0,
                                    "content": "– if the user asks a plausible question that the form documentation does not answer, the agent",
                                    "type": "text"
                                }
                            ],
                            "index": 20,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                127,
                                370,
                                434,
                                381
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        127,
                                        370,
                                        434,
                                        381
                                    ],
                                    "score": 1.0,
                                    "content": "should acknowledge the question and say that it can not be answered.",
                                    "type": "text"
                                }
                            ],
                            "index": 21,
                            "is_list_end_line": true
                        }
                    ],
                    "index": 16.5,
                    "page_num": "page_11",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        115,
                        254,
                        541,
                        381
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        106,
                        388,
                        541,
                        459
                    ],
                    "lines": [
                        {
                            "bbox": [
                                106,
                                388,
                                540,
                                401
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        388,
                                        540,
                                        401
                                    ],
                                    "score": 0.9919794797897339,
                                    "content": "The user may ask other requests that have nothing to do with form-filling (i.e. weather requests).",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                106,
                                401,
                                541,
                                413
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        401,
                                        541,
                                        413
                                    ],
                                    "score": 1.0,
                                    "content": "In that case, the agent must politely decline the request and keep moving the conversation towards",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                107,
                                413,
                                541,
                                425
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        413,
                                        541,
                                        425
                                    ],
                                    "score": 0.9929166436195374,
                                    "content": "either submitting or aborting the request. To align our definition of responsiveness with the common",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                106,
                                425,
                                540,
                                437
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        425,
                                        540,
                                        437
                                    ],
                                    "score": 1.0,
                                    "content": "sense meaning of this word, we also require a REsponsive assistant to acknowledge all valid slot",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                107,
                                437,
                                540,
                                449
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        437,
                                        540,
                                        449
                                    ],
                                    "score": 1.0,
                                    "content": "values and valid questions. Thus we often deem a response that is not Transparent, or not Helpful",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                106,
                                448,
                                201,
                                461
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        448,
                                        201,
                                        461
                                    ],
                                    "score": 1.0,
                                    "content": "also not REsponsive.",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        }
                    ],
                    "index": 24.5,
                    "page_num": "page_11",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        106,
                        388,
                        541,
                        461
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        474,
                        540,
                        534
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                476,
                                540,
                                487
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        476,
                                        540,
                                        487
                                    ],
                                    "score": 1.0,
                                    "content": "The GREADTH criteria above are binary, a conscious choice that we made to simplify the evaluation and the",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                70,
                                487,
                                541,
                                500
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        487,
                                        541,
                                        500
                                    ],
                                    "score": 1.0,
                                    "content": "analysis. We acknowledge that this makes them somewhat crude, as e.g. two assistant answers can be both",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                71,
                                500,
                                541,
                                512
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        500,
                                        541,
                                        512
                                    ],
                                    "score": 0.9856508374214172,
                                    "content": "technically correct but can widely differ in readability and in the choice of the information to present. One",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                70,
                                511,
                                540,
                                525
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        511,
                                        540,
                                        525
                                    ],
                                    "score": 0.9899897575378418,
                                    "content": "can complement these criteria with a preference-based experience evaluation that implicitly covers fuency,",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                70,
                                523,
                                313,
                                536
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        523,
                                        313,
                                        536
                                    ],
                                    "score": 1.0,
                                    "content": "verbosity, and other aspects of the assistant’s response.",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        }
                    ],
                    "index": 30,
                    "page_num": "page_11",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        476,
                        541,
                        536
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        72,
                        549,
                        262,
                        561
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                549,
                                261,
                                563
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        549,
                                        261,
                                        563
                                    ],
                                    "score": 1.0,
                                    "content": "5.3 Design of a Form Filling TapeAgent",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        }
                    ],
                    "index": 33,
                    "page_num": "page_11",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        570,
                        541,
                        655
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                571,
                                541,
                                585
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        571,
                                        541,
                                        585
                                    ],
                                    "score": 1.0,
                                    "content": "Tape Structure To build an agent that provides a GREADTH experience, we decompose the conver-",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                70,
                                583,
                                542,
                                597
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        583,
                                        542,
                                        597
                                    ],
                                    "score": 0.9877321124076843,
                                    "content": "sational form-filling task into smaller reasoning steps before each agent message. Having the GREADTH",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                71,
                                596,
                                541,
                                608
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        596,
                                        541,
                                        608
                                    ],
                                    "score": 0.9855294227600098,
                                    "content": "metrics in mind, we define the agent's thoughts to help it plan its response. The thoughts are used to",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                70,
                                608,
                                541,
                                621
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        608,
                                        541,
                                        621
                                    ],
                                    "score": 1.0,
                                    "content": "represent a chain-of-thought of the agent, which includes (a) analyzing the user’s intent (e.g. the form that",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                70,
                                619,
                                540,
                                632
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        619,
                                        540,
                                        632
                                    ],
                                    "score": 1.0,
                                    "content": "is requested, the provided slot values, a question being asked); (b) updating the internal state of the conver-",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                71,
                                632,
                                541,
                                644
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        632,
                                        541,
                                        644
                                    ],
                                    "score": 0.9960423111915588,
                                    "content": "sation (e.g. slot-filling); and (c) planning the next actions (e.g. requesting a specific slot value or requesting",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                70,
                                644,
                                502,
                                657
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        644,
                                        502,
                                        657
                                    ],
                                    "score": 0.9892570972442627,
                                    "content": "a user confirmation). In particular, after each user message or observation, the agent must return:",
                                    "type": "text"
                                }
                            ],
                            "index": 40
                        }
                    ],
                    "index": 37,
                    "page_num": "page_11",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        571,
                        542,
                        657
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        91,
                        669,
                        538,
                        694
                    ],
                    "lines": [
                        {
                            "bbox": [
                                93,
                                670,
                                541,
                                683
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        93,
                                        670,
                                        230,
                                        683
                                    ],
                                    "score": 1.0,
                                    "content": "1. A list of thoughts:",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        255,
                                        670,
                                        541,
                                        683
                                    ],
                                    "score": 0.8812819123268127,
                                    "content": "these include  slot-filling related　thoughts   such as",
                                    "type": "text"
                                }
                            ],
                            "index": 41
                        },
                        {
                            "bbox": [
                                105,
                                681,
                                541,
                                696
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        681,
                                        255,
                                        696
                                    ],
                                    "score": 1.0,
                                    "content": "UpdateFunctionParametersThought",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        255,
                                        683,
                                        260,
                                        691
                                    ],
                                    "score": 0.26,
                                    "content": "^6",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 5
                                },
                                {
                                    "bbox": [
                                        261,
                                        681,
                                        541,
                                        696
                                    ],
                                    "score": 1.0,
                                    "content": "; and message planning thoughts specifying the next",
                                    "type": "text"
                                }
                            ],
                            "index": 42
                        },
                        {
                            "bbox": [
                                107,
                                509,
                                540,
                                520
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        509,
                                        540,
                                        520
                                    ],
                                    "score": 0.9726431965827942,
                                    "content": "slot to request  (RequestFunctionParametersThought), the need to ask for confirmation be-",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                105,
                                519,
                                541,
                                533
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        519,
                                        541,
                                        533
                                    ],
                                    "score": 1.0,
                                    "content": "fore submitting the request (RequestFunctionCallConfirmationThought), planning to an-",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                106,
                                532,
                                542,
                                545
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        532,
                                        542,
                                        545
                                    ],
                                    "score": 1.0,
                                    "content": "swer a question (AnswerFromFunctionSchemaThought), planning to inform the user that their",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                106,
                                544,
                                541,
                                556
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        544,
                                        541,
                                        556
                                    ],
                                    "score": 1.0,
                                    "content": "question cannot be answered (NoAnswerInFunctionSchemaThought), refusing unsupported re-",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                107,
                                556,
                                541,
                                568
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        556,
                                        541,
                                        568
                                    ],
                                    "score": 1.0,
                                    "content": "quest/behavior/slot values (RefuseInexistentFunctionThought / RefuseToEngageThought /",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                106,
                                568,
                                541,
                                580
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        568,
                                        541,
                                        580
                                    ],
                                    "score": 1.0,
                                    "content": "RefuseInvalidFunctionParameterValueThought), etc. The full list of thoughts is described in",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                107,
                                580,
                                172,
                                592
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        580,
                                        172,
                                        592
                                    ],
                                    "score": 1.0,
                                    "content": "Appendix E.2.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 13
                        }
                    ],
                    "index": 41.5,
                    "page_num": "page_11",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        93,
                        670,
                        541,
                        696
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "image",
                    "bbox": [
                        72,
                        80,
                        538,
                        429
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                72,
                                80,
                                538,
                                429
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        72,
                                        80,
                                        538,
                                        429
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                72,
                                                80,
                                                538,
                                                429
                                            ],
                                            "score": 0.974,
                                            "type": "image",
                                            "image_path": "496e22280509493b8ece58ab5d0b022ad10ce6b8c07f4e2b0e4078ae71d7a530.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        72,
                                        80,
                                        538,
                                        196.33333333333331
                                    ],
                                    "spans": [],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        72,
                                        196.33333333333331,
                                        538,
                                        312.66666666666663
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        72,
                                        312.66666666666663,
                                        538,
                                        428.99999999999994
                                    ],
                                    "spans": [],
                                    "index": 2
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                71,
                                434,
                                541,
                                478
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        70,
                                        435,
                                        541,
                                        448
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                435,
                                                541,
                                                448
                                            ],
                                            "score": 0.9972940683364868,
                                            "content": "Figure 5: Node structure of the Teacher and the Student agents. The Teacher agent combines intent classification",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        71,
                                        447,
                                        540,
                                        458
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                447,
                                                540,
                                                458
                                            ],
                                            "score": 0.9860089421272278,
                                            "content": "nodes and 5 extra nodes, while the Student agent combines intent classification nodes plus 1 additional node. We",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                },
                                {
                                    "bbox": [
                                        71,
                                        458,
                                        540,
                                        469
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                458,
                                                540,
                                                469
                                            ],
                                            "score": 0.9985380172729492,
                                            "content": "represent nodes in blue and produced steps in yellow. Please note that words intent/form/function and slot/feld/-",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 5
                                },
                                {
                                    "bbox": [
                                        71,
                                        469,
                                        274,
                                        480
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                469,
                                                274,
                                                480
                                            ],
                                            "score": 1.0,
                                            "content": "parameter are used interchangeably in this report.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 6
                                }
                            ],
                            "index": 4.5
                        }
                    ],
                    "index": 2.75
                },
                {
                    "type": "text",
                    "bbox": [
                        106,
                        507,
                        541,
                        591
                    ],
                    "lines": [
                        {
                            "bbox": [
                                107,
                                509,
                                540,
                                520
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        509,
                                        540,
                                        520
                                    ],
                                    "score": 0.9726431965827942,
                                    "content": "slot to request  (RequestFunctionParametersThought), the need to ask for confirmation be-",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                105,
                                519,
                                541,
                                533
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        519,
                                        541,
                                        533
                                    ],
                                    "score": 1.0,
                                    "content": "fore submitting the request (RequestFunctionCallConfirmationThought), planning to an-",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                106,
                                532,
                                542,
                                545
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        532,
                                        542,
                                        545
                                    ],
                                    "score": 1.0,
                                    "content": "swer a question (AnswerFromFunctionSchemaThought), planning to inform the user that their",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                106,
                                544,
                                541,
                                556
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        544,
                                        541,
                                        556
                                    ],
                                    "score": 1.0,
                                    "content": "question cannot be answered (NoAnswerInFunctionSchemaThought), refusing unsupported re-",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                107,
                                556,
                                541,
                                568
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        556,
                                        541,
                                        568
                                    ],
                                    "score": 1.0,
                                    "content": "quest/behavior/slot values (RefuseInexistentFunctionThought / RefuseToEngageThought /",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                106,
                                568,
                                541,
                                580
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        568,
                                        541,
                                        580
                                    ],
                                    "score": 1.0,
                                    "content": "RefuseInvalidFunctionParameterValueThought), etc. The full list of thoughts is described in",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                107,
                                580,
                                172,
                                592
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        580,
                                        172,
                                        592
                                    ],
                                    "score": 1.0,
                                    "content": "Appendix E.2.",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        }
                    ],
                    "index": 10
                },
                {
                    "type": "text",
                    "bbox": [
                        94,
                        613,
                        541,
                        673
                    ],
                    "lines": [
                        {
                            "bbox": [
                                92,
                                614,
                                542,
                                628
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        92,
                                        614,
                                        542,
                                        628
                                    ],
                                    "score": 1.0,
                                    "content": "2. A single action: the agent returns a single action, such as searching available forms",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                107,
                                626,
                                541,
                                639
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        626,
                                        541,
                                        639
                                    ],
                                    "score": 1.0,
                                    "content": "(ResolveFunctionAction), retrieving form documentation (InspectFunctionAction), replying to the",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                106,
                                637,
                                540,
                                650
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        637,
                                        540,
                                        650
                                    ],
                                    "score": 1.0,
                                    "content": "user (PromptUserForTextMessageAction), submitting the request (CallFunctionAction), or exiting",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                106,
                                650,
                                541,
                                662
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        650,
                                        541,
                                        662
                                    ],
                                    "score": 1.0,
                                    "content": "the conversation (ExitAction). Each action results in new observations (available forms, retrieved",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                106,
                                661,
                                388,
                                676
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        661,
                                        388,
                                        676
                                    ],
                                    "score": 1.0,
                                    "content": "documentation, or user input), and ends the current agent turn.",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        }
                    ],
                    "index": 16
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        708,
                        540,
                        732
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                709,
                                541,
                                722
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        709,
                                        541,
                                        722
                                    ],
                                    "score": 1.0,
                                    "content": "Multi-node Teacher Agent We experimented with various combinations of prompting techniques and",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                71,
                                721,
                                539,
                                733
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        721,
                                        539,
                                        733
                                    ],
                                    "score": 1.0,
                                    "content": "LLMs to obtain the best performance (see GREADTH metrics in Sections 5.2 and human evaluation pro-",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        }
                    ],
                    "index": 19.5
                }
            ],
            "layout_bboxes": [],
            "page_idx": 12,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [
                {
                    "type": "image",
                    "bbox": [
                        72,
                        80,
                        538,
                        429
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                72,
                                80,
                                538,
                                429
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        72,
                                        80,
                                        538,
                                        429
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                72,
                                                80,
                                                538,
                                                429
                                            ],
                                            "score": 0.974,
                                            "type": "image",
                                            "image_path": "496e22280509493b8ece58ab5d0b022ad10ce6b8c07f4e2b0e4078ae71d7a530.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        72,
                                        80,
                                        538,
                                        196.33333333333331
                                    ],
                                    "spans": [],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        72,
                                        196.33333333333331,
                                        538,
                                        312.66666666666663
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        72,
                                        312.66666666666663,
                                        538,
                                        428.99999999999994
                                    ],
                                    "spans": [],
                                    "index": 2
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                71,
                                434,
                                541,
                                478
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        70,
                                        435,
                                        541,
                                        448
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                435,
                                                541,
                                                448
                                            ],
                                            "score": 0.9972940683364868,
                                            "content": "Figure 5: Node structure of the Teacher and the Student agents. The Teacher agent combines intent classification",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        71,
                                        447,
                                        540,
                                        458
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                447,
                                                540,
                                                458
                                            ],
                                            "score": 0.9860089421272278,
                                            "content": "nodes and 5 extra nodes, while the Student agent combines intent classification nodes plus 1 additional node. We",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                },
                                {
                                    "bbox": [
                                        71,
                                        458,
                                        540,
                                        469
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                458,
                                                540,
                                                469
                                            ],
                                            "score": 0.9985380172729492,
                                            "content": "represent nodes in blue and produced steps in yellow. Please note that words intent/form/function and slot/feld/-",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 5
                                },
                                {
                                    "bbox": [
                                        71,
                                        469,
                                        274,
                                        480
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                469,
                                                274,
                                                480
                                            ],
                                            "score": 1.0,
                                            "content": "parameter are used interchangeably in this report.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 6
                                }
                            ],
                            "index": 4.5
                        }
                    ],
                    "index": 2.75
                }
            ],
            "tables": [],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        72,
                        27,
                        143,
                        37
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                25,
                                144,
                                38
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        25,
                                        144,
                                        38
                                    ],
                                    "score": 1.0,
                                    "content": "Technical report",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        751,
                        311,
                        760
                    ],
                    "lines": [
                        {
                            "bbox": [
                                299,
                                751,
                                312,
                                762
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        299,
                                        751,
                                        312,
                                        762
                                    ],
                                    "score": 1.0,
                                    "content": "13",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "image",
                    "bbox": [
                        72,
                        80,
                        538,
                        429
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                72,
                                80,
                                538,
                                429
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        72,
                                        80,
                                        538,
                                        429
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                72,
                                                80,
                                                538,
                                                429
                                            ],
                                            "score": 0.974,
                                            "type": "image",
                                            "image_path": "496e22280509493b8ece58ab5d0b022ad10ce6b8c07f4e2b0e4078ae71d7a530.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        72,
                                        80,
                                        538,
                                        196.33333333333331
                                    ],
                                    "spans": [],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        72,
                                        196.33333333333331,
                                        538,
                                        312.66666666666663
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        72,
                                        312.66666666666663,
                                        538,
                                        428.99999999999994
                                    ],
                                    "spans": [],
                                    "index": 2
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                71,
                                434,
                                541,
                                478
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        70,
                                        435,
                                        541,
                                        448
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                435,
                                                541,
                                                448
                                            ],
                                            "score": 0.9972940683364868,
                                            "content": "Figure 5: Node structure of the Teacher and the Student agents. The Teacher agent combines intent classification",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        71,
                                        447,
                                        540,
                                        458
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                447,
                                                540,
                                                458
                                            ],
                                            "score": 0.9860089421272278,
                                            "content": "nodes and 5 extra nodes, while the Student agent combines intent classification nodes plus 1 additional node. We",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                },
                                {
                                    "bbox": [
                                        71,
                                        458,
                                        540,
                                        469
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                458,
                                                540,
                                                469
                                            ],
                                            "score": 0.9985380172729492,
                                            "content": "represent nodes in blue and produced steps in yellow. Please note that words intent/form/function and slot/feld/-",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 5
                                },
                                {
                                    "bbox": [
                                        71,
                                        469,
                                        274,
                                        480
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                469,
                                                274,
                                                480
                                            ],
                                            "score": 1.0,
                                            "content": "parameter are used interchangeably in this report.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 6
                                }
                            ],
                            "index": 4.5
                        }
                    ],
                    "index": 2.75,
                    "page_num": "page_12",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        106,
                        507,
                        541,
                        591
                    ],
                    "lines": [],
                    "index": 10,
                    "page_num": "page_12",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        105,
                        509,
                        542,
                        592
                    ],
                    "lines_deleted": true
                },
                {
                    "type": "text",
                    "bbox": [
                        94,
                        613,
                        541,
                        673
                    ],
                    "lines": [
                        {
                            "bbox": [
                                92,
                                614,
                                542,
                                628
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        92,
                                        614,
                                        542,
                                        628
                                    ],
                                    "score": 1.0,
                                    "content": "2. A single action: the agent returns a single action, such as searching available forms",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                107,
                                626,
                                541,
                                639
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        626,
                                        541,
                                        639
                                    ],
                                    "score": 1.0,
                                    "content": "(ResolveFunctionAction), retrieving form documentation (InspectFunctionAction), replying to the",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                106,
                                637,
                                540,
                                650
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        637,
                                        540,
                                        650
                                    ],
                                    "score": 1.0,
                                    "content": "user (PromptUserForTextMessageAction), submitting the request (CallFunctionAction), or exiting",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                106,
                                650,
                                541,
                                662
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        650,
                                        541,
                                        662
                                    ],
                                    "score": 1.0,
                                    "content": "the conversation (ExitAction). Each action results in new observations (available forms, retrieved",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                106,
                                661,
                                388,
                                676
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        661,
                                        388,
                                        676
                                    ],
                                    "score": 1.0,
                                    "content": "documentation, or user input), and ends the current agent turn.",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        }
                    ],
                    "index": 16,
                    "page_num": "page_12",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        92,
                        614,
                        542,
                        676
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        708,
                        540,
                        732
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                709,
                                541,
                                722
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        709,
                                        541,
                                        722
                                    ],
                                    "score": 1.0,
                                    "content": "Multi-node Teacher Agent We experimented with various combinations of prompting techniques and",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                71,
                                721,
                                539,
                                733
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        721,
                                        539,
                                        733
                                    ],
                                    "score": 1.0,
                                    "content": "LLMs to obtain the best performance (see GREADTH metrics in Sections 5.2 and human evaluation pro-",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                70,
                                83,
                                540,
                                97
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        83,
                                        540,
                                        97
                                    ],
                                    "score": 1.0,
                                    "content": "cedure in Section 5.4). We found that using Llama-405B with multi-step prompting7 (multiple TapeAgent",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                70,
                                95,
                                540,
                                108
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        95,
                                        540,
                                        108
                                    ],
                                    "score": 1.0,
                                    "content": "nodes) yielded the most promising results based on human evaluation. For additional details about the",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                72,
                                108,
                                540,
                                119
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        108,
                                        540,
                                        119
                                    ],
                                    "score": 1.0,
                                    "content": "choice of model and agent structure, see Appendix E.4. Our Teacher agent is made of 7 nodes: 2 for intent",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                70,
                                118,
                                268,
                                132
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        118,
                                        268,
                                        132
                                    ],
                                    "score": 0.9942644238471985,
                                    "content": "classification and 5 for slot flling (Figure 5):",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 3
                        }
                    ],
                    "index": 19.5,
                    "page_num": "page_12",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        709,
                        541,
                        733
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        71,
                        82,
                        540,
                        130
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                83,
                                540,
                                97
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        83,
                                        540,
                                        97
                                    ],
                                    "score": 1.0,
                                    "content": "cedure in Section 5.4). We found that using Llama-405B with multi-step prompting7 (multiple TapeAgent",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                70,
                                95,
                                540,
                                108
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        95,
                                        540,
                                        108
                                    ],
                                    "score": 1.0,
                                    "content": "nodes) yielded the most promising results based on human evaluation. For additional details about the",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                72,
                                108,
                                540,
                                119
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        108,
                                        540,
                                        119
                                    ],
                                    "score": 1.0,
                                    "content": "choice of model and agent structure, see Appendix E.4. Our Teacher agent is made of 7 nodes: 2 for intent",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                70,
                                118,
                                268,
                                132
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        118,
                                        268,
                                        132
                                    ],
                                    "score": 0.9942644238471985,
                                    "content": "classification and 5 for slot flling (Figure 5):",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        }
                    ],
                    "index": 1.5
                },
                {
                    "type": "text",
                    "bbox": [
                        93,
                        139,
                        543,
                        545
                    ],
                    "lines": [
                        {
                            "bbox": [
                                96,
                                147,
                                541,
                                158
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        96,
                                        147,
                                        541,
                                        158
                                    ],
                                    "score": 0.9903271794319153,
                                    "content": "· Is Form Selected? The initial node checks if we identified the user's intent. This node does not",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                106,
                                157,
                                541,
                                172
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        157,
                                        541,
                                        172
                                    ],
                                    "score": 1.0,
                                    "content": "call any LLM, it simply checks if an InspectFunctionAction step is already present in the current",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                107,
                                171,
                                541,
                                182
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        171,
                                        541,
                                        182
                                    ],
                                    "score": 1.0,
                                    "content": "Tape. If a form has not yet been selected, the model proceeds to the next step (Step (B) in Figure 5).",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                105,
                                181,
                                495,
                                196
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        181,
                                        495,
                                        196
                                    ],
                                    "score": 0.9780997633934021,
                                    "content": " Otherwise, the model moves directly to the form-filling phase (Step 1 (left) in Figure 5).",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                96,
                                204,
                                541,
                                217
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        96,
                                        204,
                                        541,
                                        217
                                    ],
                                    "score": 1.0,
                                    "content": "• Intent Discovery. This node (a) lists the available forms (ResolveFunctionAction queries the",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                106,
                                216,
                                541,
                                229
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        216,
                                        541,
                                        229
                                    ],
                                    "score": 0.9918398261070251,
                                    "content": "Environment to return a list of available forms); and (b) finds the relevant one based on the previous",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                106,
                                228,
                                540,
                                241
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        228,
                                        540,
                                        241
                                    ],
                                    "score": 1.0,
                                    "content": "user’s message (InspectFunctionAction queries the Environment to return the form documentation).",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                105,
                                239,
                                542,
                                254
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        239,
                                        542,
                                        254
                                    ],
                                    "score": 1.0,
                                    "content": "If the LLM cannot identify the relevant form, it is prompted to ask again the user for its intent",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                107,
                                253,
                                535,
                                266
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        253,
                                        535,
                                        266
                                    ],
                                    "score": 1.0,
                                    "content": "(RefuseInexistentFunctionThought; RequestFunctionThought; PromptUserForTextMessageAction).",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                95,
                                274,
                                541,
                                287
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        274,
                                        541,
                                        287
                                    ],
                                    "score": 1.0,
                                    "content": "• Gather Raw Parameter Values. Once the user’s intent is discovered and its form documentation",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                106,
                                287,
                                541,
                                299
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        287,
                                        541,
                                        299
                                    ],
                                    "score": 1.0,
                                    "content": "imported, the LLM is prompted to extract all raw slot values present in the user’s message and yield",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                105,
                                298,
                                232,
                                313
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        298,
                                        232,
                                        313
                                    ],
                                    "score": 1.0,
                                    "content": "a GatherValuesThought step.",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                96,
                                321,
                                541,
                                334
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        96,
                                        321,
                                        541,
                                        334
                                    ],
                                    "score": 1.0,
                                    "content": "• Verify Parameter Values & Types. In this node, the LLM is prompted to verify all extracted",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                105,
                                331,
                                542,
                                348
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        331,
                                        542,
                                        348
                                    ],
                                    "score": 0.9880946278572083,
                                    "content": "slot values based on the form documentation imported. The LLM verifies that each value is of the",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                106,
                                344,
                                505,
                                359
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        344,
                                        505,
                                        359
                                    ],
                                    "score": 1.0,
                                    "content": "correct type and is valid (in the case of categorical slots) with a VerifyValuesThought step.",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                97,
                                369,
                                540,
                                380
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        97,
                                        369,
                                        540,
                                        380
                                    ],
                                    "score": 0.9829540252685547,
                                    "content": "· Update Slots and Plan Response. Once we have identified the correct/incorrect slot values, the",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                106,
                                380,
                                540,
                                392
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        380,
                                        540,
                                        392
                                    ],
                                    "score": 0.9951191544532776,
                                    "content": "LLM is prompted to update the filled slots with a UpdateFunctionParametersThought step, refuse in-",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                106,
                                391,
                                541,
                                405
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        391,
                                        541,
                                        405
                                    ],
                                    "score": 1.0,
                                    "content": "valid slots with RefuseInvalidFunctionParameterValueThought steps, and start planning its response",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                105,
                                403,
                                388,
                                416
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        403,
                                        388,
                                        416
                                    ],
                                    "score": 1.0,
                                    "content": "to the user with AnswerFromFunctionSchemaThought if applicable.",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                95,
                                425,
                                541,
                                439
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        425,
                                        541,
                                        439
                                    ],
                                    "score": 0.9966059327125549,
                                    "content": "· Plan Next Slot or Confirmation Requests. This node prompts the LLM to move the conversa-",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                106,
                                438,
                                541,
                                451
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        438,
                                        541,
                                        451
                                    ],
                                    "score": 0.9935125112533569,
                                    "content": "tion forward by either (i) requesting the next slot (RequestFunctionParametersThought), (ii) confirm-",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                107,
                                451,
                                541,
                                462
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        451,
                                        541,
                                        462
                                    ],
                                    "score": 1.0,
                                    "content": "ing that the user wants to submit the current request (RequestFunctionCallConfirmationThought),",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                106,
                                462,
                                502,
                                475
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        462,
                                        502,
                                        475
                                    ],
                                    "score": 0.988438606262207,
                                    "content": "or (i) confirming that the user wants to exit the chat (RequestExitconfirmationThought).",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                96,
                                484,
                                541,
                                497
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        96,
                                        484,
                                        541,
                                        497
                                    ],
                                    "score": 0.9921939969062805,
                                    "content": "· Generate. Eventually, the final node of our Teacher TapeAgent prompts the LLM to generate the",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                106,
                                496,
                                540,
                                509
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        496,
                                        540,
                                        509
                                    ],
                                    "score": 1.0,
                                    "content": "next action. Based on the previous steps/thoughts in the Tape, the agent can either (i) write a mes-",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                105,
                                508,
                                541,
                                522
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        508,
                                        541,
                                        522
                                    ],
                                    "score": 1.0,
                                    "content": "sage (PromptUserForTextMessageAction), (ii) submit the request (CallFunctionAction), or (iii) exit",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                106,
                                520,
                                241,
                                533
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        520,
                                        241,
                                        533
                                    ],
                                    "score": 1.0,
                                    "content": "the conversation (ExitAction).",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        }
                    ],
                    "index": 17
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        546,
                        325,
                        558
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                547,
                                325,
                                560
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        547,
                                        325,
                                        560
                                    ],
                                    "score": 1.0,
                                    "content": "See Figure 11 of Appendix E.5 for a sample Teacher tape.",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        }
                    ],
                    "index": 31
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        572,
                        541,
                        644
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                572,
                                540,
                                587
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        572,
                                        540,
                                        587
                                    ],
                                    "score": 1.0,
                                    "content": "Single-node Student Agent We design the Student agent with the goal of minimizing input and output",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                71,
                                585,
                                540,
                                597
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        585,
                                        540,
                                        597
                                    ],
                                    "score": 0.9865122437477112,
                                    "content": "token counts in order to optimize cost. We describe the slot-filling task in one condensed LLM prompt (1",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                70,
                                596,
                                541,
                                610
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        596,
                                        541,
                                        610
                                    ],
                                    "score": 1.0,
                                    "content": "TapeAgent node) and use Llama-8B as the LLM to the Student agent to further optimize cost and inference",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                70,
                                608,
                                541,
                                622
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        608,
                                        541,
                                        622
                                    ],
                                    "score": 1.0,
                                    "content": "time. While we could get rid of the instructions entirely in the LLM prompt, we still provide enough",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                70,
                                619,
                                541,
                                635
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        619,
                                        541,
                                        635
                                    ],
                                    "score": 1.0,
                                    "content": "instructions so that a strong model (e.g. Llama-405B) can still make sense of the task in a zero-shot setting.",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                71,
                                633,
                                493,
                                645
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        633,
                                        493,
                                        645
                                    ],
                                    "score": 0.9858704209327698,
                                    "content": "Our Student agent is made of 3 nodes: 2 for intent classification and 1 for slot filling (Figure 5):",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        }
                    ],
                    "index": 34.5
                },
                {
                    "type": "text",
                    "bbox": [
                        92,
                        658,
                        540,
                        693
                    ],
                    "lines": [
                        {
                            "bbox": [
                                95,
                                659,
                                540,
                                673
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        659,
                                        540,
                                        673
                                    ],
                                    "score": 1.0,
                                    "content": "• Is Form Selected? Same structure as the Teacher but with fewer and more compact instructions.",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                96,
                                681,
                                538,
                                695
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        96,
                                        681,
                                        538,
                                        695
                                    ],
                                    "score": 1.0,
                                    "content": "• Intent Discovery. Same structure as the Teacher but with fewer and more compact instructions.",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        }
                    ],
                    "index": 38.5
                }
            ],
            "layout_bboxes": [],
            "page_idx": 13,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        73,
                        703,
                        541,
                        732
                    ],
                    "lines": [
                        {
                            "bbox": [
                                80,
                                701,
                                541,
                                717
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        701,
                                        541,
                                        717
                                    ],
                                    "score": 1.0,
                                    "content": "7Also known as prompt chaining or step-wise prompting. More information can be found in prompt engineering guidelines,",
                                    "type": "text"
                                }
                            ]
                        },
                        {
                            "bbox": [
                                72,
                                714,
                                540,
                                724
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        714,
                                        540,
                                        724
                                    ],
                                    "score": 1.0,
                                    "content": "e.g. https://docs.anthropic.com/en/docs/build-with-claude/prompt-engineering/chain-prompts and https://platform.openai.com/",
                                    "type": "text"
                                }
                            ]
                        },
                        {
                            "bbox": [
                                70,
                                722,
                                499,
                                734
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        722,
                                        499,
                                        734
                                    ],
                                    "score": 1.0,
                                    "content": "docs/guides/prompt-engineering/tactic-specify-the-steps-required-to-complete-a-task (Accessed on Oct 15, 2024)",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        72,
                        27,
                        143,
                        37
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                26,
                                144,
                                38
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        26,
                                        144,
                                        38
                                    ],
                                    "score": 1.0,
                                    "content": "Technical report",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        752,
                        311,
                        760
                    ],
                    "lines": [
                        {
                            "bbox": [
                                299,
                                751,
                                312,
                                762
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        299,
                                        751,
                                        312,
                                        762
                                    ],
                                    "score": 1.0,
                                    "content": "14",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        71,
                        82,
                        540,
                        130
                    ],
                    "lines": [],
                    "index": 1.5,
                    "page_num": "page_13",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        83,
                        540,
                        132
                    ],
                    "lines_deleted": true
                },
                {
                    "type": "list",
                    "bbox": [
                        93,
                        139,
                        543,
                        545
                    ],
                    "lines": [
                        {
                            "bbox": [
                                96,
                                147,
                                541,
                                158
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        96,
                                        147,
                                        541,
                                        158
                                    ],
                                    "score": 0.9903271794319153,
                                    "content": "· Is Form Selected? The initial node checks if we identified the user's intent. This node does not",
                                    "type": "text"
                                }
                            ],
                            "index": 4,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                106,
                                157,
                                541,
                                172
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        157,
                                        541,
                                        172
                                    ],
                                    "score": 1.0,
                                    "content": "call any LLM, it simply checks if an InspectFunctionAction step is already present in the current",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                107,
                                171,
                                541,
                                182
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        171,
                                        541,
                                        182
                                    ],
                                    "score": 1.0,
                                    "content": "Tape. If a form has not yet been selected, the model proceeds to the next step (Step (B) in Figure 5).",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                105,
                                181,
                                495,
                                196
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        181,
                                        495,
                                        196
                                    ],
                                    "score": 0.9780997633934021,
                                    "content": " Otherwise, the model moves directly to the form-filling phase (Step 1 (left) in Figure 5).",
                                    "type": "text"
                                }
                            ],
                            "index": 7,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                96,
                                204,
                                541,
                                217
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        96,
                                        204,
                                        541,
                                        217
                                    ],
                                    "score": 1.0,
                                    "content": "• Intent Discovery. This node (a) lists the available forms (ResolveFunctionAction queries the",
                                    "type": "text"
                                }
                            ],
                            "index": 8,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                106,
                                216,
                                541,
                                229
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        216,
                                        541,
                                        229
                                    ],
                                    "score": 0.9918398261070251,
                                    "content": "Environment to return a list of available forms); and (b) finds the relevant one based on the previous",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                106,
                                228,
                                540,
                                241
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        228,
                                        540,
                                        241
                                    ],
                                    "score": 1.0,
                                    "content": "user’s message (InspectFunctionAction queries the Environment to return the form documentation).",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                105,
                                239,
                                542,
                                254
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        239,
                                        542,
                                        254
                                    ],
                                    "score": 1.0,
                                    "content": "If the LLM cannot identify the relevant form, it is prompted to ask again the user for its intent",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                107,
                                253,
                                535,
                                266
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        253,
                                        535,
                                        266
                                    ],
                                    "score": 1.0,
                                    "content": "(RefuseInexistentFunctionThought; RequestFunctionThought; PromptUserForTextMessageAction).",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                95,
                                274,
                                541,
                                287
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        274,
                                        541,
                                        287
                                    ],
                                    "score": 1.0,
                                    "content": "• Gather Raw Parameter Values. Once the user’s intent is discovered and its form documentation",
                                    "type": "text"
                                }
                            ],
                            "index": 13,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                106,
                                287,
                                541,
                                299
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        287,
                                        541,
                                        299
                                    ],
                                    "score": 1.0,
                                    "content": "imported, the LLM is prompted to extract all raw slot values present in the user’s message and yield",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                105,
                                298,
                                232,
                                313
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        298,
                                        232,
                                        313
                                    ],
                                    "score": 1.0,
                                    "content": "a GatherValuesThought step.",
                                    "type": "text"
                                }
                            ],
                            "index": 15,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                96,
                                321,
                                541,
                                334
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        96,
                                        321,
                                        541,
                                        334
                                    ],
                                    "score": 1.0,
                                    "content": "• Verify Parameter Values & Types. In this node, the LLM is prompted to verify all extracted",
                                    "type": "text"
                                }
                            ],
                            "index": 16,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                105,
                                331,
                                542,
                                348
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        331,
                                        542,
                                        348
                                    ],
                                    "score": 0.9880946278572083,
                                    "content": "slot values based on the form documentation imported. The LLM verifies that each value is of the",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                106,
                                344,
                                505,
                                359
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        344,
                                        505,
                                        359
                                    ],
                                    "score": 1.0,
                                    "content": "correct type and is valid (in the case of categorical slots) with a VerifyValuesThought step.",
                                    "type": "text"
                                }
                            ],
                            "index": 18,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                97,
                                369,
                                540,
                                380
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        97,
                                        369,
                                        540,
                                        380
                                    ],
                                    "score": 0.9829540252685547,
                                    "content": "· Update Slots and Plan Response. Once we have identified the correct/incorrect slot values, the",
                                    "type": "text"
                                }
                            ],
                            "index": 19,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                106,
                                380,
                                540,
                                392
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        380,
                                        540,
                                        392
                                    ],
                                    "score": 0.9951191544532776,
                                    "content": "LLM is prompted to update the filled slots with a UpdateFunctionParametersThought step, refuse in-",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                106,
                                391,
                                541,
                                405
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        391,
                                        541,
                                        405
                                    ],
                                    "score": 1.0,
                                    "content": "valid slots with RefuseInvalidFunctionParameterValueThought steps, and start planning its response",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                105,
                                403,
                                388,
                                416
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        403,
                                        388,
                                        416
                                    ],
                                    "score": 1.0,
                                    "content": "to the user with AnswerFromFunctionSchemaThought if applicable.",
                                    "type": "text"
                                }
                            ],
                            "index": 22,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                95,
                                425,
                                541,
                                439
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        425,
                                        541,
                                        439
                                    ],
                                    "score": 0.9966059327125549,
                                    "content": "· Plan Next Slot or Confirmation Requests. This node prompts the LLM to move the conversa-",
                                    "type": "text"
                                }
                            ],
                            "index": 23,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                106,
                                438,
                                541,
                                451
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        438,
                                        541,
                                        451
                                    ],
                                    "score": 0.9935125112533569,
                                    "content": "tion forward by either (i) requesting the next slot (RequestFunctionParametersThought), (ii) confirm-",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                107,
                                451,
                                541,
                                462
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        451,
                                        541,
                                        462
                                    ],
                                    "score": 1.0,
                                    "content": "ing that the user wants to submit the current request (RequestFunctionCallConfirmationThought),",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                106,
                                462,
                                502,
                                475
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        462,
                                        502,
                                        475
                                    ],
                                    "score": 0.988438606262207,
                                    "content": "or (i) confirming that the user wants to exit the chat (RequestExitconfirmationThought).",
                                    "type": "text"
                                }
                            ],
                            "index": 26,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                96,
                                484,
                                541,
                                497
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        96,
                                        484,
                                        541,
                                        497
                                    ],
                                    "score": 0.9921939969062805,
                                    "content": "· Generate. Eventually, the final node of our Teacher TapeAgent prompts the LLM to generate the",
                                    "type": "text"
                                }
                            ],
                            "index": 27,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                106,
                                496,
                                540,
                                509
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        496,
                                        540,
                                        509
                                    ],
                                    "score": 1.0,
                                    "content": "next action. Based on the previous steps/thoughts in the Tape, the agent can either (i) write a mes-",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                105,
                                508,
                                541,
                                522
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        508,
                                        541,
                                        522
                                    ],
                                    "score": 1.0,
                                    "content": "sage (PromptUserForTextMessageAction), (ii) submit the request (CallFunctionAction), or (iii) exit",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                106,
                                520,
                                241,
                                533
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        520,
                                        241,
                                        533
                                    ],
                                    "score": 1.0,
                                    "content": "the conversation (ExitAction).",
                                    "type": "text"
                                }
                            ],
                            "index": 30,
                            "is_list_end_line": true
                        }
                    ],
                    "index": 17,
                    "page_num": "page_13",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        95,
                        147,
                        542,
                        533
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        546,
                        325,
                        558
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                547,
                                325,
                                560
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        547,
                                        325,
                                        560
                                    ],
                                    "score": 1.0,
                                    "content": "See Figure 11 of Appendix E.5 for a sample Teacher tape.",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        }
                    ],
                    "index": 31,
                    "page_num": "page_13",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        71,
                        547,
                        325,
                        560
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        572,
                        541,
                        644
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                572,
                                540,
                                587
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        572,
                                        540,
                                        587
                                    ],
                                    "score": 1.0,
                                    "content": "Single-node Student Agent We design the Student agent with the goal of minimizing input and output",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                71,
                                585,
                                540,
                                597
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        585,
                                        540,
                                        597
                                    ],
                                    "score": 0.9865122437477112,
                                    "content": "token counts in order to optimize cost. We describe the slot-filling task in one condensed LLM prompt (1",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                70,
                                596,
                                541,
                                610
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        596,
                                        541,
                                        610
                                    ],
                                    "score": 1.0,
                                    "content": "TapeAgent node) and use Llama-8B as the LLM to the Student agent to further optimize cost and inference",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                70,
                                608,
                                541,
                                622
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        608,
                                        541,
                                        622
                                    ],
                                    "score": 1.0,
                                    "content": "time. While we could get rid of the instructions entirely in the LLM prompt, we still provide enough",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                70,
                                619,
                                541,
                                635
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        619,
                                        541,
                                        635
                                    ],
                                    "score": 1.0,
                                    "content": "instructions so that a strong model (e.g. Llama-405B) can still make sense of the task in a zero-shot setting.",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                71,
                                633,
                                493,
                                645
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        633,
                                        493,
                                        645
                                    ],
                                    "score": 0.9858704209327698,
                                    "content": "Our Student agent is made of 3 nodes: 2 for intent classification and 1 for slot filling (Figure 5):",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        }
                    ],
                    "index": 34.5,
                    "page_num": "page_13",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        572,
                        541,
                        645
                    ]
                },
                {
                    "type": "list",
                    "bbox": [
                        92,
                        658,
                        540,
                        693
                    ],
                    "lines": [
                        {
                            "bbox": [
                                95,
                                659,
                                540,
                                673
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        659,
                                        540,
                                        673
                                    ],
                                    "score": 1.0,
                                    "content": "• Is Form Selected? Same structure as the Teacher but with fewer and more compact instructions.",
                                    "type": "text"
                                }
                            ],
                            "index": 38,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                96,
                                681,
                                538,
                                695
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        96,
                                        681,
                                        538,
                                        695
                                    ],
                                    "score": 1.0,
                                    "content": "• Intent Discovery. Same structure as the Teacher but with fewer and more compact instructions.",
                                    "type": "text"
                                }
                            ],
                            "index": 39,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        }
                    ],
                    "index": 38.5,
                    "page_num": "page_13",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        95,
                        659,
                        540,
                        695
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        96,
                        82,
                        540,
                        130
                    ],
                    "lines": [
                        {
                            "bbox": [
                                96,
                                83,
                                541,
                                97
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        96,
                                        83,
                                        541,
                                        97
                                    ],
                                    "score": 1.0,
                                    "content": "• Update Slots, Generate Plan, and Respond. Using a single short prompt, we ask",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                106,
                                95,
                                540,
                                108
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        95,
                                        540,
                                        108
                                    ],
                                    "score": 1.0,
                                    "content": "the agent to generate all its thoughts (e.g. RefuseInvalidFunctionParameterValueThought;",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                106,
                                107,
                                541,
                                119
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        107,
                                        541,
                                        119
                                    ],
                                    "score": 1.0,
                                    "content": "UpdateFunctionParametersThought; RequestFunctionParametersThought) and end with an action",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                106,
                                119,
                                282,
                                132
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        119,
                                        282,
                                        132
                                    ],
                                    "score": 1.0,
                                    "content": "(e.g. PromptUserForTextMessageAction).",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        }
                    ],
                    "index": 1.5
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        142,
                        384,
                        154
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                142,
                                385,
                                156
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        142,
                                        385,
                                        156
                                    ],
                                    "score": 1.0,
                                    "content": "We show an example of the Student tape in Figure 12 of Appendix E.5.",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        }
                    ],
                    "index": 4
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        167,
                        153,
                        179
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                168,
                                154,
                                180
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        168,
                                        88,
                                        179
                                    ],
                                    "score": 1.0,
                                    "content": "5.4",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        95,
                                        168,
                                        154,
                                        180
                                    ],
                                    "score": 1.0,
                                    "content": "Experiments",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        }
                    ],
                    "index": 5
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        189,
                        541,
                        249
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                189,
                                539,
                                203
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        189,
                                        539,
                                        203
                                    ],
                                    "score": 0.985506534576416,
                                    "content": "We consider the task of training a cost-effective conversational agent to help the user fill and submit a form.",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                70,
                                201,
                                541,
                                215
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        201,
                                        541,
                                        215
                                    ],
                                    "score": 1.0,
                                    "content": "We seek the conversational experience to score high in GREADTH metrics (Section 5.2), while requiring",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                70,
                                213,
                                541,
                                227
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        213,
                                        541,
                                        227
                                    ],
                                    "score": 1.0,
                                    "content": "fewer tokens per interaction and less cost per processed token. We attempt to distill a multi-node Teacher",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                71,
                                226,
                                541,
                                238
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        226,
                                        541,
                                        238
                                    ],
                                    "score": 0.9904783964157104,
                                    "content": "agent that uses a large model into a single-node Student agent that uses a small model. For both finetuning",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                70,
                                238,
                                486,
                                252
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        238,
                                        486,
                                        252
                                    ],
                                    "score": 1.0,
                                    "content": "and evaluation purposes, we simulate the environment (synthetic forms and user interactions).",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        }
                    ],
                    "index": 8
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        261,
                        540,
                        404
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                262,
                                540,
                                275
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        262,
                                        540,
                                        275
                                    ],
                                    "score": 1.0,
                                    "content": "Synthetic Companies To simulate an enterprise environment with multiple forms, we prompt a Llama-",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                70,
                                274,
                                541,
                                286
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        274,
                                        541,
                                        286
                                    ],
                                    "score": 0.9941527843475342,
                                    "content": "3-70B-Instruct model to generate the name and descriptions of 6 fictitious companies, which we divide",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                70,
                                286,
                                540,
                                299
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        286,
                                        540,
                                        299
                                    ],
                                    "score": 1.0,
                                    "content": "into training domains (FlyCorp, BigBankCorp, CoffeeCorp) and testing domains (DriveCorp, LuxuryCorp,",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                71,
                                298,
                                542,
                                311
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        298,
                                        542,
                                        311
                                    ],
                                    "score": 1.0,
                                    "content": "ShopCorp). For each company, we then prompt Llama-3-70B-Instruct to generate 10 plausible request forms",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                71,
                                310,
                                541,
                                323
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        310,
                                        541,
                                        323
                                    ],
                                    "score": 1.0,
                                    "content": "based on the company name and description. Each form has a name and a description. Eventually, for each",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                70,
                                322,
                                541,
                                334
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        322,
                                        541,
                                        334
                                    ],
                                    "score": 1.0,
                                    "content": "generated form description, we prompt Llama-3-70B-Instruct to generate a FunctionSchema for that request",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                71,
                                334,
                                541,
                                345
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        334,
                                        541,
                                        345
                                    ],
                                    "score": 1.0,
                                    "content": "form. FunctionSchemas are structured data representations including a name, a description, a JsonSchema",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                71,
                                346,
                                541,
                                357
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        346,
                                        541,
                                        357
                                    ],
                                    "score": 0.9794667959213257,
                                    "content": "describing slots to fill, and a JsonSchema describing the object returned once the form is submitted. Slots to",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                69,
                                356,
                                541,
                                371
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        356,
                                        541,
                                        371
                                    ],
                                    "score": 0.989272952079773,
                                    "content": "fill have a name, description, type (categorical, date, email, string), optionality, possible values, and default",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                71,
                                370,
                                541,
                                382
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        370,
                                        541,
                                        382
                                    ],
                                    "score": 1.0,
                                    "content": "values. The prompts used to generate synthetic companies are described in Appendix E.1. Each of our",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                70,
                                381,
                                541,
                                394
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        381,
                                        541,
                                        394
                                    ],
                                    "score": 1.0,
                                    "content": "simulated environments has 10 available forms and identifying which form the user requests is part of the",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                70,
                                393,
                                187,
                                406
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        393,
                                        187,
                                        406
                                    ],
                                    "score": 0.9997220635414124,
                                    "content": "form-filling task we tackle.",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        }
                    ],
                    "index": 16.5
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        416,
                        541,
                        512
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                417,
                                541,
                                430
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        417,
                                        541,
                                        430
                                    ],
                                    "score": 1.0,
                                    "content": "User Agents In the multi-turn dialogue setting, distillation is more complex than running the Teacher",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                71,
                                429,
                                541,
                                442
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        429,
                                        541,
                                        442
                                    ],
                                    "score": 1.0,
                                    "content": "on a set of static contexts because of alternating agent and user turns. The user turns need to either be",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                70,
                                442,
                                542,
                                455
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        442,
                                        542,
                                        455
                                    ],
                                    "score": 0.9824578762054443,
                                    "content": "produced by a human or generated. We define 19 different (single-node) User agents to generate the next",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                71,
                                454,
                                541,
                                465
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        454,
                                        541,
                                        465
                                    ],
                                    "score": 1.0,
                                    "content": "user message by simulating a variety of user behaviors. Some user behaviors are “easy” such as “answer",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                71,
                                466,
                                540,
                                477
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        466,
                                        503,
                                        477
                                    ],
                                    "score": 1.0,
                                    "content": "the agent’s question”, while others can be quite adversarial such as “provide a good value for slot ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        504,
                                        467,
                                        512,
                                        474
                                    ],
                                    "score": 0.82,
                                    "content": "X",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        512,
                                        466,
                                        534,
                                        477
                                    ],
                                    "score": 1.0,
                                    "content": " and ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        535,
                                        469,
                                        540,
                                        474
                                    ],
                                    "score": 0.27,
                                    "content": "a",
                                    "type": "inline_equation",
                                    "height": 5,
                                    "width": 5
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                71,
                                476,
                                541,
                                489
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        476,
                                        541,
                                        489
                                    ],
                                    "score": 1.0,
                                    "content": "bad value for slot Y ” or “ask for something unrelated”. All user agents and their respective behaviors are",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                71,
                                489,
                                541,
                                502
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        489,
                                        541,
                                        502
                                    ],
                                    "score": 1.0,
                                    "content": "described in Appendix E.3. Each of these User agents serves as a special instance of the Tape Environment",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                70,
                                500,
                                419,
                                515
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        500,
                                        419,
                                        515
                                    ],
                                    "score": 1.0,
                                    "content": "that responds to the assistant after each PromptUserForTextMessageAction step.",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        }
                    ],
                    "index": 26.5
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        524,
                        541,
                        667
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                525,
                                540,
                                538
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        525,
                                        540,
                                        538
                                    ],
                                    "score": 1.0,
                                    "content": "Synthetic Dialogue Generation We generate a dataset of dialogues by repeatedly and alternatively",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                71,
                                538,
                                540,
                                549
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        538,
                                        540,
                                        549
                                    ],
                                    "score": 1.0,
                                    "content": "running the Teacher agent and a User agent to generate the next turn from a set of partial conversations.",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                70,
                                549,
                                541,
                                562
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        549,
                                        541,
                                        562
                                    ],
                                    "score": 1.0,
                                    "content": "The minimal partial conversation contains only the “Hi, how can I help you?” Assistant message. User",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                70,
                                561,
                                541,
                                573
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        561,
                                        541,
                                        573
                                    ],
                                    "score": 1.0,
                                    "content": "agents are sampled randomly after each PromptUserForTextMessageAction steps from the Assistant, and",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                70,
                                573,
                                540,
                                584
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        573,
                                        540,
                                        584
                                    ],
                                    "score": 1.0,
                                    "content": "yield a user message Observation. The Assistant then continues the conversation until its next message. The",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                70,
                                585,
                                541,
                                598
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        585,
                                        541,
                                        598
                                    ],
                                    "score": 1.0,
                                    "content": "conversations end when they reach 18 turns (9 agent messages and 9 user messages), whenever the request",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                70,
                                597,
                                541,
                                610
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        597,
                                        541,
                                        610
                                    ],
                                    "score": 0.9824187159538269,
                                    "content": "is submitted or aborted, or if the agent fails to produce a valid continuation (e.g. trying to fill a nonexistent",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                70,
                                608,
                                541,
                                621
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        608,
                                        541,
                                        621
                                    ],
                                    "score": 1.0,
                                    "content": "slot). We show an example of a full conversation between the Teacher agent and the User agent in Figure 11",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                71,
                                621,
                                541,
                                633
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        621,
                                        541,
                                        633
                                    ],
                                    "score": 1.0,
                                    "content": "(Appendix E.5). We structure the dataset as a tree of dialogues, while controlling for the width of the tree",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                71,
                                632,
                                541,
                                645
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        632,
                                        541,
                                        645
                                    ],
                                    "score": 0.9931864738464355,
                                    "content": "(beam search), the diversity of user behaviors, and the diversity of filled forms (requests). We use a beam",
                                    "type": "text"
                                }
                            ],
                            "index": 40
                        },
                        {
                            "bbox": [
                                70,
                                644,
                                541,
                                657
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        644,
                                        541,
                                        657
                                    ],
                                    "score": 1.0,
                                    "content": "size of width 500, up to 9 user turns and 9 agent turns. This results in roughly 13k train and 13k test",
                                    "type": "text"
                                }
                            ],
                            "index": 41
                        },
                        {
                            "bbox": [
                                70,
                                657,
                                262,
                                670
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        657,
                                        262,
                                        670
                                    ],
                                    "score": 1.0,
                                    "content": "agent continuations per synthetic company.",
                                    "type": "text"
                                }
                            ],
                            "index": 42
                        }
                    ],
                    "index": 36.5
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        680,
                        540,
                        716
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                681,
                                540,
                                694
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        681,
                                        540,
                                        694
                                    ],
                                    "score": 1.0,
                                    "content": "Human Evaluation We perform human evaluation to score each agent turn on the basis of the GREADTH",
                                    "type": "text"
                                }
                            ],
                            "index": 43
                        },
                        {
                            "bbox": [
                                69,
                                693,
                                540,
                                706
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        693,
                                        540,
                                        706
                                    ],
                                    "score": 1.0,
                                    "content": "metrics: groundedness, responsiveness, accuracy, discipline, transparency, and helpfulness (Section 5.2).",
                                    "type": "text"
                                }
                            ],
                            "index": 44
                        },
                        {
                            "bbox": [
                                71,
                                704,
                                540,
                                717
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        704,
                                        540,
                                        717
                                    ],
                                    "score": 1.0,
                                    "content": "The labeling services were provided by Toloka,8 and the labelers were paid above the minimum wage in their",
                                    "type": "text"
                                }
                            ],
                            "index": 45
                        }
                    ],
                    "index": 44
                }
            ],
            "layout_bboxes": [],
            "page_idx": 14,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        72,
                        27,
                        143,
                        37
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                26,
                                144,
                                38
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        26,
                                        144,
                                        38
                                    ],
                                    "score": 1.0,
                                    "content": "Technical report",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        82,
                        722,
                        152,
                        731
                    ],
                    "lines": [
                        {
                            "bbox": [
                                82,
                                721,
                                153,
                                734
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        82,
                                        721,
                                        153,
                                        734
                                    ],
                                    "score": 1.0,
                                    "content": "8https://toloka.ai",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        751,
                        311,
                        760
                    ],
                    "lines": [
                        {
                            "bbox": [
                                299,
                                751,
                                312,
                                762
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        299,
                                        751,
                                        312,
                                        762
                                    ],
                                    "score": 1.0,
                                    "content": "15",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        96,
                        82,
                        540,
                        130
                    ],
                    "lines": [
                        {
                            "bbox": [
                                96,
                                83,
                                541,
                                97
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        96,
                                        83,
                                        541,
                                        97
                                    ],
                                    "score": 1.0,
                                    "content": "• Update Slots, Generate Plan, and Respond. Using a single short prompt, we ask",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                106,
                                95,
                                540,
                                108
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        95,
                                        540,
                                        108
                                    ],
                                    "score": 1.0,
                                    "content": "the agent to generate all its thoughts (e.g. RefuseInvalidFunctionParameterValueThought;",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                106,
                                107,
                                541,
                                119
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        107,
                                        541,
                                        119
                                    ],
                                    "score": 1.0,
                                    "content": "UpdateFunctionParametersThought; RequestFunctionParametersThought) and end with an action",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                106,
                                119,
                                282,
                                132
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        119,
                                        282,
                                        132
                                    ],
                                    "score": 1.0,
                                    "content": "(e.g. PromptUserForTextMessageAction).",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        }
                    ],
                    "index": 1.5,
                    "page_num": "page_14",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        96,
                        83,
                        541,
                        132
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        142,
                        384,
                        154
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                142,
                                385,
                                156
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        142,
                                        385,
                                        156
                                    ],
                                    "score": 1.0,
                                    "content": "We show an example of the Student tape in Figure 12 of Appendix E.5.",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        }
                    ],
                    "index": 4,
                    "page_num": "page_14",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        71,
                        142,
                        385,
                        156
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        167,
                        153,
                        179
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                168,
                                154,
                                180
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        168,
                                        88,
                                        179
                                    ],
                                    "score": 1.0,
                                    "content": "5.4",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        95,
                                        168,
                                        154,
                                        180
                                    ],
                                    "score": 1.0,
                                    "content": "Experiments",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        }
                    ],
                    "index": 5,
                    "page_num": "page_14",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        189,
                        541,
                        249
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                189,
                                539,
                                203
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        189,
                                        539,
                                        203
                                    ],
                                    "score": 0.985506534576416,
                                    "content": "We consider the task of training a cost-effective conversational agent to help the user fill and submit a form.",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                70,
                                201,
                                541,
                                215
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        201,
                                        541,
                                        215
                                    ],
                                    "score": 1.0,
                                    "content": "We seek the conversational experience to score high in GREADTH metrics (Section 5.2), while requiring",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                70,
                                213,
                                541,
                                227
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        213,
                                        541,
                                        227
                                    ],
                                    "score": 1.0,
                                    "content": "fewer tokens per interaction and less cost per processed token. We attempt to distill a multi-node Teacher",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                71,
                                226,
                                541,
                                238
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        226,
                                        541,
                                        238
                                    ],
                                    "score": 0.9904783964157104,
                                    "content": "agent that uses a large model into a single-node Student agent that uses a small model. For both finetuning",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                70,
                                238,
                                486,
                                252
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        238,
                                        486,
                                        252
                                    ],
                                    "score": 1.0,
                                    "content": "and evaluation purposes, we simulate the environment (synthetic forms and user interactions).",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        }
                    ],
                    "index": 8,
                    "page_num": "page_14",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        189,
                        541,
                        252
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        261,
                        540,
                        404
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                262,
                                540,
                                275
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        262,
                                        540,
                                        275
                                    ],
                                    "score": 1.0,
                                    "content": "Synthetic Companies To simulate an enterprise environment with multiple forms, we prompt a Llama-",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                70,
                                274,
                                541,
                                286
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        274,
                                        541,
                                        286
                                    ],
                                    "score": 0.9941527843475342,
                                    "content": "3-70B-Instruct model to generate the name and descriptions of 6 fictitious companies, which we divide",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                70,
                                286,
                                540,
                                299
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        286,
                                        540,
                                        299
                                    ],
                                    "score": 1.0,
                                    "content": "into training domains (FlyCorp, BigBankCorp, CoffeeCorp) and testing domains (DriveCorp, LuxuryCorp,",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                71,
                                298,
                                542,
                                311
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        298,
                                        542,
                                        311
                                    ],
                                    "score": 1.0,
                                    "content": "ShopCorp). For each company, we then prompt Llama-3-70B-Instruct to generate 10 plausible request forms",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                71,
                                310,
                                541,
                                323
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        310,
                                        541,
                                        323
                                    ],
                                    "score": 1.0,
                                    "content": "based on the company name and description. Each form has a name and a description. Eventually, for each",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                70,
                                322,
                                541,
                                334
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        322,
                                        541,
                                        334
                                    ],
                                    "score": 1.0,
                                    "content": "generated form description, we prompt Llama-3-70B-Instruct to generate a FunctionSchema for that request",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                71,
                                334,
                                541,
                                345
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        334,
                                        541,
                                        345
                                    ],
                                    "score": 1.0,
                                    "content": "form. FunctionSchemas are structured data representations including a name, a description, a JsonSchema",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                71,
                                346,
                                541,
                                357
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        346,
                                        541,
                                        357
                                    ],
                                    "score": 0.9794667959213257,
                                    "content": "describing slots to fill, and a JsonSchema describing the object returned once the form is submitted. Slots to",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                69,
                                356,
                                541,
                                371
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        356,
                                        541,
                                        371
                                    ],
                                    "score": 0.989272952079773,
                                    "content": "fill have a name, description, type (categorical, date, email, string), optionality, possible values, and default",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                71,
                                370,
                                541,
                                382
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        370,
                                        541,
                                        382
                                    ],
                                    "score": 1.0,
                                    "content": "values. The prompts used to generate synthetic companies are described in Appendix E.1. Each of our",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                70,
                                381,
                                541,
                                394
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        381,
                                        541,
                                        394
                                    ],
                                    "score": 1.0,
                                    "content": "simulated environments has 10 available forms and identifying which form the user requests is part of the",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                70,
                                393,
                                187,
                                406
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        393,
                                        187,
                                        406
                                    ],
                                    "score": 0.9997220635414124,
                                    "content": "form-filling task we tackle.",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        }
                    ],
                    "index": 16.5,
                    "page_num": "page_14",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        262,
                        542,
                        406
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        416,
                        541,
                        512
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                417,
                                541,
                                430
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        417,
                                        541,
                                        430
                                    ],
                                    "score": 1.0,
                                    "content": "User Agents In the multi-turn dialogue setting, distillation is more complex than running the Teacher",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                71,
                                429,
                                541,
                                442
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        429,
                                        541,
                                        442
                                    ],
                                    "score": 1.0,
                                    "content": "on a set of static contexts because of alternating agent and user turns. The user turns need to either be",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                70,
                                442,
                                542,
                                455
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        442,
                                        542,
                                        455
                                    ],
                                    "score": 0.9824578762054443,
                                    "content": "produced by a human or generated. We define 19 different (single-node) User agents to generate the next",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                71,
                                454,
                                541,
                                465
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        454,
                                        541,
                                        465
                                    ],
                                    "score": 1.0,
                                    "content": "user message by simulating a variety of user behaviors. Some user behaviors are “easy” such as “answer",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                71,
                                466,
                                540,
                                477
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        466,
                                        503,
                                        477
                                    ],
                                    "score": 1.0,
                                    "content": "the agent’s question”, while others can be quite adversarial such as “provide a good value for slot ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        504,
                                        467,
                                        512,
                                        474
                                    ],
                                    "score": 0.82,
                                    "content": "X",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        512,
                                        466,
                                        534,
                                        477
                                    ],
                                    "score": 1.0,
                                    "content": " and ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        535,
                                        469,
                                        540,
                                        474
                                    ],
                                    "score": 0.27,
                                    "content": "a",
                                    "type": "inline_equation",
                                    "height": 5,
                                    "width": 5
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                71,
                                476,
                                541,
                                489
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        476,
                                        541,
                                        489
                                    ],
                                    "score": 1.0,
                                    "content": "bad value for slot Y ” or “ask for something unrelated”. All user agents and their respective behaviors are",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                71,
                                489,
                                541,
                                502
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        489,
                                        541,
                                        502
                                    ],
                                    "score": 1.0,
                                    "content": "described in Appendix E.3. Each of these User agents serves as a special instance of the Tape Environment",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                70,
                                500,
                                419,
                                515
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        500,
                                        419,
                                        515
                                    ],
                                    "score": 1.0,
                                    "content": "that responds to the assistant after each PromptUserForTextMessageAction step.",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        }
                    ],
                    "index": 26.5,
                    "page_num": "page_14",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        417,
                        542,
                        515
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        524,
                        541,
                        667
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                525,
                                540,
                                538
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        525,
                                        540,
                                        538
                                    ],
                                    "score": 1.0,
                                    "content": "Synthetic Dialogue Generation We generate a dataset of dialogues by repeatedly and alternatively",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                71,
                                538,
                                540,
                                549
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        538,
                                        540,
                                        549
                                    ],
                                    "score": 1.0,
                                    "content": "running the Teacher agent and a User agent to generate the next turn from a set of partial conversations.",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                70,
                                549,
                                541,
                                562
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        549,
                                        541,
                                        562
                                    ],
                                    "score": 1.0,
                                    "content": "The minimal partial conversation contains only the “Hi, how can I help you?” Assistant message. User",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                70,
                                561,
                                541,
                                573
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        561,
                                        541,
                                        573
                                    ],
                                    "score": 1.0,
                                    "content": "agents are sampled randomly after each PromptUserForTextMessageAction steps from the Assistant, and",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                70,
                                573,
                                540,
                                584
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        573,
                                        540,
                                        584
                                    ],
                                    "score": 1.0,
                                    "content": "yield a user message Observation. The Assistant then continues the conversation until its next message. The",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                70,
                                585,
                                541,
                                598
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        585,
                                        541,
                                        598
                                    ],
                                    "score": 1.0,
                                    "content": "conversations end when they reach 18 turns (9 agent messages and 9 user messages), whenever the request",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                70,
                                597,
                                541,
                                610
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        597,
                                        541,
                                        610
                                    ],
                                    "score": 0.9824187159538269,
                                    "content": "is submitted or aborted, or if the agent fails to produce a valid continuation (e.g. trying to fill a nonexistent",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                70,
                                608,
                                541,
                                621
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        608,
                                        541,
                                        621
                                    ],
                                    "score": 1.0,
                                    "content": "slot). We show an example of a full conversation between the Teacher agent and the User agent in Figure 11",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                71,
                                621,
                                541,
                                633
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        621,
                                        541,
                                        633
                                    ],
                                    "score": 1.0,
                                    "content": "(Appendix E.5). We structure the dataset as a tree of dialogues, while controlling for the width of the tree",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                71,
                                632,
                                541,
                                645
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        632,
                                        541,
                                        645
                                    ],
                                    "score": 0.9931864738464355,
                                    "content": "(beam search), the diversity of user behaviors, and the diversity of filled forms (requests). We use a beam",
                                    "type": "text"
                                }
                            ],
                            "index": 40
                        },
                        {
                            "bbox": [
                                70,
                                644,
                                541,
                                657
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        644,
                                        541,
                                        657
                                    ],
                                    "score": 1.0,
                                    "content": "size of width 500, up to 9 user turns and 9 agent turns. This results in roughly 13k train and 13k test",
                                    "type": "text"
                                }
                            ],
                            "index": 41
                        },
                        {
                            "bbox": [
                                70,
                                657,
                                262,
                                670
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        657,
                                        262,
                                        670
                                    ],
                                    "score": 1.0,
                                    "content": "agent continuations per synthetic company.",
                                    "type": "text"
                                }
                            ],
                            "index": 42
                        }
                    ],
                    "index": 36.5,
                    "page_num": "page_14",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        525,
                        541,
                        670
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        680,
                        540,
                        716
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                681,
                                540,
                                694
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        681,
                                        540,
                                        694
                                    ],
                                    "score": 1.0,
                                    "content": "Human Evaluation We perform human evaluation to score each agent turn on the basis of the GREADTH",
                                    "type": "text"
                                }
                            ],
                            "index": 43
                        },
                        {
                            "bbox": [
                                69,
                                693,
                                540,
                                706
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        693,
                                        540,
                                        706
                                    ],
                                    "score": 1.0,
                                    "content": "metrics: groundedness, responsiveness, accuracy, discipline, transparency, and helpfulness (Section 5.2).",
                                    "type": "text"
                                }
                            ],
                            "index": 44
                        },
                        {
                            "bbox": [
                                71,
                                704,
                                540,
                                717
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        704,
                                        540,
                                        717
                                    ],
                                    "score": 1.0,
                                    "content": "The labeling services were provided by Toloka,8 and the labelers were paid above the minimum wage in their",
                                    "type": "text"
                                }
                            ],
                            "index": 45
                        },
                        {
                            "bbox": [
                                71,
                                534,
                                540,
                                547
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        534,
                                        540,
                                        547
                                    ],
                                    "score": 1.0,
                                    "content": "respective work locations. Labelers provide the 6 GREADTH binary labels per agent turn. We also have",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                71,
                                546,
                                541,
                                559
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        546,
                                        186,
                                        559
                                    ],
                                    "score": 1.0,
                                    "content": "expert labelers who audit ",
                                    "type": "text",
                                    "cross_page": true
                                },
                                {
                                    "bbox": [
                                        187,
                                        546,
                                        205,
                                        556
                                    ],
                                    "score": 0.39,
                                    "content": "10\\%",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 18,
                                    "cross_page": true
                                },
                                {
                                    "bbox": [
                                        206,
                                        546,
                                        541,
                                        559
                                    ],
                                    "score": 1.0,
                                    "content": " of the labels. We report scores for each metric as well as the GREADTH",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                70,
                                558,
                                540,
                                571
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        558,
                                        540,
                                        571
                                    ],
                                    "score": 0.9931406378746033,
                                    "content": "score, which is equal to 1 only if all 6 metrics are satisfied, and 0 otherwise (binary AND). If the agent fails",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                72,
                                571,
                                540,
                                582
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        571,
                                        540,
                                        582
                                    ],
                                    "score": 0.9806557297706604,
                                    "content": "to produce a valid continuation — due to unparsable JSON, invalid schema, attempting to fill an invalid slot",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                71,
                                583,
                                526,
                                595
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        583,
                                        526,
                                        595
                                    ],
                                    "score": 1.0,
                                    "content": "value, or submitting a form with missing values — then the agent automatically gets 0 for all 6 metrics.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 22
                        }
                    ],
                    "index": 44,
                    "page_num": "page_14",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        681,
                        540,
                        717
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "table",
                    "bbox": [
                        70,
                        137,
                        541,
                        279
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                70,
                                80,
                                541,
                                135
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        80,
                                        542,
                                        95
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                80,
                                                376,
                                                95
                                            ],
                                            "score": 1.0,
                                            "content": "Table 4: GREADTH Form Filler experiment results. The Teacher",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                376,
                                                82,
                                                380,
                                                90
                                            ],
                                            "score": 0.3,
                                            "content": "^{-1}",
                                            "type": "inline_equation",
                                            "height": 8,
                                            "width": 4
                                        },
                                        {
                                            "bbox": [
                                                381,
                                                80,
                                                542,
                                                95
                                            ],
                                            "score": 1.0,
                                            "content": " is a multi-node agent with Llama 3.1",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        71,
                                        92,
                                        541,
                                        105
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                92,
                                                541,
                                                105
                                            ],
                                            "score": 1.0,
                                            "content": "405B Instruct FP8 as its LLM. The Student2 is a single-node agent with Llama 3.1 8b Instruct as its LLM. We also",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        71,
                                        103,
                                        541,
                                        115
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                103,
                                                541,
                                                115
                                            ],
                                            "score": 1.0,
                                            "content": "evaluate the multi-node agent with GPT-4o and with Llama 3.1 8B Instruct as its LLM, as well as the single-node",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 2
                                },
                                {
                                    "bbox": [
                                        69,
                                        114,
                                        541,
                                        127
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                114,
                                                541,
                                                127
                                            ],
                                            "score": 1.0,
                                            "content": "agent with Llama 3.1 405B Instruct for comparison. The metrics are computed over 1524 partial dialogues from the",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        72,
                                        126,
                                        263,
                                        136
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                72,
                                                126,
                                                263,
                                                136
                                            ],
                                            "score": 1.0,
                                            "content": "test domains. Read full analysis in Section 5.4.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                }
                            ],
                            "index": 2
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                70,
                                137,
                                541,
                                279
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        70,
                                        137,
                                        541,
                                        279
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                137,
                                                541,
                                                279
                                            ],
                                            "score": 0.982,
                                            "html": "<html><body><table><tr><td>Agent (LLM+Nodes)</td><td>G</td><td>Re</td><td>A</td><td>D</td><td>T</td><td>H</td><td>GREADTHScore (HumanRaters)</td></tr><tr><td colspan=\"6\">Reference Comparis0n (GPT-4o-2024-08-06)</td><td></td><td></td></tr><tr><td>Multi-node (O-shot)</td><td>91.3%</td><td>87.1%</td><td>91.4%</td><td>92.7%</td><td>94.3%</td><td>87.2%</td><td>74.9%</td></tr><tr><td colspan=\"6\">Llama-3.1-405B-Instruct</td><td></td><td></td></tr><tr><td>Teacherl:Multi-node (O-shot)</td><td>89.8%</td><td>85.0%</td><td>87.9%</td><td>91.6%</td><td>92.5%</td><td>86.5%</td><td>75.8%</td></tr><tr><td>Single-node (0-shot)</td><td>74.2%</td><td>72.0%</td><td>76.8%</td><td>67.3%</td><td>78.9%</td><td>61.9%</td><td>43.2%</td></tr><tr><td colspan=\"6\">Llama-3.1-8B-Instruct</td><td></td><td></td></tr><tr><td>Multi-node (O-shot)</td><td>75.5%</td><td>57.7%</td><td>72.4%</td><td>74.0%</td><td>76.3%</td><td>60.3%</td><td>36.6%</td></tr><tr><td>Student2: Single-node (0-shot)</td><td>18.8%</td><td>6.2%</td><td>10.9%</td><td>11.6%</td><td>9.4%</td><td>12.7%</td><td>2.0%</td></tr><tr><td>Student2:Single-node (finetuned)</td><td>92.1%</td><td>86.4%</td><td>90.2%</td><td>94.4%</td><td>95.1%</td><td>87.1%</td><td>76.6%</td></tr></table></body></html>",
                                            "type": "table",
                                            "image_path": "989ccb76a278170172a016d5aa602015a026d6fa27ce43f1ca06a37cf520a36b.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 6,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        70,
                                        137,
                                        541,
                                        184.33333333333334
                                    ],
                                    "spans": [],
                                    "index": 5
                                },
                                {
                                    "bbox": [
                                        70,
                                        184.33333333333334,
                                        541,
                                        231.66666666666669
                                    ],
                                    "spans": [],
                                    "index": 6
                                },
                                {
                                    "bbox": [
                                        70,
                                        231.66666666666669,
                                        541,
                                        279.0
                                    ],
                                    "spans": [],
                                    "index": 7
                                }
                            ]
                        }
                    ],
                    "index": 4.0
                },
                {
                    "type": "table",
                    "bbox": [
                        105,
                        374,
                        506,
                        507
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                70,
                                295,
                                540,
                                372
                            ],
                            "group_id": 1,
                            "lines": [
                                {
                                    "bbox": [
                                        71,
                                        297,
                                        541,
                                        309
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                297,
                                                541,
                                                309
                                            ],
                                            "score": 0.992110550403595,
                                            "content": "Table 5: Agent Cost vs. Performance Tradeoff. On the evaluation set, we report the average number of input",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 8
                                },
                                {
                                    "bbox": [
                                        70,
                                        307,
                                        541,
                                        319
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                307,
                                                541,
                                                319
                                            ],
                                            "score": 1.0,
                                            "content": "and output tokens per agent turn, and the average cost per million agent turns, by multiplying the number of tokens",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 9
                                },
                                {
                                    "bbox": [
                                        72,
                                        319,
                                        541,
                                        330
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                72,
                                                319,
                                                541,
                                                330
                                            ],
                                            "score": 1.0,
                                            "content": "with the retail price of the cheapest provider on Openrouter as of October 3rd 2024 ($0.055 per million input/output",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 10
                                },
                                {
                                    "bbox": [
                                        71,
                                        329,
                                        540,
                                        342
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                329,
                                                221,
                                                342
                                            ],
                                            "score": 1.0,
                                            "content": "tokens for Llama-3.1-8B-instruct and",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                221,
                                                329,
                                                244,
                                                339
                                            ],
                                            "score": 0.59,
                                            "content": "\\$1.79",
                                            "type": "inline_equation",
                                            "height": 10,
                                            "width": 23
                                        },
                                        {
                                            "bbox": [
                                                244,
                                                329,
                                                525,
                                                342
                                            ],
                                            "score": 1.0,
                                            "content": " for Llama-3.1-405B-instruct). The cost per million agent turns is only",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                525,
                                                329,
                                                540,
                                                338
                                            ],
                                            "score": 0.32,
                                            "content": "\\$85",
                                            "type": "inline_equation",
                                            "height": 9,
                                            "width": 15
                                        }
                                    ],
                                    "index": 11
                                },
                                {
                                    "bbox": [
                                        70,
                                        339,
                                        541,
                                        352
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                339,
                                                151,
                                                352
                                            ],
                                            "score": 1.0,
                                            "content": "for the Student vs. ",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                152,
                                                340,
                                                184,
                                                350
                                            ],
                                            "score": 0.61,
                                            "content": "\\$28,157",
                                            "type": "inline_equation",
                                            "height": 10,
                                            "width": 32
                                        },
                                        {
                                            "bbox": [
                                                185,
                                                339,
                                                541,
                                                352
                                            ],
                                            "score": 1.0,
                                            "content": "for the Teacher, which represents a factor of 300 in savings. The cost for the Teacher",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 12
                                },
                                {
                                    "bbox": [
                                        70,
                                        351,
                                        542,
                                        363
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                351,
                                                542,
                                                363
                                            ],
                                            "score": 0.9952303767204285,
                                            "content": "agent could be mitigated by prefix caching, but most of the multi-node prompts are context-dependent. Read full",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 13
                                },
                                {
                                    "bbox": [
                                        72,
                                        362,
                                        165,
                                        373
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                72,
                                                362,
                                                165,
                                                373
                                            ],
                                            "score": 1.0,
                                            "content": "analysis in Section 5.4.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 14
                                }
                            ],
                            "index": 11
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                105,
                                374,
                                506,
                                507
                            ],
                            "group_id": 1,
                            "lines": [
                                {
                                    "bbox": [
                                        105,
                                        374,
                                        506,
                                        507
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                105,
                                                374,
                                                506,
                                                507
                                            ],
                                            "score": 0.982,
                                            "html": "<html><body><table><tr><td>Agent (LLM+Nodes)</td><td>Input Tokens /turn</td><td>Output Tokens /turn</td><td>Cost /1M turns</td><td>GREADTH score</td></tr><tr><td colspan=\"5\">Reference Comparison(GPT-4o-2024-08-06)</td></tr><tr><td>Multi-node (O-shot)</td><td>15,431</td><td>526</td><td>$43,837</td><td>74.9%</td></tr><tr><td colspan=\"5\">Llama-3.1-405B-Instruct</td></tr><tr><td>Teacher: Multi-node (O-shot)</td><td>15,189</td><td>541</td><td>$28,157</td><td>75.8%</td></tr><tr><td>Single-node (O-shot)</td><td>1,435</td><td>97</td><td>$2,742</td><td>43.2%</td></tr><tr><td colspan=\"5\">Llama-3.1-8B-Instruct</td></tr><tr><td>Multi-node (O-shot)</td><td>15,189</td><td>541</td><td>$865</td><td>36.6%</td></tr><tr><td>Student:Single-node (0-shot)</td><td>1,437</td><td>208</td><td>$90</td><td>2.0%</td></tr><tr><td>Student:Single-node (finetuned)</td><td>1,441</td><td>110</td><td>$85</td><td>76.6%</td></tr></table></body></html>",
                                            "type": "table",
                                            "image_path": "b6ea8f00a1a96aadebe63222f375a8a3ee788a45b7b780b6354339ca0e98aea1.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 16,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        105,
                                        374,
                                        506,
                                        418.3333333333333
                                    ],
                                    "spans": [],
                                    "index": 15
                                },
                                {
                                    "bbox": [
                                        105,
                                        418.3333333333333,
                                        506,
                                        462.66666666666663
                                    ],
                                    "spans": [],
                                    "index": 16
                                },
                                {
                                    "bbox": [
                                        105,
                                        462.66666666666663,
                                        506,
                                        506.99999999999994
                                    ],
                                    "spans": [],
                                    "index": 17
                                }
                            ]
                        }
                    ],
                    "index": 13.5
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        533,
                        541,
                        594
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                534,
                                540,
                                547
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        534,
                                        540,
                                        547
                                    ],
                                    "score": 1.0,
                                    "content": "respective work locations. Labelers provide the 6 GREADTH binary labels per agent turn. We also have",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                71,
                                546,
                                541,
                                559
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        546,
                                        186,
                                        559
                                    ],
                                    "score": 1.0,
                                    "content": "expert labelers who audit ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        187,
                                        546,
                                        205,
                                        556
                                    ],
                                    "score": 0.39,
                                    "content": "10\\%",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 18
                                },
                                {
                                    "bbox": [
                                        206,
                                        546,
                                        541,
                                        559
                                    ],
                                    "score": 1.0,
                                    "content": " of the labels. We report scores for each metric as well as the GREADTH",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                70,
                                558,
                                540,
                                571
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        558,
                                        540,
                                        571
                                    ],
                                    "score": 0.9931406378746033,
                                    "content": "score, which is equal to 1 only if all 6 metrics are satisfied, and 0 otherwise (binary AND). If the agent fails",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                72,
                                571,
                                540,
                                582
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        571,
                                        540,
                                        582
                                    ],
                                    "score": 0.9806557297706604,
                                    "content": "to produce a valid continuation — due to unparsable JSON, invalid schema, attempting to fill an invalid slot",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                71,
                                583,
                                526,
                                595
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        583,
                                        526,
                                        595
                                    ],
                                    "score": 1.0,
                                    "content": "value, or submitting a form with missing values — then the agent automatically gets 0 for all 6 metrics.",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        }
                    ],
                    "index": 20
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        612,
                        541,
                        732
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                613,
                                540,
                                627
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        613,
                                        540,
                                        627
                                    ],
                                    "score": 1.0,
                                    "content": "Agent Distillation As described in Section 5.3, we construct the Teacher agent by prompting a very",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                70,
                                625,
                                540,
                                639
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        625,
                                        540,
                                        639
                                    ],
                                    "score": 1.0,
                                    "content": "large model, Llama-3.1-405B-Instruct-FP8 (runs on 8 H100-80GB GPUs) with sequential and lengthy in-",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                70,
                                636,
                                541,
                                651
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        636,
                                        541,
                                        651
                                    ],
                                    "score": 1.0,
                                    "content": "structions (multi-node agent) in order to obtain the best GREADTH score, with no regards to prompt",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                69,
                                648,
                                542,
                                663
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        648,
                                        542,
                                        663
                                    ],
                                    "score": 1.0,
                                    "content": "length optimization or latency. From a qualitative perspective, our interaction with the Teacher agent reveals",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                70,
                                661,
                                539,
                                673
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        661,
                                        539,
                                        673
                                    ],
                                    "score": 1.0,
                                    "content": "a generally satisfactory user experience and validates its choice as a Teacher agent. We construct the Stu-",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                71,
                                673,
                                540,
                                685
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        673,
                                        540,
                                        685
                                    ],
                                    "score": 1.0,
                                    "content": "dent agent by combining a much smaller model, Llama-3.1-8B-Instruct model (runs on a single A100-80GB",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                70,
                                685,
                                541,
                                699
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        685,
                                        541,
                                        699
                                    ],
                                    "score": 1.0,
                                    "content": "GPU), with a single-node (single-node agent) optimized for length. We distill the Teacher agent into the",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                70,
                                696,
                                542,
                                711
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        696,
                                        225,
                                        711
                                    ],
                                    "score": 0.9849812388420105,
                                    "content": "Student agent by finetuning it over",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        225,
                                        697,
                                        244,
                                        707
                                    ],
                                    "score": 0.31,
                                    "content": "\\mathbf{13k}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 19
                                },
                                {
                                    "bbox": [
                                        244,
                                        696,
                                        542,
                                        711
                                    ],
                                    "score": 1.0,
                                    "content": " teacher agent turns (continuations) on the training domains. We",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                70,
                                709,
                                541,
                                722
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        709,
                                        541,
                                        722
                                    ],
                                    "score": 1.0,
                                    "content": "perform a single epoch of LoRA (Hu et al., 2021) optimization using AdamW (Loshchilov and Hutter, 2017)",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                70,
                                720,
                                435,
                                734
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        720,
                                        152,
                                        734
                                    ],
                                    "score": 1.0,
                                    "content": "with learning rate ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        153,
                                        721,
                                        173,
                                        730
                                    ],
                                    "score": 0.91,
                                    "content": "10^{-5}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 20
                                },
                                {
                                    "bbox": [
                                        174,
                                        720,
                                        435,
                                        734
                                    ],
                                    "score": 1.0,
                                    "content": " and batch size 32. Additional epochs did not seem to help.",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        }
                    ],
                    "index": 27.5
                }
            ],
            "layout_bboxes": [],
            "page_idx": 15,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [
                {
                    "type": "table",
                    "bbox": [
                        70,
                        137,
                        541,
                        279
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                70,
                                80,
                                541,
                                135
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        80,
                                        542,
                                        95
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                80,
                                                376,
                                                95
                                            ],
                                            "score": 1.0,
                                            "content": "Table 4: GREADTH Form Filler experiment results. The Teacher",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                376,
                                                82,
                                                380,
                                                90
                                            ],
                                            "score": 0.3,
                                            "content": "^{-1}",
                                            "type": "inline_equation",
                                            "height": 8,
                                            "width": 4
                                        },
                                        {
                                            "bbox": [
                                                381,
                                                80,
                                                542,
                                                95
                                            ],
                                            "score": 1.0,
                                            "content": " is a multi-node agent with Llama 3.1",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        71,
                                        92,
                                        541,
                                        105
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                92,
                                                541,
                                                105
                                            ],
                                            "score": 1.0,
                                            "content": "405B Instruct FP8 as its LLM. The Student2 is a single-node agent with Llama 3.1 8b Instruct as its LLM. We also",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        71,
                                        103,
                                        541,
                                        115
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                103,
                                                541,
                                                115
                                            ],
                                            "score": 1.0,
                                            "content": "evaluate the multi-node agent with GPT-4o and with Llama 3.1 8B Instruct as its LLM, as well as the single-node",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 2
                                },
                                {
                                    "bbox": [
                                        69,
                                        114,
                                        541,
                                        127
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                114,
                                                541,
                                                127
                                            ],
                                            "score": 1.0,
                                            "content": "agent with Llama 3.1 405B Instruct for comparison. The metrics are computed over 1524 partial dialogues from the",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        72,
                                        126,
                                        263,
                                        136
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                72,
                                                126,
                                                263,
                                                136
                                            ],
                                            "score": 1.0,
                                            "content": "test domains. Read full analysis in Section 5.4.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                }
                            ],
                            "index": 2
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                70,
                                137,
                                541,
                                279
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        70,
                                        137,
                                        541,
                                        279
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                137,
                                                541,
                                                279
                                            ],
                                            "score": 0.982,
                                            "html": "<html><body><table><tr><td>Agent (LLM+Nodes)</td><td>G</td><td>Re</td><td>A</td><td>D</td><td>T</td><td>H</td><td>GREADTHScore (HumanRaters)</td></tr><tr><td colspan=\"6\">Reference Comparis0n (GPT-4o-2024-08-06)</td><td></td><td></td></tr><tr><td>Multi-node (O-shot)</td><td>91.3%</td><td>87.1%</td><td>91.4%</td><td>92.7%</td><td>94.3%</td><td>87.2%</td><td>74.9%</td></tr><tr><td colspan=\"6\">Llama-3.1-405B-Instruct</td><td></td><td></td></tr><tr><td>Teacherl:Multi-node (O-shot)</td><td>89.8%</td><td>85.0%</td><td>87.9%</td><td>91.6%</td><td>92.5%</td><td>86.5%</td><td>75.8%</td></tr><tr><td>Single-node (0-shot)</td><td>74.2%</td><td>72.0%</td><td>76.8%</td><td>67.3%</td><td>78.9%</td><td>61.9%</td><td>43.2%</td></tr><tr><td colspan=\"6\">Llama-3.1-8B-Instruct</td><td></td><td></td></tr><tr><td>Multi-node (O-shot)</td><td>75.5%</td><td>57.7%</td><td>72.4%</td><td>74.0%</td><td>76.3%</td><td>60.3%</td><td>36.6%</td></tr><tr><td>Student2: Single-node (0-shot)</td><td>18.8%</td><td>6.2%</td><td>10.9%</td><td>11.6%</td><td>9.4%</td><td>12.7%</td><td>2.0%</td></tr><tr><td>Student2:Single-node (finetuned)</td><td>92.1%</td><td>86.4%</td><td>90.2%</td><td>94.4%</td><td>95.1%</td><td>87.1%</td><td>76.6%</td></tr></table></body></html>",
                                            "type": "table",
                                            "image_path": "989ccb76a278170172a016d5aa602015a026d6fa27ce43f1ca06a37cf520a36b.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 6,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        70,
                                        137,
                                        541,
                                        184.33333333333334
                                    ],
                                    "spans": [],
                                    "index": 5
                                },
                                {
                                    "bbox": [
                                        70,
                                        184.33333333333334,
                                        541,
                                        231.66666666666669
                                    ],
                                    "spans": [],
                                    "index": 6
                                },
                                {
                                    "bbox": [
                                        70,
                                        231.66666666666669,
                                        541,
                                        279.0
                                    ],
                                    "spans": [],
                                    "index": 7
                                }
                            ]
                        }
                    ],
                    "index": 4.0
                },
                {
                    "type": "table",
                    "bbox": [
                        105,
                        374,
                        506,
                        507
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                70,
                                295,
                                540,
                                372
                            ],
                            "group_id": 1,
                            "lines": [
                                {
                                    "bbox": [
                                        71,
                                        297,
                                        541,
                                        309
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                297,
                                                541,
                                                309
                                            ],
                                            "score": 0.992110550403595,
                                            "content": "Table 5: Agent Cost vs. Performance Tradeoff. On the evaluation set, we report the average number of input",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 8
                                },
                                {
                                    "bbox": [
                                        70,
                                        307,
                                        541,
                                        319
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                307,
                                                541,
                                                319
                                            ],
                                            "score": 1.0,
                                            "content": "and output tokens per agent turn, and the average cost per million agent turns, by multiplying the number of tokens",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 9
                                },
                                {
                                    "bbox": [
                                        72,
                                        319,
                                        541,
                                        330
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                72,
                                                319,
                                                541,
                                                330
                                            ],
                                            "score": 1.0,
                                            "content": "with the retail price of the cheapest provider on Openrouter as of October 3rd 2024 ($0.055 per million input/output",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 10
                                },
                                {
                                    "bbox": [
                                        71,
                                        329,
                                        540,
                                        342
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                329,
                                                221,
                                                342
                                            ],
                                            "score": 1.0,
                                            "content": "tokens for Llama-3.1-8B-instruct and",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                221,
                                                329,
                                                244,
                                                339
                                            ],
                                            "score": 0.59,
                                            "content": "\\$1.79",
                                            "type": "inline_equation",
                                            "height": 10,
                                            "width": 23
                                        },
                                        {
                                            "bbox": [
                                                244,
                                                329,
                                                525,
                                                342
                                            ],
                                            "score": 1.0,
                                            "content": " for Llama-3.1-405B-instruct). The cost per million agent turns is only",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                525,
                                                329,
                                                540,
                                                338
                                            ],
                                            "score": 0.32,
                                            "content": "\\$85",
                                            "type": "inline_equation",
                                            "height": 9,
                                            "width": 15
                                        }
                                    ],
                                    "index": 11
                                },
                                {
                                    "bbox": [
                                        70,
                                        339,
                                        541,
                                        352
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                339,
                                                151,
                                                352
                                            ],
                                            "score": 1.0,
                                            "content": "for the Student vs. ",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                152,
                                                340,
                                                184,
                                                350
                                            ],
                                            "score": 0.61,
                                            "content": "\\$28,157",
                                            "type": "inline_equation",
                                            "height": 10,
                                            "width": 32
                                        },
                                        {
                                            "bbox": [
                                                185,
                                                339,
                                                541,
                                                352
                                            ],
                                            "score": 1.0,
                                            "content": "for the Teacher, which represents a factor of 300 in savings. The cost for the Teacher",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 12
                                },
                                {
                                    "bbox": [
                                        70,
                                        351,
                                        542,
                                        363
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                351,
                                                542,
                                                363
                                            ],
                                            "score": 0.9952303767204285,
                                            "content": "agent could be mitigated by prefix caching, but most of the multi-node prompts are context-dependent. Read full",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 13
                                },
                                {
                                    "bbox": [
                                        72,
                                        362,
                                        165,
                                        373
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                72,
                                                362,
                                                165,
                                                373
                                            ],
                                            "score": 1.0,
                                            "content": "analysis in Section 5.4.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 14
                                }
                            ],
                            "index": 11
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                105,
                                374,
                                506,
                                507
                            ],
                            "group_id": 1,
                            "lines": [
                                {
                                    "bbox": [
                                        105,
                                        374,
                                        506,
                                        507
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                105,
                                                374,
                                                506,
                                                507
                                            ],
                                            "score": 0.982,
                                            "html": "<html><body><table><tr><td>Agent (LLM+Nodes)</td><td>Input Tokens /turn</td><td>Output Tokens /turn</td><td>Cost /1M turns</td><td>GREADTH score</td></tr><tr><td colspan=\"5\">Reference Comparison(GPT-4o-2024-08-06)</td></tr><tr><td>Multi-node (O-shot)</td><td>15,431</td><td>526</td><td>$43,837</td><td>74.9%</td></tr><tr><td colspan=\"5\">Llama-3.1-405B-Instruct</td></tr><tr><td>Teacher: Multi-node (O-shot)</td><td>15,189</td><td>541</td><td>$28,157</td><td>75.8%</td></tr><tr><td>Single-node (O-shot)</td><td>1,435</td><td>97</td><td>$2,742</td><td>43.2%</td></tr><tr><td colspan=\"5\">Llama-3.1-8B-Instruct</td></tr><tr><td>Multi-node (O-shot)</td><td>15,189</td><td>541</td><td>$865</td><td>36.6%</td></tr><tr><td>Student:Single-node (0-shot)</td><td>1,437</td><td>208</td><td>$90</td><td>2.0%</td></tr><tr><td>Student:Single-node (finetuned)</td><td>1,441</td><td>110</td><td>$85</td><td>76.6%</td></tr></table></body></html>",
                                            "type": "table",
                                            "image_path": "b6ea8f00a1a96aadebe63222f375a8a3ee788a45b7b780b6354339ca0e98aea1.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 16,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        105,
                                        374,
                                        506,
                                        418.3333333333333
                                    ],
                                    "spans": [],
                                    "index": 15
                                },
                                {
                                    "bbox": [
                                        105,
                                        418.3333333333333,
                                        506,
                                        462.66666666666663
                                    ],
                                    "spans": [],
                                    "index": 16
                                },
                                {
                                    "bbox": [
                                        105,
                                        462.66666666666663,
                                        506,
                                        506.99999999999994
                                    ],
                                    "spans": [],
                                    "index": 17
                                }
                            ]
                        }
                    ],
                    "index": 13.5
                }
            ],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        72,
                        27,
                        143,
                        37
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                26,
                                144,
                                38
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        26,
                                        144,
                                        38
                                    ],
                                    "score": 1.0,
                                    "content": "Technical report",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        751,
                        311,
                        760
                    ],
                    "lines": [
                        {
                            "bbox": [
                                299,
                                751,
                                312,
                                762
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        299,
                                        751,
                                        312,
                                        762
                                    ],
                                    "score": 1.0,
                                    "content": "16",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "table",
                    "bbox": [
                        70,
                        137,
                        541,
                        279
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                70,
                                80,
                                541,
                                135
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        80,
                                        542,
                                        95
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                80,
                                                376,
                                                95
                                            ],
                                            "score": 1.0,
                                            "content": "Table 4: GREADTH Form Filler experiment results. The Teacher",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                376,
                                                82,
                                                380,
                                                90
                                            ],
                                            "score": 0.3,
                                            "content": "^{-1}",
                                            "type": "inline_equation",
                                            "height": 8,
                                            "width": 4
                                        },
                                        {
                                            "bbox": [
                                                381,
                                                80,
                                                542,
                                                95
                                            ],
                                            "score": 1.0,
                                            "content": " is a multi-node agent with Llama 3.1",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        71,
                                        92,
                                        541,
                                        105
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                92,
                                                541,
                                                105
                                            ],
                                            "score": 1.0,
                                            "content": "405B Instruct FP8 as its LLM. The Student2 is a single-node agent with Llama 3.1 8b Instruct as its LLM. We also",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        71,
                                        103,
                                        541,
                                        115
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                103,
                                                541,
                                                115
                                            ],
                                            "score": 1.0,
                                            "content": "evaluate the multi-node agent with GPT-4o and with Llama 3.1 8B Instruct as its LLM, as well as the single-node",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 2
                                },
                                {
                                    "bbox": [
                                        69,
                                        114,
                                        541,
                                        127
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                114,
                                                541,
                                                127
                                            ],
                                            "score": 1.0,
                                            "content": "agent with Llama 3.1 405B Instruct for comparison. The metrics are computed over 1524 partial dialogues from the",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        72,
                                        126,
                                        263,
                                        136
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                72,
                                                126,
                                                263,
                                                136
                                            ],
                                            "score": 1.0,
                                            "content": "test domains. Read full analysis in Section 5.4.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                }
                            ],
                            "index": 2
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                70,
                                137,
                                541,
                                279
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        70,
                                        137,
                                        541,
                                        279
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                137,
                                                541,
                                                279
                                            ],
                                            "score": 0.982,
                                            "html": "<html><body><table><tr><td>Agent (LLM+Nodes)</td><td>G</td><td>Re</td><td>A</td><td>D</td><td>T</td><td>H</td><td>GREADTHScore (HumanRaters)</td></tr><tr><td colspan=\"6\">Reference Comparis0n (GPT-4o-2024-08-06)</td><td></td><td></td></tr><tr><td>Multi-node (O-shot)</td><td>91.3%</td><td>87.1%</td><td>91.4%</td><td>92.7%</td><td>94.3%</td><td>87.2%</td><td>74.9%</td></tr><tr><td colspan=\"6\">Llama-3.1-405B-Instruct</td><td></td><td></td></tr><tr><td>Teacherl:Multi-node (O-shot)</td><td>89.8%</td><td>85.0%</td><td>87.9%</td><td>91.6%</td><td>92.5%</td><td>86.5%</td><td>75.8%</td></tr><tr><td>Single-node (0-shot)</td><td>74.2%</td><td>72.0%</td><td>76.8%</td><td>67.3%</td><td>78.9%</td><td>61.9%</td><td>43.2%</td></tr><tr><td colspan=\"6\">Llama-3.1-8B-Instruct</td><td></td><td></td></tr><tr><td>Multi-node (O-shot)</td><td>75.5%</td><td>57.7%</td><td>72.4%</td><td>74.0%</td><td>76.3%</td><td>60.3%</td><td>36.6%</td></tr><tr><td>Student2: Single-node (0-shot)</td><td>18.8%</td><td>6.2%</td><td>10.9%</td><td>11.6%</td><td>9.4%</td><td>12.7%</td><td>2.0%</td></tr><tr><td>Student2:Single-node (finetuned)</td><td>92.1%</td><td>86.4%</td><td>90.2%</td><td>94.4%</td><td>95.1%</td><td>87.1%</td><td>76.6%</td></tr></table></body></html>",
                                            "type": "table",
                                            "image_path": "989ccb76a278170172a016d5aa602015a026d6fa27ce43f1ca06a37cf520a36b.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 6,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        70,
                                        137,
                                        541,
                                        184.33333333333334
                                    ],
                                    "spans": [],
                                    "index": 5
                                },
                                {
                                    "bbox": [
                                        70,
                                        184.33333333333334,
                                        541,
                                        231.66666666666669
                                    ],
                                    "spans": [],
                                    "index": 6
                                },
                                {
                                    "bbox": [
                                        70,
                                        231.66666666666669,
                                        541,
                                        279.0
                                    ],
                                    "spans": [],
                                    "index": 7
                                }
                            ]
                        }
                    ],
                    "index": 4.0,
                    "page_num": "page_15",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "table",
                    "bbox": [
                        105,
                        374,
                        506,
                        507
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                70,
                                295,
                                540,
                                372
                            ],
                            "group_id": 1,
                            "lines": [
                                {
                                    "bbox": [
                                        71,
                                        297,
                                        541,
                                        309
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                297,
                                                541,
                                                309
                                            ],
                                            "score": 0.992110550403595,
                                            "content": "Table 5: Agent Cost vs. Performance Tradeoff. On the evaluation set, we report the average number of input",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 8
                                },
                                {
                                    "bbox": [
                                        70,
                                        307,
                                        541,
                                        319
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                307,
                                                541,
                                                319
                                            ],
                                            "score": 1.0,
                                            "content": "and output tokens per agent turn, and the average cost per million agent turns, by multiplying the number of tokens",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 9
                                },
                                {
                                    "bbox": [
                                        72,
                                        319,
                                        541,
                                        330
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                72,
                                                319,
                                                541,
                                                330
                                            ],
                                            "score": 1.0,
                                            "content": "with the retail price of the cheapest provider on Openrouter as of October 3rd 2024 ($0.055 per million input/output",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 10
                                },
                                {
                                    "bbox": [
                                        71,
                                        329,
                                        540,
                                        342
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                329,
                                                221,
                                                342
                                            ],
                                            "score": 1.0,
                                            "content": "tokens for Llama-3.1-8B-instruct and",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                221,
                                                329,
                                                244,
                                                339
                                            ],
                                            "score": 0.59,
                                            "content": "\\$1.79",
                                            "type": "inline_equation",
                                            "height": 10,
                                            "width": 23
                                        },
                                        {
                                            "bbox": [
                                                244,
                                                329,
                                                525,
                                                342
                                            ],
                                            "score": 1.0,
                                            "content": " for Llama-3.1-405B-instruct). The cost per million agent turns is only",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                525,
                                                329,
                                                540,
                                                338
                                            ],
                                            "score": 0.32,
                                            "content": "\\$85",
                                            "type": "inline_equation",
                                            "height": 9,
                                            "width": 15
                                        }
                                    ],
                                    "index": 11
                                },
                                {
                                    "bbox": [
                                        70,
                                        339,
                                        541,
                                        352
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                339,
                                                151,
                                                352
                                            ],
                                            "score": 1.0,
                                            "content": "for the Student vs. ",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                152,
                                                340,
                                                184,
                                                350
                                            ],
                                            "score": 0.61,
                                            "content": "\\$28,157",
                                            "type": "inline_equation",
                                            "height": 10,
                                            "width": 32
                                        },
                                        {
                                            "bbox": [
                                                185,
                                                339,
                                                541,
                                                352
                                            ],
                                            "score": 1.0,
                                            "content": "for the Teacher, which represents a factor of 300 in savings. The cost for the Teacher",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 12
                                },
                                {
                                    "bbox": [
                                        70,
                                        351,
                                        542,
                                        363
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                351,
                                                542,
                                                363
                                            ],
                                            "score": 0.9952303767204285,
                                            "content": "agent could be mitigated by prefix caching, but most of the multi-node prompts are context-dependent. Read full",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 13
                                },
                                {
                                    "bbox": [
                                        72,
                                        362,
                                        165,
                                        373
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                72,
                                                362,
                                                165,
                                                373
                                            ],
                                            "score": 1.0,
                                            "content": "analysis in Section 5.4.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 14
                                }
                            ],
                            "index": 11
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                105,
                                374,
                                506,
                                507
                            ],
                            "group_id": 1,
                            "lines": [
                                {
                                    "bbox": [
                                        105,
                                        374,
                                        506,
                                        507
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                105,
                                                374,
                                                506,
                                                507
                                            ],
                                            "score": 0.982,
                                            "html": "<html><body><table><tr><td>Agent (LLM+Nodes)</td><td>Input Tokens /turn</td><td>Output Tokens /turn</td><td>Cost /1M turns</td><td>GREADTH score</td></tr><tr><td colspan=\"5\">Reference Comparison(GPT-4o-2024-08-06)</td></tr><tr><td>Multi-node (O-shot)</td><td>15,431</td><td>526</td><td>$43,837</td><td>74.9%</td></tr><tr><td colspan=\"5\">Llama-3.1-405B-Instruct</td></tr><tr><td>Teacher: Multi-node (O-shot)</td><td>15,189</td><td>541</td><td>$28,157</td><td>75.8%</td></tr><tr><td>Single-node (O-shot)</td><td>1,435</td><td>97</td><td>$2,742</td><td>43.2%</td></tr><tr><td colspan=\"5\">Llama-3.1-8B-Instruct</td></tr><tr><td>Multi-node (O-shot)</td><td>15,189</td><td>541</td><td>$865</td><td>36.6%</td></tr><tr><td>Student:Single-node (0-shot)</td><td>1,437</td><td>208</td><td>$90</td><td>2.0%</td></tr><tr><td>Student:Single-node (finetuned)</td><td>1,441</td><td>110</td><td>$85</td><td>76.6%</td></tr></table></body></html>",
                                            "type": "table",
                                            "image_path": "b6ea8f00a1a96aadebe63222f375a8a3ee788a45b7b780b6354339ca0e98aea1.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 16,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        105,
                                        374,
                                        506,
                                        418.3333333333333
                                    ],
                                    "spans": [],
                                    "index": 15
                                },
                                {
                                    "bbox": [
                                        105,
                                        418.3333333333333,
                                        506,
                                        462.66666666666663
                                    ],
                                    "spans": [],
                                    "index": 16
                                },
                                {
                                    "bbox": [
                                        105,
                                        462.66666666666663,
                                        506,
                                        506.99999999999994
                                    ],
                                    "spans": [],
                                    "index": 17
                                }
                            ]
                        }
                    ],
                    "index": 13.5,
                    "page_num": "page_15",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        533,
                        541,
                        594
                    ],
                    "lines": [],
                    "index": 20,
                    "page_num": "page_15",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        534,
                        541,
                        595
                    ],
                    "lines_deleted": true
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        612,
                        541,
                        732
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                613,
                                540,
                                627
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        613,
                                        540,
                                        627
                                    ],
                                    "score": 1.0,
                                    "content": "Agent Distillation As described in Section 5.3, we construct the Teacher agent by prompting a very",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                70,
                                625,
                                540,
                                639
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        625,
                                        540,
                                        639
                                    ],
                                    "score": 1.0,
                                    "content": "large model, Llama-3.1-405B-Instruct-FP8 (runs on 8 H100-80GB GPUs) with sequential and lengthy in-",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                70,
                                636,
                                541,
                                651
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        636,
                                        541,
                                        651
                                    ],
                                    "score": 1.0,
                                    "content": "structions (multi-node agent) in order to obtain the best GREADTH score, with no regards to prompt",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                69,
                                648,
                                542,
                                663
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        648,
                                        542,
                                        663
                                    ],
                                    "score": 1.0,
                                    "content": "length optimization or latency. From a qualitative perspective, our interaction with the Teacher agent reveals",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                70,
                                661,
                                539,
                                673
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        661,
                                        539,
                                        673
                                    ],
                                    "score": 1.0,
                                    "content": "a generally satisfactory user experience and validates its choice as a Teacher agent. We construct the Stu-",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                71,
                                673,
                                540,
                                685
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        673,
                                        540,
                                        685
                                    ],
                                    "score": 1.0,
                                    "content": "dent agent by combining a much smaller model, Llama-3.1-8B-Instruct model (runs on a single A100-80GB",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                70,
                                685,
                                541,
                                699
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        685,
                                        541,
                                        699
                                    ],
                                    "score": 1.0,
                                    "content": "GPU), with a single-node (single-node agent) optimized for length. We distill the Teacher agent into the",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                70,
                                696,
                                542,
                                711
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        696,
                                        225,
                                        711
                                    ],
                                    "score": 0.9849812388420105,
                                    "content": "Student agent by finetuning it over",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        225,
                                        697,
                                        244,
                                        707
                                    ],
                                    "score": 0.31,
                                    "content": "\\mathbf{13k}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 19
                                },
                                {
                                    "bbox": [
                                        244,
                                        696,
                                        542,
                                        711
                                    ],
                                    "score": 1.0,
                                    "content": " teacher agent turns (continuations) on the training domains. We",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                70,
                                709,
                                541,
                                722
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        709,
                                        541,
                                        722
                                    ],
                                    "score": 1.0,
                                    "content": "perform a single epoch of LoRA (Hu et al., 2021) optimization using AdamW (Loshchilov and Hutter, 2017)",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                70,
                                720,
                                435,
                                734
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        720,
                                        152,
                                        734
                                    ],
                                    "score": 1.0,
                                    "content": "with learning rate ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        153,
                                        721,
                                        173,
                                        730
                                    ],
                                    "score": 0.91,
                                    "content": "10^{-5}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 20
                                },
                                {
                                    "bbox": [
                                        174,
                                        720,
                                        435,
                                        734
                                    ],
                                    "score": 1.0,
                                    "content": " and batch size 32. Additional epochs did not seem to help.",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        }
                    ],
                    "index": 27.5,
                    "page_num": "page_15",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        613,
                        542,
                        734
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "title",
                    "bbox": [
                        204,
                        87,
                        442,
                        98
                    ],
                    "lines": [
                        {
                            "bbox": [
                                204,
                                87,
                                442,
                                98
                            ],
                            "spans": [],
                            "index": 0
                        }
                    ],
                    "index": 0
                },
                {
                    "type": "image",
                    "bbox": [
                        99,
                        92,
                        511,
                        326
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                99,
                                92,
                                511,
                                326
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        206,
                                        88,
                                        440,
                                        99
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                206,
                                                88,
                                                440,
                                                99
                                            ],
                                            "score": 1.0,
                                            "content": "Cost ($) / 1M turns vs. GREADTH Score Tradeoff",
                                            "type": "text"
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        99,
                                        92,
                                        511,
                                        326
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                99,
                                                92,
                                                511,
                                                326
                                            ],
                                            "score": 0.959,
                                            "type": "image",
                                            "image_path": "043a63de58bd4dd1639751efbdb9a75bf63e310e09253a8097274c20653aa8b7.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 2,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        99,
                                        92,
                                        511,
                                        170.0
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        99,
                                        170.0,
                                        511,
                                        248.0
                                    ],
                                    "spans": [],
                                    "index": 2
                                },
                                {
                                    "bbox": [
                                        99,
                                        248.0,
                                        511,
                                        326.0
                                    ],
                                    "spans": [],
                                    "index": 3
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                70,
                                338,
                                541,
                                393
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        71,
                                        339,
                                        541,
                                        352
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                339,
                                                541,
                                                352
                                            ],
                                            "score": 0.9905129075050354,
                                            "content": "Figure 6: Cost per 1M Agent Turns vs. GREADTH Score Tradeoff. The finetuned Student agent (top-left)",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                },
                                {
                                    "bbox": [
                                        71,
                                        350,
                                        541,
                                        363
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                350,
                                                541,
                                                363
                                            ],
                                            "score": 1.0,
                                            "content": "performs on par with the Teacher and reference agents (top-right) for a fraction of the cost. We also provide ablations",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 5
                                },
                                {
                                    "bbox": [
                                        71,
                                        361,
                                        541,
                                        374
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                361,
                                                541,
                                                374
                                            ],
                                            "score": 0.988860547542572,
                                            "content": "for various combinations of LLMs and node fows (single -vs- multi), which shows that finetuning is instrumental in",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 6
                                },
                                {
                                    "bbox": [
                                        70,
                                        372,
                                        541,
                                        384
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                372,
                                                541,
                                                384
                                            ],
                                            "score": 1.0,
                                            "content": "getting the desired performance when using a short and simple LLM prompt (single-node). See Section 5.4 for the",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 7
                                },
                                {
                                    "bbox": [
                                        70,
                                        383,
                                        131,
                                        395
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                383,
                                                131,
                                                395
                                            ],
                                            "score": 1.0,
                                            "content": "full discussion.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 8
                                }
                            ],
                            "index": 6
                        }
                    ],
                    "index": 4.0
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        413,
                        540,
                        461
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                415,
                                540,
                                428
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        415,
                                        540,
                                        428
                                    ],
                                    "score": 1.0,
                                    "content": "Results We evaluate the Teacher and Student agents by generating a single agent turn (continuation) over",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                70,
                                426,
                                540,
                                439
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        426,
                                        540,
                                        439
                                    ],
                                    "score": 1.0,
                                    "content": "a set of 1524 partial dialogues subsampled from the testing domains generated previously. We control for",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                71,
                                438,
                                541,
                                451
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        438,
                                        541,
                                        451
                                    ],
                                    "score": 1.0,
                                    "content": "the diversity of user behaviors (19 mostly uniform) and for the diversity of requested forms (30 forms split",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                71,
                                451,
                                479,
                                462
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        451,
                                        140,
                                        462
                                    ],
                                    "score": 1.0,
                                    "content": "over 3 domains ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        140,
                                        453,
                                        148,
                                        460
                                    ],
                                    "score": 0.52,
                                    "content": "^+",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        149,
                                        451,
                                        479,
                                        462
                                    ],
                                    "score": 1.0,
                                    "content": " dialogues where no form has been selected yet). Here is what we observed:",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        }
                    ],
                    "index": 10.5
                },
                {
                    "type": "text",
                    "bbox": [
                        88,
                        473,
                        542,
                        668
                    ],
                    "lines": [
                        {
                            "bbox": [
                                93,
                                474,
                                542,
                                488
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        93,
                                        474,
                                        346,
                                        488
                                    ],
                                    "score": 1.0,
                                    "content": "1. The Teacher agent achieves a GREADTH Score of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        347,
                                        475,
                                        377,
                                        484
                                    ],
                                    "score": 0.27,
                                    "content": "75.8\\%",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 30
                                },
                                {
                                    "bbox": [
                                        378,
                                        474,
                                        542,
                                        488
                                    ],
                                    "score": 1.0,
                                    "content": " (Table 4) at the expensive cost of",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                106,
                                486,
                                540,
                                499
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        486,
                                        540,
                                        499
                                    ],
                                    "score": 1.0,
                                    "content": "$28,157/1M agent turns (Table 5), due to using a large model and multiple nodes with lengthy",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                106,
                                499,
                                542,
                                512
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        499,
                                        426,
                                        512
                                    ],
                                    "score": 1.0,
                                    "content": "instructions. In comparison, the Student agent achieves an honorable ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        427,
                                        500,
                                        457,
                                        509
                                    ],
                                    "score": 0.41,
                                    "content": "76.6\\%",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 30
                                },
                                {
                                    "bbox": [
                                        457,
                                        499,
                                        542,
                                        512
                                    ],
                                    "score": 1.0,
                                    "content": " GREADTH score",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                106,
                                511,
                                541,
                                523
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        511,
                                        541,
                                        523
                                    ],
                                    "score": 1.0,
                                    "content": "comparable to the Teacher agent but costing only $85/1M agent turns, a factor 300x cheaper,",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                106,
                                522,
                                324,
                                535
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        522,
                                        324,
                                        535
                                    ],
                                    "score": 1.0,
                                    "content": "thanks to shorter instructions and smaller model.",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                93,
                                542,
                                541,
                                555
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        93,
                                        542,
                                        541,
                                        555
                                    ],
                                    "score": 0.9970990419387817,
                                    "content": "2. We also evaluate single-node agents (same as the Student) but with different LMs in a O-shot setting,",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                107,
                                555,
                                540,
                                566
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        555,
                                        372,
                                        566
                                    ],
                                    "score": 0.9924886226654053,
                                    "content": "with no fine-tuning. We achieve GREADTH scores of only",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        372,
                                        555,
                                        399,
                                        564
                                    ],
                                    "score": 0.52,
                                    "content": "43.2\\%",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 27
                                },
                                {
                                    "bbox": [
                                        399,
                                        555,
                                        518,
                                        566
                                    ],
                                    "score": 1.0,
                                    "content": " with Llama-3.1-405B and ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        518,
                                        555,
                                        540,
                                        564
                                    ],
                                    "score": 0.67,
                                    "content": "2.0\\%",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 22
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                106,
                                565,
                                541,
                                580
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        565,
                                        541,
                                        580
                                    ],
                                    "score": 1.0,
                                    "content": "with Llama-3.1-8B. This is not particularly surprising given that the single-node Student agent",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                106,
                                578,
                                541,
                                590
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        578,
                                        541,
                                        590
                                    ],
                                    "score": 1.0,
                                    "content": "prompt is designed for cost optimization over task success, though it is interesting to observe that",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                105,
                                589,
                                542,
                                604
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        589,
                                        258,
                                        604
                                    ],
                                    "score": 1.0,
                                    "content": "the big gap between the two LLMs ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        258,
                                        590,
                                        357,
                                        600
                                    ],
                                    "score": 0.81,
                                    "content": "(43.2\\%-2.0\\%=41.2\\%",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 99
                                },
                                {
                                    "bbox": [
                                        357,
                                        589,
                                        542,
                                        604
                                    ],
                                    "score": 0.9791661500930786,
                                    "content": " points) is entirely closed by the finetuning",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                105,
                                602,
                                396,
                                615
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        602,
                                        254,
                                        615
                                    ],
                                    "score": 0.9724442958831787,
                                    "content": " process (the finetuned Student is",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        254,
                                        603,
                                        275,
                                        612
                                    ],
                                    "score": 0.35,
                                    "content": "0.8\\%",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 21
                                },
                                {
                                    "bbox": [
                                        276,
                                        602,
                                        396,
                                        615
                                    ],
                                    "score": 1.0,
                                    "content": " points above the Teacher).",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                93,
                                621,
                                540,
                                633
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        93,
                                        621,
                                        540,
                                        633
                                    ],
                                    "score": 1.0,
                                    "content": "3. Similarly, we evaluate a multi-node agent (same as the Teacher) but with a small LM (Llama-3.1-8B-",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                106,
                                633,
                                541,
                                646
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        633,
                                        465,
                                        646
                                    ],
                                    "score": 0.9863361120223999,
                                    "content": "Instruct) in a O-shot setting, with no fine-tuning. We observe a large difference of",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        465,
                                        633,
                                        541,
                                        643
                                    ],
                                    "score": 0.81,
                                    "content": "75.8\\%-36.6\\%=",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 76
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                107,
                                646,
                                541,
                                657
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        646,
                                        133,
                                        655
                                    ],
                                    "score": 0.46,
                                    "content": "39.2\\%",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 26
                                },
                                {
                                    "bbox": [
                                        134,
                                        646,
                                        541,
                                        657
                                    ],
                                    "score": 0.9905627965927124,
                                    "content": " points, which mostly confirms that while using the largest models is most crucial in the",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                107,
                                658,
                                512,
                                669
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        658,
                                        512,
                                        669
                                    ],
                                    "score": 0.9959064722061157,
                                    "content": "zero-shot regime, finetuning smaller models can close the gap and generalize across domains.",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        }
                    ],
                    "index": 20
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        682,
                        167,
                        696
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                682,
                                167,
                                696
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        684,
                                        79,
                                        695
                                    ],
                                    "score": 1.0,
                                    "content": "6",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        90,
                                        682,
                                        167,
                                        696
                                    ],
                                    "score": 1.0,
                                    "content": "Related Work",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        }
                    ],
                    "index": 28
                },
                {
                    "type": "text",
                    "bbox": [
                        73,
                        708,
                        541,
                        732
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                708,
                                541,
                                722
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        708,
                                        541,
                                        722
                                    ],
                                    "score": 1.0,
                                    "content": "Autonomous agents aim to tackle complex tasks via self-guided planning and actions in often dynamic",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                72,
                                721,
                                541,
                                733
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        721,
                                        541,
                                        733
                                    ],
                                    "score": 1.0,
                                    "content": "environments (Wang et al., 2024). Several strategies have been introduced to streamline agent’s abilities to",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        }
                    ],
                    "index": 29.5
                }
            ],
            "layout_bboxes": [],
            "page_idx": 16,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [
                {
                    "type": "image",
                    "bbox": [
                        99,
                        92,
                        511,
                        326
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                99,
                                92,
                                511,
                                326
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        206,
                                        88,
                                        440,
                                        99
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                206,
                                                88,
                                                440,
                                                99
                                            ],
                                            "score": 1.0,
                                            "content": "Cost ($) / 1M turns vs. GREADTH Score Tradeoff",
                                            "type": "text"
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        99,
                                        92,
                                        511,
                                        326
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                99,
                                                92,
                                                511,
                                                326
                                            ],
                                            "score": 0.959,
                                            "type": "image",
                                            "image_path": "043a63de58bd4dd1639751efbdb9a75bf63e310e09253a8097274c20653aa8b7.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 2,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        99,
                                        92,
                                        511,
                                        170.0
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        99,
                                        170.0,
                                        511,
                                        248.0
                                    ],
                                    "spans": [],
                                    "index": 2
                                },
                                {
                                    "bbox": [
                                        99,
                                        248.0,
                                        511,
                                        326.0
                                    ],
                                    "spans": [],
                                    "index": 3
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                70,
                                338,
                                541,
                                393
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        71,
                                        339,
                                        541,
                                        352
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                339,
                                                541,
                                                352
                                            ],
                                            "score": 0.9905129075050354,
                                            "content": "Figure 6: Cost per 1M Agent Turns vs. GREADTH Score Tradeoff. The finetuned Student agent (top-left)",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                },
                                {
                                    "bbox": [
                                        71,
                                        350,
                                        541,
                                        363
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                350,
                                                541,
                                                363
                                            ],
                                            "score": 1.0,
                                            "content": "performs on par with the Teacher and reference agents (top-right) for a fraction of the cost. We also provide ablations",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 5
                                },
                                {
                                    "bbox": [
                                        71,
                                        361,
                                        541,
                                        374
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                361,
                                                541,
                                                374
                                            ],
                                            "score": 0.988860547542572,
                                            "content": "for various combinations of LLMs and node fows (single -vs- multi), which shows that finetuning is instrumental in",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 6
                                },
                                {
                                    "bbox": [
                                        70,
                                        372,
                                        541,
                                        384
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                372,
                                                541,
                                                384
                                            ],
                                            "score": 1.0,
                                            "content": "getting the desired performance when using a short and simple LLM prompt (single-node). See Section 5.4 for the",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 7
                                },
                                {
                                    "bbox": [
                                        70,
                                        383,
                                        131,
                                        395
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                383,
                                                131,
                                                395
                                            ],
                                            "score": 1.0,
                                            "content": "full discussion.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 8
                                }
                            ],
                            "index": 6
                        }
                    ],
                    "index": 4.0
                }
            ],
            "tables": [],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        71,
                        27,
                        143,
                        36
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                26,
                                144,
                                37
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        26,
                                        144,
                                        37
                                    ],
                                    "score": 1.0,
                                    "content": "Technical report",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        751,
                        311,
                        760
                    ],
                    "lines": [
                        {
                            "bbox": [
                                299,
                                751,
                                312,
                                762
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        299,
                                        751,
                                        312,
                                        762
                                    ],
                                    "score": 1.0,
                                    "content": "17",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "title",
                    "bbox": [
                        204,
                        87,
                        442,
                        98
                    ],
                    "lines": [
                        {
                            "bbox": [
                                204,
                                87,
                                442,
                                98
                            ],
                            "spans": [],
                            "index": 0
                        }
                    ],
                    "index": 0,
                    "page_num": "page_16",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "image",
                    "bbox": [
                        99,
                        92,
                        511,
                        326
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                99,
                                92,
                                511,
                                326
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        206,
                                        88,
                                        440,
                                        99
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                206,
                                                88,
                                                440,
                                                99
                                            ],
                                            "score": 1.0,
                                            "content": "Cost ($) / 1M turns vs. GREADTH Score Tradeoff",
                                            "type": "text"
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        99,
                                        92,
                                        511,
                                        326
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                99,
                                                92,
                                                511,
                                                326
                                            ],
                                            "score": 0.959,
                                            "type": "image",
                                            "image_path": "043a63de58bd4dd1639751efbdb9a75bf63e310e09253a8097274c20653aa8b7.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 2,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        99,
                                        92,
                                        511,
                                        170.0
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        99,
                                        170.0,
                                        511,
                                        248.0
                                    ],
                                    "spans": [],
                                    "index": 2
                                },
                                {
                                    "bbox": [
                                        99,
                                        248.0,
                                        511,
                                        326.0
                                    ],
                                    "spans": [],
                                    "index": 3
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                70,
                                338,
                                541,
                                393
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        71,
                                        339,
                                        541,
                                        352
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                339,
                                                541,
                                                352
                                            ],
                                            "score": 0.9905129075050354,
                                            "content": "Figure 6: Cost per 1M Agent Turns vs. GREADTH Score Tradeoff. The finetuned Student agent (top-left)",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                },
                                {
                                    "bbox": [
                                        71,
                                        350,
                                        541,
                                        363
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                350,
                                                541,
                                                363
                                            ],
                                            "score": 1.0,
                                            "content": "performs on par with the Teacher and reference agents (top-right) for a fraction of the cost. We also provide ablations",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 5
                                },
                                {
                                    "bbox": [
                                        71,
                                        361,
                                        541,
                                        374
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                361,
                                                541,
                                                374
                                            ],
                                            "score": 0.988860547542572,
                                            "content": "for various combinations of LLMs and node fows (single -vs- multi), which shows that finetuning is instrumental in",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 6
                                },
                                {
                                    "bbox": [
                                        70,
                                        372,
                                        541,
                                        384
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                372,
                                                541,
                                                384
                                            ],
                                            "score": 1.0,
                                            "content": "getting the desired performance when using a short and simple LLM prompt (single-node). See Section 5.4 for the",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 7
                                },
                                {
                                    "bbox": [
                                        70,
                                        383,
                                        131,
                                        395
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                383,
                                                131,
                                                395
                                            ],
                                            "score": 1.0,
                                            "content": "full discussion.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 8
                                }
                            ],
                            "index": 6
                        }
                    ],
                    "index": 4.0,
                    "page_num": "page_16",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        413,
                        540,
                        461
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                415,
                                540,
                                428
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        415,
                                        540,
                                        428
                                    ],
                                    "score": 1.0,
                                    "content": "Results We evaluate the Teacher and Student agents by generating a single agent turn (continuation) over",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                70,
                                426,
                                540,
                                439
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        426,
                                        540,
                                        439
                                    ],
                                    "score": 1.0,
                                    "content": "a set of 1524 partial dialogues subsampled from the testing domains generated previously. We control for",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                71,
                                438,
                                541,
                                451
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        438,
                                        541,
                                        451
                                    ],
                                    "score": 1.0,
                                    "content": "the diversity of user behaviors (19 mostly uniform) and for the diversity of requested forms (30 forms split",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                71,
                                451,
                                479,
                                462
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        451,
                                        140,
                                        462
                                    ],
                                    "score": 1.0,
                                    "content": "over 3 domains ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        140,
                                        453,
                                        148,
                                        460
                                    ],
                                    "score": 0.52,
                                    "content": "^+",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        149,
                                        451,
                                        479,
                                        462
                                    ],
                                    "score": 1.0,
                                    "content": " dialogues where no form has been selected yet). Here is what we observed:",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        }
                    ],
                    "index": 10.5,
                    "page_num": "page_16",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        415,
                        541,
                        462
                    ]
                },
                {
                    "type": "list",
                    "bbox": [
                        88,
                        473,
                        542,
                        668
                    ],
                    "lines": [
                        {
                            "bbox": [
                                93,
                                474,
                                542,
                                488
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        93,
                                        474,
                                        346,
                                        488
                                    ],
                                    "score": 1.0,
                                    "content": "1. The Teacher agent achieves a GREADTH Score of ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        347,
                                        475,
                                        377,
                                        484
                                    ],
                                    "score": 0.27,
                                    "content": "75.8\\%",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 30
                                },
                                {
                                    "bbox": [
                                        378,
                                        474,
                                        542,
                                        488
                                    ],
                                    "score": 1.0,
                                    "content": " (Table 4) at the expensive cost of",
                                    "type": "text"
                                }
                            ],
                            "index": 13,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                106,
                                486,
                                540,
                                499
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        486,
                                        540,
                                        499
                                    ],
                                    "score": 1.0,
                                    "content": "$28,157/1M agent turns (Table 5), due to using a large model and multiple nodes with lengthy",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                106,
                                499,
                                542,
                                512
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        499,
                                        426,
                                        512
                                    ],
                                    "score": 1.0,
                                    "content": "instructions. In comparison, the Student agent achieves an honorable ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        427,
                                        500,
                                        457,
                                        509
                                    ],
                                    "score": 0.41,
                                    "content": "76.6\\%",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 30
                                },
                                {
                                    "bbox": [
                                        457,
                                        499,
                                        542,
                                        512
                                    ],
                                    "score": 1.0,
                                    "content": " GREADTH score",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                106,
                                511,
                                541,
                                523
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        511,
                                        541,
                                        523
                                    ],
                                    "score": 1.0,
                                    "content": "comparable to the Teacher agent but costing only $85/1M agent turns, a factor 300x cheaper,",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                106,
                                522,
                                324,
                                535
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        522,
                                        324,
                                        535
                                    ],
                                    "score": 1.0,
                                    "content": "thanks to shorter instructions and smaller model.",
                                    "type": "text"
                                }
                            ],
                            "index": 17,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                93,
                                542,
                                541,
                                555
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        93,
                                        542,
                                        541,
                                        555
                                    ],
                                    "score": 0.9970990419387817,
                                    "content": "2. We also evaluate single-node agents (same as the Student) but with different LMs in a O-shot setting,",
                                    "type": "text"
                                }
                            ],
                            "index": 18,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                107,
                                555,
                                540,
                                566
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        555,
                                        372,
                                        566
                                    ],
                                    "score": 0.9924886226654053,
                                    "content": "with no fine-tuning. We achieve GREADTH scores of only",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        372,
                                        555,
                                        399,
                                        564
                                    ],
                                    "score": 0.52,
                                    "content": "43.2\\%",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 27
                                },
                                {
                                    "bbox": [
                                        399,
                                        555,
                                        518,
                                        566
                                    ],
                                    "score": 1.0,
                                    "content": " with Llama-3.1-405B and ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        518,
                                        555,
                                        540,
                                        564
                                    ],
                                    "score": 0.67,
                                    "content": "2.0\\%",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 22
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                106,
                                565,
                                541,
                                580
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        565,
                                        541,
                                        580
                                    ],
                                    "score": 1.0,
                                    "content": "with Llama-3.1-8B. This is not particularly surprising given that the single-node Student agent",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                106,
                                578,
                                541,
                                590
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        578,
                                        541,
                                        590
                                    ],
                                    "score": 1.0,
                                    "content": "prompt is designed for cost optimization over task success, though it is interesting to observe that",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                105,
                                589,
                                542,
                                604
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        589,
                                        258,
                                        604
                                    ],
                                    "score": 1.0,
                                    "content": "the big gap between the two LLMs ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        258,
                                        590,
                                        357,
                                        600
                                    ],
                                    "score": 0.81,
                                    "content": "(43.2\\%-2.0\\%=41.2\\%",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 99
                                },
                                {
                                    "bbox": [
                                        357,
                                        589,
                                        542,
                                        604
                                    ],
                                    "score": 0.9791661500930786,
                                    "content": " points) is entirely closed by the finetuning",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                105,
                                602,
                                396,
                                615
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        602,
                                        254,
                                        615
                                    ],
                                    "score": 0.9724442958831787,
                                    "content": " process (the finetuned Student is",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        254,
                                        603,
                                        275,
                                        612
                                    ],
                                    "score": 0.35,
                                    "content": "0.8\\%",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 21
                                },
                                {
                                    "bbox": [
                                        276,
                                        602,
                                        396,
                                        615
                                    ],
                                    "score": 1.0,
                                    "content": " points above the Teacher).",
                                    "type": "text"
                                }
                            ],
                            "index": 23,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                93,
                                621,
                                540,
                                633
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        93,
                                        621,
                                        540,
                                        633
                                    ],
                                    "score": 1.0,
                                    "content": "3. Similarly, we evaluate a multi-node agent (same as the Teacher) but with a small LM (Llama-3.1-8B-",
                                    "type": "text"
                                }
                            ],
                            "index": 24,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                106,
                                633,
                                541,
                                646
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        633,
                                        465,
                                        646
                                    ],
                                    "score": 0.9863361120223999,
                                    "content": "Instruct) in a O-shot setting, with no fine-tuning. We observe a large difference of",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        465,
                                        633,
                                        541,
                                        643
                                    ],
                                    "score": 0.81,
                                    "content": "75.8\\%-36.6\\%=",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 76
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                107,
                                646,
                                541,
                                657
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        646,
                                        133,
                                        655
                                    ],
                                    "score": 0.46,
                                    "content": "39.2\\%",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 26
                                },
                                {
                                    "bbox": [
                                        134,
                                        646,
                                        541,
                                        657
                                    ],
                                    "score": 0.9905627965927124,
                                    "content": " points, which mostly confirms that while using the largest models is most crucial in the",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                107,
                                658,
                                512,
                                669
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        658,
                                        512,
                                        669
                                    ],
                                    "score": 0.9959064722061157,
                                    "content": "zero-shot regime, finetuning smaller models can close the gap and generalize across domains.",
                                    "type": "text"
                                }
                            ],
                            "index": 27,
                            "is_list_end_line": true
                        }
                    ],
                    "index": 20,
                    "page_num": "page_16",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        93,
                        474,
                        542,
                        669
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        682,
                        167,
                        696
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                682,
                                167,
                                696
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        684,
                                        79,
                                        695
                                    ],
                                    "score": 1.0,
                                    "content": "6",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        90,
                                        682,
                                        167,
                                        696
                                    ],
                                    "score": 1.0,
                                    "content": "Related Work",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        }
                    ],
                    "index": 28,
                    "page_num": "page_16",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        73,
                        708,
                        541,
                        732
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                708,
                                541,
                                722
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        708,
                                        541,
                                        722
                                    ],
                                    "score": 1.0,
                                    "content": "Autonomous agents aim to tackle complex tasks via self-guided planning and actions in often dynamic",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                72,
                                721,
                                541,
                                733
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        721,
                                        541,
                                        733
                                    ],
                                    "score": 1.0,
                                    "content": "environments (Wang et al., 2024). Several strategies have been introduced to streamline agent’s abilities to",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                71,
                                84,
                                540,
                                96
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        84,
                                        540,
                                        96
                                    ],
                                    "score": 1.0,
                                    "content": "accomplish their objectives. One tried-and-true strategy to enhance the reasoning capabilities involves meta-",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                70,
                                95,
                                541,
                                108
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        95,
                                        541,
                                        108
                                    ],
                                    "score": 0.9931671023368835,
                                    "content": "reasoning where the agent is instructed to generate reasoning traces and plans prior to arriving at a final",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                70,
                                106,
                                541,
                                120
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        106,
                                        541,
                                        120
                                    ],
                                    "score": 1.0,
                                    "content": "decision (Yao et al., 2023c). Another prominent strategy hinges on improving the agent’s ability to conduct",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                71,
                                119,
                                540,
                                132
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        119,
                                        540,
                                        132
                                    ],
                                    "score": 1.0,
                                    "content": "self-diagnosis (Xie et al., 2023; Kim et al., 2023; Shinn et al., 2024; Chen et al., 2024). Combining both",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                71,
                                132,
                                540,
                                144
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        132,
                                        540,
                                        144
                                    ],
                                    "score": 0.9920036792755127,
                                    "content": "strategies to find a success path from different reasoning paths and self-evaluating choices has also proven",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                71,
                                144,
                                540,
                                155
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        144,
                                        540,
                                        155
                                    ],
                                    "score": 0.987678587436676,
                                    "content": "effective (Yao et al., 2023a). TapeAgents offers a holistic solution for seamlessly integrating these paradigms",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                70,
                                155,
                                541,
                                168
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        155,
                                        541,
                                        168
                                    ],
                                    "score": 1.0,
                                    "content": "into agent behavior. In particular, Steps in TapeAgents represents planning and reasoning traces that guide",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                70,
                                167,
                                540,
                                180
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        167,
                                        540,
                                        180
                                    ],
                                    "score": 1.0,
                                    "content": "the agent’s actions and Nodes can be used for self-evaluation. Finally, Tapes serves as an abstraction for",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                71,
                                180,
                                540,
                                191
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        180,
                                        540,
                                        191
                                    ],
                                    "score": 1.0,
                                    "content": "memory that logs agent’s internal thought process and interactions with the environment. In this section, we",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                70,
                                190,
                                538,
                                204
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        190,
                                        538,
                                        204
                                    ],
                                    "score": 1.0,
                                    "content": "provide a detailed overview of existing agentic frameworks and examine how they compare to TapeAgents.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 9
                        }
                    ],
                    "index": 29.5,
                    "page_num": "page_16",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        71,
                        708,
                        541,
                        733
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        71,
                        82,
                        540,
                        201
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                84,
                                540,
                                96
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        84,
                                        540,
                                        96
                                    ],
                                    "score": 1.0,
                                    "content": "accomplish their objectives. One tried-and-true strategy to enhance the reasoning capabilities involves meta-",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                70,
                                95,
                                541,
                                108
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        95,
                                        541,
                                        108
                                    ],
                                    "score": 0.9931671023368835,
                                    "content": "reasoning where the agent is instructed to generate reasoning traces and plans prior to arriving at a final",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                70,
                                106,
                                541,
                                120
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        106,
                                        541,
                                        120
                                    ],
                                    "score": 1.0,
                                    "content": "decision (Yao et al., 2023c). Another prominent strategy hinges on improving the agent’s ability to conduct",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                71,
                                119,
                                540,
                                132
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        119,
                                        540,
                                        132
                                    ],
                                    "score": 1.0,
                                    "content": "self-diagnosis (Xie et al., 2023; Kim et al., 2023; Shinn et al., 2024; Chen et al., 2024). Combining both",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                71,
                                132,
                                540,
                                144
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        132,
                                        540,
                                        144
                                    ],
                                    "score": 0.9920036792755127,
                                    "content": "strategies to find a success path from different reasoning paths and self-evaluating choices has also proven",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                71,
                                144,
                                540,
                                155
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        144,
                                        540,
                                        155
                                    ],
                                    "score": 0.987678587436676,
                                    "content": "effective (Yao et al., 2023a). TapeAgents offers a holistic solution for seamlessly integrating these paradigms",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                70,
                                155,
                                541,
                                168
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        155,
                                        541,
                                        168
                                    ],
                                    "score": 1.0,
                                    "content": "into agent behavior. In particular, Steps in TapeAgents represents planning and reasoning traces that guide",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                70,
                                167,
                                540,
                                180
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        167,
                                        540,
                                        180
                                    ],
                                    "score": 1.0,
                                    "content": "the agent’s actions and Nodes can be used for self-evaluation. Finally, Tapes serves as an abstraction for",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                71,
                                180,
                                540,
                                191
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        180,
                                        540,
                                        191
                                    ],
                                    "score": 1.0,
                                    "content": "memory that logs agent’s internal thought process and interactions with the environment. In this section, we",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                70,
                                190,
                                538,
                                204
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        190,
                                        538,
                                        204
                                    ],
                                    "score": 1.0,
                                    "content": "provide a detailed overview of existing agentic frameworks and examine how they compare to TapeAgents.",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        }
                    ],
                    "index": 4.5
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        208,
                        540,
                        279
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                209,
                                540,
                                221
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        209,
                                        540,
                                        221
                                    ],
                                    "score": 1.0,
                                    "content": "Among the developer-oriented frameworks most similar to TapeAgents are LangGraph (Chase, 2023) and",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                71,
                                220,
                                541,
                                234
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        220,
                                        541,
                                        234
                                    ],
                                    "score": 1.0,
                                    "content": "AutoGen (Wu et al., 2024a). In LangGraph, one builds the agent at a very low-level as a concurrent",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                71,
                                232,
                                541,
                                246
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        232,
                                        541,
                                        246
                                    ],
                                    "score": 0.9887656569480896,
                                    "content": "graph-based state machine. AutoGen offers a high-level paradigm to build multi-agent teams. TapeAgents",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                71,
                                244,
                                541,
                                257
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        244,
                                        541,
                                        257
                                    ],
                                    "score": 1.0,
                                    "content": "combines the best of these two worlds, as it allows both the low-level control and the implementation of",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                70,
                                255,
                                541,
                                270
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        255,
                                        541,
                                        270
                                    ],
                                    "score": 1.0,
                                    "content": "higher-level low-code paradigms like AutoGen. Neither LangGraph nor AutoGen are designed with agent",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                71,
                                269,
                                168,
                                281
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        269,
                                        168,
                                        281
                                    ],
                                    "score": 1.0,
                                    "content": "optimization in mind.",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        }
                    ],
                    "index": 12.5
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        285,
                        541,
                        417
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                286,
                                540,
                                299
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        286,
                                        540,
                                        299
                                    ],
                                    "score": 1.0,
                                    "content": "On the other side of the spectrum are AI frameworks that have recently demonstrated techniques to automat-",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                70,
                                298,
                                542,
                                311
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        298,
                                        542,
                                        311
                                    ],
                                    "score": 0.9923496246337891,
                                    "content": "ically optimize prompts and tweak other aspects of agent configuration, such as the fow or the assignment of",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                71,
                                311,
                                540,
                                322
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        311,
                                        540,
                                        322
                                    ],
                                    "score": 1.0,
                                    "content": "tools to the agents. Solutions using DSPy (Khattab et al., 2023b) and TextGrad (Yuksekgonul et al., 2024)",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                70,
                                322,
                                541,
                                335
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        322,
                                        541,
                                        335
                                    ],
                                    "score": 1.0,
                                    "content": "attain higher performance compared to human prompt engineering. AgentOptimizer (Zhang et al., 2024)",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                71,
                                333,
                                540,
                                347
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        333,
                                        540,
                                        347
                                    ],
                                    "score": 1.0,
                                    "content": "and agent symbolic learning (Zhou et al., 2024) enable improving agent tools and pipelines. Meta-Agent",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                70,
                                345,
                                541,
                                359
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        345,
                                        541,
                                        359
                                    ],
                                    "score": 1.0,
                                    "content": "Search (Hu et al., 2024) aims to create the best multi-agent architecture. The rich metadata that links the",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                71,
                                359,
                                540,
                                370
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        359,
                                        540,
                                        370
                                    ],
                                    "score": 0.9761947393417358,
                                    "content": "tape with the agent configuration in TapeAgents provides a perfect medium for implementing agent opti-",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                70,
                                370,
                                542,
                                383
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        370,
                                        542,
                                        383
                                    ],
                                    "score": 1.0,
                                    "content": "mization algorithms like the ones from the above works. Notably, DSPy and TextGrad implement control",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                70,
                                382,
                                542,
                                395
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        382,
                                        542,
                                        395
                                    ],
                                    "score": 0.9929314255714417,
                                    "content": "fow in pure Python, which created challenges for resuming the agent from a persistent session state. In",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                71,
                                393,
                                541,
                                407
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        393,
                                        541,
                                        407
                                    ],
                                    "score": 0.9941158294677734,
                                    "content": "TapeAgents, developers can freely use Python within one node, but between-node control fow is handled by",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                70,
                                406,
                                414,
                                420
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        406,
                                        414,
                                        420
                                    ],
                                    "score": 1.0,
                                    "content": "adding steps to the tape, which makes the tape perfect for session persistence.",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        }
                    ],
                    "index": 21
                },
                {
                    "type": "title",
                    "bbox": [
                        70,
                        430,
                        346,
                        442
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                430,
                                345,
                                444
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        430,
                                        345,
                                        444
                                    ],
                                    "score": 1.0,
                                    "content": "6.1 Detailed comparison with LangGraph, AutoGen, DSPy",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        }
                    ],
                    "index": 27
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        451,
                        541,
                        499
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                452,
                                541,
                                466
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        452,
                                        541,
                                        466
                                    ],
                                    "score": 1.0,
                                    "content": "To show that TapeAgents is uniquely holistic in targeting all stages of LLM agent lifecycle, we present a more",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                70,
                                464,
                                540,
                                478
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        464,
                                        540,
                                        478
                                    ],
                                    "score": 1.0,
                                    "content": "detailed side-by-side comparison of TapeAgents with three particularly popular frameworks: LangGraph,",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                70,
                                475,
                                541,
                                490
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        475,
                                        110,
                                        490
                                    ],
                                    "score": 1.0,
                                    "content": "AutoGen",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        111,
                                        477,
                                        115,
                                        486
                                    ],
                                    "score": 0.32,
                                    "content": "^{9}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 4
                                },
                                {
                                    "bbox": [
                                        115,
                                        475,
                                        541,
                                        490
                                    ],
                                    "score": 0.9941114187240601,
                                    "content": " and DSPy. We focus on the following seven axis that are particularly helpful to differentiate these",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                70,
                                488,
                                125,
                                501
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        488,
                                        125,
                                        501
                                    ],
                                    "score": 1.0,
                                    "content": "frameworks:",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        }
                    ],
                    "index": 29.5
                },
                {
                    "type": "text",
                    "bbox": [
                        92,
                        511,
                        542,
                        706
                    ],
                    "lines": [
                        {
                            "bbox": [
                                93,
                                513,
                                540,
                                526
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        93,
                                        513,
                                        540,
                                        526
                                    ],
                                    "score": 1.0,
                                    "content": "1. Building from Components while Allowing Finegrained Flow Control All the frame-",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                107,
                                525,
                                541,
                                538
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        525,
                                        541,
                                        538
                                    ],
                                    "score": 1.0,
                                    "content": "works we compare here allow building agentic systems from components, which are called agents in",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                106,
                                537,
                                541,
                                550
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        537,
                                        541,
                                        550
                                    ],
                                    "score": 1.0,
                                    "content": "TapeAgents and AutoGen, subgraphs in LangGraph, predictors in DSPy. TapeAgents and Lang-",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                106,
                                548,
                                541,
                                562
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        548,
                                        541,
                                        562
                                    ],
                                    "score": 0.9928389191627502,
                                    "content": "Graph additionally offer fine-grainted control fow inside each module via nodes and transition",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                106,
                                561,
                                542,
                                574
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        561,
                                        542,
                                        574
                                    ],
                                    "score": 1.0,
                                    "content": "between them. To have the same level of control in AutoGen, one must write long non-resumable",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                106,
                                573,
                                207,
                                585
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        573,
                                        207,
                                        585
                                    ],
                                    "score": 1.0,
                                    "content": "blocks of Python code.",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                93,
                                592,
                                542,
                                606
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        93,
                                        592,
                                        542,
                                        606
                                    ],
                                    "score": 1.0,
                                    "content": "2. Native Streaming Support LangGraph and TapeAgents natively support response streaming",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                107,
                                605,
                                541,
                                618
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        605,
                                        541,
                                        618
                                    ],
                                    "score": 1.0,
                                    "content": "by propagating intermediate event loops through the orchestration loops. Streaming support for",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                106,
                                615,
                                430,
                                630
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        615,
                                        430,
                                        630
                                    ],
                                    "score": 1.0,
                                    "content": "AutoGen agents requires substantial change to the agent implementation.",
                                    "type": "text"
                                }
                            ],
                            "index": 40
                        },
                        {
                            "bbox": [
                                93,
                                635,
                                541,
                                648
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        93,
                                        635,
                                        541,
                                        648
                                    ],
                                    "score": 1.0,
                                    "content": "3. Concurrent LLM Calls LangGraph state-machine natively supports concurrent node execution,",
                                    "type": "text"
                                }
                            ],
                            "index": 41
                        },
                        {
                            "bbox": [
                                107,
                                648,
                                541,
                                659
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        648,
                                        541,
                                        659
                                    ],
                                    "score": 1.0,
                                    "content": "which allows one to make concurrent LLM Calls. At the moment the agent in TapeAgents can only",
                                    "type": "text"
                                }
                            ],
                            "index": 42
                        },
                        {
                            "bbox": [
                                106,
                                660,
                                541,
                                671
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        660,
                                        541,
                                        671
                                    ],
                                    "score": 1.0,
                                    "content": "run one node of one agent at a time. We have a plan on how to address this limitation, see Section 7",
                                    "type": "text"
                                }
                            ],
                            "index": 43
                        },
                        {
                            "bbox": [
                                106,
                                670,
                                541,
                                685
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        670,
                                        541,
                                        685
                                    ],
                                    "score": 1.0,
                                    "content": "for details. We believe AutoGen also has no intra-agent concurrency at the framework level. DSPy",
                                    "type": "text"
                                }
                            ],
                            "index": 44
                        },
                        {
                            "bbox": [
                                107,
                                684,
                                541,
                                695
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        684,
                                        541,
                                        695
                                    ],
                                    "score": 1.0,
                                    "content": "users orchestrate DSPy modules with Python code, hence they can use Python multithreading to",
                                    "type": "text"
                                }
                            ],
                            "index": 45
                        },
                        {
                            "bbox": [
                                106,
                                694,
                                261,
                                708
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        694,
                                        261,
                                        708
                                    ],
                                    "score": 1.0,
                                    "content": "run multiple modules concurrently.",
                                    "type": "text"
                                }
                            ],
                            "index": 46
                        }
                    ],
                    "index": 39
                }
            ],
            "layout_bboxes": [],
            "page_idx": 17,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        72,
                        712,
                        540,
                        732
                    ],
                    "lines": [
                        {
                            "bbox": [
                                79,
                                711,
                                542,
                                726
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        711,
                                        542,
                                        726
                                    ],
                                    "score": 1.0,
                                    "content": "9A new AutoGen 0.4 version with major changes came out when we were writing this report. The comparison below is based",
                                    "type": "text"
                                }
                            ]
                        },
                        {
                            "bbox": [
                                71,
                                723,
                                140,
                                734
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        723,
                                        140,
                                        734
                                    ],
                                    "score": 1.0,
                                    "content": "on a prior version.",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        72,
                        27,
                        143,
                        37
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                26,
                                144,
                                38
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        26,
                                        144,
                                        38
                                    ],
                                    "score": 1.0,
                                    "content": "Technical report",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        751,
                        311,
                        760
                    ],
                    "lines": [
                        {
                            "bbox": [
                                299,
                                751,
                                312,
                                762
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        299,
                                        751,
                                        312,
                                        762
                                    ],
                                    "score": 1.0,
                                    "content": "18",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        71,
                        82,
                        540,
                        201
                    ],
                    "lines": [],
                    "index": 4.5,
                    "page_num": "page_17",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        84,
                        541,
                        204
                    ],
                    "lines_deleted": true
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        208,
                        540,
                        279
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                209,
                                540,
                                221
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        209,
                                        540,
                                        221
                                    ],
                                    "score": 1.0,
                                    "content": "Among the developer-oriented frameworks most similar to TapeAgents are LangGraph (Chase, 2023) and",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                71,
                                220,
                                541,
                                234
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        220,
                                        541,
                                        234
                                    ],
                                    "score": 1.0,
                                    "content": "AutoGen (Wu et al., 2024a). In LangGraph, one builds the agent at a very low-level as a concurrent",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                71,
                                232,
                                541,
                                246
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        232,
                                        541,
                                        246
                                    ],
                                    "score": 0.9887656569480896,
                                    "content": "graph-based state machine. AutoGen offers a high-level paradigm to build multi-agent teams. TapeAgents",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                71,
                                244,
                                541,
                                257
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        244,
                                        541,
                                        257
                                    ],
                                    "score": 1.0,
                                    "content": "combines the best of these two worlds, as it allows both the low-level control and the implementation of",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                70,
                                255,
                                541,
                                270
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        255,
                                        541,
                                        270
                                    ],
                                    "score": 1.0,
                                    "content": "higher-level low-code paradigms like AutoGen. Neither LangGraph nor AutoGen are designed with agent",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                71,
                                269,
                                168,
                                281
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        269,
                                        168,
                                        281
                                    ],
                                    "score": 1.0,
                                    "content": "optimization in mind.",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        }
                    ],
                    "index": 12.5,
                    "page_num": "page_17",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        209,
                        541,
                        281
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        285,
                        541,
                        417
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                286,
                                540,
                                299
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        286,
                                        540,
                                        299
                                    ],
                                    "score": 1.0,
                                    "content": "On the other side of the spectrum are AI frameworks that have recently demonstrated techniques to automat-",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                70,
                                298,
                                542,
                                311
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        298,
                                        542,
                                        311
                                    ],
                                    "score": 0.9923496246337891,
                                    "content": "ically optimize prompts and tweak other aspects of agent configuration, such as the fow or the assignment of",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                71,
                                311,
                                540,
                                322
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        311,
                                        540,
                                        322
                                    ],
                                    "score": 1.0,
                                    "content": "tools to the agents. Solutions using DSPy (Khattab et al., 2023b) and TextGrad (Yuksekgonul et al., 2024)",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                70,
                                322,
                                541,
                                335
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        322,
                                        541,
                                        335
                                    ],
                                    "score": 1.0,
                                    "content": "attain higher performance compared to human prompt engineering. AgentOptimizer (Zhang et al., 2024)",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                71,
                                333,
                                540,
                                347
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        333,
                                        540,
                                        347
                                    ],
                                    "score": 1.0,
                                    "content": "and agent symbolic learning (Zhou et al., 2024) enable improving agent tools and pipelines. Meta-Agent",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                70,
                                345,
                                541,
                                359
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        345,
                                        541,
                                        359
                                    ],
                                    "score": 1.0,
                                    "content": "Search (Hu et al., 2024) aims to create the best multi-agent architecture. The rich metadata that links the",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                71,
                                359,
                                540,
                                370
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        359,
                                        540,
                                        370
                                    ],
                                    "score": 0.9761947393417358,
                                    "content": "tape with the agent configuration in TapeAgents provides a perfect medium for implementing agent opti-",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                70,
                                370,
                                542,
                                383
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        370,
                                        542,
                                        383
                                    ],
                                    "score": 1.0,
                                    "content": "mization algorithms like the ones from the above works. Notably, DSPy and TextGrad implement control",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                70,
                                382,
                                542,
                                395
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        382,
                                        542,
                                        395
                                    ],
                                    "score": 0.9929314255714417,
                                    "content": "fow in pure Python, which created challenges for resuming the agent from a persistent session state. In",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                71,
                                393,
                                541,
                                407
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        393,
                                        541,
                                        407
                                    ],
                                    "score": 0.9941158294677734,
                                    "content": "TapeAgents, developers can freely use Python within one node, but between-node control fow is handled by",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                70,
                                406,
                                414,
                                420
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        406,
                                        414,
                                        420
                                    ],
                                    "score": 1.0,
                                    "content": "adding steps to the tape, which makes the tape perfect for session persistence.",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        }
                    ],
                    "index": 21,
                    "page_num": "page_17",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        286,
                        542,
                        420
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        70,
                        430,
                        346,
                        442
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                430,
                                345,
                                444
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        430,
                                        345,
                                        444
                                    ],
                                    "score": 1.0,
                                    "content": "6.1 Detailed comparison with LangGraph, AutoGen, DSPy",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        }
                    ],
                    "index": 27,
                    "page_num": "page_17",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        451,
                        541,
                        499
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                452,
                                541,
                                466
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        452,
                                        541,
                                        466
                                    ],
                                    "score": 1.0,
                                    "content": "To show that TapeAgents is uniquely holistic in targeting all stages of LLM agent lifecycle, we present a more",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                70,
                                464,
                                540,
                                478
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        464,
                                        540,
                                        478
                                    ],
                                    "score": 1.0,
                                    "content": "detailed side-by-side comparison of TapeAgents with three particularly popular frameworks: LangGraph,",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                70,
                                475,
                                541,
                                490
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        475,
                                        110,
                                        490
                                    ],
                                    "score": 1.0,
                                    "content": "AutoGen",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        111,
                                        477,
                                        115,
                                        486
                                    ],
                                    "score": 0.32,
                                    "content": "^{9}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 4
                                },
                                {
                                    "bbox": [
                                        115,
                                        475,
                                        541,
                                        490
                                    ],
                                    "score": 0.9941114187240601,
                                    "content": " and DSPy. We focus on the following seven axis that are particularly helpful to differentiate these",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                70,
                                488,
                                125,
                                501
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        488,
                                        125,
                                        501
                                    ],
                                    "score": 1.0,
                                    "content": "frameworks:",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        }
                    ],
                    "index": 29.5,
                    "page_num": "page_17",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        452,
                        541,
                        501
                    ]
                },
                {
                    "type": "list",
                    "bbox": [
                        92,
                        511,
                        542,
                        706
                    ],
                    "lines": [
                        {
                            "bbox": [
                                93,
                                513,
                                540,
                                526
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        93,
                                        513,
                                        540,
                                        526
                                    ],
                                    "score": 1.0,
                                    "content": "1. Building from Components while Allowing Finegrained Flow Control All the frame-",
                                    "type": "text"
                                }
                            ],
                            "index": 32,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                107,
                                525,
                                541,
                                538
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        525,
                                        541,
                                        538
                                    ],
                                    "score": 1.0,
                                    "content": "works we compare here allow building agentic systems from components, which are called agents in",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                106,
                                537,
                                541,
                                550
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        537,
                                        541,
                                        550
                                    ],
                                    "score": 1.0,
                                    "content": "TapeAgents and AutoGen, subgraphs in LangGraph, predictors in DSPy. TapeAgents and Lang-",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                106,
                                548,
                                541,
                                562
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        548,
                                        541,
                                        562
                                    ],
                                    "score": 0.9928389191627502,
                                    "content": "Graph additionally offer fine-grainted control fow inside each module via nodes and transition",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                106,
                                561,
                                542,
                                574
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        561,
                                        542,
                                        574
                                    ],
                                    "score": 1.0,
                                    "content": "between them. To have the same level of control in AutoGen, one must write long non-resumable",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                106,
                                573,
                                207,
                                585
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        573,
                                        207,
                                        585
                                    ],
                                    "score": 1.0,
                                    "content": "blocks of Python code.",
                                    "type": "text"
                                }
                            ],
                            "index": 37,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                93,
                                592,
                                542,
                                606
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        93,
                                        592,
                                        542,
                                        606
                                    ],
                                    "score": 1.0,
                                    "content": "2. Native Streaming Support LangGraph and TapeAgents natively support response streaming",
                                    "type": "text"
                                }
                            ],
                            "index": 38,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                107,
                                605,
                                541,
                                618
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        605,
                                        541,
                                        618
                                    ],
                                    "score": 1.0,
                                    "content": "by propagating intermediate event loops through the orchestration loops. Streaming support for",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                106,
                                615,
                                430,
                                630
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        615,
                                        430,
                                        630
                                    ],
                                    "score": 1.0,
                                    "content": "AutoGen agents requires substantial change to the agent implementation.",
                                    "type": "text"
                                }
                            ],
                            "index": 40,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                93,
                                635,
                                541,
                                648
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        93,
                                        635,
                                        541,
                                        648
                                    ],
                                    "score": 1.0,
                                    "content": "3. Concurrent LLM Calls LangGraph state-machine natively supports concurrent node execution,",
                                    "type": "text"
                                }
                            ],
                            "index": 41,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                107,
                                648,
                                541,
                                659
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        648,
                                        541,
                                        659
                                    ],
                                    "score": 1.0,
                                    "content": "which allows one to make concurrent LLM Calls. At the moment the agent in TapeAgents can only",
                                    "type": "text"
                                }
                            ],
                            "index": 42
                        },
                        {
                            "bbox": [
                                106,
                                660,
                                541,
                                671
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        660,
                                        541,
                                        671
                                    ],
                                    "score": 1.0,
                                    "content": "run one node of one agent at a time. We have a plan on how to address this limitation, see Section 7",
                                    "type": "text"
                                }
                            ],
                            "index": 43
                        },
                        {
                            "bbox": [
                                106,
                                670,
                                541,
                                685
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        670,
                                        541,
                                        685
                                    ],
                                    "score": 1.0,
                                    "content": "for details. We believe AutoGen also has no intra-agent concurrency at the framework level. DSPy",
                                    "type": "text"
                                }
                            ],
                            "index": 44
                        },
                        {
                            "bbox": [
                                107,
                                684,
                                541,
                                695
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        684,
                                        541,
                                        695
                                    ],
                                    "score": 1.0,
                                    "content": "users orchestrate DSPy modules with Python code, hence they can use Python multithreading to",
                                    "type": "text"
                                }
                            ],
                            "index": 45
                        },
                        {
                            "bbox": [
                                106,
                                694,
                                261,
                                708
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        694,
                                        261,
                                        708
                                    ],
                                    "score": 1.0,
                                    "content": "run multiple modules concurrently.",
                                    "type": "text"
                                }
                            ],
                            "index": 46,
                            "is_list_end_line": true
                        }
                    ],
                    "index": 39,
                    "page_num": "page_17",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        93,
                        513,
                        542,
                        708
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        96,
                        82,
                        541,
                        213
                    ],
                    "lines": [
                        {
                            "bbox": [
                                94,
                                82,
                                541,
                                96
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        94,
                                        82,
                                        541,
                                        96
                                    ],
                                    "score": 1.0,
                                    "content": "4. Resumable State Machine Agents Developer-friendly frameworks like LangGraph and",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                107,
                                95,
                                541,
                                108
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        95,
                                        541,
                                        108
                                    ],
                                    "score": 1.0,
                                    "content": "TapeAgents share the following design pattern: (a) there is a notion of the agent state (tape)",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                106,
                                106,
                                541,
                                120
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        106,
                                        541,
                                        120
                                    ],
                                    "score": 1.0,
                                    "content": "that is serializable and that fully determines the agent’s behavior (b) one implements an agent by",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                106,
                                118,
                                542,
                                132
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        118,
                                        542,
                                        132
                                    ],
                                    "score": 0.9895148873329163,
                                    "content": "defining how the agent makes the new state from the old state in response to external inputs, such",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                106,
                                131,
                                542,
                                144
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        131,
                                        542,
                                        144
                                    ],
                                    "score": 1.0,
                                    "content": "as LLM outputs or API responses. This state machine agent pattern should be contrasted with",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                107,
                                143,
                                541,
                                156
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        143,
                                        541,
                                        156
                                    ],
                                    "score": 1.0,
                                    "content": "implementing the agent in pure Python code as advocated by DSPy. In the latter case the agent",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                106,
                                155,
                                541,
                                167
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        155,
                                        541,
                                        167
                                    ],
                                    "score": 1.0,
                                    "content": "state is entangled in the non-serializable state of the Python interpreter. The advantage of having a",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                106,
                                166,
                                542,
                                180
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        166,
                                        542,
                                        180
                                    ],
                                    "score": 0.9777563214302063,
                                    "content": "well-defined state machine for the agent is that it can resume from frequent state checkpoints, such",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                106,
                                179,
                                541,
                                192
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        179,
                                        541,
                                        192
                                    ],
                                    "score": 1.0,
                                    "content": "as intermediate tapes in case of TapeAgents, and it can be stopped at any time. Our understanding",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                105,
                                190,
                                541,
                                204
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        190,
                                        541,
                                        204
                                    ],
                                    "score": 1.0,
                                    "content": "is that AutoGen provides less control over resumption and agent execution, e.g. one can not just",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                106,
                                203,
                                505,
                                216
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        203,
                                        505,
                                        216
                                    ],
                                    "score": 1.0,
                                    "content": "rerun the next speaker selection or restart the agent from a pre-recorded speaker selection.",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        }
                    ],
                    "index": 5
                },
                {
                    "type": "text",
                    "bbox": [
                        94,
                        225,
                        541,
                        284
                    ],
                    "lines": [
                        {
                            "bbox": [
                                93,
                                226,
                                541,
                                239
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        93,
                                        226,
                                        541,
                                        239
                                    ],
                                    "score": 1.0,
                                    "content": "5. Log Reuse Across Agents A practitioner that uses TapeAgents can reuse tapes from one agent to",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                108,
                                239,
                                540,
                                249
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        108,
                                        239,
                                        540,
                                        249
                                    ],
                                    "score": 0.9875055551528931,
                                    "content": "evaluate or improve another agent. We show an example of this pattern in our form-filling case-study",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                106,
                                249,
                                541,
                                262
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        249,
                                        541,
                                        262
                                    ],
                                    "score": 0.9872847199440002,
                                    "content": "in Section 5. There, the tapes could be reused as is, though we believe often minor modifications",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                106,
                                261,
                                541,
                                275
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        261,
                                        541,
                                        275
                                    ],
                                    "score": 0.9932569265365601,
                                    "content": "can suffce for adapting the tape from e.g. a monolithic agent to an agent team. Our understanding",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                106,
                                273,
                                540,
                                286
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        273,
                                        540,
                                        286
                                    ],
                                    "score": 0.9902901649475098,
                                    "content": "is that from the frameworks in comparison only LangGraph can be modified to support this pattern.",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        }
                    ],
                    "index": 13
                },
                {
                    "type": "text",
                    "bbox": [
                        94,
                        295,
                        540,
                        379
                    ],
                    "lines": [
                        {
                            "bbox": [
                                93,
                                296,
                                541,
                                310
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        93,
                                        296,
                                        541,
                                        310
                                    ],
                                    "score": 0.9941208362579346,
                                    "content": "6. Structured Logs and Agent Configurations for Data-Driven Agent Optimization In",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                106,
                                308,
                                540,
                                321
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        308,
                                        540,
                                        321
                                    ],
                                    "score": 0.9880839586257935,
                                    "content": "TapeAgents the agent configuration and the tape are highly structured and linked with metadata,",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                106,
                                319,
                                541,
                                333
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        319,
                                        541,
                                        333
                                    ],
                                    "score": 1.0,
                                    "content": "helping the implementation of agent optimization algorithms. LangGraph does not currently posi-",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                107,
                                333,
                                540,
                                345
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        333,
                                        540,
                                        345
                                    ],
                                    "score": 1.0,
                                    "content": "tion its event sequences as a medium to express algorithms. We likewise found the message history",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                106,
                                344,
                                541,
                                357
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        344,
                                        541,
                                        357
                                    ],
                                    "score": 0.9897916316986084,
                                    "content": "and the agent configuration in AutoGen were not designed with agent optimization in mind. On the",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                106,
                                356,
                                542,
                                370
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        356,
                                        542,
                                        370
                                    ],
                                    "score": 1.0,
                                    "content": "contrary, the hierarchical structure of DSPy predictors and the traces that DSPy programs enabled",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                106,
                                367,
                                323,
                                381
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        367,
                                        323,
                                        381
                                    ],
                                    "score": 0.9959762096405029,
                                    "content": "implementation of numerous effective algorithms.",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        }
                    ],
                    "index": 19
                },
                {
                    "type": "text",
                    "bbox": [
                        94,
                        390,
                        541,
                        438
                    ],
                    "lines": [
                        {
                            "bbox": [
                                94,
                                391,
                                541,
                                404
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        94,
                                        391,
                                        541,
                                        404
                                    ],
                                    "score": 0.9970143437385559,
                                    "content": "7. Making Training Text From Semantic-Level Logs Tape offers a semantic-level representation",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                107,
                                403,
                                541,
                                416
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        403,
                                        541,
                                        416
                                    ],
                                    "score": 0.9978527426719666,
                                    "content": "of the agent session that the agent can convert into low-level training text for LLM finetuning. This",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                106,
                                415,
                                542,
                                428
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        415,
                                        542,
                                        428
                                    ],
                                    "score": 1.0,
                                    "content": "is a unique trait of our framework which we believe LangGraph and AutoGen do not share. We",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                106,
                                426,
                                430,
                                441
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        426,
                                        430,
                                        441
                                    ],
                                    "score": 0.9867095947265625,
                                    "content": "believe with some effort a similar pattern could be implemented in DSPy.",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        }
                    ],
                    "index": 24.5
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        454,
                        539,
                        477
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                455,
                                541,
                                468
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        455,
                                        541,
                                        468
                                    ],
                                    "score": 1.0,
                                    "content": "We refer the reader to Table 6 for a tabular summary of the above analysis. One can see that TapeAgents",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                71,
                                466,
                                475,
                                480
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        466,
                                        475,
                                        480
                                    ],
                                    "score": 1.0,
                                    "content": "uniquely helps practitioners to both develop the agent and optimize it in a data-driven way.",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        }
                    ],
                    "index": 27.5
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        492,
                        275,
                        505
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                493,
                                274,
                                507
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        493,
                                        274,
                                        507
                                    ],
                                    "score": 1.0,
                                    "content": "6.2 Observability Platforms vs TapeAgents",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        }
                    ],
                    "index": 29
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        514,
                        540,
                        563
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                515,
                                540,
                                530
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        515,
                                        281,
                                        530
                                    ],
                                    "score": 1.0,
                                    "content": "Agent observability software such as LangSmith",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        282,
                                        516,
                                        290,
                                        525
                                    ],
                                    "score": 0.48,
                                    "content": "^{10}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        290,
                                        515,
                                        352,
                                        530
                                    ],
                                    "score": 1.0,
                                    "content": " and Langfuse",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        352,
                                        516,
                                        360,
                                        525
                                    ],
                                    "score": 0.68,
                                    "content": "^{11}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        361,
                                        515,
                                        540,
                                        530
                                    ],
                                    "score": 1.0,
                                    "content": " adds visibility to agent execution. They",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                70,
                                528,
                                541,
                                541
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        528,
                                        541,
                                        541
                                    ],
                                    "score": 0.987068235874176,
                                    "content": "allow one to incrementally instrument agent code to track specific components. In TapeAgents, the tape",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                70,
                                540,
                                540,
                                553
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        540,
                                        540,
                                        553
                                    ],
                                    "score": 0.9969942569732666,
                                    "content": "offers complete observability by design, but beyond that it can also be used for point-in-time resumption",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                72,
                                553,
                                176,
                                564
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        553,
                                        176,
                                        564
                                    ],
                                    "score": 1.0,
                                    "content": "and agent optimization.",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        }
                    ],
                    "index": 31.5
                },
                {
                    "type": "title",
                    "bbox": [
                        72,
                        579,
                        246,
                        594
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                580,
                                246,
                                593
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        582,
                                        79,
                                        591
                                    ],
                                    "score": 1.0,
                                    "content": "7",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        91,
                                        580,
                                        246,
                                        593
                                    ],
                                    "score": 1.0,
                                    "content": "Discussion and Future Work",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        }
                    ],
                    "index": 34
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        606,
                        541,
                        702
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                607,
                                541,
                                620
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        607,
                                        541,
                                        620
                                    ],
                                    "score": 1.0,
                                    "content": "We have presented TapeAgents, a holistic framework that targets all stages of the LLM Agent lifecycle. We",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                70,
                                619,
                                541,
                                632
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        619,
                                        541,
                                        632
                                    ],
                                    "score": 1.0,
                                    "content": "believe the tape-centered approach of our framework can facilitate responsible deployment and continual",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                71,
                                632,
                                541,
                                645
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        632,
                                        541,
                                        645
                                    ],
                                    "score": 1.0,
                                    "content": "improvement of LLM agents. Initial tapes will help debugging and testing at the development stages,",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                71,
                                644,
                                540,
                                655
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        644,
                                        540,
                                        655
                                    ],
                                    "score": 1.0,
                                    "content": "historical tapes from production agent sessions will serve as a machine-readable source of evaluation and",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                71,
                                656,
                                541,
                                667
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        656,
                                        541,
                                        667
                                    ],
                                    "score": 1.0,
                                    "content": "training data. Red-teaming algorithms can use historical tapes as seed data for testing the agent on potential",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                71,
                                668,
                                540,
                                679
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        668,
                                        540,
                                        679
                                    ],
                                    "score": 1.0,
                                    "content": "attacks or business-critical dangerous situations. The practitioner can also use historical tapes to seed the",
                                    "type": "text"
                                }
                            ],
                            "index": 40
                        },
                        {
                            "bbox": [
                                71,
                                680,
                                541,
                                691
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        680,
                                        541,
                                        691
                                    ],
                                    "score": 0.9961543679237366,
                                    "content": "simulation that they use for testing the agent. These are but a few benefits that TapeAgents can bring to",
                                    "type": "text"
                                }
                            ],
                            "index": 41
                        },
                        {
                            "bbox": [
                                70,
                                693,
                                129,
                                703
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        693,
                                        129,
                                        703
                                    ],
                                    "score": 1.0,
                                    "content": "practitioners.",
                                    "type": "text"
                                }
                            ],
                            "index": 42
                        }
                    ],
                    "index": 38.5
                }
            ],
            "layout_bboxes": [],
            "page_idx": 18,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        79,
                        712,
                        230,
                        732
                    ],
                    "lines": [
                        {
                            "bbox": [
                                77,
                                710,
                                232,
                                726
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        710,
                                        232,
                                        726
                                    ],
                                    "score": 1.0,
                                    "content": "10https://www.langchain.com/langsmith",
                                    "type": "text"
                                }
                            ]
                        },
                        {
                            "bbox": [
                                78,
                                720,
                                227,
                                735
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        78,
                                        720,
                                        227,
                                        735
                                    ],
                                    "score": 1.0,
                                    "content": "11https://github.com/langfuse/langfuse",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        72,
                        27,
                        143,
                        37
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                25,
                                144,
                                38
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        25,
                                        144,
                                        38
                                    ],
                                    "score": 1.0,
                                    "content": "Technical report",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        751,
                        311,
                        760
                    ],
                    "lines": [
                        {
                            "bbox": [
                                299,
                                751,
                                312,
                                762
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        299,
                                        751,
                                        312,
                                        762
                                    ],
                                    "score": 1.0,
                                    "content": "19",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        96,
                        82,
                        541,
                        213
                    ],
                    "lines": [
                        {
                            "bbox": [
                                94,
                                82,
                                541,
                                96
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        94,
                                        82,
                                        541,
                                        96
                                    ],
                                    "score": 1.0,
                                    "content": "4. Resumable State Machine Agents Developer-friendly frameworks like LangGraph and",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                107,
                                95,
                                541,
                                108
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        95,
                                        541,
                                        108
                                    ],
                                    "score": 1.0,
                                    "content": "TapeAgents share the following design pattern: (a) there is a notion of the agent state (tape)",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                106,
                                106,
                                541,
                                120
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        106,
                                        541,
                                        120
                                    ],
                                    "score": 1.0,
                                    "content": "that is serializable and that fully determines the agent’s behavior (b) one implements an agent by",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                106,
                                118,
                                542,
                                132
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        118,
                                        542,
                                        132
                                    ],
                                    "score": 0.9895148873329163,
                                    "content": "defining how the agent makes the new state from the old state in response to external inputs, such",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                106,
                                131,
                                542,
                                144
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        131,
                                        542,
                                        144
                                    ],
                                    "score": 1.0,
                                    "content": "as LLM outputs or API responses. This state machine agent pattern should be contrasted with",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                107,
                                143,
                                541,
                                156
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        143,
                                        541,
                                        156
                                    ],
                                    "score": 1.0,
                                    "content": "implementing the agent in pure Python code as advocated by DSPy. In the latter case the agent",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                106,
                                155,
                                541,
                                167
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        155,
                                        541,
                                        167
                                    ],
                                    "score": 1.0,
                                    "content": "state is entangled in the non-serializable state of the Python interpreter. The advantage of having a",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                106,
                                166,
                                542,
                                180
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        166,
                                        542,
                                        180
                                    ],
                                    "score": 0.9777563214302063,
                                    "content": "well-defined state machine for the agent is that it can resume from frequent state checkpoints, such",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                106,
                                179,
                                541,
                                192
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        179,
                                        541,
                                        192
                                    ],
                                    "score": 1.0,
                                    "content": "as intermediate tapes in case of TapeAgents, and it can be stopped at any time. Our understanding",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                105,
                                190,
                                541,
                                204
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        190,
                                        541,
                                        204
                                    ],
                                    "score": 1.0,
                                    "content": "is that AutoGen provides less control over resumption and agent execution, e.g. one can not just",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                106,
                                203,
                                505,
                                216
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        203,
                                        505,
                                        216
                                    ],
                                    "score": 1.0,
                                    "content": "rerun the next speaker selection or restart the agent from a pre-recorded speaker selection.",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        }
                    ],
                    "index": 5,
                    "page_num": "page_18",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        94,
                        82,
                        542,
                        216
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        94,
                        225,
                        541,
                        284
                    ],
                    "lines": [
                        {
                            "bbox": [
                                93,
                                226,
                                541,
                                239
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        93,
                                        226,
                                        541,
                                        239
                                    ],
                                    "score": 1.0,
                                    "content": "5. Log Reuse Across Agents A practitioner that uses TapeAgents can reuse tapes from one agent to",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                108,
                                239,
                                540,
                                249
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        108,
                                        239,
                                        540,
                                        249
                                    ],
                                    "score": 0.9875055551528931,
                                    "content": "evaluate or improve another agent. We show an example of this pattern in our form-filling case-study",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                106,
                                249,
                                541,
                                262
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        249,
                                        541,
                                        262
                                    ],
                                    "score": 0.9872847199440002,
                                    "content": "in Section 5. There, the tapes could be reused as is, though we believe often minor modifications",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                106,
                                261,
                                541,
                                275
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        261,
                                        541,
                                        275
                                    ],
                                    "score": 0.9932569265365601,
                                    "content": "can suffce for adapting the tape from e.g. a monolithic agent to an agent team. Our understanding",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                106,
                                273,
                                540,
                                286
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        273,
                                        540,
                                        286
                                    ],
                                    "score": 0.9902901649475098,
                                    "content": "is that from the frameworks in comparison only LangGraph can be modified to support this pattern.",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        }
                    ],
                    "index": 13,
                    "page_num": "page_18",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        93,
                        226,
                        541,
                        286
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        94,
                        295,
                        540,
                        379
                    ],
                    "lines": [
                        {
                            "bbox": [
                                93,
                                296,
                                541,
                                310
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        93,
                                        296,
                                        541,
                                        310
                                    ],
                                    "score": 0.9941208362579346,
                                    "content": "6. Structured Logs and Agent Configurations for Data-Driven Agent Optimization In",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                106,
                                308,
                                540,
                                321
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        308,
                                        540,
                                        321
                                    ],
                                    "score": 0.9880839586257935,
                                    "content": "TapeAgents the agent configuration and the tape are highly structured and linked with metadata,",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                106,
                                319,
                                541,
                                333
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        319,
                                        541,
                                        333
                                    ],
                                    "score": 1.0,
                                    "content": "helping the implementation of agent optimization algorithms. LangGraph does not currently posi-",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                107,
                                333,
                                540,
                                345
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        333,
                                        540,
                                        345
                                    ],
                                    "score": 1.0,
                                    "content": "tion its event sequences as a medium to express algorithms. We likewise found the message history",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                106,
                                344,
                                541,
                                357
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        344,
                                        541,
                                        357
                                    ],
                                    "score": 0.9897916316986084,
                                    "content": "and the agent configuration in AutoGen were not designed with agent optimization in mind. On the",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                106,
                                356,
                                542,
                                370
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        356,
                                        542,
                                        370
                                    ],
                                    "score": 1.0,
                                    "content": "contrary, the hierarchical structure of DSPy predictors and the traces that DSPy programs enabled",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                106,
                                367,
                                323,
                                381
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        367,
                                        323,
                                        381
                                    ],
                                    "score": 0.9959762096405029,
                                    "content": "implementation of numerous effective algorithms.",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        }
                    ],
                    "index": 19,
                    "page_num": "page_18",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        93,
                        296,
                        542,
                        381
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        94,
                        390,
                        541,
                        438
                    ],
                    "lines": [
                        {
                            "bbox": [
                                94,
                                391,
                                541,
                                404
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        94,
                                        391,
                                        541,
                                        404
                                    ],
                                    "score": 0.9970143437385559,
                                    "content": "7. Making Training Text From Semantic-Level Logs Tape offers a semantic-level representation",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                107,
                                403,
                                541,
                                416
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        403,
                                        541,
                                        416
                                    ],
                                    "score": 0.9978527426719666,
                                    "content": "of the agent session that the agent can convert into low-level training text for LLM finetuning. This",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                106,
                                415,
                                542,
                                428
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        415,
                                        542,
                                        428
                                    ],
                                    "score": 1.0,
                                    "content": "is a unique trait of our framework which we believe LangGraph and AutoGen do not share. We",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                106,
                                426,
                                430,
                                441
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        426,
                                        430,
                                        441
                                    ],
                                    "score": 0.9867095947265625,
                                    "content": "believe with some effort a similar pattern could be implemented in DSPy.",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        }
                    ],
                    "index": 24.5,
                    "page_num": "page_18",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        94,
                        391,
                        542,
                        441
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        72,
                        454,
                        539,
                        477
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                455,
                                541,
                                468
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        455,
                                        541,
                                        468
                                    ],
                                    "score": 1.0,
                                    "content": "We refer the reader to Table 6 for a tabular summary of the above analysis. One can see that TapeAgents",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                71,
                                466,
                                475,
                                480
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        466,
                                        475,
                                        480
                                    ],
                                    "score": 1.0,
                                    "content": "uniquely helps practitioners to both develop the agent and optimize it in a data-driven way.",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        }
                    ],
                    "index": 27.5,
                    "page_num": "page_18",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        71,
                        455,
                        541,
                        480
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        492,
                        275,
                        505
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                493,
                                274,
                                507
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        493,
                                        274,
                                        507
                                    ],
                                    "score": 1.0,
                                    "content": "6.2 Observability Platforms vs TapeAgents",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        }
                    ],
                    "index": 29,
                    "page_num": "page_18",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        514,
                        540,
                        563
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                515,
                                540,
                                530
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        515,
                                        281,
                                        530
                                    ],
                                    "score": 1.0,
                                    "content": "Agent observability software such as LangSmith",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        282,
                                        516,
                                        290,
                                        525
                                    ],
                                    "score": 0.48,
                                    "content": "^{10}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        290,
                                        515,
                                        352,
                                        530
                                    ],
                                    "score": 1.0,
                                    "content": " and Langfuse",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        352,
                                        516,
                                        360,
                                        525
                                    ],
                                    "score": 0.68,
                                    "content": "^{11}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        361,
                                        515,
                                        540,
                                        530
                                    ],
                                    "score": 1.0,
                                    "content": " adds visibility to agent execution. They",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                70,
                                528,
                                541,
                                541
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        528,
                                        541,
                                        541
                                    ],
                                    "score": 0.987068235874176,
                                    "content": "allow one to incrementally instrument agent code to track specific components. In TapeAgents, the tape",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                70,
                                540,
                                540,
                                553
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        540,
                                        540,
                                        553
                                    ],
                                    "score": 0.9969942569732666,
                                    "content": "offers complete observability by design, but beyond that it can also be used for point-in-time resumption",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                72,
                                553,
                                176,
                                564
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        553,
                                        176,
                                        564
                                    ],
                                    "score": 1.0,
                                    "content": "and agent optimization.",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        }
                    ],
                    "index": 31.5,
                    "page_num": "page_18",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        515,
                        541,
                        564
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        72,
                        579,
                        246,
                        594
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                580,
                                246,
                                593
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        582,
                                        79,
                                        591
                                    ],
                                    "score": 1.0,
                                    "content": "7",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        91,
                                        580,
                                        246,
                                        593
                                    ],
                                    "score": 1.0,
                                    "content": "Discussion and Future Work",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        }
                    ],
                    "index": 34,
                    "page_num": "page_18",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        606,
                        541,
                        702
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                607,
                                541,
                                620
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        607,
                                        541,
                                        620
                                    ],
                                    "score": 1.0,
                                    "content": "We have presented TapeAgents, a holistic framework that targets all stages of the LLM Agent lifecycle. We",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                70,
                                619,
                                541,
                                632
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        619,
                                        541,
                                        632
                                    ],
                                    "score": 1.0,
                                    "content": "believe the tape-centered approach of our framework can facilitate responsible deployment and continual",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                71,
                                632,
                                541,
                                645
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        632,
                                        541,
                                        645
                                    ],
                                    "score": 1.0,
                                    "content": "improvement of LLM agents. Initial tapes will help debugging and testing at the development stages,",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                71,
                                644,
                                540,
                                655
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        644,
                                        540,
                                        655
                                    ],
                                    "score": 1.0,
                                    "content": "historical tapes from production agent sessions will serve as a machine-readable source of evaluation and",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                71,
                                656,
                                541,
                                667
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        656,
                                        541,
                                        667
                                    ],
                                    "score": 1.0,
                                    "content": "training data. Red-teaming algorithms can use historical tapes as seed data for testing the agent on potential",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                71,
                                668,
                                540,
                                679
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        668,
                                        540,
                                        679
                                    ],
                                    "score": 1.0,
                                    "content": "attacks or business-critical dangerous situations. The practitioner can also use historical tapes to seed the",
                                    "type": "text"
                                }
                            ],
                            "index": 40
                        },
                        {
                            "bbox": [
                                71,
                                680,
                                541,
                                691
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        680,
                                        541,
                                        691
                                    ],
                                    "score": 0.9961543679237366,
                                    "content": "simulation that they use for testing the agent. These are but a few benefits that TapeAgents can bring to",
                                    "type": "text"
                                }
                            ],
                            "index": 41
                        },
                        {
                            "bbox": [
                                70,
                                693,
                                129,
                                703
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        693,
                                        129,
                                        703
                                    ],
                                    "score": 1.0,
                                    "content": "practitioners.",
                                    "type": "text"
                                }
                            ],
                            "index": 42
                        }
                    ],
                    "index": 38.5,
                    "page_num": "page_18",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        607,
                        541,
                        703
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "table",
                    "bbox": [
                        73,
                        79,
                        538,
                        168
                    ],
                    "blocks": [
                        {
                            "type": "table_body",
                            "bbox": [
                                73,
                                79,
                                538,
                                168
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        73,
                                        79,
                                        538,
                                        168
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                73,
                                                79,
                                                538,
                                                168
                                            ],
                                            "score": 0.981,
                                            "html": "<html><body><table><tr><td rowspan=\"2\">Method</td><td colspan=\"4\">Development</td><td colspan=\"4\">Optimization</td></tr><tr><td>Building from Components</td><td>Native Streaming</td><td>Concurrent LLM</td><td>Resumable State</td><td>Log Reuse Across</td><td>Structured and Agent</td><td>Logs Con-</td><td>Making Training</td></tr><tr><td rowspan=\"3\"></td><td>while Allow-</td><td>Support</td><td>Calls</td><td>Machine</td><td>Agents</td><td>figurations</td><td>for</td><td>TextFrom</td></tr><tr><td>ing Finegrained FlowControl</td><td></td><td></td><td>Agents</td><td></td><td>Data-Driven</td><td>：Agent</td><td>Semantic-</td></tr><tr><td></td><td></td><td></td><td></td><td>×</td><td>Optimization</td><td></td><td>LevelLogs</td></tr><tr><td>DSPy LangGraph</td><td></td><td>√</td><td></td><td></td><td></td><td></td><td></td><td>x</td></tr><tr><td>AutoGen</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>TapeAgents (Ours</td><td></td><td></td><td></td><td></td><td>√</td><td></td><td></td><td>√</td></tr></table></body></html>",
                                            "type": "table",
                                            "image_path": "e7019844323b049f6c548aa1276b874006c1b775ff43531d690ce20feb23494f.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        73,
                                        79,
                                        538,
                                        108.66666666666667
                                    ],
                                    "spans": [],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        73,
                                        108.66666666666667,
                                        538,
                                        138.33333333333334
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        73,
                                        138.33333333333334,
                                        538,
                                        168.0
                                    ],
                                    "spans": [],
                                    "index": 2
                                }
                            ]
                        },
                        {
                            "type": "table_caption",
                            "bbox": [
                                71,
                                169,
                                541,
                                245
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        71,
                                        170,
                                        541,
                                        181
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                170,
                                                541,
                                                181
                                            ],
                                            "score": 0.9900768399238586,
                                            "content": "Table 6: TapeAgents vs Other Frameworks. TapeAgents stands out in features it offers to the practitioner to",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        71,
                                        180,
                                        541,
                                        193
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                180,
                                                481,
                                                193
                                            ],
                                            "score": 0.9984709024429321,
                                            "content": "the support them throughout the LLM Agent development cycle. In this figure, we use the cross sign",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                481,
                                                180,
                                                494,
                                                191
                                            ],
                                            "score": 0.71,
                                            "content": "({\\pmb x})",
                                            "type": "inline_equation",
                                            "height": 11,
                                            "width": 13
                                        },
                                        {
                                            "bbox": [
                                                495,
                                                180,
                                                541,
                                                193
                                            ],
                                            "score": 1.0,
                                            "content": " to indicate",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                },
                                {
                                    "bbox": [
                                        71,
                                        191,
                                        541,
                                        203
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                192,
                                                456,
                                                203
                                            ],
                                            "score": 1.0,
                                            "content": "that major core changes would be required for the framework support the feature. Triangle sign",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                457,
                                                191,
                                                473,
                                                202
                                            ],
                                            "score": 0.8,
                                            "content": "(\\blacktriangle)",
                                            "type": "inline_equation",
                                            "height": 11,
                                            "width": 16
                                        },
                                        {
                                            "bbox": [
                                                473,
                                                192,
                                                541,
                                                203
                                            ],
                                            "score": 1.0,
                                            "content": " indicates partial",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 5
                                },
                                {
                                    "bbox": [
                                        71,
                                        203,
                                        540,
                                        215
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                203,
                                                540,
                                                215
                                            ],
                                            "score": 0.9900211095809937,
                                            "content": "support of a feature, meaning that practitioner would have to do extra effort or accept associated limitations to achieve",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 6
                                },
                                {
                                    "bbox": [
                                        71,
                                        213,
                                        542,
                                        226
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                213,
                                                234,
                                                226
                                            ],
                                            "score": 1.0,
                                            "content": "the respective functionality. Check sign ",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                234,
                                                213,
                                                246,
                                                223
                                            ],
                                            "score": 0.36,
                                            "content": "(\\checkmark,",
                                            "type": "inline_equation",
                                            "height": 10,
                                            "width": 12
                                        },
                                        {
                                            "bbox": [
                                                246,
                                                213,
                                                542,
                                                226
                                            ],
                                            "score": 1.0,
                                            "content": ") indicates that the framework natively supports a feature. TapeAgents’s",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 7
                                },
                                {
                                    "bbox": [
                                        71,
                                        225,
                                        541,
                                        236
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                225,
                                                541,
                                                236
                                            ],
                                            "score": 1.0,
                                            "content": "only weakness in this table is the lack of Concurrent LLM Calls, see Section 7 for a discuss of how we intend to tackle",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 8
                                },
                                {
                                    "bbox": [
                                        70,
                                        236,
                                        82,
                                        246
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                236,
                                                82,
                                                246
                                            ],
                                            "score": 1.0,
                                            "content": "it.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 9
                                }
                            ],
                            "index": 6
                        }
                    ],
                    "index": 3.5
                },
                {
                    "type": "title",
                    "bbox": [
                        72,
                        271,
                        200,
                        284
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                271,
                                200,
                                284
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        271,
                                        200,
                                        284
                                    ],
                                    "score": 1.0,
                                    "content": "7.1 Immediate Next Steps",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        }
                    ],
                    "index": 10
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        295,
                        541,
                        367
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                295,
                                540,
                                309
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        295,
                                        540,
                                        309
                                    ],
                                    "score": 1.0,
                                    "content": "TapeAgents is still in early development stages. A key next step for TapeAgents is adding coroutine im-",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                70,
                                308,
                                541,
                                322
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        308,
                                        541,
                                        322
                                    ],
                                    "score": 1.0,
                                    "content": "plementations for the agent loop and for agent-environment orchestration. This will enable both running",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                71,
                                321,
                                541,
                                333
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        321,
                                        541,
                                        333
                                    ],
                                    "score": 1.0,
                                    "content": "many agent-environment loops in parallel on their respective tapes and running members of the same agent",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                70,
                                331,
                                542,
                                345
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        331,
                                        542,
                                        345
                                    ],
                                    "score": 1.0,
                                    "content": "team on their shared tape. The latter will require changes in the tape view computation to ignore steps of",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                71,
                                344,
                                541,
                                357
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        344,
                                        541,
                                        357
                                    ],
                                    "score": 1.0,
                                    "content": "the agents running in parallel, but we believe that the main framework concepts that we introduced in this",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                69,
                                356,
                                182,
                                369
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        356,
                                        182,
                                        369
                                    ],
                                    "score": 1.0,
                                    "content": "paper will stay the same.",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        }
                    ],
                    "index": 13.5
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        372,
                        540,
                        433
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                372,
                                541,
                                387
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        372,
                                        541,
                                        387
                                    ],
                                    "score": 1.0,
                                    "content": "On the optimization front, we will soon release an online Reinforcement Learning (RL) trainer for",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                71,
                                385,
                                540,
                                398
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        385,
                                        540,
                                        398
                                    ],
                                    "score": 1.0,
                                    "content": "TapeAgents, which will improve the assistant agent using the rewards that the annotator agent com-",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                70,
                                398,
                                540,
                                411
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        398,
                                        540,
                                        411
                                    ],
                                    "score": 1.0,
                                    "content": "putes. Another welcome optimizer addition would be implementing in TapeAgents a text-based feedback-",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                69,
                                410,
                                542,
                                422
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        410,
                                        542,
                                        422
                                    ],
                                    "score": 1.0,
                                    "content": "propagation algorithm like the one in TextGrad. Tapes steps are a perfect medium to attach feedback",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                71,
                                423,
                                84,
                                433
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        423,
                                        84,
                                        433
                                    ],
                                    "score": 1.0,
                                    "content": "to.",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        }
                    ],
                    "index": 19
                },
                {
                    "type": "title",
                    "bbox": [
                        72,
                        451,
                        256,
                        464
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                453,
                                257,
                                465
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        453,
                                        257,
                                        465
                                    ],
                                    "score": 0.9697423577308655,
                                    "content": "7.2  Agent as an Optimizable Workflow",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        }
                    ],
                    "index": 22
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        475,
                        541,
                        630
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                476,
                                541,
                                488
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        476,
                                        541,
                                        488
                                    ],
                                    "score": 0.9892956018447876,
                                    "content": "Stepping back from the immediate future plans, we believe it is worth refecting on what should be called an",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                70,
                                487,
                                540,
                                501
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        487,
                                        540,
                                        501
                                    ],
                                    "score": 0.9871585965156555,
                                    "content": "LLM Agent and what should be called “just\" a program, a workfow or software. In the TapeAgents context,",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                70,
                                499,
                                541,
                                513
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        499,
                                        541,
                                        513
                                    ],
                                    "score": 1.0,
                                    "content": "this philosophical question is what the developer asks themselves when they build an agent—whether they",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                71,
                                512,
                                541,
                                524
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        512,
                                        541,
                                        524
                                    ],
                                    "score": 1.0,
                                    "content": "should implement as agent nodes, and what should go in the application that uses the agent. Our current",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                70,
                                524,
                                540,
                                536
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        524,
                                        540,
                                        536
                                    ],
                                    "score": 1.0,
                                    "content": "recommendation is that one should treat and implement the parts of the system that they intend to optimize",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                71,
                                536,
                                541,
                                548
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        536,
                                        541,
                                        548
                                    ],
                                    "score": 1.0,
                                    "content": "with data-driven algorithms as LLM Agents. Frameworks provide the structure that the algorithms require",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                70,
                                547,
                                542,
                                561
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        547,
                                        542,
                                        561
                                    ],
                                    "score": 1.0,
                                    "content": "to identify the issue, propose a change, and test the change’s outcome. In TapeAgents, this process is",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                70,
                                559,
                                541,
                                573
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        559,
                                        541,
                                        573
                                    ],
                                    "score": 1.0,
                                    "content": "particularly clear: the algorithm will identify an issue in the tape, attribute it to a root cause step, propose",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                70,
                                572,
                                541,
                                584
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        572,
                                        541,
                                        584
                                    ],
                                    "score": 0.9907531142234802,
                                    "content": "a change to the agent configuration and test this change by resuming the agent from intermediate points in",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                70,
                                583,
                                541,
                                597
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        583,
                                        541,
                                        597
                                    ],
                                    "score": 1.0,
                                    "content": "the tape. Thus the gains from algorithmic improvement will compensate for the overhead of respecting the",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                70,
                                595,
                                541,
                                609
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        595,
                                        541,
                                        609
                                    ],
                                    "score": 0.9881096482276917,
                                    "content": "TapeAgents engineering constraints. To sum up, our recommendation is to implement optimizable workflows",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                70,
                                607,
                                541,
                                621
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        607,
                                        541,
                                        621
                                    ],
                                    "score": 1.0,
                                    "content": "as LLM Agents and use other appropriate tools for the software that will not be subject to data-driven",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                71,
                                620,
                                131,
                                632
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        620,
                                        131,
                                        632
                                    ],
                                    "score": 1.0,
                                    "content": "improvement.",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        }
                    ],
                    "index": 29
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        649,
                        348,
                        661
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                650,
                                348,
                                663
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        650,
                                        348,
                                        663
                                    ],
                                    "score": 1.0,
                                    "content": "7.3 Synthetic Data Generation with Worlds of TapeAgents",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        }
                    ],
                    "index": 36
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        672,
                        540,
                        732
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                674,
                                540,
                                686
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        674,
                                        540,
                                        686
                                    ],
                                    "score": 0.9839993715286255,
                                    "content": " In addition to helping practitioners with their solution-specific challenges, we envision synthetic data gener-",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                70,
                                685,
                                541,
                                698
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        685,
                                        541,
                                        698
                                    ],
                                    "score": 1.0,
                                    "content": "ation as another application area where TapeAgents can make an impact. A key trend in the data-making",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                71,
                                698,
                                540,
                                710
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        698,
                                        540,
                                        710
                                    ],
                                    "score": 0.9845552444458008,
                                    "content": "trade is building modular pipelines with many agent-like modules, such as prompt-generating workflows (Mi-",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                71,
                                709,
                                541,
                                722
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        709,
                                        541,
                                        722
                                    ],
                                    "score": 1.0,
                                    "content": "tra et al., 2024), judges (Bai et al., 2022), meta-judges (Wu et al., 2024b), process supervisors (Lightman",
                                    "type": "text"
                                }
                            ],
                            "index": 40
                        },
                        {
                            "bbox": [
                                70,
                                721,
                                540,
                                734
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        721,
                                        540,
                                        734
                                    ],
                                    "score": 1.0,
                                    "content": "et al., 2023; Uesato et al., 2022), annotator augmented with tools (Wei et al., 2024) among other examples.",
                                    "type": "text"
                                }
                            ],
                            "index": 41
                        }
                    ],
                    "index": 39
                }
            ],
            "layout_bboxes": [],
            "page_idx": 19,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [
                {
                    "type": "table",
                    "bbox": [
                        73,
                        79,
                        538,
                        168
                    ],
                    "blocks": [
                        {
                            "type": "table_body",
                            "bbox": [
                                73,
                                79,
                                538,
                                168
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        73,
                                        79,
                                        538,
                                        168
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                73,
                                                79,
                                                538,
                                                168
                                            ],
                                            "score": 0.981,
                                            "html": "<html><body><table><tr><td rowspan=\"2\">Method</td><td colspan=\"4\">Development</td><td colspan=\"4\">Optimization</td></tr><tr><td>Building from Components</td><td>Native Streaming</td><td>Concurrent LLM</td><td>Resumable State</td><td>Log Reuse Across</td><td>Structured and Agent</td><td>Logs Con-</td><td>Making Training</td></tr><tr><td rowspan=\"3\"></td><td>while Allow-</td><td>Support</td><td>Calls</td><td>Machine</td><td>Agents</td><td>figurations</td><td>for</td><td>TextFrom</td></tr><tr><td>ing Finegrained FlowControl</td><td></td><td></td><td>Agents</td><td></td><td>Data-Driven</td><td>：Agent</td><td>Semantic-</td></tr><tr><td></td><td></td><td></td><td></td><td>×</td><td>Optimization</td><td></td><td>LevelLogs</td></tr><tr><td>DSPy LangGraph</td><td></td><td>√</td><td></td><td></td><td></td><td></td><td></td><td>x</td></tr><tr><td>AutoGen</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>TapeAgents (Ours</td><td></td><td></td><td></td><td></td><td>√</td><td></td><td></td><td>√</td></tr></table></body></html>",
                                            "type": "table",
                                            "image_path": "e7019844323b049f6c548aa1276b874006c1b775ff43531d690ce20feb23494f.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        73,
                                        79,
                                        538,
                                        108.66666666666667
                                    ],
                                    "spans": [],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        73,
                                        108.66666666666667,
                                        538,
                                        138.33333333333334
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        73,
                                        138.33333333333334,
                                        538,
                                        168.0
                                    ],
                                    "spans": [],
                                    "index": 2
                                }
                            ]
                        },
                        {
                            "type": "table_caption",
                            "bbox": [
                                71,
                                169,
                                541,
                                245
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        71,
                                        170,
                                        541,
                                        181
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                170,
                                                541,
                                                181
                                            ],
                                            "score": 0.9900768399238586,
                                            "content": "Table 6: TapeAgents vs Other Frameworks. TapeAgents stands out in features it offers to the practitioner to",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        71,
                                        180,
                                        541,
                                        193
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                180,
                                                481,
                                                193
                                            ],
                                            "score": 0.9984709024429321,
                                            "content": "the support them throughout the LLM Agent development cycle. In this figure, we use the cross sign",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                481,
                                                180,
                                                494,
                                                191
                                            ],
                                            "score": 0.71,
                                            "content": "({\\pmb x})",
                                            "type": "inline_equation",
                                            "height": 11,
                                            "width": 13
                                        },
                                        {
                                            "bbox": [
                                                495,
                                                180,
                                                541,
                                                193
                                            ],
                                            "score": 1.0,
                                            "content": " to indicate",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                },
                                {
                                    "bbox": [
                                        71,
                                        191,
                                        541,
                                        203
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                192,
                                                456,
                                                203
                                            ],
                                            "score": 1.0,
                                            "content": "that major core changes would be required for the framework support the feature. Triangle sign",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                457,
                                                191,
                                                473,
                                                202
                                            ],
                                            "score": 0.8,
                                            "content": "(\\blacktriangle)",
                                            "type": "inline_equation",
                                            "height": 11,
                                            "width": 16
                                        },
                                        {
                                            "bbox": [
                                                473,
                                                192,
                                                541,
                                                203
                                            ],
                                            "score": 1.0,
                                            "content": " indicates partial",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 5
                                },
                                {
                                    "bbox": [
                                        71,
                                        203,
                                        540,
                                        215
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                203,
                                                540,
                                                215
                                            ],
                                            "score": 0.9900211095809937,
                                            "content": "support of a feature, meaning that practitioner would have to do extra effort or accept associated limitations to achieve",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 6
                                },
                                {
                                    "bbox": [
                                        71,
                                        213,
                                        542,
                                        226
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                213,
                                                234,
                                                226
                                            ],
                                            "score": 1.0,
                                            "content": "the respective functionality. Check sign ",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                234,
                                                213,
                                                246,
                                                223
                                            ],
                                            "score": 0.36,
                                            "content": "(\\checkmark,",
                                            "type": "inline_equation",
                                            "height": 10,
                                            "width": 12
                                        },
                                        {
                                            "bbox": [
                                                246,
                                                213,
                                                542,
                                                226
                                            ],
                                            "score": 1.0,
                                            "content": ") indicates that the framework natively supports a feature. TapeAgents’s",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 7
                                },
                                {
                                    "bbox": [
                                        71,
                                        225,
                                        541,
                                        236
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                225,
                                                541,
                                                236
                                            ],
                                            "score": 1.0,
                                            "content": "only weakness in this table is the lack of Concurrent LLM Calls, see Section 7 for a discuss of how we intend to tackle",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 8
                                },
                                {
                                    "bbox": [
                                        70,
                                        236,
                                        82,
                                        246
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                236,
                                                82,
                                                246
                                            ],
                                            "score": 1.0,
                                            "content": "it.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 9
                                }
                            ],
                            "index": 6
                        }
                    ],
                    "index": 3.5
                }
            ],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        71,
                        27,
                        143,
                        37
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                26,
                                144,
                                38
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        26,
                                        144,
                                        38
                                    ],
                                    "score": 1.0,
                                    "content": "Technical report",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        751,
                        311,
                        760
                    ],
                    "lines": [
                        {
                            "bbox": [
                                299,
                                751,
                                312,
                                762
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        299,
                                        751,
                                        312,
                                        762
                                    ],
                                    "score": 1.0,
                                    "content": "20",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "table",
                    "bbox": [
                        73,
                        79,
                        538,
                        168
                    ],
                    "blocks": [
                        {
                            "type": "table_body",
                            "bbox": [
                                73,
                                79,
                                538,
                                168
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        73,
                                        79,
                                        538,
                                        168
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                73,
                                                79,
                                                538,
                                                168
                                            ],
                                            "score": 0.981,
                                            "html": "<html><body><table><tr><td rowspan=\"2\">Method</td><td colspan=\"4\">Development</td><td colspan=\"4\">Optimization</td></tr><tr><td>Building from Components</td><td>Native Streaming</td><td>Concurrent LLM</td><td>Resumable State</td><td>Log Reuse Across</td><td>Structured and Agent</td><td>Logs Con-</td><td>Making Training</td></tr><tr><td rowspan=\"3\"></td><td>while Allow-</td><td>Support</td><td>Calls</td><td>Machine</td><td>Agents</td><td>figurations</td><td>for</td><td>TextFrom</td></tr><tr><td>ing Finegrained FlowControl</td><td></td><td></td><td>Agents</td><td></td><td>Data-Driven</td><td>：Agent</td><td>Semantic-</td></tr><tr><td></td><td></td><td></td><td></td><td>×</td><td>Optimization</td><td></td><td>LevelLogs</td></tr><tr><td>DSPy LangGraph</td><td></td><td>√</td><td></td><td></td><td></td><td></td><td></td><td>x</td></tr><tr><td>AutoGen</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>TapeAgents (Ours</td><td></td><td></td><td></td><td></td><td>√</td><td></td><td></td><td>√</td></tr></table></body></html>",
                                            "type": "table",
                                            "image_path": "e7019844323b049f6c548aa1276b874006c1b775ff43531d690ce20feb23494f.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        73,
                                        79,
                                        538,
                                        108.66666666666667
                                    ],
                                    "spans": [],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        73,
                                        108.66666666666667,
                                        538,
                                        138.33333333333334
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        73,
                                        138.33333333333334,
                                        538,
                                        168.0
                                    ],
                                    "spans": [],
                                    "index": 2
                                }
                            ]
                        },
                        {
                            "type": "table_caption",
                            "bbox": [
                                71,
                                169,
                                541,
                                245
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        71,
                                        170,
                                        541,
                                        181
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                170,
                                                541,
                                                181
                                            ],
                                            "score": 0.9900768399238586,
                                            "content": "Table 6: TapeAgents vs Other Frameworks. TapeAgents stands out in features it offers to the practitioner to",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        71,
                                        180,
                                        541,
                                        193
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                180,
                                                481,
                                                193
                                            ],
                                            "score": 0.9984709024429321,
                                            "content": "the support them throughout the LLM Agent development cycle. In this figure, we use the cross sign",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                481,
                                                180,
                                                494,
                                                191
                                            ],
                                            "score": 0.71,
                                            "content": "({\\pmb x})",
                                            "type": "inline_equation",
                                            "height": 11,
                                            "width": 13
                                        },
                                        {
                                            "bbox": [
                                                495,
                                                180,
                                                541,
                                                193
                                            ],
                                            "score": 1.0,
                                            "content": " to indicate",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                },
                                {
                                    "bbox": [
                                        71,
                                        191,
                                        541,
                                        203
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                192,
                                                456,
                                                203
                                            ],
                                            "score": 1.0,
                                            "content": "that major core changes would be required for the framework support the feature. Triangle sign",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                457,
                                                191,
                                                473,
                                                202
                                            ],
                                            "score": 0.8,
                                            "content": "(\\blacktriangle)",
                                            "type": "inline_equation",
                                            "height": 11,
                                            "width": 16
                                        },
                                        {
                                            "bbox": [
                                                473,
                                                192,
                                                541,
                                                203
                                            ],
                                            "score": 1.0,
                                            "content": " indicates partial",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 5
                                },
                                {
                                    "bbox": [
                                        71,
                                        203,
                                        540,
                                        215
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                203,
                                                540,
                                                215
                                            ],
                                            "score": 0.9900211095809937,
                                            "content": "support of a feature, meaning that practitioner would have to do extra effort or accept associated limitations to achieve",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 6
                                },
                                {
                                    "bbox": [
                                        71,
                                        213,
                                        542,
                                        226
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                213,
                                                234,
                                                226
                                            ],
                                            "score": 1.0,
                                            "content": "the respective functionality. Check sign ",
                                            "type": "text"
                                        },
                                        {
                                            "bbox": [
                                                234,
                                                213,
                                                246,
                                                223
                                            ],
                                            "score": 0.36,
                                            "content": "(\\checkmark,",
                                            "type": "inline_equation",
                                            "height": 10,
                                            "width": 12
                                        },
                                        {
                                            "bbox": [
                                                246,
                                                213,
                                                542,
                                                226
                                            ],
                                            "score": 1.0,
                                            "content": ") indicates that the framework natively supports a feature. TapeAgents’s",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 7
                                },
                                {
                                    "bbox": [
                                        71,
                                        225,
                                        541,
                                        236
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                225,
                                                541,
                                                236
                                            ],
                                            "score": 1.0,
                                            "content": "only weakness in this table is the lack of Concurrent LLM Calls, see Section 7 for a discuss of how we intend to tackle",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 8
                                },
                                {
                                    "bbox": [
                                        70,
                                        236,
                                        82,
                                        246
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                236,
                                                82,
                                                246
                                            ],
                                            "score": 1.0,
                                            "content": "it.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 9
                                }
                            ],
                            "index": 6
                        }
                    ],
                    "index": 3.5,
                    "page_num": "page_19",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        72,
                        271,
                        200,
                        284
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                271,
                                200,
                                284
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        271,
                                        200,
                                        284
                                    ],
                                    "score": 1.0,
                                    "content": "7.1 Immediate Next Steps",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        }
                    ],
                    "index": 10,
                    "page_num": "page_19",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        295,
                        541,
                        367
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                295,
                                540,
                                309
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        295,
                                        540,
                                        309
                                    ],
                                    "score": 1.0,
                                    "content": "TapeAgents is still in early development stages. A key next step for TapeAgents is adding coroutine im-",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                70,
                                308,
                                541,
                                322
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        308,
                                        541,
                                        322
                                    ],
                                    "score": 1.0,
                                    "content": "plementations for the agent loop and for agent-environment orchestration. This will enable both running",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                71,
                                321,
                                541,
                                333
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        321,
                                        541,
                                        333
                                    ],
                                    "score": 1.0,
                                    "content": "many agent-environment loops in parallel on their respective tapes and running members of the same agent",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                70,
                                331,
                                542,
                                345
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        331,
                                        542,
                                        345
                                    ],
                                    "score": 1.0,
                                    "content": "team on their shared tape. The latter will require changes in the tape view computation to ignore steps of",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                71,
                                344,
                                541,
                                357
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        344,
                                        541,
                                        357
                                    ],
                                    "score": 1.0,
                                    "content": "the agents running in parallel, but we believe that the main framework concepts that we introduced in this",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                69,
                                356,
                                182,
                                369
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        356,
                                        182,
                                        369
                                    ],
                                    "score": 1.0,
                                    "content": "paper will stay the same.",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        }
                    ],
                    "index": 13.5,
                    "page_num": "page_19",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        295,
                        542,
                        369
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        372,
                        540,
                        433
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                372,
                                541,
                                387
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        372,
                                        541,
                                        387
                                    ],
                                    "score": 1.0,
                                    "content": "On the optimization front, we will soon release an online Reinforcement Learning (RL) trainer for",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                71,
                                385,
                                540,
                                398
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        385,
                                        540,
                                        398
                                    ],
                                    "score": 1.0,
                                    "content": "TapeAgents, which will improve the assistant agent using the rewards that the annotator agent com-",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                70,
                                398,
                                540,
                                411
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        398,
                                        540,
                                        411
                                    ],
                                    "score": 1.0,
                                    "content": "putes. Another welcome optimizer addition would be implementing in TapeAgents a text-based feedback-",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                69,
                                410,
                                542,
                                422
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        410,
                                        542,
                                        422
                                    ],
                                    "score": 1.0,
                                    "content": "propagation algorithm like the one in TextGrad. Tapes steps are a perfect medium to attach feedback",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                71,
                                423,
                                84,
                                433
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        423,
                                        84,
                                        433
                                    ],
                                    "score": 1.0,
                                    "content": "to.",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        }
                    ],
                    "index": 19,
                    "page_num": "page_19",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        372,
                        542,
                        433
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        72,
                        451,
                        256,
                        464
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                453,
                                257,
                                465
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        453,
                                        257,
                                        465
                                    ],
                                    "score": 0.9697423577308655,
                                    "content": "7.2  Agent as an Optimizable Workflow",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        }
                    ],
                    "index": 22,
                    "page_num": "page_19",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        475,
                        541,
                        630
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                476,
                                541,
                                488
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        476,
                                        541,
                                        488
                                    ],
                                    "score": 0.9892956018447876,
                                    "content": "Stepping back from the immediate future plans, we believe it is worth refecting on what should be called an",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                70,
                                487,
                                540,
                                501
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        487,
                                        540,
                                        501
                                    ],
                                    "score": 0.9871585965156555,
                                    "content": "LLM Agent and what should be called “just\" a program, a workfow or software. In the TapeAgents context,",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                70,
                                499,
                                541,
                                513
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        499,
                                        541,
                                        513
                                    ],
                                    "score": 1.0,
                                    "content": "this philosophical question is what the developer asks themselves when they build an agent—whether they",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                71,
                                512,
                                541,
                                524
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        512,
                                        541,
                                        524
                                    ],
                                    "score": 1.0,
                                    "content": "should implement as agent nodes, and what should go in the application that uses the agent. Our current",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                70,
                                524,
                                540,
                                536
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        524,
                                        540,
                                        536
                                    ],
                                    "score": 1.0,
                                    "content": "recommendation is that one should treat and implement the parts of the system that they intend to optimize",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                71,
                                536,
                                541,
                                548
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        536,
                                        541,
                                        548
                                    ],
                                    "score": 1.0,
                                    "content": "with data-driven algorithms as LLM Agents. Frameworks provide the structure that the algorithms require",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                70,
                                547,
                                542,
                                561
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        547,
                                        542,
                                        561
                                    ],
                                    "score": 1.0,
                                    "content": "to identify the issue, propose a change, and test the change’s outcome. In TapeAgents, this process is",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                70,
                                559,
                                541,
                                573
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        559,
                                        541,
                                        573
                                    ],
                                    "score": 1.0,
                                    "content": "particularly clear: the algorithm will identify an issue in the tape, attribute it to a root cause step, propose",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                70,
                                572,
                                541,
                                584
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        572,
                                        541,
                                        584
                                    ],
                                    "score": 0.9907531142234802,
                                    "content": "a change to the agent configuration and test this change by resuming the agent from intermediate points in",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                70,
                                583,
                                541,
                                597
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        583,
                                        541,
                                        597
                                    ],
                                    "score": 1.0,
                                    "content": "the tape. Thus the gains from algorithmic improvement will compensate for the overhead of respecting the",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                70,
                                595,
                                541,
                                609
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        595,
                                        541,
                                        609
                                    ],
                                    "score": 0.9881096482276917,
                                    "content": "TapeAgents engineering constraints. To sum up, our recommendation is to implement optimizable workflows",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                70,
                                607,
                                541,
                                621
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        607,
                                        541,
                                        621
                                    ],
                                    "score": 1.0,
                                    "content": "as LLM Agents and use other appropriate tools for the software that will not be subject to data-driven",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                71,
                                620,
                                131,
                                632
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        620,
                                        131,
                                        632
                                    ],
                                    "score": 1.0,
                                    "content": "improvement.",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        }
                    ],
                    "index": 29,
                    "page_num": "page_19",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        476,
                        542,
                        632
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        649,
                        348,
                        661
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                650,
                                348,
                                663
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        650,
                                        348,
                                        663
                                    ],
                                    "score": 1.0,
                                    "content": "7.3 Synthetic Data Generation with Worlds of TapeAgents",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        }
                    ],
                    "index": 36,
                    "page_num": "page_19",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        672,
                        540,
                        732
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                674,
                                540,
                                686
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        674,
                                        540,
                                        686
                                    ],
                                    "score": 0.9839993715286255,
                                    "content": " In addition to helping practitioners with their solution-specific challenges, we envision synthetic data gener-",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                70,
                                685,
                                541,
                                698
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        685,
                                        541,
                                        698
                                    ],
                                    "score": 1.0,
                                    "content": "ation as another application area where TapeAgents can make an impact. A key trend in the data-making",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                71,
                                698,
                                540,
                                710
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        698,
                                        540,
                                        710
                                    ],
                                    "score": 0.9845552444458008,
                                    "content": "trade is building modular pipelines with many agent-like modules, such as prompt-generating workflows (Mi-",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                71,
                                709,
                                541,
                                722
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        709,
                                        541,
                                        722
                                    ],
                                    "score": 1.0,
                                    "content": "tra et al., 2024), judges (Bai et al., 2022), meta-judges (Wu et al., 2024b), process supervisors (Lightman",
                                    "type": "text"
                                }
                            ],
                            "index": 40
                        },
                        {
                            "bbox": [
                                70,
                                721,
                                540,
                                734
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        721,
                                        540,
                                        734
                                    ],
                                    "score": 1.0,
                                    "content": "et al., 2023; Uesato et al., 2022), annotator augmented with tools (Wei et al., 2024) among other examples.",
                                    "type": "text"
                                }
                            ],
                            "index": 41
                        }
                    ],
                    "index": 39,
                    "page_num": "page_19",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        674,
                        541,
                        734
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        72,
                        82,
                        540,
                        106
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                83,
                                541,
                                96
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        83,
                                        541,
                                        96
                                    ],
                                    "score": 1.0,
                                    "content": "We believe TapeAgents is a great foundation for the continual improvement of such multi-agent pipelines with",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                71,
                                96,
                                539,
                                108
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        96,
                                        539,
                                        108
                                    ],
                                    "score": 1.0,
                                    "content": "human feedback, as implementing all pipeline modules as TapeAgents immediately makes them optimizable.",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        }
                    ],
                    "index": 0.5
                },
                {
                    "type": "title",
                    "bbox": [
                        72,
                        120,
                        176,
                        135
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                122,
                                176,
                                136
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        122,
                                        176,
                                        136
                                    ],
                                    "score": 1.0,
                                    "content": "Acknowledgements",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        }
                    ],
                    "index": 2
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        146,
                        540,
                        170
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                147,
                                541,
                                161
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        147,
                                        541,
                                        161
                                    ],
                                    "score": 1.0,
                                    "content": "We would like to thank Nicolas Chapados, Chris Manning, Chris Pal, Sebastien Paquet, Siva Reddy, Arkil",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                71,
                                159,
                                310,
                                171
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        159,
                                        310,
                                        171
                                    ],
                                    "score": 1.0,
                                    "content": "Patel and David Vazquez for their feedback and ideas.",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        }
                    ],
                    "index": 3.5
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        185,
                        131,
                        199
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                185,
                                132,
                                200
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        185,
                                        132,
                                        200
                                    ],
                                    "score": 1.0,
                                    "content": "References",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        }
                    ],
                    "index": 5
                },
                {
                    "type": "text",
                    "bbox": [
                        65,
                        196,
                        543,
                        732
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                206,
                                540,
                                218
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        206,
                                        540,
                                        218
                                    ],
                                    "score": 1.0,
                                    "content": "Bai, Y., Kadavath, S., Kundu, S., Askell, A., Kernion, J., Jones, A., Chen, A., Goldie, A., Mirhoseini, A.,",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                80,
                                217,
                                540,
                                231
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        217,
                                        540,
                                        231
                                    ],
                                    "score": 1.0,
                                    "content": "McKinnon, C., Chen, C., Olsson, C., Olah, C., Hernandez, D., Drain, D., Ganguli, D., Li, D., Tran-",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                80,
                                229,
                                542,
                                243
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        229,
                                        542,
                                        243
                                    ],
                                    "score": 1.0,
                                    "content": "Johnson, E., Perez, E., Kerr, J., Mueller, J., Ladish, J., Landau, J., Ndousse, K., Lukosuite, K., Lovitt,",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                79,
                                240,
                                542,
                                256
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        240,
                                        542,
                                        256
                                    ],
                                    "score": 1.0,
                                    "content": "L., Sellitto, M., Elhage, N., Schiefer, N., Mercado, N., DasSarma, N., Lasenby, R., Larson, R., Ringer, S.,",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                80,
                                253,
                                540,
                                267
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        253,
                                        540,
                                        267
                                    ],
                                    "score": 1.0,
                                    "content": "Johnston, S., Kravec, S., Showk, S. E., Fort, S., Lanham, T., Telleen-Lawton, T., Conerly, T., Henighan,",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                81,
                                265,
                                542,
                                279
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        81,
                                        265,
                                        542,
                                        279
                                    ],
                                    "score": 0.9807438850402832,
                                    "content": "T., Hume, T., Bowman, S. R., Hatfield-Dodds, Z., Mann, B., Amodei, D., Joseph, N., McCandlish, S.,",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                80,
                                277,
                                452,
                                290
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        277,
                                        452,
                                        290
                                    ],
                                    "score": 1.0,
                                    "content": "Brown, T., and Kaplan, J. (2022). Constitutional ai: Harmlessness from ai feedback.",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                71,
                                297,
                                540,
                                310
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        297,
                                        540,
                                        310
                                    ],
                                    "score": 1.0,
                                    "content": "Budzianowski, P., Wen, T.-H., Tseng, B.-H., Casanueva, I., Stefan, U., Osman, R., and Gašić, M. (2018).",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                80,
                                308,
                                541,
                                322
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        308,
                                        541,
                                        322
                                    ],
                                    "score": 1.0,
                                    "content": "Multiwoz - a large-scale multi-domain wizard-of-oz dataset for task-oriented dialogue modelling. In Pro-",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                82,
                                321,
                                512,
                                335
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        82,
                                        321,
                                        512,
                                        335
                                    ],
                                    "score": 1.0,
                                    "content": "ceedings of the 2018 Conference on Empirical Methods in Natural Language Processing (EMNLP).",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                69,
                                339,
                                203,
                                355
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        339,
                                        203,
                                        355
                                    ],
                                    "score": 1.0,
                                    "content": "Chase, H. (2022). LangChain.",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                69,
                                358,
                                205,
                                374
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        358,
                                        205,
                                        374
                                    ],
                                    "score": 1.0,
                                    "content": "Chase, H. (2023). LangGraph.",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                70,
                                379,
                                542,
                                393
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        379,
                                        542,
                                        393
                                    ],
                                    "score": 1.0,
                                    "content": "Chen, X., Lin, M., Schärli, N., and Zhou, D. (2024). Teaching large language models to self-debug. In The",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                82,
                                390,
                                358,
                                406
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        82,
                                        390,
                                        358,
                                        406
                                    ],
                                    "score": 1.0,
                                    "content": "Twelfth International Conference on Learning Representations.",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                70,
                                409,
                                541,
                                425
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        409,
                                        541,
                                        425
                                    ],
                                    "score": 1.0,
                                    "content": "Drouin, A., Gasse, M., Caccia, M., Laradji, I. H., Verme, M. D., Marty, T., Vazquez, D., Chapados, N., and",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                80,
                                422,
                                541,
                                437
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        422,
                                        541,
                                        437
                                    ],
                                    "score": 1.0,
                                    "content": "Lacoste, A. (2024). Workarena: How capable are web agents at solving common knowledge work tasks?",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                80,
                                433,
                                351,
                                449
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        433,
                                        351,
                                        449
                                    ],
                                    "score": 0.9953489303588867,
                                    "content": "In Forty-first International Conference on Machine Learning.",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                69,
                                452,
                                540,
                                467
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        452,
                                        540,
                                        467
                                    ],
                                    "score": 1.0,
                                    "content": "Fourney, A., Bansal, G., Mozannar, H., Tan, C., Salinas, E., Niedtner, F., Proebsting, G., Bassman, G.,",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                80,
                                465,
                                541,
                                480
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        465,
                                        541,
                                        480
                                    ],
                                    "score": 1.0,
                                    "content": "Gerrits, J., Alber, J., et al. (2024). Magentic-one: A generalist multi-agent system for solving complex",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                81,
                                478,
                                257,
                                491
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        81,
                                        478,
                                        257,
                                        491
                                    ],
                                    "score": 1.0,
                                    "content": "tasks. arXiv preprint arXiv:2411.04468.",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                71,
                                497,
                                540,
                                511
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        497,
                                        540,
                                        511
                                    ],
                                    "score": 1.0,
                                    "content": "Gugger, S., Debut, L., Wolf, T., Schmid, P., Mueller, Z., Mangrulkar, S., Sun, M., and Bossan, B. (2022).",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                80,
                                509,
                                540,
                                523
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        509,
                                        540,
                                        523
                                    ],
                                    "score": 0.9926861524581909,
                                    "content": "Accelerate: Training and inference at scale made simple, efficient and adaptable. https://github.com/",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                81,
                                522,
                                191,
                                534
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        81,
                                        522,
                                        191,
                                        534
                                    ],
                                    "score": 1.0,
                                    "content": "huggingface/accelerate.",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                70,
                                540,
                                541,
                                554
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        540,
                                        541,
                                        554
                                    ],
                                    "score": 1.0,
                                    "content": "Hu, E. J., Shen, Y., Wallis, P., Allen-Zhu, Z., Li, Y., Wang, S., Wang, L., and Chen, W. (2021). Lora:",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                80,
                                553,
                                442,
                                566
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        553,
                                        442,
                                        566
                                    ],
                                    "score": 1.0,
                                    "content": "Low-rank adaptation of large language models. arXiv preprint arXiv: 2106.09685.",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                71,
                                572,
                                401,
                                585
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        572,
                                        401,
                                        585
                                    ],
                                    "score": 1.0,
                                    "content": "Hu, S., Lu, C., and Clune, J. (2024). Automated design of agentic systems.",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                70,
                                590,
                                541,
                                604
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        590,
                                        541,
                                        604
                                    ],
                                    "score": 1.0,
                                    "content": "Khattab, O., Singhvi, A., Maheshwari, P., Zhang, Z., Santhanam, K., Vardhamanan, S., Haq, S., Sharma,",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                81,
                                603,
                                541,
                                616
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        81,
                                        603,
                                        541,
                                        616
                                    ],
                                    "score": 1.0,
                                    "content": "A., Joshi, T. T., Moazam, H., Miller, H., Zaharia, M., and Potts, C. (2023a). DSPy: Compiling declarative",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                80,
                                615,
                                452,
                                629
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        615,
                                        452,
                                        629
                                    ],
                                    "score": 1.0,
                                    "content": "language model calls into self-improving pipelines. arXiv preprint arXiv:2310.03714.",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                69,
                                633,
                                541,
                                649
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        633,
                                        541,
                                        649
                                    ],
                                    "score": 1.0,
                                    "content": "Khattab, O., Singhvi, A., Maheshwari, P., Zhang, Z., Santhanam, K., Vardhamanan, S., Haq, S., Sharma,",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                81,
                                646,
                                541,
                                660
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        81,
                                        646,
                                        541,
                                        660
                                    ],
                                    "score": 1.0,
                                    "content": "A., Joshi, T. T., Moazam, H., Miller, H., Zaharia, M., and Potts, C. (2023b). DSPy: Compiling declarative",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                79,
                                657,
                                302,
                                673
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        657,
                                        302,
                                        673
                                    ],
                                    "score": 1.0,
                                    "content": "language model calls into self-improving pipelines.",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                69,
                                676,
                                543,
                                693
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        676,
                                        543,
                                        693
                                    ],
                                    "score": 1.0,
                                    "content": "Kim, G., Baldi, P., and McAleer, S. M. (2023). Language models can solve computer tasks. In Thirty-seventh",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                82,
                                690,
                                323,
                                702
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        82,
                                        690,
                                        323,
                                        702
                                    ],
                                    "score": 1.0,
                                    "content": "Conference on Neural Information Processing Systems.",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                69,
                                707,
                                542,
                                723
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        707,
                                        542,
                                        723
                                    ],
                                    "score": 1.0,
                                    "content": "Lightman, H., Kosaraju, V., Burda, Y., Edwards, H., Baker, B., Lee, T., Leike, J., Schulman, J., Sutskever,",
                                    "type": "text"
                                }
                            ],
                            "index": 40
                        },
                        {
                            "bbox": [
                                80,
                                721,
                                455,
                                734
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        721,
                                        455,
                                        734
                                    ],
                                    "score": 1.0,
                                    "content": "I., and Cobbe, K. (2023). Let’s verify step by step. arXiv preprint arXiv:2305.20050.",
                                    "type": "text"
                                }
                            ],
                            "index": 41
                        }
                    ],
                    "index": 23.5
                }
            ],
            "layout_bboxes": [],
            "page_idx": 20,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        71,
                        27,
                        143,
                        37
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                26,
                                144,
                                38
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        26,
                                        144,
                                        38
                                    ],
                                    "score": 1.0,
                                    "content": "Technical report",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        751,
                        310,
                        761
                    ],
                    "lines": [
                        {
                            "bbox": [
                                299,
                                751,
                                312,
                                762
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        299,
                                        751,
                                        312,
                                        762
                                    ],
                                    "score": 1.0,
                                    "content": "21",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        72,
                        82,
                        540,
                        106
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                83,
                                541,
                                96
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        83,
                                        541,
                                        96
                                    ],
                                    "score": 1.0,
                                    "content": "We believe TapeAgents is a great foundation for the continual improvement of such multi-agent pipelines with",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                71,
                                96,
                                539,
                                108
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        96,
                                        539,
                                        108
                                    ],
                                    "score": 1.0,
                                    "content": "human feedback, as implementing all pipeline modules as TapeAgents immediately makes them optimizable.",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        }
                    ],
                    "index": 0.5,
                    "page_num": "page_20",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        71,
                        83,
                        541,
                        108
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        72,
                        120,
                        176,
                        135
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                122,
                                176,
                                136
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        122,
                                        176,
                                        136
                                    ],
                                    "score": 1.0,
                                    "content": "Acknowledgements",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        }
                    ],
                    "index": 2,
                    "page_num": "page_20",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        71,
                        146,
                        540,
                        170
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                147,
                                541,
                                161
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        147,
                                        541,
                                        161
                                    ],
                                    "score": 1.0,
                                    "content": "We would like to thank Nicolas Chapados, Chris Manning, Chris Pal, Sebastien Paquet, Siva Reddy, Arkil",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                71,
                                159,
                                310,
                                171
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        159,
                                        310,
                                        171
                                    ],
                                    "score": 1.0,
                                    "content": "Patel and David Vazquez for their feedback and ideas.",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        }
                    ],
                    "index": 3.5,
                    "page_num": "page_20",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        147,
                        541,
                        171
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        185,
                        131,
                        199
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                185,
                                132,
                                200
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        185,
                                        132,
                                        200
                                    ],
                                    "score": 1.0,
                                    "content": "References",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        }
                    ],
                    "index": 5,
                    "page_num": "page_20",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "list",
                    "bbox": [
                        65,
                        196,
                        543,
                        732
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                206,
                                540,
                                218
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        206,
                                        540,
                                        218
                                    ],
                                    "score": 1.0,
                                    "content": "Bai, Y., Kadavath, S., Kundu, S., Askell, A., Kernion, J., Jones, A., Chen, A., Goldie, A., Mirhoseini, A.,",
                                    "type": "text"
                                }
                            ],
                            "index": 6,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                80,
                                217,
                                540,
                                231
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        217,
                                        540,
                                        231
                                    ],
                                    "score": 1.0,
                                    "content": "McKinnon, C., Chen, C., Olsson, C., Olah, C., Hernandez, D., Drain, D., Ganguli, D., Li, D., Tran-",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                80,
                                229,
                                542,
                                243
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        229,
                                        542,
                                        243
                                    ],
                                    "score": 1.0,
                                    "content": "Johnson, E., Perez, E., Kerr, J., Mueller, J., Ladish, J., Landau, J., Ndousse, K., Lukosuite, K., Lovitt,",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                79,
                                240,
                                542,
                                256
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        240,
                                        542,
                                        256
                                    ],
                                    "score": 1.0,
                                    "content": "L., Sellitto, M., Elhage, N., Schiefer, N., Mercado, N., DasSarma, N., Lasenby, R., Larson, R., Ringer, S.,",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                80,
                                253,
                                540,
                                267
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        253,
                                        540,
                                        267
                                    ],
                                    "score": 1.0,
                                    "content": "Johnston, S., Kravec, S., Showk, S. E., Fort, S., Lanham, T., Telleen-Lawton, T., Conerly, T., Henighan,",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                81,
                                265,
                                542,
                                279
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        81,
                                        265,
                                        542,
                                        279
                                    ],
                                    "score": 0.9807438850402832,
                                    "content": "T., Hume, T., Bowman, S. R., Hatfield-Dodds, Z., Mann, B., Amodei, D., Joseph, N., McCandlish, S.,",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                80,
                                277,
                                452,
                                290
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        277,
                                        452,
                                        290
                                    ],
                                    "score": 1.0,
                                    "content": "Brown, T., and Kaplan, J. (2022). Constitutional ai: Harmlessness from ai feedback.",
                                    "type": "text"
                                }
                            ],
                            "index": 12,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                297,
                                540,
                                310
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        297,
                                        540,
                                        310
                                    ],
                                    "score": 1.0,
                                    "content": "Budzianowski, P., Wen, T.-H., Tseng, B.-H., Casanueva, I., Stefan, U., Osman, R., and Gašić, M. (2018).",
                                    "type": "text"
                                }
                            ],
                            "index": 13,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                80,
                                308,
                                541,
                                322
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        308,
                                        541,
                                        322
                                    ],
                                    "score": 1.0,
                                    "content": "Multiwoz - a large-scale multi-domain wizard-of-oz dataset for task-oriented dialogue modelling. In Pro-",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                82,
                                321,
                                512,
                                335
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        82,
                                        321,
                                        512,
                                        335
                                    ],
                                    "score": 1.0,
                                    "content": "ceedings of the 2018 Conference on Empirical Methods in Natural Language Processing (EMNLP).",
                                    "type": "text"
                                }
                            ],
                            "index": 15,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                69,
                                339,
                                203,
                                355
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        339,
                                        203,
                                        355
                                    ],
                                    "score": 1.0,
                                    "content": "Chase, H. (2022). LangChain.",
                                    "type": "text"
                                }
                            ],
                            "index": 16,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                69,
                                358,
                                205,
                                374
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        358,
                                        205,
                                        374
                                    ],
                                    "score": 1.0,
                                    "content": "Chase, H. (2023). LangGraph.",
                                    "type": "text"
                                }
                            ],
                            "index": 17,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                379,
                                542,
                                393
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        379,
                                        542,
                                        393
                                    ],
                                    "score": 1.0,
                                    "content": "Chen, X., Lin, M., Schärli, N., and Zhou, D. (2024). Teaching large language models to self-debug. In The",
                                    "type": "text"
                                }
                            ],
                            "index": 18,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                82,
                                390,
                                358,
                                406
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        82,
                                        390,
                                        358,
                                        406
                                    ],
                                    "score": 1.0,
                                    "content": "Twelfth International Conference on Learning Representations.",
                                    "type": "text"
                                }
                            ],
                            "index": 19,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                409,
                                541,
                                425
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        409,
                                        541,
                                        425
                                    ],
                                    "score": 1.0,
                                    "content": "Drouin, A., Gasse, M., Caccia, M., Laradji, I. H., Verme, M. D., Marty, T., Vazquez, D., Chapados, N., and",
                                    "type": "text"
                                }
                            ],
                            "index": 20,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                80,
                                422,
                                541,
                                437
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        422,
                                        541,
                                        437
                                    ],
                                    "score": 1.0,
                                    "content": "Lacoste, A. (2024). Workarena: How capable are web agents at solving common knowledge work tasks?",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                80,
                                433,
                                351,
                                449
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        433,
                                        351,
                                        449
                                    ],
                                    "score": 0.9953489303588867,
                                    "content": "In Forty-first International Conference on Machine Learning.",
                                    "type": "text"
                                }
                            ],
                            "index": 22,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                69,
                                452,
                                540,
                                467
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        452,
                                        540,
                                        467
                                    ],
                                    "score": 1.0,
                                    "content": "Fourney, A., Bansal, G., Mozannar, H., Tan, C., Salinas, E., Niedtner, F., Proebsting, G., Bassman, G.,",
                                    "type": "text"
                                }
                            ],
                            "index": 23,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                80,
                                465,
                                541,
                                480
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        465,
                                        541,
                                        480
                                    ],
                                    "score": 1.0,
                                    "content": "Gerrits, J., Alber, J., et al. (2024). Magentic-one: A generalist multi-agent system for solving complex",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                81,
                                478,
                                257,
                                491
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        81,
                                        478,
                                        257,
                                        491
                                    ],
                                    "score": 1.0,
                                    "content": "tasks. arXiv preprint arXiv:2411.04468.",
                                    "type": "text"
                                }
                            ],
                            "index": 25,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                497,
                                540,
                                511
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        497,
                                        540,
                                        511
                                    ],
                                    "score": 1.0,
                                    "content": "Gugger, S., Debut, L., Wolf, T., Schmid, P., Mueller, Z., Mangrulkar, S., Sun, M., and Bossan, B. (2022).",
                                    "type": "text"
                                }
                            ],
                            "index": 26,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                80,
                                509,
                                540,
                                523
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        509,
                                        540,
                                        523
                                    ],
                                    "score": 0.9926861524581909,
                                    "content": "Accelerate: Training and inference at scale made simple, efficient and adaptable. https://github.com/",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                81,
                                522,
                                191,
                                534
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        81,
                                        522,
                                        191,
                                        534
                                    ],
                                    "score": 1.0,
                                    "content": "huggingface/accelerate.",
                                    "type": "text"
                                }
                            ],
                            "index": 28,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                540,
                                541,
                                554
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        540,
                                        541,
                                        554
                                    ],
                                    "score": 1.0,
                                    "content": "Hu, E. J., Shen, Y., Wallis, P., Allen-Zhu, Z., Li, Y., Wang, S., Wang, L., and Chen, W. (2021). Lora:",
                                    "type": "text"
                                }
                            ],
                            "index": 29,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                80,
                                553,
                                442,
                                566
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        553,
                                        442,
                                        566
                                    ],
                                    "score": 1.0,
                                    "content": "Low-rank adaptation of large language models. arXiv preprint arXiv: 2106.09685.",
                                    "type": "text"
                                }
                            ],
                            "index": 30,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                572,
                                401,
                                585
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        572,
                                        401,
                                        585
                                    ],
                                    "score": 1.0,
                                    "content": "Hu, S., Lu, C., and Clune, J. (2024). Automated design of agentic systems.",
                                    "type": "text"
                                }
                            ],
                            "index": 31,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                590,
                                541,
                                604
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        590,
                                        541,
                                        604
                                    ],
                                    "score": 1.0,
                                    "content": "Khattab, O., Singhvi, A., Maheshwari, P., Zhang, Z., Santhanam, K., Vardhamanan, S., Haq, S., Sharma,",
                                    "type": "text"
                                }
                            ],
                            "index": 32,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                81,
                                603,
                                541,
                                616
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        81,
                                        603,
                                        541,
                                        616
                                    ],
                                    "score": 1.0,
                                    "content": "A., Joshi, T. T., Moazam, H., Miller, H., Zaharia, M., and Potts, C. (2023a). DSPy: Compiling declarative",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                80,
                                615,
                                452,
                                629
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        615,
                                        452,
                                        629
                                    ],
                                    "score": 1.0,
                                    "content": "language model calls into self-improving pipelines. arXiv preprint arXiv:2310.03714.",
                                    "type": "text"
                                }
                            ],
                            "index": 34,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                69,
                                633,
                                541,
                                649
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        633,
                                        541,
                                        649
                                    ],
                                    "score": 1.0,
                                    "content": "Khattab, O., Singhvi, A., Maheshwari, P., Zhang, Z., Santhanam, K., Vardhamanan, S., Haq, S., Sharma,",
                                    "type": "text"
                                }
                            ],
                            "index": 35,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                81,
                                646,
                                541,
                                660
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        81,
                                        646,
                                        541,
                                        660
                                    ],
                                    "score": 1.0,
                                    "content": "A., Joshi, T. T., Moazam, H., Miller, H., Zaharia, M., and Potts, C. (2023b). DSPy: Compiling declarative",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                79,
                                657,
                                302,
                                673
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        657,
                                        302,
                                        673
                                    ],
                                    "score": 1.0,
                                    "content": "language model calls into self-improving pipelines.",
                                    "type": "text"
                                }
                            ],
                            "index": 37,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                69,
                                676,
                                543,
                                693
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        676,
                                        543,
                                        693
                                    ],
                                    "score": 1.0,
                                    "content": "Kim, G., Baldi, P., and McAleer, S. M. (2023). Language models can solve computer tasks. In Thirty-seventh",
                                    "type": "text"
                                }
                            ],
                            "index": 38,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                82,
                                690,
                                323,
                                702
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        82,
                                        690,
                                        323,
                                        702
                                    ],
                                    "score": 1.0,
                                    "content": "Conference on Neural Information Processing Systems.",
                                    "type": "text"
                                }
                            ],
                            "index": 39,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                69,
                                707,
                                542,
                                723
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        707,
                                        542,
                                        723
                                    ],
                                    "score": 1.0,
                                    "content": "Lightman, H., Kosaraju, V., Burda, Y., Edwards, H., Baker, B., Lee, T., Leike, J., Schulman, J., Sutskever,",
                                    "type": "text"
                                }
                            ],
                            "index": 40,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                80,
                                721,
                                455,
                                734
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        721,
                                        455,
                                        734
                                    ],
                                    "score": 1.0,
                                    "content": "I., and Cobbe, K. (2023). Let’s verify step by step. arXiv preprint arXiv:2305.20050.",
                                    "type": "text"
                                }
                            ],
                            "index": 41,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                69,
                                81,
                                542,
                                99
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        81,
                                        542,
                                        99
                                    ],
                                    "score": 1.0,
                                    "content": "Loshchilov, I. and Hutter, F. (2017). Decoupled weight decay regularization. International Conference on",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 0,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                81,
                                94,
                                196,
                                110
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        81,
                                        94,
                                        196,
                                        110
                                    ],
                                    "score": 1.0,
                                    "content": "Learning Representations.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 1,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                69,
                                114,
                                542,
                                131
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        114,
                                        542,
                                        131
                                    ],
                                    "score": 1.0,
                                    "content": "Mialon, G., Fourrier, C., Wolf, T., LeCun, Y., and Scialom, T. (2024). GAIA: a benchmark for general AI",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 2,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                80,
                                128,
                                440,
                                142
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        128,
                                        440,
                                        142
                                    ],
                                    "score": 1.0,
                                    "content": "assistants. In The Twelfth International Conference on Learning Representations.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 3,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                69,
                                146,
                                541,
                                163
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        146,
                                        541,
                                        163
                                    ],
                                    "score": 1.0,
                                    "content": "Mitra, A., Corro, L. D., Zheng, G., Mahajan, S., Rouhana, D., Codas, A., Lu, Y., ge Chen, W., Vrousgos,",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 4,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                80,
                                160,
                                542,
                                174
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        160,
                                        542,
                                        174
                                    ],
                                    "score": 1.0,
                                    "content": "O., Rosset, C., Silva, F., Khanpour, H., Lara, Y., and Awadallah, A. (2024). Agentinstruct: Toward",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                79,
                                172,
                                252,
                                187
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        172,
                                        252,
                                        187
                                    ],
                                    "score": 0.9812988042831421,
                                    "content": " generative teaching with agentic fows.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 6,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                69,
                                191,
                                542,
                                208
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        191,
                                        542,
                                        208
                                    ],
                                    "score": 1.0,
                                    "content": "Pryzant, R., Iter, D., Li, J., Lee, Y., Zhu, C., and Zeng, M. (2023). Automatic prompt optimization with",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 7,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                81,
                                204,
                                542,
                                218
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        81,
                                        204,
                                        542,
                                        218
                                    ],
                                    "score": 1.0,
                                    "content": "“gradient descent” and beam search. In Proceedings of the 2023 Conference on Empirical Methods in",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                80,
                                216,
                                528,
                                232
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        216,
                                        528,
                                        232
                                    ],
                                    "score": 1.0,
                                    "content": "Natural Language Processing, pages 7957–7968, Singapore. Association for Computational Linguistics.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                69,
                                236,
                                542,
                                252
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        236,
                                        542,
                                        252
                                    ],
                                    "score": 1.0,
                                    "content": "Rasley, J., Rajbhandari, S., Ruwase, O., and He, Y. (2020). Deepspeed: System optimizations enable",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 10,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                79,
                                248,
                                543,
                                264
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        248,
                                        543,
                                        264
                                    ],
                                    "score": 1.0,
                                    "content": "training deep learning models with over 100 billion parameters. Proceedings of the 26th ACM SIGKDD",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                79,
                                258,
                                376,
                                277
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        258,
                                        376,
                                        277
                                    ],
                                    "score": 1.0,
                                    "content": "International Conference on Knowledge Discovery & Data Mining.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 12,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                69,
                                279,
                                542,
                                296
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        279,
                                        542,
                                        296
                                    ],
                                    "score": 1.0,
                                    "content": "Rastogi, A., Zang, X., Sunkara, S., Gupta, R., and Khaitan, P. (2020). Towards scalable multi-domain",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 13,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                80,
                                293,
                                542,
                                307
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        293,
                                        542,
                                        307
                                    ],
                                    "score": 1.0,
                                    "content": "conversational agents: The schema-guided dialogue dataset. In Proceedings of the AAAI Conference on",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                79,
                                303,
                                307,
                                320
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        303,
                                        307,
                                        320
                                    ],
                                    "score": 0.9884405136108398,
                                    "content": "Artifcial Intelligence, volume 34, pages 8689-8696.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 15,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                69,
                                323,
                                542,
                                340
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        323,
                                        542,
                                        340
                                    ],
                                    "score": 0.979293942451477,
                                    "content": "Shinn, N., Cassano, F., Gopinath, A., Narasimhan, K., and Yao, S. (2024). Refexion: Language agents with",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 16,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                80,
                                337,
                                510,
                                351
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        337,
                                        510,
                                        351
                                    ],
                                    "score": 1.0,
                                    "content": "verbal reinforcement learning. In Advances in Neural Information Processing Systems, volume 36.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 17,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                69,
                                357,
                                542,
                                373
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        357,
                                        542,
                                        373
                                    ],
                                    "score": 1.0,
                                    "content": "Uesato, J., Kushman, N., Kumar, R., Song, F., Siegel, N., Wang, L., Creswell, A., Irving, G., and Higgins,",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 18,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                77,
                                368,
                                445,
                                385
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        368,
                                        445,
                                        385
                                    ],
                                    "score": 1.0,
                                    "content": "I. (2022). Solving math word problems with process- and outcome-based feedback.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 19,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                390,
                                540,
                                404
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        390,
                                        540,
                                        404
                                    ],
                                    "score": 1.0,
                                    "content": "Wang, L., Ma, C., Feng, X., Zhang, Z., Yang, H., Zhang, J., Chen, Z., Tang, J., Chen, X., Lin, Y., Zhao,",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 20,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                79,
                                401,
                                542,
                                418
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        401,
                                        542,
                                        418
                                    ],
                                    "score": 1.0,
                                    "content": "W. X., Wei, Z., and Wen, J. (2024). A survey on large language model based autonomous agents. Frontiers",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                81,
                                413,
                                236,
                                428
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        81,
                                        413,
                                        236,
                                        428
                                    ],
                                    "score": 1.0,
                                    "content": "of Computer Science, 18(6):186345.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 22,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                69,
                                433,
                                542,
                                450
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        433,
                                        542,
                                        450
                                    ],
                                    "score": 1.0,
                                    "content": "Wei, J., Yang, C., Song, X., Lu, Y., Hu, N., Huang, J., Tran, D., Peng, D., Liu, R., Huang, D., Du, C., and",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 23,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                79,
                                446,
                                367,
                                462
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        446,
                                        367,
                                        462
                                    ],
                                    "score": 1.0,
                                    "content": "Le, Q. V. (2024). Long-form factuality in large language models.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 24,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                69,
                                465,
                                541,
                                482
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        465,
                                        541,
                                        482
                                    ],
                                    "score": 1.0,
                                    "content": "Wu, Q., Bansal, G., Zhang, J., Wu, Y., Li, B., Zhu, E., Jiang, L., Zhang, X., Zhang, S., Liu, J., Awadallah,",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 25,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                79,
                                477,
                                542,
                                495
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        477,
                                        542,
                                        495
                                    ],
                                    "score": 1.0,
                                    "content": "A. H., White, R. W., Burger, D., and Wang, C. (2024a). Autogen: Enabling next-gen llm applications via",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                80,
                                491,
                                293,
                                505
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        491,
                                        293,
                                        505
                                    ],
                                    "score": 1.0,
                                    "content": "multi-agent conversation framework. In COLM.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 27,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                511,
                                540,
                                525
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        511,
                                        540,
                                        525
                                    ],
                                    "score": 1.0,
                                    "content": "Wu, T., Yuan, W., Golovneva, O., Xu, J., Tian, Y., Jiao, J., Weston, J., and Sukhbaatar, S. (2024b).",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 28,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                79,
                                522,
                                543,
                                538
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        522,
                                        543,
                                        538
                                    ],
                                    "score": 1.0,
                                    "content": "Meta-rewarding language models: Self-improving alignment with LLM-as-a-meta-judge. arXiv preprint",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                81,
                                533,
                                162,
                                549
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        81,
                                        533,
                                        162,
                                        549
                                    ],
                                    "score": 1.0,
                                    "content": "arXiv:2407.19594.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 30,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                69,
                                555,
                                543,
                                571
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        555,
                                        543,
                                        571
                                    ],
                                    "score": 1.0,
                                    "content": "Xie, Y., Kawaguchi, K., Zhao, Y., Zhao, X., Kan, M.-Y., He, J., and Xie, Q. (2023). Self-evaluation guided",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 31,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                79,
                                566,
                                522,
                                583
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        566,
                                        522,
                                        583
                                    ],
                                    "score": 1.0,
                                    "content": "beam search for reasoning. In Thirty-seventh Conference on Neural Information Processing Systems.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 32,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                587,
                                542,
                                603
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        587,
                                        542,
                                        603
                                    ],
                                    "score": 0.9724253416061401,
                                    "content": "Yao, S., Yu, D., Zhao, J., Shafran, I., Griffths, T. L., Cao, Y., and Narasimhan, K. R. (2023a). Tree of",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 33,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                79,
                                597,
                                543,
                                617
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        597,
                                        543,
                                        617
                                    ],
                                    "score": 1.0,
                                    "content": "thoughts: Deliberate problem solving with large language models. In Thirty-seventh Conference on Neural",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                81,
                                612,
                                225,
                                627
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        81,
                                        612,
                                        225,
                                        627
                                    ],
                                    "score": 1.0,
                                    "content": "Information Processing Systems.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 35,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                632,
                                542,
                                647
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        632,
                                        542,
                                        647
                                    ],
                                    "score": 1.0,
                                    "content": "Yao, S., Zhao, J., Yu, D., Du, N., Shafran, I., Narasimhan, K., and Cao, Y. (2023b). ReAct: Synergizing",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 36,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                79,
                                643,
                                263,
                                660
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        643,
                                        263,
                                        660
                                    ],
                                    "score": 1.0,
                                    "content": "reasoning and acting in language models.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 37,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                664,
                                540,
                                679
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        664,
                                        540,
                                        679
                                    ],
                                    "score": 1.0,
                                    "content": "Yao, S., Zhao, J., Yu, D., Du, N., Shafran, I., Narasimhan, K. R., and Cao, Y. (2023c). ReAct: Syner-",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 38,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                79,
                                676,
                                542,
                                692
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        676,
                                        542,
                                        692
                                    ],
                                    "score": 1.0,
                                    "content": "gizing reasoning and acting in language models. In The Eleventh International Conference on Learning",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                80,
                                687,
                                431,
                                704
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        687,
                                        431,
                                        704
                                    ],
                                    "score": 1.0,
                                    "content": "Representations, ICLR 2023, Kigali, Rwanda, May 1-5, 2023. OpenReview.net.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 40,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                707,
                                542,
                                724
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        707,
                                        542,
                                        724
                                    ],
                                    "score": 1.0,
                                    "content": "Yuksekgonul, M., Bianchi, F., Boen, J., Liu, S., Huang, Z., Guestrin, C., and Zou, J. (2024). Textgrad:",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 41,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                80,
                                720,
                                240,
                                735
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        720,
                                        240,
                                        735
                                    ],
                                    "score": 0.984423041343689,
                                    "content": "Automatic \"differentiation\" via text.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 42,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                82,
                                541,
                                97
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        82,
                                        541,
                                        97
                                    ],
                                    "score": 1.0,
                                    "content": "Zhang, S., Zhang, J., Liu, J., Song, L., Wang, C., Krishna, R., and Wu, Q. (2024). Training language model",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 0,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                80,
                                95,
                                318,
                                108
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        95,
                                        318,
                                        108
                                    ],
                                    "score": 1.0,
                                    "content": "agents without modifying language models. ICML’24.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 1,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                114,
                                541,
                                128
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        114,
                                        541,
                                        128
                                    ],
                                    "score": 1.0,
                                    "content": "Zhou, W., Jiang, Y. E., Li, L., Wu, J., Wang, T., Qiu, S., Zhang, J., Chen, J., Wu, R., Wang, S., Zhu,",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 2,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                80,
                                126,
                                541,
                                141
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        126,
                                        541,
                                        141
                                    ],
                                    "score": 1.0,
                                    "content": "S., Chen, J., Zhang, W., Tang, X., Zhang, N., Chen, H., Cui, P., and Sachan, M. (2023a). Agents: An",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                79,
                                138,
                                329,
                                153
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        138,
                                        329,
                                        153
                                    ],
                                    "score": 1.0,
                                    "content": "open-source framework for autonomous language agents.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 4,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                157,
                                541,
                                173
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        157,
                                        541,
                                        173
                                    ],
                                    "score": 1.0,
                                    "content": "Zhou, W., Ou, Y., Ding, S., Li, L., Wu, J., Wang, T., Chen, J., Wang, S., Xu, X., Zhang, N., Chen, H., and",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 5,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                79,
                                170,
                                376,
                                185
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        170,
                                        376,
                                        185
                                    ],
                                    "score": 1.0,
                                    "content": "Jiang, Y. E. (2024). Symbolic learning enables self-evolving agents.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 6,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                190,
                                541,
                                204
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        190,
                                        541,
                                        204
                                    ],
                                    "score": 1.0,
                                    "content": "Zhou, Y., Muresanu, A. I., Han, Z., Paster, K., Pitis, S., Chan, H., and Ba, J. (2023b). Large language models",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 7,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                81,
                                203,
                                540,
                                216
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        81,
                                        203,
                                        540,
                                        216
                                    ],
                                    "score": 1.0,
                                    "content": "are human-level prompt engineers. In The Eleventh International Conference on Learning Representations.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 8
                        }
                    ],
                    "index": 23.5,
                    "page_num": "page_20",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        206,
                        543,
                        734
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        68,
                        49,
                        545,
                        732
                    ],
                    "lines": [
                        {
                            "bbox": [
                                69,
                                81,
                                542,
                                99
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        81,
                                        542,
                                        99
                                    ],
                                    "score": 1.0,
                                    "content": "Loshchilov, I. and Hutter, F. (2017). Decoupled weight decay regularization. International Conference on",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                81,
                                94,
                                196,
                                110
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        81,
                                        94,
                                        196,
                                        110
                                    ],
                                    "score": 1.0,
                                    "content": "Learning Representations.",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                69,
                                114,
                                542,
                                131
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        114,
                                        542,
                                        131
                                    ],
                                    "score": 1.0,
                                    "content": "Mialon, G., Fourrier, C., Wolf, T., LeCun, Y., and Scialom, T. (2024). GAIA: a benchmark for general AI",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                80,
                                128,
                                440,
                                142
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        128,
                                        440,
                                        142
                                    ],
                                    "score": 1.0,
                                    "content": "assistants. In The Twelfth International Conference on Learning Representations.",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                69,
                                146,
                                541,
                                163
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        146,
                                        541,
                                        163
                                    ],
                                    "score": 1.0,
                                    "content": "Mitra, A., Corro, L. D., Zheng, G., Mahajan, S., Rouhana, D., Codas, A., Lu, Y., ge Chen, W., Vrousgos,",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                80,
                                160,
                                542,
                                174
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        160,
                                        542,
                                        174
                                    ],
                                    "score": 1.0,
                                    "content": "O., Rosset, C., Silva, F., Khanpour, H., Lara, Y., and Awadallah, A. (2024). Agentinstruct: Toward",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                79,
                                172,
                                252,
                                187
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        172,
                                        252,
                                        187
                                    ],
                                    "score": 0.9812988042831421,
                                    "content": " generative teaching with agentic fows.",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                69,
                                191,
                                542,
                                208
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        191,
                                        542,
                                        208
                                    ],
                                    "score": 1.0,
                                    "content": "Pryzant, R., Iter, D., Li, J., Lee, Y., Zhu, C., and Zeng, M. (2023). Automatic prompt optimization with",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                81,
                                204,
                                542,
                                218
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        81,
                                        204,
                                        542,
                                        218
                                    ],
                                    "score": 1.0,
                                    "content": "“gradient descent” and beam search. In Proceedings of the 2023 Conference on Empirical Methods in",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                80,
                                216,
                                528,
                                232
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        216,
                                        528,
                                        232
                                    ],
                                    "score": 1.0,
                                    "content": "Natural Language Processing, pages 7957–7968, Singapore. Association for Computational Linguistics.",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                69,
                                236,
                                542,
                                252
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        236,
                                        542,
                                        252
                                    ],
                                    "score": 1.0,
                                    "content": "Rasley, J., Rajbhandari, S., Ruwase, O., and He, Y. (2020). Deepspeed: System optimizations enable",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                79,
                                248,
                                543,
                                264
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        248,
                                        543,
                                        264
                                    ],
                                    "score": 1.0,
                                    "content": "training deep learning models with over 100 billion parameters. Proceedings of the 26th ACM SIGKDD",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                79,
                                258,
                                376,
                                277
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        258,
                                        376,
                                        277
                                    ],
                                    "score": 1.0,
                                    "content": "International Conference on Knowledge Discovery & Data Mining.",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                69,
                                279,
                                542,
                                296
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        279,
                                        542,
                                        296
                                    ],
                                    "score": 1.0,
                                    "content": "Rastogi, A., Zang, X., Sunkara, S., Gupta, R., and Khaitan, P. (2020). Towards scalable multi-domain",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                80,
                                293,
                                542,
                                307
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        293,
                                        542,
                                        307
                                    ],
                                    "score": 1.0,
                                    "content": "conversational agents: The schema-guided dialogue dataset. In Proceedings of the AAAI Conference on",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                79,
                                303,
                                307,
                                320
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        303,
                                        307,
                                        320
                                    ],
                                    "score": 0.9884405136108398,
                                    "content": "Artifcial Intelligence, volume 34, pages 8689-8696.",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                69,
                                323,
                                542,
                                340
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        323,
                                        542,
                                        340
                                    ],
                                    "score": 0.979293942451477,
                                    "content": "Shinn, N., Cassano, F., Gopinath, A., Narasimhan, K., and Yao, S. (2024). Refexion: Language agents with",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                80,
                                337,
                                510,
                                351
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        337,
                                        510,
                                        351
                                    ],
                                    "score": 1.0,
                                    "content": "verbal reinforcement learning. In Advances in Neural Information Processing Systems, volume 36.",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                69,
                                357,
                                542,
                                373
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        357,
                                        542,
                                        373
                                    ],
                                    "score": 1.0,
                                    "content": "Uesato, J., Kushman, N., Kumar, R., Song, F., Siegel, N., Wang, L., Creswell, A., Irving, G., and Higgins,",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                77,
                                368,
                                445,
                                385
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        368,
                                        445,
                                        385
                                    ],
                                    "score": 1.0,
                                    "content": "I. (2022). Solving math word problems with process- and outcome-based feedback.",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                71,
                                390,
                                540,
                                404
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        390,
                                        540,
                                        404
                                    ],
                                    "score": 1.0,
                                    "content": "Wang, L., Ma, C., Feng, X., Zhang, Z., Yang, H., Zhang, J., Chen, Z., Tang, J., Chen, X., Lin, Y., Zhao,",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                79,
                                401,
                                542,
                                418
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        401,
                                        542,
                                        418
                                    ],
                                    "score": 1.0,
                                    "content": "W. X., Wei, Z., and Wen, J. (2024). A survey on large language model based autonomous agents. Frontiers",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                81,
                                413,
                                236,
                                428
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        81,
                                        413,
                                        236,
                                        428
                                    ],
                                    "score": 1.0,
                                    "content": "of Computer Science, 18(6):186345.",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                69,
                                433,
                                542,
                                450
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        433,
                                        542,
                                        450
                                    ],
                                    "score": 1.0,
                                    "content": "Wei, J., Yang, C., Song, X., Lu, Y., Hu, N., Huang, J., Tran, D., Peng, D., Liu, R., Huang, D., Du, C., and",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                79,
                                446,
                                367,
                                462
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        446,
                                        367,
                                        462
                                    ],
                                    "score": 1.0,
                                    "content": "Le, Q. V. (2024). Long-form factuality in large language models.",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                69,
                                465,
                                541,
                                482
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        465,
                                        541,
                                        482
                                    ],
                                    "score": 1.0,
                                    "content": "Wu, Q., Bansal, G., Zhang, J., Wu, Y., Li, B., Zhu, E., Jiang, L., Zhang, X., Zhang, S., Liu, J., Awadallah,",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                79,
                                477,
                                542,
                                495
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        477,
                                        542,
                                        495
                                    ],
                                    "score": 1.0,
                                    "content": "A. H., White, R. W., Burger, D., and Wang, C. (2024a). Autogen: Enabling next-gen llm applications via",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                80,
                                491,
                                293,
                                505
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        491,
                                        293,
                                        505
                                    ],
                                    "score": 1.0,
                                    "content": "multi-agent conversation framework. In COLM.",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                70,
                                511,
                                540,
                                525
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        511,
                                        540,
                                        525
                                    ],
                                    "score": 1.0,
                                    "content": "Wu, T., Yuan, W., Golovneva, O., Xu, J., Tian, Y., Jiao, J., Weston, J., and Sukhbaatar, S. (2024b).",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                79,
                                522,
                                543,
                                538
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        522,
                                        543,
                                        538
                                    ],
                                    "score": 1.0,
                                    "content": "Meta-rewarding language models: Self-improving alignment with LLM-as-a-meta-judge. arXiv preprint",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                81,
                                533,
                                162,
                                549
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        81,
                                        533,
                                        162,
                                        549
                                    ],
                                    "score": 1.0,
                                    "content": "arXiv:2407.19594.",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                69,
                                555,
                                543,
                                571
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        555,
                                        543,
                                        571
                                    ],
                                    "score": 1.0,
                                    "content": "Xie, Y., Kawaguchi, K., Zhao, Y., Zhao, X., Kan, M.-Y., He, J., and Xie, Q. (2023). Self-evaluation guided",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                79,
                                566,
                                522,
                                583
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        566,
                                        522,
                                        583
                                    ],
                                    "score": 1.0,
                                    "content": "beam search for reasoning. In Thirty-seventh Conference on Neural Information Processing Systems.",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                70,
                                587,
                                542,
                                603
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        587,
                                        542,
                                        603
                                    ],
                                    "score": 0.9724253416061401,
                                    "content": "Yao, S., Yu, D., Zhao, J., Shafran, I., Griffths, T. L., Cao, Y., and Narasimhan, K. R. (2023a). Tree of",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                79,
                                597,
                                543,
                                617
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        597,
                                        543,
                                        617
                                    ],
                                    "score": 1.0,
                                    "content": "thoughts: Deliberate problem solving with large language models. In Thirty-seventh Conference on Neural",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                81,
                                612,
                                225,
                                627
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        81,
                                        612,
                                        225,
                                        627
                                    ],
                                    "score": 1.0,
                                    "content": "Information Processing Systems.",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                71,
                                632,
                                542,
                                647
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        632,
                                        542,
                                        647
                                    ],
                                    "score": 1.0,
                                    "content": "Yao, S., Zhao, J., Yu, D., Du, N., Shafran, I., Narasimhan, K., and Cao, Y. (2023b). ReAct: Synergizing",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                79,
                                643,
                                263,
                                660
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        643,
                                        263,
                                        660
                                    ],
                                    "score": 1.0,
                                    "content": "reasoning and acting in language models.",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                70,
                                664,
                                540,
                                679
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        664,
                                        540,
                                        679
                                    ],
                                    "score": 1.0,
                                    "content": "Yao, S., Zhao, J., Yu, D., Du, N., Shafran, I., Narasimhan, K. R., and Cao, Y. (2023c). ReAct: Syner-",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                79,
                                676,
                                542,
                                692
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        676,
                                        542,
                                        692
                                    ],
                                    "score": 1.0,
                                    "content": "gizing reasoning and acting in language models. In The Eleventh International Conference on Learning",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                80,
                                687,
                                431,
                                704
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        687,
                                        431,
                                        704
                                    ],
                                    "score": 1.0,
                                    "content": "Representations, ICLR 2023, Kigali, Rwanda, May 1-5, 2023. OpenReview.net.",
                                    "type": "text"
                                }
                            ],
                            "index": 40
                        },
                        {
                            "bbox": [
                                70,
                                707,
                                542,
                                724
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        707,
                                        542,
                                        724
                                    ],
                                    "score": 1.0,
                                    "content": "Yuksekgonul, M., Bianchi, F., Boen, J., Liu, S., Huang, Z., Guestrin, C., and Zou, J. (2024). Textgrad:",
                                    "type": "text"
                                }
                            ],
                            "index": 41
                        },
                        {
                            "bbox": [
                                80,
                                720,
                                240,
                                735
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        720,
                                        240,
                                        735
                                    ],
                                    "score": 0.984423041343689,
                                    "content": "Automatic \"differentiation\" via text.",
                                    "type": "text"
                                }
                            ],
                            "index": 42
                        }
                    ],
                    "index": 21
                }
            ],
            "layout_bboxes": [],
            "page_idx": 21,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        71,
                        27,
                        143,
                        37
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                25,
                                144,
                                38
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        25,
                                        144,
                                        38
                                    ],
                                    "score": 1.0,
                                    "content": "Technical report",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        751,
                        311,
                        761
                    ],
                    "lines": [
                        {
                            "bbox": [
                                299,
                                751,
                                312,
                                762
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        299,
                                        751,
                                        312,
                                        762
                                    ],
                                    "score": 1.0,
                                    "content": "22",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "list",
                    "bbox": [
                        68,
                        49,
                        545,
                        732
                    ],
                    "lines": [],
                    "index": 21,
                    "page_num": "page_21",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        81,
                        543,
                        735
                    ],
                    "lines_deleted": true
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        68,
                        80,
                        543,
                        214
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                82,
                                541,
                                97
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        82,
                                        541,
                                        97
                                    ],
                                    "score": 1.0,
                                    "content": "Zhang, S., Zhang, J., Liu, J., Song, L., Wang, C., Krishna, R., and Wu, Q. (2024). Training language model",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                80,
                                95,
                                318,
                                108
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        95,
                                        318,
                                        108
                                    ],
                                    "score": 1.0,
                                    "content": "agents without modifying language models. ICML’24.",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                70,
                                114,
                                541,
                                128
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        114,
                                        541,
                                        128
                                    ],
                                    "score": 1.0,
                                    "content": "Zhou, W., Jiang, Y. E., Li, L., Wu, J., Wang, T., Qiu, S., Zhang, J., Chen, J., Wu, R., Wang, S., Zhu,",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                80,
                                126,
                                541,
                                141
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        126,
                                        541,
                                        141
                                    ],
                                    "score": 1.0,
                                    "content": "S., Chen, J., Zhang, W., Tang, X., Zhang, N., Chen, H., Cui, P., and Sachan, M. (2023a). Agents: An",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                79,
                                138,
                                329,
                                153
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        138,
                                        329,
                                        153
                                    ],
                                    "score": 1.0,
                                    "content": "open-source framework for autonomous language agents.",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                70,
                                157,
                                541,
                                173
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        157,
                                        541,
                                        173
                                    ],
                                    "score": 1.0,
                                    "content": "Zhou, W., Ou, Y., Ding, S., Li, L., Wu, J., Wang, T., Chen, J., Wang, S., Xu, X., Zhang, N., Chen, H., and",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                79,
                                170,
                                376,
                                185
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        170,
                                        376,
                                        185
                                    ],
                                    "score": 1.0,
                                    "content": "Jiang, Y. E. (2024). Symbolic learning enables self-evolving agents.",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                70,
                                190,
                                541,
                                204
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        190,
                                        541,
                                        204
                                    ],
                                    "score": 1.0,
                                    "content": "Zhou, Y., Muresanu, A. I., Han, Z., Paster, K., Pitis, S., Chan, H., and Ba, J. (2023b). Large language models",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                81,
                                203,
                                540,
                                216
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        81,
                                        203,
                                        540,
                                        216
                                    ],
                                    "score": 1.0,
                                    "content": "are human-level prompt engineers. In The Eleventh International Conference on Learning Representations.",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        }
                    ],
                    "index": 4
                }
            ],
            "layout_bboxes": [],
            "page_idx": 22,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        71,
                        27,
                        143,
                        37
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                25,
                                144,
                                38
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        25,
                                        144,
                                        38
                                    ],
                                    "score": 1.0,
                                    "content": "Technical report",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        751,
                        311,
                        760
                    ],
                    "lines": [
                        {
                            "bbox": [
                                299,
                                751,
                                312,
                                762
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        299,
                                        751,
                                        312,
                                        762
                                    ],
                                    "score": 1.0,
                                    "content": "23",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "list",
                    "bbox": [
                        68,
                        80,
                        543,
                        214
                    ],
                    "lines": [],
                    "index": 4,
                    "page_num": "page_22",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        82,
                        541,
                        216
                    ],
                    "lines_deleted": true
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "title",
                    "bbox": [
                        72,
                        80,
                        244,
                        95
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                81,
                                243,
                                97
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        82,
                                        83,
                                        94
                                    ],
                                    "score": 1.0,
                                    "content": "A",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        91,
                                        81,
                                        243,
                                        97
                                    ],
                                    "score": 1.0,
                                    "content": "Multi-Agent Code Example",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        }
                    ],
                    "index": 0
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        110,
                        479,
                        293
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                112,
                                126,
                                124
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        112,
                                        126,
                                        124
                                    ],
                                    "score": 1.0,
                                    "content": "import json",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                70,
                                123,
                                265,
                                136
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        123,
                                        265,
                                        136
                                    ],
                                    "score": 1.0,
                                    "content": "from tapeagents.agent import Agent, Node",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                69,
                                134,
                                371,
                                148
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        134,
                                        371,
                                        148
                                    ],
                                    "score": 1.0,
                                    "content": "from tapeagents.core import Prompt, SetNextNode, Call, Respond",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                70,
                                146,
                                478,
                                160
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        146,
                                        478,
                                        160
                                    ],
                                    "score": 1.0,
                                    "content": "from tapeagents.dialog_tape import DialogTape, AssistantThought, ToolCalls, UserStep,",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                90,
                                159,
                                155,
                                172
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        159,
                                        155,
                                        172
                                    ],
                                    "score": 1.0,
                                    "content": "AssistantStep",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                70,
                                171,
                                294,
                                184
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        171,
                                        294,
                                        184
                                    ],
                                    "score": 1.0,
                                    "content": "from tapeagents.llms import LLMStream, LiteLLM",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                69,
                                182,
                                308,
                                196
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        182,
                                        308,
                                        196
                                    ],
                                    "score": 1.0,
                                    "content": "from tapeagents.prompting import view_to_messages",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                70,
                                194,
                                288,
                                208
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        194,
                                        288,
                                        208
                                    ],
                                    "score": 1.0,
                                    "content": "from tapeagents.orchestrator import main_loop",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                69,
                                207,
                                365,
                                219
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        207,
                                        365,
                                        219
                                    ],
                                    "score": 1.0,
                                    "content": "from tapeagents.tools.simple_browser import SimpleTextBrowser",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                69,
                                218,
                                394,
                                232
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        218,
                                        394,
                                        232
                                    ],
                                    "score": 1.0,
                                    "content": "from tapeagents.tools.stock import get_stock_data, get_stock_ticker",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                70,
                                231,
                                312,
                                243
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        231,
                                        312,
                                        243
                                    ],
                                    "score": 1.0,
                                    "content": "from tapeagents.environment import ToolEnvironment",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                70,
                                244,
                                264,
                                254
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        244,
                                        264,
                                        254
                                    ],
                                    "score": 1.0,
                                    "content": "# to visualize Tapes in Python notebooks",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                69,
                                254,
                                346,
                                267
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        254,
                                        346,
                                        267
                                    ],
                                    "score": 1.0,
                                    "content": "from tapeagents.rendering import render_tape_with_prompts",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                70,
                                267,
                                426,
                                279
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        267,
                                        426,
                                        279
                                    ],
                                    "score": 1.0,
                                    "content": "from tapeagents.renderers.camera_ready_renderer import CameraReadyRenderer",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                70,
                                278,
                                294,
                                292
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        278,
                                        294,
                                        292
                                    ],
                                    "score": 1.0,
                                    "content": "from IPython.display import HTML, clear_output",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        }
                    ],
                    "index": 8
                },
                {
                    "type": "text",
                    "bbox": [
                        68,
                        245,
                        539,
                        724
                    ],
                    "lines": [
                        {
                            "bbox": [
                                69,
                                303,
                                227,
                                315
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        303,
                                        227,
                                        315
                                    ],
                                    "score": 1.0,
                                    "content": "######### Search Agent #########",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                70,
                                328,
                                245,
                                339
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        328,
                                        245,
                                        339
                                    ],
                                    "score": 1.0,
                                    "content": "# define environment of search agent",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                70,
                                339,
                                212,
                                352
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        339,
                                        107,
                                        352
                                    ],
                                    "score": 1.0,
                                    "content": "browser",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        108,
                                        340,
                                        117,
                                        348
                                    ],
                                    "score": 0.76,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        117,
                                        339,
                                        212,
                                        352
                                    ],
                                    "score": 1.0,
                                    "content": " SimpleTextBrowser()",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                70,
                                351,
                                245,
                                363
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        351,
                                        150,
                                        363
                                    ],
                                    "score": 1.0,
                                    "content": "search_agent_env",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        151,
                                        352,
                                        159,
                                        360
                                    ],
                                    "score": 0.75,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        160,
                                        351,
                                        245,
                                        363
                                    ],
                                    "score": 1.0,
                                    "content": " ToolEnvironment([",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                79,
                                362,
                                403,
                                375
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        362,
                                        403,
                                        375
                                    ],
                                    "score": 1.0,
                                    "content": "browser.get_search_results, browser.get_page, browser.get_next_page",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                70,
                                375,
                                83,
                                387
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        375,
                                        83,
                                        387
                                    ],
                                    "score": 1.0,
                                    "content": "])",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                69,
                                398,
                                275,
                                411
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        398,
                                        275,
                                        411
                                    ],
                                    "score": 1.0,
                                    "content": "# define the main node of the search agent",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                70,
                                411,
                                226,
                                423
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        411,
                                        226,
                                        423
                                    ],
                                    "score": 1.0,
                                    "content": "class SearchAgentMainNode(Node):",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                79,
                                422,
                                356,
                                435
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        423,
                                        304,
                                        435
                                    ],
                                    "score": 1.0,
                                    "content": "def make_prompt(self, agent, tape: DialogTape) ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        304,
                                        424,
                                        317,
                                        432
                                    ],
                                    "score": 0.36,
                                    "content": "->",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 13
                                },
                                {
                                    "bbox": [
                                        317,
                                        422,
                                        356,
                                        435
                                    ],
                                    "score": 1.0,
                                    "content": " Prompt:",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                89,
                                435,
                                240,
                                447
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        435,
                                        112,
                                        447
                                    ],
                                    "score": 1.0,
                                    "content": "view",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        113,
                                        436,
                                        121,
                                        443
                                    ],
                                    "score": 0.79,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        122,
                                        435,
                                        240,
                                        446
                                    ],
                                    "score": 1.0,
                                    "content": " agent.compute_view(tape)",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                88,
                                447,
                                213,
                                459
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        88,
                                        447,
                                        194,
                                        459
                                    ],
                                    "score": 1.0,
                                    "content": "search_system_message ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        194,
                                        447,
                                        202,
                                        456
                                    ],
                                    "score": 0.37,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        202,
                                        447,
                                        213,
                                        459
                                    ],
                                    "score": 1.0,
                                    "content": " {",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                99,
                                457,
                                182,
                                471
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        99,
                                        457,
                                        182,
                                        471
                                    ],
                                    "score": 1.0,
                                    "content": "\"role\": \"system\",",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                99,
                                468,
                                499,
                                483
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        99,
                                        468,
                                        499,
                                        483
                                    ],
                                    "score": 1.0,
                                    "content": "\"content\": \"\"\"Use at most 5 tool calls to search the request info on on the web.\"\"\"",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                89,
                                483,
                                98,
                                492
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        483,
                                        98,
                                        492
                                    ],
                                    "score": 1.0,
                                    "content": "}",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                89,
                                494,
                                159,
                                506
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        494,
                                        159,
                                        506
                                    ],
                                    "score": 1.0,
                                    "content": "return Prompt(",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                98,
                                506,
                                430,
                                519
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        98,
                                        507,
                                        138,
                                        519
                                    ],
                                    "score": 1.0,
                                    "content": "messages",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        138,
                                        508,
                                        144,
                                        515
                                    ],
                                    "score": 0.45,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        144,
                                        506,
                                        255,
                                        519
                                    ],
                                    "score": 1.0,
                                    "content": "[search_system_message]",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        256,
                                        507,
                                        264,
                                        515
                                    ],
                                    "score": 0.72,
                                    "content": "^+",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        265,
                                        506,
                                        430,
                                        519
                                    ],
                                    "score": 1.0,
                                    "content": " view_to_messages(view.top, agent),",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                99,
                                517,
                                322,
                                530
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        99,
                                        517,
                                        123,
                                        530
                                    ],
                                    "score": 1.0,
                                    "content": "tools",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        124,
                                        520,
                                        129,
                                        527
                                    ],
                                    "score": 0.48,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 5
                                },
                                {
                                    "bbox": [
                                        129,
                                        517,
                                        322,
                                        530
                                    ],
                                    "score": 1.0,
                                    "content": "search_agent_env.get_tool_schema_dicts()",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                89,
                                532,
                                98,
                                541
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        532,
                                        98,
                                        541
                                    ],
                                    "score": 1.0,
                                    "content": ")",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                80,
                                554,
                                374,
                                566
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        554,
                                        374,
                                        566
                                    ],
                                    "score": 1.0,
                                    "content": "def generate_steps(self, agent, tape, llm_stream: LLMStream):",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                88,
                                566,
                                225,
                                578
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        88,
                                        566,
                                        99,
                                        578
                                    ],
                                    "score": 1.0,
                                    "content": "m ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        99,
                                        567,
                                        107,
                                        575
                                    ],
                                    "score": 0.36,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        108,
                                        567,
                                        225,
                                        578
                                    ],
                                    "score": 1.0,
                                    "content": "llm_stream.get_message()",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                89,
                                578,
                                155,
                                590
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        578,
                                        155,
                                        590
                                    ],
                                    "score": 1.0,
                                    "content": "if m.content:",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                99,
                                590,
                                518,
                                603
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        99,
                                        590,
                                        273,
                                        603
                                    ],
                                    "score": 1.0,
                                    "content": "# if the LLM responds, yield Respond",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        273,
                                        591,
                                        291,
                                        601
                                    ],
                                    "score": 0.49,
                                    "content": "(\\mathbf{\\nabla}\\cdot\\cdot\\mathbf{\\nabla})",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 18
                                },
                                {
                                    "bbox": [
                                        291,
                                        590,
                                        518,
                                        603
                                    ],
                                    "score": 1.0,
                                    "content": " as your last step. This special step tells the",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                118,
                                601,
                                536,
                                614
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        118,
                                        601,
                                        536,
                                        614
                                    ],
                                    "score": 1.0,
                                    "content": "orchestrator that this agent is done. The next active agent will be the one that ‘Call‘",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                118,
                                614,
                                307,
                                627
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        118,
                                        614,
                                        307,
                                        627
                                    ],
                                    "score": 1.0,
                                    "content": "ed it (the Analyst Agent in this case).",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                99,
                                627,
                                254,
                                638
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        99,
                                        627,
                                        200,
                                        638
                                    ],
                                    "score": 1.0,
                                    "content": "yield Respond(content",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        200,
                                        627,
                                        211,
                                        635
                                    ],
                                    "score": 0.41,
                                    "content": "{\\mathsf{=m}}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 11
                                },
                                {
                                    "bbox": [
                                        211,
                                        627,
                                        254,
                                        638
                                    ],
                                    "score": 1.0,
                                    "content": ".content)",
                                    "type": "text"
                                }
                            ],
                            "index": 40
                        },
                        {
                            "bbox": [
                                90,
                                638,
                                179,
                                650
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        638,
                                        179,
                                        650
                                    ],
                                    "score": 1.0,
                                    "content": "elif m.tool_calls:",
                                    "type": "text"
                                }
                            ],
                            "index": 41
                        },
                        {
                            "bbox": [
                                98,
                                650,
                                403,
                                662
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        98,
                                        650,
                                        403,
                                        662
                                    ],
                                    "score": 1.0,
                                    "content": "# while the LLM suggests tool calls, yield them as action steps",
                                    "type": "text"
                                }
                            ],
                            "index": 42
                        },
                        {
                            "bbox": [
                                98,
                                661,
                                264,
                                674
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        98,
                                        661,
                                        264,
                                        674
                                    ],
                                    "score": 1.0,
                                    "content": "yield ToolCalls.from_llm_output(m)",
                                    "type": "text"
                                }
                            ],
                            "index": 43
                        },
                        {
                            "bbox": [
                                97,
                                674,
                                527,
                                685
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        97,
                                        674,
                                        228,
                                        685
                                    ],
                                    "score": 1.0,
                                    "content": "yield SetNextNode(next_node",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        229,
                                        675,
                                        239,
                                        683
                                    ],
                                    "score": 0.61,
                                    "content": "=0",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 10
                                },
                                {
                                    "bbox": [
                                        240,
                                        674,
                                        527,
                                        685
                                    ],
                                    "score": 1.0,
                                    "content": ") # set yourself as next node for when you get called again",
                                    "type": "text"
                                }
                            ],
                            "index": 44
                        },
                        {
                            "bbox": [
                                90,
                                686,
                                117,
                                697
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        686,
                                        117,
                                        697
                                    ],
                                    "score": 1.0,
                                    "content": "else:",
                                    "type": "text"
                                }
                            ],
                            "index": 45
                        },
                        {
                            "bbox": [
                                99,
                                698,
                                187,
                                709
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        99,
                                        698,
                                        187,
                                        709
                                    ],
                                    "score": 1.0,
                                    "content": "raise ValueError()",
                                    "type": "text"
                                }
                            ],
                            "index": 46
                        }
                    ],
                    "index": 31
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        721,
                        192,
                        732
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                722,
                                192,
                                732
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        722,
                                        192,
                                        732
                                    ],
                                    "score": 1.0,
                                    "content": "# create the search agent",
                                    "type": "text"
                                }
                            ],
                            "index": 47
                        }
                    ],
                    "index": 47
                }
            ],
            "layout_bboxes": [],
            "page_idx": 23,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        71,
                        27,
                        143,
                        37
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                25,
                                144,
                                38
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        25,
                                        144,
                                        38
                                    ],
                                    "score": 1.0,
                                    "content": "Technical report",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        751,
                        311,
                        761
                    ],
                    "lines": [
                        {
                            "bbox": [
                                299,
                                751,
                                312,
                                762
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        299,
                                        751,
                                        312,
                                        762
                                    ],
                                    "score": 1.0,
                                    "content": "24",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "title",
                    "bbox": [
                        72,
                        80,
                        244,
                        95
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                81,
                                243,
                                97
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        82,
                                        83,
                                        94
                                    ],
                                    "score": 1.0,
                                    "content": "A",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        91,
                                        81,
                                        243,
                                        97
                                    ],
                                    "score": 1.0,
                                    "content": "Multi-Agent Code Example",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        }
                    ],
                    "index": 0,
                    "page_num": "page_23",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "list",
                    "bbox": [
                        70,
                        110,
                        479,
                        293
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                112,
                                126,
                                124
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        112,
                                        126,
                                        124
                                    ],
                                    "score": 1.0,
                                    "content": "import json",
                                    "type": "text"
                                }
                            ],
                            "index": 1,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                70,
                                123,
                                265,
                                136
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        123,
                                        265,
                                        136
                                    ],
                                    "score": 1.0,
                                    "content": "from tapeagents.agent import Agent, Node",
                                    "type": "text"
                                }
                            ],
                            "index": 2,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                69,
                                134,
                                371,
                                148
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        134,
                                        371,
                                        148
                                    ],
                                    "score": 1.0,
                                    "content": "from tapeagents.core import Prompt, SetNextNode, Call, Respond",
                                    "type": "text"
                                }
                            ],
                            "index": 3,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                70,
                                146,
                                478,
                                160
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        146,
                                        478,
                                        160
                                    ],
                                    "score": 1.0,
                                    "content": "from tapeagents.dialog_tape import DialogTape, AssistantThought, ToolCalls, UserStep,",
                                    "type": "text"
                                }
                            ],
                            "index": 4,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                90,
                                159,
                                155,
                                172
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        159,
                                        155,
                                        172
                                    ],
                                    "score": 1.0,
                                    "content": "AssistantStep",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                70,
                                171,
                                294,
                                184
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        171,
                                        294,
                                        184
                                    ],
                                    "score": 1.0,
                                    "content": "from tapeagents.llms import LLMStream, LiteLLM",
                                    "type": "text"
                                }
                            ],
                            "index": 6,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                69,
                                182,
                                308,
                                196
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        182,
                                        308,
                                        196
                                    ],
                                    "score": 1.0,
                                    "content": "from tapeagents.prompting import view_to_messages",
                                    "type": "text"
                                }
                            ],
                            "index": 7,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                70,
                                194,
                                288,
                                208
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        194,
                                        288,
                                        208
                                    ],
                                    "score": 1.0,
                                    "content": "from tapeagents.orchestrator import main_loop",
                                    "type": "text"
                                }
                            ],
                            "index": 8,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                69,
                                207,
                                365,
                                219
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        207,
                                        365,
                                        219
                                    ],
                                    "score": 1.0,
                                    "content": "from tapeagents.tools.simple_browser import SimpleTextBrowser",
                                    "type": "text"
                                }
                            ],
                            "index": 9,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                69,
                                218,
                                394,
                                232
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        218,
                                        394,
                                        232
                                    ],
                                    "score": 1.0,
                                    "content": "from tapeagents.tools.stock import get_stock_data, get_stock_ticker",
                                    "type": "text"
                                }
                            ],
                            "index": 10,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                70,
                                231,
                                312,
                                243
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        231,
                                        312,
                                        243
                                    ],
                                    "score": 1.0,
                                    "content": "from tapeagents.environment import ToolEnvironment",
                                    "type": "text"
                                }
                            ],
                            "index": 11,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                70,
                                244,
                                264,
                                254
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        244,
                                        264,
                                        254
                                    ],
                                    "score": 1.0,
                                    "content": "# to visualize Tapes in Python notebooks",
                                    "type": "text"
                                }
                            ],
                            "index": 12,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                69,
                                254,
                                346,
                                267
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        254,
                                        346,
                                        267
                                    ],
                                    "score": 1.0,
                                    "content": "from tapeagents.rendering import render_tape_with_prompts",
                                    "type": "text"
                                }
                            ],
                            "index": 13,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                70,
                                267,
                                426,
                                279
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        267,
                                        426,
                                        279
                                    ],
                                    "score": 1.0,
                                    "content": "from tapeagents.renderers.camera_ready_renderer import CameraReadyRenderer",
                                    "type": "text"
                                }
                            ],
                            "index": 14,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                70,
                                278,
                                294,
                                292
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        278,
                                        294,
                                        292
                                    ],
                                    "score": 1.0,
                                    "content": "from IPython.display import HTML, clear_output",
                                    "type": "text"
                                }
                            ],
                            "index": 15,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                69,
                                303,
                                227,
                                315
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        303,
                                        227,
                                        315
                                    ],
                                    "score": 1.0,
                                    "content": "######### Search Agent #########",
                                    "type": "text"
                                }
                            ],
                            "index": 16,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                328,
                                245,
                                339
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        328,
                                        245,
                                        339
                                    ],
                                    "score": 1.0,
                                    "content": "# define environment of search agent",
                                    "type": "text"
                                }
                            ],
                            "index": 17,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                339,
                                212,
                                352
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        339,
                                        107,
                                        352
                                    ],
                                    "score": 1.0,
                                    "content": "browser",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        108,
                                        340,
                                        117,
                                        348
                                    ],
                                    "score": 0.76,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        117,
                                        339,
                                        212,
                                        352
                                    ],
                                    "score": 1.0,
                                    "content": " SimpleTextBrowser()",
                                    "type": "text"
                                }
                            ],
                            "index": 18,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                351,
                                245,
                                363
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        351,
                                        150,
                                        363
                                    ],
                                    "score": 1.0,
                                    "content": "search_agent_env",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        151,
                                        352,
                                        159,
                                        360
                                    ],
                                    "score": 0.75,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        160,
                                        351,
                                        245,
                                        363
                                    ],
                                    "score": 1.0,
                                    "content": " ToolEnvironment([",
                                    "type": "text"
                                }
                            ],
                            "index": 19,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                79,
                                362,
                                403,
                                375
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        362,
                                        403,
                                        375
                                    ],
                                    "score": 1.0,
                                    "content": "browser.get_search_results, browser.get_page, browser.get_next_page",
                                    "type": "text"
                                }
                            ],
                            "index": 20,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                375,
                                83,
                                387
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        375,
                                        83,
                                        387
                                    ],
                                    "score": 1.0,
                                    "content": "])",
                                    "type": "text"
                                }
                            ],
                            "index": 21,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                69,
                                398,
                                275,
                                411
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        398,
                                        275,
                                        411
                                    ],
                                    "score": 1.0,
                                    "content": "# define the main node of the search agent",
                                    "type": "text"
                                }
                            ],
                            "index": 22,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                411,
                                226,
                                423
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        411,
                                        226,
                                        423
                                    ],
                                    "score": 1.0,
                                    "content": "class SearchAgentMainNode(Node):",
                                    "type": "text"
                                }
                            ],
                            "index": 23,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                79,
                                422,
                                356,
                                435
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        423,
                                        304,
                                        435
                                    ],
                                    "score": 1.0,
                                    "content": "def make_prompt(self, agent, tape: DialogTape) ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        304,
                                        424,
                                        317,
                                        432
                                    ],
                                    "score": 0.36,
                                    "content": "->",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 13
                                },
                                {
                                    "bbox": [
                                        317,
                                        422,
                                        356,
                                        435
                                    ],
                                    "score": 1.0,
                                    "content": " Prompt:",
                                    "type": "text"
                                }
                            ],
                            "index": 24,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                89,
                                435,
                                240,
                                447
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        435,
                                        112,
                                        447
                                    ],
                                    "score": 1.0,
                                    "content": "view",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        113,
                                        436,
                                        121,
                                        443
                                    ],
                                    "score": 0.79,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        122,
                                        435,
                                        240,
                                        446
                                    ],
                                    "score": 1.0,
                                    "content": " agent.compute_view(tape)",
                                    "type": "text"
                                }
                            ],
                            "index": 25,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                88,
                                447,
                                213,
                                459
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        88,
                                        447,
                                        194,
                                        459
                                    ],
                                    "score": 1.0,
                                    "content": "search_system_message ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        194,
                                        447,
                                        202,
                                        456
                                    ],
                                    "score": 0.37,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        202,
                                        447,
                                        213,
                                        459
                                    ],
                                    "score": 1.0,
                                    "content": " {",
                                    "type": "text"
                                }
                            ],
                            "index": 26,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                99,
                                457,
                                182,
                                471
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        99,
                                        457,
                                        182,
                                        471
                                    ],
                                    "score": 1.0,
                                    "content": "\"role\": \"system\",",
                                    "type": "text"
                                }
                            ],
                            "index": 27,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                99,
                                468,
                                499,
                                483
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        99,
                                        468,
                                        499,
                                        483
                                    ],
                                    "score": 1.0,
                                    "content": "\"content\": \"\"\"Use at most 5 tool calls to search the request info on on the web.\"\"\"",
                                    "type": "text"
                                }
                            ],
                            "index": 28,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                89,
                                483,
                                98,
                                492
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        483,
                                        98,
                                        492
                                    ],
                                    "score": 1.0,
                                    "content": "}",
                                    "type": "text"
                                }
                            ],
                            "index": 29,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                89,
                                494,
                                159,
                                506
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        494,
                                        159,
                                        506
                                    ],
                                    "score": 1.0,
                                    "content": "return Prompt(",
                                    "type": "text"
                                }
                            ],
                            "index": 30,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                98,
                                506,
                                430,
                                519
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        98,
                                        507,
                                        138,
                                        519
                                    ],
                                    "score": 1.0,
                                    "content": "messages",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        138,
                                        508,
                                        144,
                                        515
                                    ],
                                    "score": 0.45,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        144,
                                        506,
                                        255,
                                        519
                                    ],
                                    "score": 1.0,
                                    "content": "[search_system_message]",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        256,
                                        507,
                                        264,
                                        515
                                    ],
                                    "score": 0.72,
                                    "content": "^+",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        265,
                                        506,
                                        430,
                                        519
                                    ],
                                    "score": 1.0,
                                    "content": " view_to_messages(view.top, agent),",
                                    "type": "text"
                                }
                            ],
                            "index": 31,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                99,
                                517,
                                322,
                                530
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        99,
                                        517,
                                        123,
                                        530
                                    ],
                                    "score": 1.0,
                                    "content": "tools",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        124,
                                        520,
                                        129,
                                        527
                                    ],
                                    "score": 0.48,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 5
                                },
                                {
                                    "bbox": [
                                        129,
                                        517,
                                        322,
                                        530
                                    ],
                                    "score": 1.0,
                                    "content": "search_agent_env.get_tool_schema_dicts()",
                                    "type": "text"
                                }
                            ],
                            "index": 32,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                89,
                                532,
                                98,
                                541
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        532,
                                        98,
                                        541
                                    ],
                                    "score": 1.0,
                                    "content": ")",
                                    "type": "text"
                                }
                            ],
                            "index": 33,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                80,
                                554,
                                374,
                                566
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        554,
                                        374,
                                        566
                                    ],
                                    "score": 1.0,
                                    "content": "def generate_steps(self, agent, tape, llm_stream: LLMStream):",
                                    "type": "text"
                                }
                            ],
                            "index": 34,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                88,
                                566,
                                225,
                                578
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        88,
                                        566,
                                        99,
                                        578
                                    ],
                                    "score": 1.0,
                                    "content": "m ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        99,
                                        567,
                                        107,
                                        575
                                    ],
                                    "score": 0.36,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        108,
                                        567,
                                        225,
                                        578
                                    ],
                                    "score": 1.0,
                                    "content": "llm_stream.get_message()",
                                    "type": "text"
                                }
                            ],
                            "index": 35,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                89,
                                578,
                                155,
                                590
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        578,
                                        155,
                                        590
                                    ],
                                    "score": 1.0,
                                    "content": "if m.content:",
                                    "type": "text"
                                }
                            ],
                            "index": 36,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                99,
                                590,
                                518,
                                603
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        99,
                                        590,
                                        273,
                                        603
                                    ],
                                    "score": 1.0,
                                    "content": "# if the LLM responds, yield Respond",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        273,
                                        591,
                                        291,
                                        601
                                    ],
                                    "score": 0.49,
                                    "content": "(\\mathbf{\\nabla}\\cdot\\cdot\\mathbf{\\nabla})",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 18
                                },
                                {
                                    "bbox": [
                                        291,
                                        590,
                                        518,
                                        603
                                    ],
                                    "score": 1.0,
                                    "content": " as your last step. This special step tells the",
                                    "type": "text"
                                }
                            ],
                            "index": 37,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                118,
                                601,
                                536,
                                614
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        118,
                                        601,
                                        536,
                                        614
                                    ],
                                    "score": 1.0,
                                    "content": "orchestrator that this agent is done. The next active agent will be the one that ‘Call‘",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                118,
                                614,
                                307,
                                627
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        118,
                                        614,
                                        307,
                                        627
                                    ],
                                    "score": 1.0,
                                    "content": "ed it (the Analyst Agent in this case).",
                                    "type": "text"
                                }
                            ],
                            "index": 39,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                99,
                                627,
                                254,
                                638
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        99,
                                        627,
                                        200,
                                        638
                                    ],
                                    "score": 1.0,
                                    "content": "yield Respond(content",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        200,
                                        627,
                                        211,
                                        635
                                    ],
                                    "score": 0.41,
                                    "content": "{\\mathsf{=m}}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 11
                                },
                                {
                                    "bbox": [
                                        211,
                                        627,
                                        254,
                                        638
                                    ],
                                    "score": 1.0,
                                    "content": ".content)",
                                    "type": "text"
                                }
                            ],
                            "index": 40,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                90,
                                638,
                                179,
                                650
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        638,
                                        179,
                                        650
                                    ],
                                    "score": 1.0,
                                    "content": "elif m.tool_calls:",
                                    "type": "text"
                                }
                            ],
                            "index": 41,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                98,
                                650,
                                403,
                                662
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        98,
                                        650,
                                        403,
                                        662
                                    ],
                                    "score": 1.0,
                                    "content": "# while the LLM suggests tool calls, yield them as action steps",
                                    "type": "text"
                                }
                            ],
                            "index": 42,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                98,
                                661,
                                264,
                                674
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        98,
                                        661,
                                        264,
                                        674
                                    ],
                                    "score": 1.0,
                                    "content": "yield ToolCalls.from_llm_output(m)",
                                    "type": "text"
                                }
                            ],
                            "index": 43,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                97,
                                674,
                                527,
                                685
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        97,
                                        674,
                                        228,
                                        685
                                    ],
                                    "score": 1.0,
                                    "content": "yield SetNextNode(next_node",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        229,
                                        675,
                                        239,
                                        683
                                    ],
                                    "score": 0.61,
                                    "content": "=0",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 10
                                },
                                {
                                    "bbox": [
                                        240,
                                        674,
                                        527,
                                        685
                                    ],
                                    "score": 1.0,
                                    "content": ") # set yourself as next node for when you get called again",
                                    "type": "text"
                                }
                            ],
                            "index": 44
                        },
                        {
                            "bbox": [
                                90,
                                686,
                                117,
                                697
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        686,
                                        117,
                                        697
                                    ],
                                    "score": 1.0,
                                    "content": "else:",
                                    "type": "text"
                                }
                            ],
                            "index": 45,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                99,
                                698,
                                187,
                                709
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        99,
                                        698,
                                        187,
                                        709
                                    ],
                                    "score": 1.0,
                                    "content": "raise ValueError()",
                                    "type": "text"
                                }
                            ],
                            "index": 46,
                            "is_list_end_line": true
                        }
                    ],
                    "index": 8,
                    "page_num": "page_23",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        112,
                        478,
                        292
                    ]
                },
                {
                    "type": "list",
                    "bbox": [
                        68,
                        245,
                        539,
                        724
                    ],
                    "lines": [],
                    "index": 31,
                    "page_num": "page_23",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        303,
                        536,
                        709
                    ],
                    "lines_deleted": true
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        721,
                        192,
                        732
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                722,
                                192,
                                732
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        722,
                                        192,
                                        732
                                    ],
                                    "score": 1.0,
                                    "content": "# create the search agent",
                                    "type": "text"
                                }
                            ],
                            "index": 47
                        }
                    ],
                    "index": 47,
                    "page_num": "page_23",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        722,
                        192,
                        732
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        69,
                        83,
                        509,
                        106
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                84,
                                507,
                                95
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        84,
                                        131,
                                        95
                                    ],
                                    "score": 1.0,
                                    "content": "search_agent",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        132,
                                        84,
                                        141,
                                        92
                                    ],
                                    "score": 0.72,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        141,
                                        84,
                                        224,
                                        95
                                    ],
                                    "score": 1.0,
                                    "content": " Agent.create(name",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        224,
                                        84,
                                        230,
                                        92
                                    ],
                                    "score": 0.45,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        231,
                                        84,
                                        415,
                                        95
                                    ],
                                    "score": 1.0,
                                    "content": "\"search_agent\", llms=LiteLLM(model_name",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        415,
                                        84,
                                        421,
                                        92
                                    ],
                                    "score": 0.26,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        422,
                                        84,
                                        507,
                                        95
                                    ],
                                    "score": 1.0,
                                    "content": "\"gpt-4o\"), nodes=[",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                89,
                                94,
                                203,
                                107
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        94,
                                        203,
                                        107
                                    ],
                                    "score": 1.0,
                                    "content": "SearchAgentMainNode()])",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        }
                    ],
                    "index": 0.5
                },
                {
                    "type": "text",
                    "bbox": [
                        68,
                        91,
                        529,
                        729
                    ],
                    "lines": [
                        {
                            "bbox": [
                                74,
                                106,
                                151,
                                120
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        74,
                                        106,
                                        151,
                                        120
                                    ],
                                    "score": 1.0,
                                    "content": "Agent #########",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                69,
                                131,
                                252,
                                144
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        131,
                                        252,
                                        144
                                    ],
                                    "score": 1.0,
                                    "content": "# define environment of analyst agent",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                69,
                                153,
                                526,
                                168
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        153,
                                        526,
                                        168
                                    ],
                                    "score": 1.0,
                                    "content": "# We will use the tool choice mechanism to let the main agent call its search specialist agent.",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                69,
                                167,
                                446,
                                180
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        167,
                                        446,
                                        180
                                    ],
                                    "score": 1.0,
                                    "content": "# To this end, we create a mock tool that represents calling the search agent.",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                70,
                                179,
                                236,
                                192
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        179,
                                        236,
                                        192
                                    ],
                                    "score": 1.0,
                                    "content": "def call_search_agent(query: str):",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                88,
                                188,
                                485,
                                205
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        88,
                                        188,
                                        485,
                                        205
                                    ],
                                    "score": 1.0,
                                    "content": "\"\"\"Use this tool to ask a fellow AI agent to search for information on the web.\"\"\"",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                88,
                                203,
                                113,
                                215
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        88,
                                        203,
                                        113,
                                        215
                                    ],
                                    "score": 1.0,
                                    "content": "pass",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                68,
                                226,
                                237,
                                240
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        226,
                                        141,
                                        240
                                    ],
                                    "score": 1.0,
                                    "content": "main_agent_env",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        141,
                                        228,
                                        150,
                                        236
                                    ],
                                    "score": 0.76,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        150,
                                        226,
                                        237,
                                        240
                                    ],
                                    "score": 1.0,
                                    "content": " ToolEnvironment([",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                79,
                                238,
                                327,
                                252
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        238,
                                        327,
                                        252
                                    ],
                                    "score": 1.0,
                                    "content": "get_stock_ticker, get_stock_data, call_search_agent",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                70,
                                251,
                                83,
                                262
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        251,
                                        83,
                                        262
                                    ],
                                    "score": 1.0,
                                    "content": "])",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                72,
                                274,
                                347,
                                288
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        274,
                                        168,
                                        285
                                    ],
                                    "score": 0.33,
                                    "content": "\\mathtt{t o d a y}=\\mathtt{\"2}824\\mathrm{-}\\theta9\\mathrm{-}17\\mathrm{\"}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 96
                                },
                                {
                                    "bbox": [
                                        168,
                                        274,
                                        347,
                                        288
                                    ],
                                    "score": 1.0,
                                    "content": "# fixed date for reproducible tests",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                69,
                                285,
                                317,
                                299
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        285,
                                        141,
                                        299
                                    ],
                                    "score": 1.0,
                                    "content": "system_message",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        141,
                                        288,
                                        150,
                                        296
                                    ],
                                    "score": 0.78,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        151,
                                        285,
                                        317,
                                        299
                                    ],
                                    "score": 1.0,
                                    "content": "{\"role\": \"system\", \"content\": f\"\"\"",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                70,
                                298,
                                533,
                                311
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        298,
                                        533,
                                        311
                                    ],
                                    "score": 1.0,
                                    "content": "You will help the user to learn about financials of companies. For general user queries, includ",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                94,
                                310,
                                486,
                                324
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        94,
                                        310,
                                        486,
                                        324
                                    ],
                                    "score": 1.0,
                                    "content": "some info about stock price changes during the last year, as well as some general",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                89,
                                322,
                                307,
                                335
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        322,
                                        307,
                                        335
                                    ],
                                    "score": 1.0,
                                    "content": "information on the company. Today is {today}.",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                78,
                                335,
                                93,
                                346
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        78,
                                        335,
                                        93,
                                        346
                                    ],
                                    "score": 1.0,
                                    "content": "\"\"}",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                69,
                                357,
                                266,
                                371
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        357,
                                        266,
                                        371
                                    ],
                                    "score": 1.0,
                                    "content": "# define the two nodes of the main agent",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                69,
                                370,
                                175,
                                383
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        370,
                                        175,
                                        383
                                    ],
                                    "score": 1.0,
                                    "content": "class PlanNode(Node):",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                77,
                                380,
                                299,
                                397
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        380,
                                        247,
                                        397
                                    ],
                                    "score": 1.0,
                                    "content": "def make_prompt(self, agent, tape) ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        247,
                                        383,
                                        259,
                                        391
                                    ],
                                    "score": 0.43,
                                    "content": "->",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 12
                                },
                                {
                                    "bbox": [
                                        260,
                                        380,
                                        299,
                                        397
                                    ],
                                    "score": 1.0,
                                    "content": " Prompt:",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                88,
                                393,
                                240,
                                407
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        88,
                                        393,
                                        112,
                                        407
                                    ],
                                    "score": 1.0,
                                    "content": "view",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        113,
                                        395,
                                        121,
                                        403
                                    ],
                                    "score": 0.78,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        122,
                                        393,
                                        240,
                                        407
                                    ],
                                    "score": 1.0,
                                    "content": " agent.compute_view(tape)",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                88,
                                406,
                                190,
                                420
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        88,
                                        406,
                                        170,
                                        420
                                    ],
                                    "score": 1.0,
                                    "content": "guidance_message",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        170,
                                        407,
                                        178,
                                        415
                                    ],
                                    "score": 0.34,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        178,
                                        406,
                                        190,
                                        420
                                    ],
                                    "score": 1.0,
                                    "content": " {",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                100,
                                417,
                                172,
                                431
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        100,
                                        417,
                                        172,
                                        431
                                    ],
                                    "score": 1.0,
                                    "content": "\"role\": \"user\",",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                100,
                                428,
                                519,
                                443
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        100,
                                        428,
                                        519,
                                        443
                                    ],
                                    "score": 1.0,
                                    "content": "\"content\": \"\"\"Write a natural language plan on how to use tools help the user. Output a",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                118,
                                441,
                                351,
                                453
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        118,
                                        441,
                                        351,
                                        453
                                    ],
                                    "score": 1.0,
                                    "content": "list of numbered items, like 1., 2., 3., etc.\"\"\"",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                91,
                                457,
                                96,
                                463
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        457,
                                        96,
                                        463
                                    ],
                                    "score": 1.0,
                                    "content": "}",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                90,
                                467,
                                160,
                                478
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        467,
                                        160,
                                        478
                                    ],
                                    "score": 1.0,
                                    "content": "return Prompt(",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                99,
                                478,
                                498,
                                491
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        99,
                                        478,
                                        138,
                                        491
                                    ],
                                    "score": 1.0,
                                    "content": "messages",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        138,
                                        480,
                                        144,
                                        487
                                    ],
                                    "score": 0.48,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        144,
                                        478,
                                        222,
                                        491
                                    ],
                                    "score": 1.0,
                                    "content": "[system_message]",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        222,
                                        479,
                                        231,
                                        487
                                    ],
                                    "score": 0.75,
                                    "content": "^+",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        231,
                                        478,
                                        394,
                                        491
                                    ],
                                    "score": 1.0,
                                    "content": " view_to_messages(view.top, agent)",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        395,
                                        479,
                                        403,
                                        487
                                    ],
                                    "score": 0.65,
                                    "content": "^+",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        404,
                                        478,
                                        498,
                                        491
                                    ],
                                    "score": 1.0,
                                    "content": " [guidance_message],",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                99,
                                489,
                                317,
                                502
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        99,
                                        489,
                                        124,
                                        502
                                    ],
                                    "score": 1.0,
                                    "content": "tools",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        124,
                                        492,
                                        129,
                                        498
                                    ],
                                    "score": 0.33,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 6,
                                    "width": 5
                                },
                                {
                                    "bbox": [
                                        129,
                                        489,
                                        317,
                                        502
                                    ],
                                    "score": 1.0,
                                    "content": "main_agent_env.get_tool_schema_dicts(),",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                91,
                                505,
                                96,
                                511
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        505,
                                        96,
                                        511
                                    ],
                                    "score": 1.0,
                                    "content": ")",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                78,
                                524,
                                385,
                                540
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        78,
                                        524,
                                        385,
                                        540
                                    ],
                                    "score": 1.0,
                                    "content": "def generate_steps(self, agent, dialog, llm_stream: LLMStream):",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                86,
                                536,
                                405,
                                552
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        536,
                                        405,
                                        552
                                    ],
                                    "score": 1.0,
                                    "content": "# the PlanNode should only yield thoughts based on the llm output",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                88,
                                547,
                                318,
                                564
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        88,
                                        547,
                                        146,
                                        564
                                    ],
                                    "score": 1.0,
                                    "content": "if content :",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        147,
                                        551,
                                        154,
                                        559
                                    ],
                                    "score": 0.44,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        155,
                                        547,
                                        318,
                                        564
                                    ],
                                    "score": 1.0,
                                    "content": " llm_stream.get_message().content:",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                99,
                                562,
                                288,
                                573
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        99,
                                        562,
                                        243,
                                        573
                                    ],
                                    "score": 1.0,
                                    "content": "yield AssistantThought(content",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        243,
                                        563,
                                        249,
                                        570
                                    ],
                                    "score": 0.61,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        249,
                                        562,
                                        288,
                                        573
                                    ],
                                    "score": 1.0,
                                    "content": "content)",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                90,
                                574,
                                116,
                                586
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        574,
                                        116,
                                        586
                                    ],
                                    "score": 1.0,
                                    "content": "else:",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                99,
                                586,
                                187,
                                597
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        99,
                                        586,
                                        187,
                                        597
                                    ],
                                    "score": 1.0,
                                    "content": "raise ValueError()",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                69,
                                608,
                                170,
                                622
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        608,
                                        170,
                                        622
                                    ],
                                    "score": 1.0,
                                    "content": "class ActNode(Node):",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                77,
                                619,
                                357,
                                635
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        619,
                                        357,
                                        635
                                    ],
                                    "score": 1.0,
                                    "content": "def make_prompt(self, agent, tape: DialogTape) -> Prompt:",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                88,
                                632,
                                241,
                                646
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        88,
                                        632,
                                        112,
                                        646
                                    ],
                                    "score": 1.0,
                                    "content": "view",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        113,
                                        635,
                                        121,
                                        642
                                    ],
                                    "score": 0.77,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        121,
                                        632,
                                        241,
                                        646
                                    ],
                                    "score": 1.0,
                                    "content": " agent.compute_view(tape)",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                88,
                                645,
                                190,
                                658
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        88,
                                        645,
                                        170,
                                        658
                                    ],
                                    "score": 1.0,
                                    "content": "guidance_message",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        170,
                                        646,
                                        178,
                                        654
                                    ],
                                    "score": 0.58,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        178,
                                        645,
                                        190,
                                        658
                                    ],
                                    "score": 1.0,
                                    "content": " {",
                                    "type": "text"
                                }
                            ],
                            "index": 40
                        },
                        {
                            "bbox": [
                                100,
                                658,
                                173,
                                669
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        100,
                                        658,
                                        173,
                                        669
                                    ],
                                    "score": 1.0,
                                    "content": "\"role\": \"user\",",
                                    "type": "text"
                                }
                            ],
                            "index": 41
                        },
                        {
                            "bbox": [
                                100,
                                668,
                                518,
                                682
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        100,
                                        668,
                                        518,
                                        682
                                    ],
                                    "score": 1.0,
                                    "content": "\"content\": \"\"\"Follow the plan you created to earlier. When you are done, respond to the",
                                    "type": "text"
                                }
                            ],
                            "index": 42
                        },
                        {
                            "bbox": [
                                117,
                                680,
                                162,
                                694
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        680,
                                        162,
                                        694
                                    ],
                                    "score": 1.0,
                                    "content": "user.\"\"\"",
                                    "type": "text"
                                }
                            ],
                            "index": 43
                        },
                        {
                            "bbox": [
                                91,
                                696,
                                96,
                                703
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        696,
                                        96,
                                        703
                                    ],
                                    "score": 1.0,
                                    "content": "}",
                                    "type": "text"
                                }
                            ],
                            "index": 44
                        },
                        {
                            "bbox": [
                                89,
                                705,
                                160,
                                718
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        705,
                                        160,
                                        718
                                    ],
                                    "score": 1.0,
                                    "content": "return Prompt(",
                                    "type": "text"
                                }
                            ],
                            "index": 45
                        },
                        {
                            "bbox": [
                                98,
                                717,
                                498,
                                730
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        98,
                                        717,
                                        138,
                                        730
                                    ],
                                    "score": 1.0,
                                    "content": "messages",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        138,
                                        718,
                                        144,
                                        726
                                    ],
                                    "score": 0.3,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        144,
                                        717,
                                        222,
                                        730
                                    ],
                                    "score": 1.0,
                                    "content": "[system_message]",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        223,
                                        718,
                                        231,
                                        726
                                    ],
                                    "score": 0.7,
                                    "content": "^+",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        231,
                                        717,
                                        394,
                                        730
                                    ],
                                    "score": 1.0,
                                    "content": " view_to_messages(view.top, agent)",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        395,
                                        718,
                                        403,
                                        726
                                    ],
                                    "score": 0.66,
                                    "content": "^+",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        404,
                                        717,
                                        498,
                                        730
                                    ],
                                    "score": 1.0,
                                    "content": " [guidance_message],",
                                    "type": "text"
                                }
                            ],
                            "index": 46
                        }
                    ],
                    "index": 24
                }
            ],
            "layout_bboxes": [],
            "page_idx": 24,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        71,
                        27,
                        143,
                        37
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                25,
                                144,
                                38
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        25,
                                        144,
                                        38
                                    ],
                                    "score": 1.0,
                                    "content": "Technical report",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        751,
                        311,
                        761
                    ],
                    "lines": [
                        {
                            "bbox": [
                                299,
                                751,
                                312,
                                763
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        299,
                                        751,
                                        312,
                                        763
                                    ],
                                    "score": 1.0,
                                    "content": "25",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        69,
                        83,
                        509,
                        106
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                84,
                                507,
                                95
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        84,
                                        131,
                                        95
                                    ],
                                    "score": 1.0,
                                    "content": "search_agent",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        132,
                                        84,
                                        141,
                                        92
                                    ],
                                    "score": 0.72,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        141,
                                        84,
                                        224,
                                        95
                                    ],
                                    "score": 1.0,
                                    "content": " Agent.create(name",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        224,
                                        84,
                                        230,
                                        92
                                    ],
                                    "score": 0.45,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        231,
                                        84,
                                        415,
                                        95
                                    ],
                                    "score": 1.0,
                                    "content": "\"search_agent\", llms=LiteLLM(model_name",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        415,
                                        84,
                                        421,
                                        92
                                    ],
                                    "score": 0.26,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        422,
                                        84,
                                        507,
                                        95
                                    ],
                                    "score": 1.0,
                                    "content": "\"gpt-4o\"), nodes=[",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                89,
                                94,
                                203,
                                107
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        94,
                                        203,
                                        107
                                    ],
                                    "score": 1.0,
                                    "content": "SearchAgentMainNode()])",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        }
                    ],
                    "index": 0.5,
                    "page_num": "page_24",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        84,
                        507,
                        107
                    ]
                },
                {
                    "type": "list",
                    "bbox": [
                        68,
                        91,
                        529,
                        729
                    ],
                    "lines": [
                        {
                            "bbox": [
                                74,
                                106,
                                151,
                                120
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        74,
                                        106,
                                        151,
                                        120
                                    ],
                                    "score": 1.0,
                                    "content": "Agent #########",
                                    "type": "text"
                                }
                            ],
                            "index": 2,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                69,
                                131,
                                252,
                                144
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        131,
                                        252,
                                        144
                                    ],
                                    "score": 1.0,
                                    "content": "# define environment of analyst agent",
                                    "type": "text"
                                }
                            ],
                            "index": 3,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                69,
                                153,
                                526,
                                168
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        153,
                                        526,
                                        168
                                    ],
                                    "score": 1.0,
                                    "content": "# We will use the tool choice mechanism to let the main agent call its search specialist agent.",
                                    "type": "text"
                                }
                            ],
                            "index": 4,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                69,
                                167,
                                446,
                                180
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        167,
                                        446,
                                        180
                                    ],
                                    "score": 1.0,
                                    "content": "# To this end, we create a mock tool that represents calling the search agent.",
                                    "type": "text"
                                }
                            ],
                            "index": 5,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                179,
                                236,
                                192
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        179,
                                        236,
                                        192
                                    ],
                                    "score": 1.0,
                                    "content": "def call_search_agent(query: str):",
                                    "type": "text"
                                }
                            ],
                            "index": 6,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                88,
                                188,
                                485,
                                205
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        88,
                                        188,
                                        485,
                                        205
                                    ],
                                    "score": 1.0,
                                    "content": "\"\"\"Use this tool to ask a fellow AI agent to search for information on the web.\"\"\"",
                                    "type": "text"
                                }
                            ],
                            "index": 7,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                88,
                                203,
                                113,
                                215
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        88,
                                        203,
                                        113,
                                        215
                                    ],
                                    "score": 1.0,
                                    "content": "pass",
                                    "type": "text"
                                }
                            ],
                            "index": 8,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                68,
                                226,
                                237,
                                240
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        226,
                                        141,
                                        240
                                    ],
                                    "score": 1.0,
                                    "content": "main_agent_env",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        141,
                                        228,
                                        150,
                                        236
                                    ],
                                    "score": 0.76,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        150,
                                        226,
                                        237,
                                        240
                                    ],
                                    "score": 1.0,
                                    "content": " ToolEnvironment([",
                                    "type": "text"
                                }
                            ],
                            "index": 9,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                79,
                                238,
                                327,
                                252
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        238,
                                        327,
                                        252
                                    ],
                                    "score": 1.0,
                                    "content": "get_stock_ticker, get_stock_data, call_search_agent",
                                    "type": "text"
                                }
                            ],
                            "index": 10,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                251,
                                83,
                                262
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        251,
                                        83,
                                        262
                                    ],
                                    "score": 1.0,
                                    "content": "])",
                                    "type": "text"
                                }
                            ],
                            "index": 11,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                72,
                                274,
                                347,
                                288
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        274,
                                        168,
                                        285
                                    ],
                                    "score": 0.33,
                                    "content": "\\mathtt{t o d a y}=\\mathtt{\"2}824\\mathrm{-}\\theta9\\mathrm{-}17\\mathrm{\"}",
                                    "type": "inline_equation",
                                    "height": 11,
                                    "width": 96
                                },
                                {
                                    "bbox": [
                                        168,
                                        274,
                                        347,
                                        288
                                    ],
                                    "score": 1.0,
                                    "content": "# fixed date for reproducible tests",
                                    "type": "text"
                                }
                            ],
                            "index": 12,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                69,
                                285,
                                317,
                                299
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        285,
                                        141,
                                        299
                                    ],
                                    "score": 1.0,
                                    "content": "system_message",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        141,
                                        288,
                                        150,
                                        296
                                    ],
                                    "score": 0.78,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        151,
                                        285,
                                        317,
                                        299
                                    ],
                                    "score": 1.0,
                                    "content": "{\"role\": \"system\", \"content\": f\"\"\"",
                                    "type": "text"
                                }
                            ],
                            "index": 13,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                298,
                                533,
                                311
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        298,
                                        533,
                                        311
                                    ],
                                    "score": 1.0,
                                    "content": "You will help the user to learn about financials of companies. For general user queries, includ",
                                    "type": "text"
                                }
                            ],
                            "index": 14,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                94,
                                310,
                                486,
                                324
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        94,
                                        310,
                                        486,
                                        324
                                    ],
                                    "score": 1.0,
                                    "content": "some info about stock price changes during the last year, as well as some general",
                                    "type": "text"
                                }
                            ],
                            "index": 15,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                89,
                                322,
                                307,
                                335
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        322,
                                        307,
                                        335
                                    ],
                                    "score": 1.0,
                                    "content": "information on the company. Today is {today}.",
                                    "type": "text"
                                }
                            ],
                            "index": 16,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                78,
                                335,
                                93,
                                346
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        78,
                                        335,
                                        93,
                                        346
                                    ],
                                    "score": 1.0,
                                    "content": "\"\"}",
                                    "type": "text"
                                }
                            ],
                            "index": 17,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                69,
                                357,
                                266,
                                371
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        357,
                                        266,
                                        371
                                    ],
                                    "score": 1.0,
                                    "content": "# define the two nodes of the main agent",
                                    "type": "text"
                                }
                            ],
                            "index": 18,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                69,
                                370,
                                175,
                                383
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        370,
                                        175,
                                        383
                                    ],
                                    "score": 1.0,
                                    "content": "class PlanNode(Node):",
                                    "type": "text"
                                }
                            ],
                            "index": 19,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                77,
                                380,
                                299,
                                397
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        380,
                                        247,
                                        397
                                    ],
                                    "score": 1.0,
                                    "content": "def make_prompt(self, agent, tape) ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        247,
                                        383,
                                        259,
                                        391
                                    ],
                                    "score": 0.43,
                                    "content": "->",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 12
                                },
                                {
                                    "bbox": [
                                        260,
                                        380,
                                        299,
                                        397
                                    ],
                                    "score": 1.0,
                                    "content": " Prompt:",
                                    "type": "text"
                                }
                            ],
                            "index": 20,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                88,
                                393,
                                240,
                                407
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        88,
                                        393,
                                        112,
                                        407
                                    ],
                                    "score": 1.0,
                                    "content": "view",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        113,
                                        395,
                                        121,
                                        403
                                    ],
                                    "score": 0.78,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        122,
                                        393,
                                        240,
                                        407
                                    ],
                                    "score": 1.0,
                                    "content": " agent.compute_view(tape)",
                                    "type": "text"
                                }
                            ],
                            "index": 21,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                88,
                                406,
                                190,
                                420
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        88,
                                        406,
                                        170,
                                        420
                                    ],
                                    "score": 1.0,
                                    "content": "guidance_message",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        170,
                                        407,
                                        178,
                                        415
                                    ],
                                    "score": 0.34,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        178,
                                        406,
                                        190,
                                        420
                                    ],
                                    "score": 1.0,
                                    "content": " {",
                                    "type": "text"
                                }
                            ],
                            "index": 22,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                100,
                                417,
                                172,
                                431
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        100,
                                        417,
                                        172,
                                        431
                                    ],
                                    "score": 1.0,
                                    "content": "\"role\": \"user\",",
                                    "type": "text"
                                }
                            ],
                            "index": 23,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                100,
                                428,
                                519,
                                443
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        100,
                                        428,
                                        519,
                                        443
                                    ],
                                    "score": 1.0,
                                    "content": "\"content\": \"\"\"Write a natural language plan on how to use tools help the user. Output a",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                118,
                                441,
                                351,
                                453
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        118,
                                        441,
                                        351,
                                        453
                                    ],
                                    "score": 1.0,
                                    "content": "list of numbered items, like 1., 2., 3., etc.\"\"\"",
                                    "type": "text"
                                }
                            ],
                            "index": 25,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                91,
                                457,
                                96,
                                463
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        457,
                                        96,
                                        463
                                    ],
                                    "score": 1.0,
                                    "content": "}",
                                    "type": "text"
                                }
                            ],
                            "index": 26,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                90,
                                467,
                                160,
                                478
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        467,
                                        160,
                                        478
                                    ],
                                    "score": 1.0,
                                    "content": "return Prompt(",
                                    "type": "text"
                                }
                            ],
                            "index": 27,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                99,
                                478,
                                498,
                                491
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        99,
                                        478,
                                        138,
                                        491
                                    ],
                                    "score": 1.0,
                                    "content": "messages",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        138,
                                        480,
                                        144,
                                        487
                                    ],
                                    "score": 0.48,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        144,
                                        478,
                                        222,
                                        491
                                    ],
                                    "score": 1.0,
                                    "content": "[system_message]",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        222,
                                        479,
                                        231,
                                        487
                                    ],
                                    "score": 0.75,
                                    "content": "^+",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        231,
                                        478,
                                        394,
                                        491
                                    ],
                                    "score": 1.0,
                                    "content": " view_to_messages(view.top, agent)",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        395,
                                        479,
                                        403,
                                        487
                                    ],
                                    "score": 0.65,
                                    "content": "^+",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        404,
                                        478,
                                        498,
                                        491
                                    ],
                                    "score": 1.0,
                                    "content": " [guidance_message],",
                                    "type": "text"
                                }
                            ],
                            "index": 28,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                99,
                                489,
                                317,
                                502
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        99,
                                        489,
                                        124,
                                        502
                                    ],
                                    "score": 1.0,
                                    "content": "tools",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        124,
                                        492,
                                        129,
                                        498
                                    ],
                                    "score": 0.33,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 6,
                                    "width": 5
                                },
                                {
                                    "bbox": [
                                        129,
                                        489,
                                        317,
                                        502
                                    ],
                                    "score": 1.0,
                                    "content": "main_agent_env.get_tool_schema_dicts(),",
                                    "type": "text"
                                }
                            ],
                            "index": 29,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                91,
                                505,
                                96,
                                511
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        505,
                                        96,
                                        511
                                    ],
                                    "score": 1.0,
                                    "content": ")",
                                    "type": "text"
                                }
                            ],
                            "index": 30,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                78,
                                524,
                                385,
                                540
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        78,
                                        524,
                                        385,
                                        540
                                    ],
                                    "score": 1.0,
                                    "content": "def generate_steps(self, agent, dialog, llm_stream: LLMStream):",
                                    "type": "text"
                                }
                            ],
                            "index": 31,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                86,
                                536,
                                405,
                                552
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        536,
                                        405,
                                        552
                                    ],
                                    "score": 1.0,
                                    "content": "# the PlanNode should only yield thoughts based on the llm output",
                                    "type": "text"
                                }
                            ],
                            "index": 32,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                88,
                                547,
                                318,
                                564
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        88,
                                        547,
                                        146,
                                        564
                                    ],
                                    "score": 1.0,
                                    "content": "if content :",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        147,
                                        551,
                                        154,
                                        559
                                    ],
                                    "score": 0.44,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        155,
                                        547,
                                        318,
                                        564
                                    ],
                                    "score": 1.0,
                                    "content": " llm_stream.get_message().content:",
                                    "type": "text"
                                }
                            ],
                            "index": 33,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                99,
                                562,
                                288,
                                573
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        99,
                                        562,
                                        243,
                                        573
                                    ],
                                    "score": 1.0,
                                    "content": "yield AssistantThought(content",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        243,
                                        563,
                                        249,
                                        570
                                    ],
                                    "score": 0.61,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        249,
                                        562,
                                        288,
                                        573
                                    ],
                                    "score": 1.0,
                                    "content": "content)",
                                    "type": "text"
                                }
                            ],
                            "index": 34,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                90,
                                574,
                                116,
                                586
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        574,
                                        116,
                                        586
                                    ],
                                    "score": 1.0,
                                    "content": "else:",
                                    "type": "text"
                                }
                            ],
                            "index": 35,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                99,
                                586,
                                187,
                                597
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        99,
                                        586,
                                        187,
                                        597
                                    ],
                                    "score": 1.0,
                                    "content": "raise ValueError()",
                                    "type": "text"
                                }
                            ],
                            "index": 36,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                69,
                                608,
                                170,
                                622
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        608,
                                        170,
                                        622
                                    ],
                                    "score": 1.0,
                                    "content": "class ActNode(Node):",
                                    "type": "text"
                                }
                            ],
                            "index": 37,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                77,
                                619,
                                357,
                                635
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        619,
                                        357,
                                        635
                                    ],
                                    "score": 1.0,
                                    "content": "def make_prompt(self, agent, tape: DialogTape) -> Prompt:",
                                    "type": "text"
                                }
                            ],
                            "index": 38,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                88,
                                632,
                                241,
                                646
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        88,
                                        632,
                                        112,
                                        646
                                    ],
                                    "score": 1.0,
                                    "content": "view",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        113,
                                        635,
                                        121,
                                        642
                                    ],
                                    "score": 0.77,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        121,
                                        632,
                                        241,
                                        646
                                    ],
                                    "score": 1.0,
                                    "content": " agent.compute_view(tape)",
                                    "type": "text"
                                }
                            ],
                            "index": 39,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                88,
                                645,
                                190,
                                658
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        88,
                                        645,
                                        170,
                                        658
                                    ],
                                    "score": 1.0,
                                    "content": "guidance_message",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        170,
                                        646,
                                        178,
                                        654
                                    ],
                                    "score": 0.58,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        178,
                                        645,
                                        190,
                                        658
                                    ],
                                    "score": 1.0,
                                    "content": " {",
                                    "type": "text"
                                }
                            ],
                            "index": 40,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                100,
                                658,
                                173,
                                669
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        100,
                                        658,
                                        173,
                                        669
                                    ],
                                    "score": 1.0,
                                    "content": "\"role\": \"user\",",
                                    "type": "text"
                                }
                            ],
                            "index": 41,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                100,
                                668,
                                518,
                                682
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        100,
                                        668,
                                        518,
                                        682
                                    ],
                                    "score": 1.0,
                                    "content": "\"content\": \"\"\"Follow the plan you created to earlier. When you are done, respond to the",
                                    "type": "text"
                                }
                            ],
                            "index": 42,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                117,
                                680,
                                162,
                                694
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        680,
                                        162,
                                        694
                                    ],
                                    "score": 1.0,
                                    "content": "user.\"\"\"",
                                    "type": "text"
                                }
                            ],
                            "index": 43,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                91,
                                696,
                                96,
                                703
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        696,
                                        96,
                                        703
                                    ],
                                    "score": 1.0,
                                    "content": "}",
                                    "type": "text"
                                }
                            ],
                            "index": 44,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                89,
                                705,
                                160,
                                718
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        705,
                                        160,
                                        718
                                    ],
                                    "score": 1.0,
                                    "content": "return Prompt(",
                                    "type": "text"
                                }
                            ],
                            "index": 45,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                98,
                                717,
                                498,
                                730
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        98,
                                        717,
                                        138,
                                        730
                                    ],
                                    "score": 1.0,
                                    "content": "messages",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        138,
                                        718,
                                        144,
                                        726
                                    ],
                                    "score": 0.3,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        144,
                                        717,
                                        222,
                                        730
                                    ],
                                    "score": 1.0,
                                    "content": "[system_message]",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        223,
                                        718,
                                        231,
                                        726
                                    ],
                                    "score": 0.7,
                                    "content": "^+",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        231,
                                        717,
                                        394,
                                        730
                                    ],
                                    "score": 1.0,
                                    "content": " view_to_messages(view.top, agent)",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        395,
                                        718,
                                        403,
                                        726
                                    ],
                                    "score": 0.66,
                                    "content": "^+",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        404,
                                        717,
                                        498,
                                        730
                                    ],
                                    "score": 1.0,
                                    "content": " [guidance_message],",
                                    "type": "text"
                                }
                            ],
                            "index": 46,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                99,
                                84,
                                315,
                                96
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        99,
                                        84,
                                        123,
                                        96
                                    ],
                                    "score": 1.0,
                                    "content": "tools",
                                    "type": "text",
                                    "cross_page": true
                                },
                                {
                                    "bbox": [
                                        124,
                                        85,
                                        129,
                                        92
                                    ],
                                    "score": 0.33,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 5,
                                    "cross_page": true
                                },
                                {
                                    "bbox": [
                                        129,
                                        84,
                                        315,
                                        96
                                    ],
                                    "score": 1.0,
                                    "content": "main_agent_env.get_tool_schema_dicts(),",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 0,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                90,
                                98,
                                97,
                                105
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        98,
                                        97,
                                        105
                                    ],
                                    "score": 1.0,
                                    "content": ")",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 1,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                81,
                                120,
                                384,
                                132
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        81,
                                        120,
                                        384,
                                        132
                                    ],
                                    "score": 1.0,
                                    "content": "def generate_steps(self, agent, dialog, llm_stream: LLMStream):",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 2,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                87,
                                131,
                                227,
                                145
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        87,
                                        131,
                                        98,
                                        145
                                    ],
                                    "score": 1.0,
                                    "content": "m",
                                    "type": "text",
                                    "cross_page": true
                                },
                                {
                                    "bbox": [
                                        99,
                                        132,
                                        107,
                                        140
                                    ],
                                    "score": 0.43,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 8,
                                    "cross_page": true
                                },
                                {
                                    "bbox": [
                                        108,
                                        131,
                                        227,
                                        145
                                    ],
                                    "score": 1.0,
                                    "content": "llm_stream.get_message()",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 3,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                89,
                                144,
                                155,
                                156
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        144,
                                        155,
                                        156
                                    ],
                                    "score": 1.0,
                                    "content": "if m.content:",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 4,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                96,
                                153,
                                452,
                                169
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        96,
                                        153,
                                        452,
                                        169
                                    ],
                                    "score": 1.0,
                                    "content": "# show the llm output as your response and give back control to plan node",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 5,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                99,
                                168,
                                389,
                                180
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        99,
                                        168,
                                        228,
                                        180
                                    ],
                                    "score": 1.0,
                                    "content": "yield SetNextNode(next_node",
                                    "type": "text",
                                    "cross_page": true
                                },
                                {
                                    "bbox": [
                                        229,
                                        168,
                                        239,
                                        176
                                    ],
                                    "score": 0.74,
                                    "content": "=0",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 10,
                                    "cross_page": true
                                },
                                {
                                    "bbox": [
                                        240,
                                        168,
                                        389,
                                        180
                                    ],
                                    "score": 1.0,
                                    "content": ") # set next node to Plan node",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 6,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                98,
                                179,
                                393,
                                191
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        98,
                                        179,
                                        228,
                                        191
                                    ],
                                    "score": 1.0,
                                    "content": "yield AssistantStep(content",
                                    "type": "text",
                                    "cross_page": true
                                },
                                {
                                    "bbox": [
                                        228,
                                        181,
                                        240,
                                        188
                                    ],
                                    "score": 0.76,
                                    "content": "\\mathsf{=m}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 12,
                                    "cross_page": true
                                },
                                {
                                    "bbox": [
                                        240,
                                        179,
                                        393,
                                        191
                                    ],
                                    "score": 1.0,
                                    "content": ".content) # show the llm output",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 7,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                88,
                                189,
                                180,
                                204
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        88,
                                        189,
                                        180,
                                        204
                                    ],
                                    "score": 1.0,
                                    "content": "elif m.tool_calls:",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 8,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                98,
                                202,
                                533,
                                217
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        98,
                                        202,
                                        228,
                                        217
                                    ],
                                    "score": 1.0,
                                    "content": "yield SetNextNode(next_node",
                                    "type": "text",
                                    "cross_page": true
                                },
                                {
                                    "bbox": [
                                        229,
                                        204,
                                        239,
                                        212
                                    ],
                                    "score": 0.52,
                                    "content": "=1",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 10,
                                    "cross_page": true
                                },
                                {
                                    "bbox": [
                                        239,
                                        202,
                                        533,
                                        217
                                    ],
                                    "score": 1.0,
                                    "content": ") # set next node to Act node (self) until we get tool_calls",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                98,
                                215,
                                385,
                                227
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        98,
                                        215,
                                        385,
                                        227
                                    ],
                                    "score": 1.0,
                                    "content": "# only keep the tool calls before the call to another agent",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 10,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                97,
                                227,
                                185,
                                239
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        97,
                                        227,
                                        150,
                                        239
                                    ],
                                    "score": 1.0,
                                    "content": "agent_call",
                                    "type": "text",
                                    "cross_page": true
                                },
                                {
                                    "bbox": [
                                        150,
                                        228,
                                        159,
                                        236
                                    ],
                                    "score": 0.78,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 9,
                                    "cross_page": true
                                },
                                {
                                    "bbox": [
                                        160,
                                        227,
                                        185,
                                        239
                                    ],
                                    "score": 1.0,
                                    "content": " None",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 11,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                98,
                                237,
                                279,
                                252
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        98,
                                        237,
                                        279,
                                        252
                                    ],
                                    "score": 1.0,
                                    "content": "for i, tc in enumerate(m.tool_calls):",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 12,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                108,
                                250,
                                319,
                                264
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        108,
                                        250,
                                        204,
                                        264
                                    ],
                                    "score": 1.0,
                                    "content": "if tc.function.name ",
                                    "type": "text",
                                    "cross_page": true
                                },
                                {
                                    "bbox": [
                                        204,
                                        252,
                                        217,
                                        260
                                    ],
                                    "score": 0.84,
                                    "content": "==",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 13,
                                    "cross_page": true
                                },
                                {
                                    "bbox": [
                                        217,
                                        250,
                                        319,
                                        264
                                    ],
                                    "score": 1.0,
                                    "content": " \"call_search_agent\":",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 13,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                116,
                                262,
                                195,
                                275
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        116,
                                        262,
                                        169,
                                        275
                                    ],
                                    "score": 1.0,
                                    "content": "agent_call",
                                    "type": "text",
                                    "cross_page": true
                                },
                                {
                                    "bbox": [
                                        170,
                                        264,
                                        178,
                                        271
                                    ],
                                    "score": 0.77,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8,
                                    "cross_page": true
                                },
                                {
                                    "bbox": [
                                        178,
                                        262,
                                        195,
                                        275
                                    ],
                                    "score": 1.0,
                                    "content": " tc",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 14,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                116,
                                274,
                                271,
                                288
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        116,
                                        274,
                                        179,
                                        288
                                    ],
                                    "score": 1.0,
                                    "content": "m.tool_calls",
                                    "type": "text",
                                    "cross_page": true
                                },
                                {
                                    "bbox": [
                                        180,
                                        276,
                                        188,
                                        283
                                    ],
                                    "score": 0.67,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8,
                                    "cross_page": true
                                },
                                {
                                    "bbox": [
                                        189,
                                        274,
                                        271,
                                        288
                                    ],
                                    "score": 1.0,
                                    "content": " m.tool_calls[:i]",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 15,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                118,
                                287,
                                146,
                                300
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        118,
                                        287,
                                        146,
                                        300
                                    ],
                                    "score": 1.0,
                                    "content": "break",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 16,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                98,
                                298,
                                385,
                                313
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        98,
                                        298,
                                        385,
                                        313
                                    ],
                                    "score": 1.0,
                                    "content": "# either produce the ToolCalls action OR call another agent",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 17,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                97,
                                309,
                                180,
                                325
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        97,
                                        309,
                                        180,
                                        325
                                    ],
                                    "score": 1.0,
                                    "content": "if m.tool_calls:",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 18,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                107,
                                322,
                                275,
                                336
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        322,
                                        275,
                                        336
                                    ],
                                    "score": 1.0,
                                    "content": "yield ToolCalls.from_llm_output(m)",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 19,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                99,
                                334,
                                126,
                                345
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        99,
                                        334,
                                        126,
                                        345
                                    ],
                                    "score": 1.0,
                                    "content": "else:",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 20,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                107,
                                346,
                                441,
                                361
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        346,
                                        333,
                                        361
                                    ],
                                    "score": 1.0,
                                    "content": "assert agent_call and agent_call.function.name ",
                                    "type": "text",
                                    "cross_page": true
                                },
                                {
                                    "bbox": [
                                        333,
                                        348,
                                        346,
                                        356
                                    ],
                                    "score": 0.81,
                                    "content": "==",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 13,
                                    "cross_page": true
                                },
                                {
                                    "bbox": [
                                        346,
                                        346,
                                        441,
                                        361
                                    ],
                                    "score": 1.0,
                                    "content": " \"call_search_agent\"",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 21,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                106,
                                358,
                                165,
                                370
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        358,
                                        165,
                                        370
                                    ],
                                    "score": 1.0,
                                    "content": "yield Call(",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 22,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                116,
                                370,
                                245,
                                384
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        116,
                                        370,
                                        167,
                                        384
                                    ],
                                    "score": 1.0,
                                    "content": "agent_name",
                                    "type": "text",
                                    "cross_page": true
                                },
                                {
                                    "bbox": [
                                        167,
                                        372,
                                        173,
                                        379
                                    ],
                                    "score": 0.35,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 6,
                                    "cross_page": true
                                },
                                {
                                    "bbox": [
                                        173,
                                        370,
                                        245,
                                        384
                                    ],
                                    "score": 1.0,
                                    "content": "\"search_agent\",",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 23,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                118,
                                383,
                                398,
                                395
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        118,
                                        383,
                                        152,
                                        395
                                    ],
                                    "score": 1.0,
                                    "content": "content",
                                    "type": "text",
                                    "cross_page": true
                                },
                                {
                                    "bbox": [
                                        153,
                                        384,
                                        158,
                                        391
                                    ],
                                    "score": 0.31,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 5,
                                    "cross_page": true
                                },
                                {
                                    "bbox": [
                                        158,
                                        383,
                                        398,
                                        395
                                    ],
                                    "score": 1.0,
                                    "content": "json.loads(agent_call.function.arguments)[\"query\"]",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 24,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                107,
                                395,
                                117,
                                405
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        395,
                                        117,
                                        405
                                    ],
                                    "score": 1.0,
                                    "content": ")",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 25,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                90,
                                406,
                                116,
                                417
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        406,
                                        116,
                                        417
                                    ],
                                    "score": 1.0,
                                    "content": "else:",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 26,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                99,
                                417,
                                189,
                                432
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        99,
                                        417,
                                        189,
                                        432
                                    ],
                                    "score": 1.0,
                                    "content": "raise ValueError()",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 27,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                69,
                                440,
                                218,
                                455
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        440,
                                        218,
                                        455
                                    ],
                                    "score": 1.0,
                                    "content": "# define the main (root) agent",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 28,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                455,
                                538,
                                466
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        455,
                                        165,
                                        466
                                    ],
                                    "score": 1.0,
                                    "content": "multi_agent_analyst",
                                    "type": "text",
                                    "cross_page": true
                                },
                                {
                                    "bbox": [
                                        165,
                                        455,
                                        174,
                                        463
                                    ],
                                    "score": 0.81,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 9,
                                    "cross_page": true
                                },
                                {
                                    "bbox": [
                                        174,
                                        455,
                                        257,
                                        466
                                    ],
                                    "score": 1.0,
                                    "content": " Agent.create(name",
                                    "type": "text",
                                    "cross_page": true
                                },
                                {
                                    "bbox": [
                                        258,
                                        455,
                                        264,
                                        463
                                    ],
                                    "score": 0.59,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 6,
                                    "cross_page": true
                                },
                                {
                                    "bbox": [
                                        264,
                                        455,
                                        358,
                                        466
                                    ],
                                    "score": 1.0,
                                    "content": "\"analyst\", subagents",
                                    "type": "text",
                                    "cross_page": true
                                },
                                {
                                    "bbox": [
                                        358,
                                        456,
                                        364,
                                        463
                                    ],
                                    "score": 0.55,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 6,
                                    "cross_page": true
                                },
                                {
                                    "bbox": [
                                        364,
                                        455,
                                        496,
                                        466
                                    ],
                                    "score": 1.0,
                                    "content": "[search_agent.clone()], llms",
                                    "type": "text",
                                    "cross_page": true
                                },
                                {
                                    "bbox": [
                                        497,
                                        455,
                                        502,
                                        462
                                    ],
                                    "score": 0.44,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 5,
                                    "cross_page": true
                                },
                                {
                                    "bbox": [
                                        502,
                                        455,
                                        538,
                                        466
                                    ],
                                    "score": 1.0,
                                    "content": "LiteLLM",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 29,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                90,
                                465,
                                348,
                                479
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        465,
                                        143,
                                        479
                                    ],
                                    "score": 1.0,
                                    "content": "(model_name",
                                    "type": "text",
                                    "cross_page": true
                                },
                                {
                                    "bbox": [
                                        144,
                                        468,
                                        150,
                                        474
                                    ],
                                    "score": 0.33,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 6,
                                    "width": 6,
                                    "cross_page": true
                                },
                                {
                                    "bbox": [
                                        150,
                                        465,
                                        225,
                                        479
                                    ],
                                    "score": 1.0,
                                    "content": "\"gpt-4o\"), nodes",
                                    "type": "text",
                                    "cross_page": true
                                },
                                {
                                    "bbox": [
                                        225,
                                        468,
                                        231,
                                        474
                                    ],
                                    "score": 0.55,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 6,
                                    "width": 6,
                                    "cross_page": true
                                },
                                {
                                    "bbox": [
                                        231,
                                        465,
                                        348,
                                        479
                                    ],
                                    "score": 1.0,
                                    "content": "[PlanNode(), ActNode()])",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 30,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                68,
                                487,
                                372,
                                505
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        487,
                                        372,
                                        505
                                    ],
                                    "score": 1.0,
                                    "content": "# define the starting point: a DialogTape with only 1 UserStep",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 31,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                501,
                                494,
                                515
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        501,
                                        122,
                                        515
                                    ],
                                    "score": 1.0,
                                    "content": "start_tape",
                                    "type": "text",
                                    "cross_page": true
                                },
                                {
                                    "bbox": [
                                        122,
                                        502,
                                        131,
                                        511
                                    ],
                                    "score": 0.79,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 9,
                                    "cross_page": true
                                },
                                {
                                    "bbox": [
                                        131,
                                        501,
                                        209,
                                        515
                                    ],
                                    "score": 1.0,
                                    "content": " DialogTape(steps",
                                    "type": "text",
                                    "cross_page": true
                                },
                                {
                                    "bbox": [
                                        210,
                                        503,
                                        216,
                                        510
                                    ],
                                    "score": 0.55,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 6,
                                    "cross_page": true
                                },
                                {
                                    "bbox": [
                                        216,
                                        501,
                                        295,
                                        515
                                    ],
                                    "score": 1.0,
                                    "content": "[UserStep(content",
                                    "type": "text",
                                    "cross_page": true
                                },
                                {
                                    "bbox": [
                                        295,
                                        502,
                                        305,
                                        510
                                    ],
                                    "score": 0.31,
                                    "content": "{\\boldsymbol{\\cdot}}^{\\prime\\prime}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 10,
                                    "cross_page": true
                                },
                                {
                                    "bbox": [
                                        306,
                                        501,
                                        494,
                                        515
                                    ],
                                    "score": 1.0,
                                    "content": "Tell me about Vulcan in 3 sentences\")])",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 32,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                69,
                                524,
                                495,
                                539
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        524,
                                        495,
                                        539
                                    ],
                                    "score": 1.0,
                                    "content": "# define the whole environment as the combination of all agents & subagents environments",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 33,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                538,
                                212,
                                550
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        538,
                                        117,
                                        550
                                    ],
                                    "score": 1.0,
                                    "content": "whole_env",
                                    "type": "text",
                                    "cross_page": true
                                },
                                {
                                    "bbox": [
                                        117,
                                        538,
                                        126,
                                        547
                                    ],
                                    "score": 0.76,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 9,
                                    "cross_page": true
                                },
                                {
                                    "bbox": [
                                        126,
                                        538,
                                        212,
                                        550
                                    ],
                                    "score": 1.0,
                                    "content": " ToolEnvironment([",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 34,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                79,
                                549,
                                502,
                                563
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        549,
                                        502,
                                        563
                                    ],
                                    "score": 1.0,
                                    "content": "get_stock_ticker, get_stock_data, browser.get_search_results, browser.get_page, browser.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 35,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                98,
                                559,
                                166,
                                576
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        98,
                                        559,
                                        166,
                                        576
                                    ],
                                    "score": 1.0,
                                    "content": "get_next_page",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 36,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                573,
                                83,
                                586
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        573,
                                        83,
                                        586
                                    ],
                                    "score": 1.0,
                                    "content": "])",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 37,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                597,
                                483,
                                610
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        597,
                                        483,
                                        610
                                    ],
                                    "score": 1.0,
                                    "content": "# Main loop executing the ‘multi_agent_analyst‘ on the ‘start_tape‘ in the ‘whole_env‘",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 38,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                90,
                                610,
                                149,
                                622
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        610,
                                        149,
                                        622
                                    ],
                                    "score": 1.0,
                                    "content": "environment.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 39,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                621,
                                395,
                                635
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        621,
                                        395,
                                        635
                                    ],
                                    "score": 1.0,
                                    "content": "for event in main_loop(multi_agent_analyst, start_tape, whole_env):",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 40,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                78,
                                633,
                                524,
                                647
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        78,
                                        633,
                                        524,
                                        647
                                    ],
                                    "score": 1.0,
                                    "content": "# ‘event‘s are all types of steps yielded by the ‘multi_agent_analyst‘ when running on the ‘",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 41,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                99,
                                646,
                                309,
                                658
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        99,
                                        646,
                                        309,
                                        658
                                    ],
                                    "score": 1.0,
                                    "content": "start_tape‘ in the ‘whole_env‘ environment.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 42,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                78,
                                655,
                                323,
                                672
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        78,
                                        655,
                                        142,
                                        672
                                    ],
                                    "score": 1.0,
                                    "content": "if new_tape :",
                                    "type": "text",
                                    "cross_page": true
                                },
                                {
                                    "bbox": [
                                        142,
                                        659,
                                        150,
                                        666
                                    ],
                                    "score": 0.65,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8,
                                    "cross_page": true
                                },
                                {
                                    "bbox": [
                                        150,
                                        655,
                                        323,
                                        672
                                    ],
                                    "score": 1.0,
                                    "content": " event.agent_tape or event.env_tape:",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 43,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                88,
                                668,
                                514,
                                683
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        88,
                                        668,
                                        514,
                                        683
                                    ],
                                    "score": 1.0,
                                    "content": "# show a fresh render every time when the environment finishes reacting with new actions",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 44,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                89,
                                680,
                                159,
                                695
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        680,
                                        159,
                                        695
                                    ],
                                    "score": 1.0,
                                    "content": "clear_output()",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 45,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                90,
                                694,
                                435,
                                706
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        694,
                                        435,
                                        706
                                    ],
                                    "score": 1.0,
                                    "content": "display(HTML(render_tape_with_prompts(new_tape, CameraReadyRenderer())))",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 46,
                            "is_list_end_line": true
                        }
                    ],
                    "index": 24,
                    "page_num": "page_24",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        68,
                        106,
                        533,
                        730
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        66,
                        18,
                        541,
                        714
                    ],
                    "lines": [
                        {
                            "bbox": [
                                99,
                                84,
                                315,
                                96
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        99,
                                        84,
                                        123,
                                        96
                                    ],
                                    "score": 1.0,
                                    "content": "tools",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        124,
                                        85,
                                        129,
                                        92
                                    ],
                                    "score": 0.33,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 5
                                },
                                {
                                    "bbox": [
                                        129,
                                        84,
                                        315,
                                        96
                                    ],
                                    "score": 1.0,
                                    "content": "main_agent_env.get_tool_schema_dicts(),",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                90,
                                98,
                                97,
                                105
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        98,
                                        97,
                                        105
                                    ],
                                    "score": 1.0,
                                    "content": ")",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                81,
                                120,
                                384,
                                132
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        81,
                                        120,
                                        384,
                                        132
                                    ],
                                    "score": 1.0,
                                    "content": "def generate_steps(self, agent, dialog, llm_stream: LLMStream):",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                87,
                                131,
                                227,
                                145
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        87,
                                        131,
                                        98,
                                        145
                                    ],
                                    "score": 1.0,
                                    "content": "m",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        99,
                                        132,
                                        107,
                                        140
                                    ],
                                    "score": 0.43,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        108,
                                        131,
                                        227,
                                        145
                                    ],
                                    "score": 1.0,
                                    "content": "llm_stream.get_message()",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                89,
                                144,
                                155,
                                156
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        144,
                                        155,
                                        156
                                    ],
                                    "score": 1.0,
                                    "content": "if m.content:",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                96,
                                153,
                                452,
                                169
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        96,
                                        153,
                                        452,
                                        169
                                    ],
                                    "score": 1.0,
                                    "content": "# show the llm output as your response and give back control to plan node",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                99,
                                168,
                                389,
                                180
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        99,
                                        168,
                                        228,
                                        180
                                    ],
                                    "score": 1.0,
                                    "content": "yield SetNextNode(next_node",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        229,
                                        168,
                                        239,
                                        176
                                    ],
                                    "score": 0.74,
                                    "content": "=0",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 10
                                },
                                {
                                    "bbox": [
                                        240,
                                        168,
                                        389,
                                        180
                                    ],
                                    "score": 1.0,
                                    "content": ") # set next node to Plan node",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                98,
                                179,
                                393,
                                191
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        98,
                                        179,
                                        228,
                                        191
                                    ],
                                    "score": 1.0,
                                    "content": "yield AssistantStep(content",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        228,
                                        181,
                                        240,
                                        188
                                    ],
                                    "score": 0.76,
                                    "content": "\\mathsf{=m}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 12
                                },
                                {
                                    "bbox": [
                                        240,
                                        179,
                                        393,
                                        191
                                    ],
                                    "score": 1.0,
                                    "content": ".content) # show the llm output",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                88,
                                189,
                                180,
                                204
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        88,
                                        189,
                                        180,
                                        204
                                    ],
                                    "score": 1.0,
                                    "content": "elif m.tool_calls:",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                98,
                                202,
                                533,
                                217
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        98,
                                        202,
                                        228,
                                        217
                                    ],
                                    "score": 1.0,
                                    "content": "yield SetNextNode(next_node",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        229,
                                        204,
                                        239,
                                        212
                                    ],
                                    "score": 0.52,
                                    "content": "=1",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 10
                                },
                                {
                                    "bbox": [
                                        239,
                                        202,
                                        533,
                                        217
                                    ],
                                    "score": 1.0,
                                    "content": ") # set next node to Act node (self) until we get tool_calls",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                98,
                                215,
                                385,
                                227
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        98,
                                        215,
                                        385,
                                        227
                                    ],
                                    "score": 1.0,
                                    "content": "# only keep the tool calls before the call to another agent",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                97,
                                227,
                                185,
                                239
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        97,
                                        227,
                                        150,
                                        239
                                    ],
                                    "score": 1.0,
                                    "content": "agent_call",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        150,
                                        228,
                                        159,
                                        236
                                    ],
                                    "score": 0.78,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        160,
                                        227,
                                        185,
                                        239
                                    ],
                                    "score": 1.0,
                                    "content": " None",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                98,
                                237,
                                279,
                                252
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        98,
                                        237,
                                        279,
                                        252
                                    ],
                                    "score": 1.0,
                                    "content": "for i, tc in enumerate(m.tool_calls):",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                108,
                                250,
                                319,
                                264
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        108,
                                        250,
                                        204,
                                        264
                                    ],
                                    "score": 1.0,
                                    "content": "if tc.function.name ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        204,
                                        252,
                                        217,
                                        260
                                    ],
                                    "score": 0.84,
                                    "content": "==",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 13
                                },
                                {
                                    "bbox": [
                                        217,
                                        250,
                                        319,
                                        264
                                    ],
                                    "score": 1.0,
                                    "content": " \"call_search_agent\":",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                116,
                                262,
                                195,
                                275
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        116,
                                        262,
                                        169,
                                        275
                                    ],
                                    "score": 1.0,
                                    "content": "agent_call",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        170,
                                        264,
                                        178,
                                        271
                                    ],
                                    "score": 0.77,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        178,
                                        262,
                                        195,
                                        275
                                    ],
                                    "score": 1.0,
                                    "content": " tc",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                116,
                                274,
                                271,
                                288
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        116,
                                        274,
                                        179,
                                        288
                                    ],
                                    "score": 1.0,
                                    "content": "m.tool_calls",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        180,
                                        276,
                                        188,
                                        283
                                    ],
                                    "score": 0.67,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        189,
                                        274,
                                        271,
                                        288
                                    ],
                                    "score": 1.0,
                                    "content": " m.tool_calls[:i]",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                118,
                                287,
                                146,
                                300
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        118,
                                        287,
                                        146,
                                        300
                                    ],
                                    "score": 1.0,
                                    "content": "break",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                98,
                                298,
                                385,
                                313
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        98,
                                        298,
                                        385,
                                        313
                                    ],
                                    "score": 1.0,
                                    "content": "# either produce the ToolCalls action OR call another agent",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                97,
                                309,
                                180,
                                325
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        97,
                                        309,
                                        180,
                                        325
                                    ],
                                    "score": 1.0,
                                    "content": "if m.tool_calls:",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                107,
                                322,
                                275,
                                336
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        322,
                                        275,
                                        336
                                    ],
                                    "score": 1.0,
                                    "content": "yield ToolCalls.from_llm_output(m)",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                99,
                                334,
                                126,
                                345
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        99,
                                        334,
                                        126,
                                        345
                                    ],
                                    "score": 1.0,
                                    "content": "else:",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                107,
                                346,
                                441,
                                361
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        346,
                                        333,
                                        361
                                    ],
                                    "score": 1.0,
                                    "content": "assert agent_call and agent_call.function.name ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        333,
                                        348,
                                        346,
                                        356
                                    ],
                                    "score": 0.81,
                                    "content": "==",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 13
                                },
                                {
                                    "bbox": [
                                        346,
                                        346,
                                        441,
                                        361
                                    ],
                                    "score": 1.0,
                                    "content": " \"call_search_agent\"",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                106,
                                358,
                                165,
                                370
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        358,
                                        165,
                                        370
                                    ],
                                    "score": 1.0,
                                    "content": "yield Call(",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                116,
                                370,
                                245,
                                384
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        116,
                                        370,
                                        167,
                                        384
                                    ],
                                    "score": 1.0,
                                    "content": "agent_name",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        167,
                                        372,
                                        173,
                                        379
                                    ],
                                    "score": 0.35,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        173,
                                        370,
                                        245,
                                        384
                                    ],
                                    "score": 1.0,
                                    "content": "\"search_agent\",",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                118,
                                383,
                                398,
                                395
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        118,
                                        383,
                                        152,
                                        395
                                    ],
                                    "score": 1.0,
                                    "content": "content",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        153,
                                        384,
                                        158,
                                        391
                                    ],
                                    "score": 0.31,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 5
                                },
                                {
                                    "bbox": [
                                        158,
                                        383,
                                        398,
                                        395
                                    ],
                                    "score": 1.0,
                                    "content": "json.loads(agent_call.function.arguments)[\"query\"]",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                107,
                                395,
                                117,
                                405
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        395,
                                        117,
                                        405
                                    ],
                                    "score": 1.0,
                                    "content": ")",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                90,
                                406,
                                116,
                                417
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        406,
                                        116,
                                        417
                                    ],
                                    "score": 1.0,
                                    "content": "else:",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                99,
                                417,
                                189,
                                432
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        99,
                                        417,
                                        189,
                                        432
                                    ],
                                    "score": 1.0,
                                    "content": "raise ValueError()",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                69,
                                440,
                                218,
                                455
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        440,
                                        218,
                                        455
                                    ],
                                    "score": 1.0,
                                    "content": "# define the main (root) agent",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                70,
                                455,
                                538,
                                466
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        455,
                                        165,
                                        466
                                    ],
                                    "score": 1.0,
                                    "content": "multi_agent_analyst",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        165,
                                        455,
                                        174,
                                        463
                                    ],
                                    "score": 0.81,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        174,
                                        455,
                                        257,
                                        466
                                    ],
                                    "score": 1.0,
                                    "content": " Agent.create(name",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        258,
                                        455,
                                        264,
                                        463
                                    ],
                                    "score": 0.59,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        264,
                                        455,
                                        358,
                                        466
                                    ],
                                    "score": 1.0,
                                    "content": "\"analyst\", subagents",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        358,
                                        456,
                                        364,
                                        463
                                    ],
                                    "score": 0.55,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        364,
                                        455,
                                        496,
                                        466
                                    ],
                                    "score": 1.0,
                                    "content": "[search_agent.clone()], llms",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        497,
                                        455,
                                        502,
                                        462
                                    ],
                                    "score": 0.44,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 5
                                },
                                {
                                    "bbox": [
                                        502,
                                        455,
                                        538,
                                        466
                                    ],
                                    "score": 1.0,
                                    "content": "LiteLLM",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                90,
                                465,
                                348,
                                479
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        465,
                                        143,
                                        479
                                    ],
                                    "score": 1.0,
                                    "content": "(model_name",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        144,
                                        468,
                                        150,
                                        474
                                    ],
                                    "score": 0.33,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 6,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        150,
                                        465,
                                        225,
                                        479
                                    ],
                                    "score": 1.0,
                                    "content": "\"gpt-4o\"), nodes",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        225,
                                        468,
                                        231,
                                        474
                                    ],
                                    "score": 0.55,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 6,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        231,
                                        465,
                                        348,
                                        479
                                    ],
                                    "score": 1.0,
                                    "content": "[PlanNode(), ActNode()])",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                68,
                                487,
                                372,
                                505
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        487,
                                        372,
                                        505
                                    ],
                                    "score": 1.0,
                                    "content": "# define the starting point: a DialogTape with only 1 UserStep",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                70,
                                501,
                                494,
                                515
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        501,
                                        122,
                                        515
                                    ],
                                    "score": 1.0,
                                    "content": "start_tape",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        122,
                                        502,
                                        131,
                                        511
                                    ],
                                    "score": 0.79,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        131,
                                        501,
                                        209,
                                        515
                                    ],
                                    "score": 1.0,
                                    "content": " DialogTape(steps",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        210,
                                        503,
                                        216,
                                        510
                                    ],
                                    "score": 0.55,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        216,
                                        501,
                                        295,
                                        515
                                    ],
                                    "score": 1.0,
                                    "content": "[UserStep(content",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        295,
                                        502,
                                        305,
                                        510
                                    ],
                                    "score": 0.31,
                                    "content": "{\\boldsymbol{\\cdot}}^{\\prime\\prime}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 10
                                },
                                {
                                    "bbox": [
                                        306,
                                        501,
                                        494,
                                        515
                                    ],
                                    "score": 1.0,
                                    "content": "Tell me about Vulcan in 3 sentences\")])",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                69,
                                524,
                                495,
                                539
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        524,
                                        495,
                                        539
                                    ],
                                    "score": 1.0,
                                    "content": "# define the whole environment as the combination of all agents & subagents environments",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                70,
                                538,
                                212,
                                550
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        538,
                                        117,
                                        550
                                    ],
                                    "score": 1.0,
                                    "content": "whole_env",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        117,
                                        538,
                                        126,
                                        547
                                    ],
                                    "score": 0.76,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        126,
                                        538,
                                        212,
                                        550
                                    ],
                                    "score": 1.0,
                                    "content": " ToolEnvironment([",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                79,
                                549,
                                502,
                                563
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        79,
                                        549,
                                        502,
                                        563
                                    ],
                                    "score": 1.0,
                                    "content": "get_stock_ticker, get_stock_data, browser.get_search_results, browser.get_page, browser.",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                98,
                                559,
                                166,
                                576
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        98,
                                        559,
                                        166,
                                        576
                                    ],
                                    "score": 1.0,
                                    "content": "get_next_page",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                70,
                                573,
                                83,
                                586
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        573,
                                        83,
                                        586
                                    ],
                                    "score": 1.0,
                                    "content": "])",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                70,
                                597,
                                483,
                                610
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        597,
                                        483,
                                        610
                                    ],
                                    "score": 1.0,
                                    "content": "# Main loop executing the ‘multi_agent_analyst‘ on the ‘start_tape‘ in the ‘whole_env‘",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                90,
                                610,
                                149,
                                622
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        610,
                                        149,
                                        622
                                    ],
                                    "score": 1.0,
                                    "content": "environment.",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                70,
                                621,
                                395,
                                635
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        621,
                                        395,
                                        635
                                    ],
                                    "score": 1.0,
                                    "content": "for event in main_loop(multi_agent_analyst, start_tape, whole_env):",
                                    "type": "text"
                                }
                            ],
                            "index": 40
                        },
                        {
                            "bbox": [
                                78,
                                633,
                                524,
                                647
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        78,
                                        633,
                                        524,
                                        647
                                    ],
                                    "score": 1.0,
                                    "content": "# ‘event‘s are all types of steps yielded by the ‘multi_agent_analyst‘ when running on the ‘",
                                    "type": "text"
                                }
                            ],
                            "index": 41
                        },
                        {
                            "bbox": [
                                99,
                                646,
                                309,
                                658
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        99,
                                        646,
                                        309,
                                        658
                                    ],
                                    "score": 1.0,
                                    "content": "start_tape‘ in the ‘whole_env‘ environment.",
                                    "type": "text"
                                }
                            ],
                            "index": 42
                        },
                        {
                            "bbox": [
                                78,
                                655,
                                323,
                                672
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        78,
                                        655,
                                        142,
                                        672
                                    ],
                                    "score": 1.0,
                                    "content": "if new_tape :",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        142,
                                        659,
                                        150,
                                        666
                                    ],
                                    "score": 0.65,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        150,
                                        655,
                                        323,
                                        672
                                    ],
                                    "score": 1.0,
                                    "content": " event.agent_tape or event.env_tape:",
                                    "type": "text"
                                }
                            ],
                            "index": 43
                        },
                        {
                            "bbox": [
                                88,
                                668,
                                514,
                                683
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        88,
                                        668,
                                        514,
                                        683
                                    ],
                                    "score": 1.0,
                                    "content": "# show a fresh render every time when the environment finishes reacting with new actions",
                                    "type": "text"
                                }
                            ],
                            "index": 44
                        },
                        {
                            "bbox": [
                                89,
                                680,
                                159,
                                695
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        680,
                                        159,
                                        695
                                    ],
                                    "score": 1.0,
                                    "content": "clear_output()",
                                    "type": "text"
                                }
                            ],
                            "index": 45
                        },
                        {
                            "bbox": [
                                90,
                                694,
                                435,
                                706
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        694,
                                        435,
                                        706
                                    ],
                                    "score": 1.0,
                                    "content": "display(HTML(render_tape_with_prompts(new_tape, CameraReadyRenderer())))",
                                    "type": "text"
                                }
                            ],
                            "index": 46
                        }
                    ],
                    "index": 23
                }
            ],
            "layout_bboxes": [],
            "page_idx": 25,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        71,
                        27,
                        143,
                        37
                    ],
                    "lines": [
                        {
                            "bbox": [
                                69,
                                24,
                                145,
                                40
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        24,
                                        145,
                                        40
                                    ],
                                    "score": 1.0,
                                    "content": "Technical report",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        751,
                        311,
                        760
                    ],
                    "lines": [
                        {
                            "bbox": [
                                299,
                                751,
                                313,
                                762
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        299,
                                        751,
                                        313,
                                        762
                                    ],
                                    "score": 1.0,
                                    "content": "26",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "list",
                    "bbox": [
                        66,
                        18,
                        541,
                        714
                    ],
                    "lines": [],
                    "index": 23,
                    "page_num": "page_25",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        68,
                        84,
                        538,
                        706
                    ],
                    "lines_deleted": true
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "title",
                    "bbox": [
                        71,
                        80,
                        254,
                        95
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                81,
                                254,
                                97
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        81,
                                        254,
                                        97
                                    ],
                                    "score": 1.0,
                                    "content": "B Agentic RAG Code Examples",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        }
                    ],
                    "index": 0
                },
                {
                    "type": "text",
                    "bbox": [
                        74,
                        123,
                        494,
                        305
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                123,
                                456,
                                137
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        123,
                                        428,
                                        137
                                    ],
                                    "score": 1.0,
                                    "content": "def add_demos(agent: Agent, tapes: list[Tape], max_n_demos: int, seed: int",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        428,
                                        124,
                                        445,
                                        134
                                    ],
                                    "score": 0.36,
                                    "content": "=~1",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 17
                                },
                                {
                                    "bbox": [
                                        446,
                                        123,
                                        456,
                                        137
                                    ],
                                    "score": 1.0,
                                    "content": "):",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                89,
                                134,
                                384,
                                150
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        134,
                                        384,
                                        150
                                    ],
                                    "score": 1.0,
                                    "content": "\"\"\"Extract demos for function templates from the given tapes.",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                88,
                                148,
                                331,
                                160
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        88,
                                        148,
                                        331,
                                        160
                                    ],
                                    "score": 1.0,
                                    "content": "When there are too many demos, select random ones.",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                90,
                                160,
                                106,
                                168
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        160,
                                        106,
                                        168
                                    ],
                                    "score": 1.0,
                                    "content": "\"\"\"",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                89,
                                172,
                                398,
                                185
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        172,
                                        117,
                                        185
                                    ],
                                    "score": 1.0,
                                    "content": "demos",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        117,
                                        173,
                                        126,
                                        181
                                    ],
                                    "score": 0.75,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        126,
                                        172,
                                        398,
                                        185
                                    ],
                                    "score": 1.0,
                                    "content": " {template_name: [] for template_name in agent.templates}",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                90,
                                184,
                                178,
                                196
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        184,
                                        178,
                                        196
                                    ],
                                    "score": 1.0,
                                    "content": "for tape in tapes:",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                108,
                                196,
                                326,
                                208
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        108,
                                        196,
                                        326,
                                        208
                                    ],
                                    "score": 1.0,
                                    "content": "for node, index in agent.get_node_runs(tape):",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                128,
                                209,
                                307,
                                219
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        128,
                                        209,
                                        307,
                                        219
                                    ],
                                    "score": 1.0,
                                    "content": "if isinstance(node, LLMFunctionNode):",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                146,
                                219,
                                489,
                                233
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        146,
                                        219,
                                        489,
                                        233
                                    ],
                                    "score": 1.0,
                                    "content": "demos[node.template_name].append(node.extract_demo(agent, tape, index))",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                90,
                                232,
                                212,
                                244
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        232,
                                        108,
                                        244
                                    ],
                                    "score": 1.0,
                                    "content": "rng ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        108,
                                        234,
                                        116,
                                        241
                                    ],
                                    "score": 0.57,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        117,
                                        232,
                                        212,
                                        244
                                    ],
                                    "score": 1.0,
                                    "content": " random.Random(seed)",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                90,
                                244,
                                283,
                                257
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        244,
                                        141,
                                        257
                                    ],
                                    "score": 1.0,
                                    "content": "agent_copy",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        141,
                                        245,
                                        150,
                                        253
                                    ],
                                    "score": 0.69,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        150,
                                        244,
                                        252,
                                        257
                                    ],
                                    "score": 1.0,
                                    "content": " agent.model_copy(deep",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        253,
                                        245,
                                        258,
                                        252
                                    ],
                                    "score": 0.31,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 5
                                },
                                {
                                    "bbox": [
                                        259,
                                        244,
                                        283,
                                        257
                                    ],
                                    "score": 1.0,
                                    "content": "True)",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                88,
                                255,
                                379,
                                269
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        88,
                                        255,
                                        379,
                                        269
                                    ],
                                    "score": 1.0,
                                    "content": "for template_name, template in agent_copy.templates.items():",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                108,
                                267,
                                336,
                                280
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        108,
                                        268,
                                        126,
                                        277
                                    ],
                                    "score": 0.57,
                                    "content": "\\begin{array}{r l}{\\mathsf{k}}&{{}=}\\end{array}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 18
                                },
                                {
                                    "bbox": [
                                        126,
                                        267,
                                        336,
                                        280
                                    ],
                                    "score": 1.0,
                                    "content": " min(max_n_demos, len(demos[template_name]))",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                109,
                                280,
                                360,
                                293
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        109,
                                        280,
                                        179,
                                        293
                                    ],
                                    "score": 1.0,
                                    "content": "template.demos",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        179,
                                        281,
                                        189,
                                        289
                                    ],
                                    "score": 0.78,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 10
                                },
                                {
                                    "bbox": [
                                        189,
                                        280,
                                        360,
                                        293
                                    ],
                                    "score": 1.0,
                                    "content": " rng.sample(demos[template_name], k)",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                90,
                                291,
                                174,
                                305
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        291,
                                        174,
                                        305
                                    ],
                                    "score": 1.0,
                                    "content": "return agent_copy",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        }
                    ],
                    "index": 8
                },
                {
                    "type": "title",
                    "bbox": [
                        232,
                        319,
                        380,
                        330
                    ],
                    "lines": [
                        {
                            "bbox": [
                                232,
                                320,
                                379,
                                332
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        232,
                                        320,
                                        379,
                                        332
                                    ],
                                    "score": 1.0,
                                    "content": "Listing 2: LLMFunction templates",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        }
                    ],
                    "index": 16
                },
                {
                    "type": "text",
                    "bbox": [
                        68,
                        334,
                        516,
                        525
                    ],
                    "lines": [
                        {
                            "bbox": [
                                69,
                                334,
                                280,
                                348
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        334,
                                        280,
                                        348
                                    ],
                                    "score": 1.0,
                                    "content": "# Create a template for answering questions",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                71,
                                347,
                                311,
                                358
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        347,
                                        199,
                                        358
                                    ],
                                    "score": 1.0,
                                    "content": "def make_answer_template() ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        199,
                                        348,
                                        212,
                                        357
                                    ],
                                    "score": 0.37,
                                    "content": "->",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 13
                                },
                                {
                                    "bbox": [
                                        212,
                                        347,
                                        311,
                                        358
                                    ],
                                    "score": 1.0,
                                    "content": " LLMFunctionTemplate:",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                90,
                                360,
                                221,
                                371
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        360,
                                        221,
                                        371
                                    ],
                                    "score": 1.0,
                                    "content": "return LLMFunctionTemplate(",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                109,
                                371,
                                354,
                                383
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        109,
                                        371,
                                        128,
                                        383
                                    ],
                                    "score": 1.0,
                                    "content": "desc",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        128,
                                        372,
                                        135,
                                        379
                                    ],
                                    "score": 0.4,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        135,
                                        371,
                                        354,
                                        383
                                    ],
                                    "score": 1.0,
                                    "content": "\"Answer questions with short factoid answers.\"",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                109,
                                383,
                                149,
                                395
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        109,
                                        383,
                                        149,
                                        395
                                    ],
                                    "score": 1.0,
                                    "content": "inputs=[",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                127,
                                394,
                                511,
                                407
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        127,
                                        394,
                                        209,
                                        407
                                    ],
                                    "score": 1.0,
                                    "content": "ContextInput(name",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        210,
                                        397,
                                        216,
                                        403
                                    ],
                                    "score": 0.53,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 6,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        217,
                                        394,
                                        286,
                                        407
                                    ],
                                    "score": 1.0,
                                    "content": "\"context\", desc",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        286,
                                        396,
                                        295,
                                        404
                                    ],
                                    "score": 0.65,
                                    "content": "=\"",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        295,
                                        394,
                                        477,
                                        407
                                    ],
                                    "score": 1.0,
                                    "content": "may contain relevant facts\", separator",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        477,
                                        395,
                                        502,
                                        405
                                    ],
                                    "score": 0.3,
                                    "content": "\"=\"1\"\\cdots",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 25
                                },
                                {
                                    "bbox": [
                                        502,
                                        394,
                                        511,
                                        407
                                    ],
                                    "score": 1.0,
                                    "content": "),",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                126,
                                406,
                                271,
                                419
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        126,
                                        406,
                                        271,
                                        419
                                    ],
                                    "score": 1.0,
                                    "content": "# The question to be answered",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                127,
                                419,
                                240,
                                431
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        127,
                                        419,
                                        176,
                                        431
                                    ],
                                    "score": 1.0,
                                    "content": "Input(name",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        176,
                                        420,
                                        182,
                                        428
                                    ],
                                    "score": 0.36,
                                    "content": "^{1}=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        183,
                                        419,
                                        240,
                                        431
                                    ],
                                    "score": 1.0,
                                    "content": "\"question\"),",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                109,
                                431,
                                120,
                                442
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        109,
                                        431,
                                        120,
                                        442
                                    ],
                                    "score": 1.0,
                                    "content": "],",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                109,
                                443,
                                154,
                                455
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        109,
                                        443,
                                        142,
                                        455
                                    ],
                                    "score": 1.0,
                                    "content": "outputs",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        143,
                                        444,
                                        149,
                                        452
                                    ],
                                    "score": 0.29,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        149,
                                        443,
                                        154,
                                        455
                                    ],
                                    "score": 1.0,
                                    "content": "[",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                126,
                                455,
                                254,
                                466
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        126,
                                        455,
                                        254,
                                        466
                                    ],
                                    "score": 1.0,
                                    "content": "# Rationale for the answer",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                127,
                                466,
                                305,
                                478
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        127,
                                        466,
                                        305,
                                        478
                                    ],
                                    "score": 1.0,
                                    "content": "RationaleOutput.for_output(\"answer\"),",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                127,
                                479,
                                222,
                                490
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        127,
                                        479,
                                        222,
                                        490
                                    ],
                                    "score": 1.0,
                                    "content": "# The actual answer",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                127,
                                490,
                                446,
                                502
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        127,
                                        490,
                                        224,
                                        502
                                    ],
                                    "score": 1.0,
                                    "content": "AssistantOutput(name",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        224,
                                        492,
                                        231,
                                        499
                                    ],
                                    "score": 0.61,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        231,
                                        490,
                                        295,
                                        502
                                    ],
                                    "score": 1.0,
                                    "content": "\"answer\", desc",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        296,
                                        492,
                                        303,
                                        499
                                    ],
                                    "score": 0.57,
                                    "content": "=^{\\prime}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        303,
                                        490,
                                        446,
                                        502
                                    ],
                                    "score": 1.0,
                                    "content": "\"often between 1 and 5 words\")",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        }
                    ],
                    "index": 23.5
                },
                {
                    "type": "text",
                    "bbox": [
                        69,
                        539,
                        515,
                        732
                    ],
                    "lines": [
                        {
                            "bbox": [
                                69,
                                537,
                                412,
                                550
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        537,
                                        412,
                                        550
                                    ],
                                    "score": 1.0,
                                    "content": "# Create a template for generating search queries with a retrieval tool",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                70,
                                550,
                                307,
                                563
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        550,
                                        307,
                                        563
                                    ],
                                    "score": 1.0,
                                    "content": "def make_query_template() -> LLMFunctionTemplate:",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                89,
                                563,
                                221,
                                574
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        563,
                                        221,
                                        574
                                    ],
                                    "score": 1.0,
                                    "content": "return LLMFunctionTemplate(",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                108,
                                574,
                                476,
                                587
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        108,
                                        574,
                                        128,
                                        587
                                    ],
                                    "score": 1.0,
                                    "content": "desc",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        128,
                                        576,
                                        135,
                                        583
                                    ],
                                    "score": 0.57,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        135,
                                        574,
                                        476,
                                        587
                                    ],
                                    "score": 1.0,
                                    "content": "\"Write a simple search query that will help answer a complex question.\",",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                109,
                                586,
                                150,
                                598
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        109,
                                        586,
                                        150,
                                        598
                                    ],
                                    "score": 1.0,
                                    "content": "inputs=[",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                128,
                                598,
                                511,
                                610
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        128,
                                        598,
                                        209,
                                        610
                                    ],
                                    "score": 1.0,
                                    "content": "ContextInput(name",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        210,
                                        599,
                                        216,
                                        607
                                    ],
                                    "score": 0.63,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        217,
                                        598,
                                        286,
                                        610
                                    ],
                                    "score": 1.0,
                                    "content": "\"context\", desc",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        286,
                                        599,
                                        295,
                                        607
                                    ],
                                    "score": 0.7,
                                    "content": "=\"",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        295,
                                        598,
                                        477,
                                        610
                                    ],
                                    "score": 1.0,
                                    "content": "may contain relevant facts\", separator",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        477,
                                        598,
                                        502,
                                        608
                                    ],
                                    "score": 0.44,
                                    "content": "\"=\"1\"\\cdots",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 25
                                },
                                {
                                    "bbox": [
                                        502,
                                        598,
                                        511,
                                        610
                                    ],
                                    "score": 1.0,
                                    "content": "),",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                127,
                                610,
                                365,
                                622
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        127,
                                        610,
                                        365,
                                        622
                                    ],
                                    "score": 1.0,
                                    "content": "# The question for which a search query is needed",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                127,
                                621,
                                239,
                                635
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        127,
                                        621,
                                        176,
                                        635
                                    ],
                                    "score": 1.0,
                                    "content": "Input(name",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        176,
                                        624,
                                        182,
                                        631
                                    ],
                                    "score": 0.37,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        183,
                                        621,
                                        239,
                                        635
                                    ],
                                    "score": 1.0,
                                    "content": "\"question\"),",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                109,
                                635,
                                119,
                                645
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        109,
                                        635,
                                        119,
                                        645
                                    ],
                                    "score": 1.0,
                                    "content": "],",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                109,
                                646,
                                155,
                                658
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        109,
                                        646,
                                        155,
                                        658
                                    ],
                                    "score": 1.0,
                                    "content": "outputs=[",
                                    "type": "text"
                                }
                            ],
                            "index": 40
                        },
                        {
                            "bbox": [
                                126,
                                657,
                                298,
                                671
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        126,
                                        657,
                                        298,
                                        671
                                    ],
                                    "score": 1.0,
                                    "content": "# Rationale for the generated query",
                                    "type": "text"
                                }
                            ],
                            "index": 41
                        },
                        {
                            "bbox": [
                                127,
                                669,
                                301,
                                683
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        127,
                                        669,
                                        301,
                                        683
                                    ],
                                    "score": 1.0,
                                    "content": "RationaleOutput.for_output(\"query\"),",
                                    "type": "text"
                                }
                            ],
                            "index": 42
                        },
                        {
                            "bbox": [
                                127,
                                681,
                                426,
                                694
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        127,
                                        681,
                                        426,
                                        694
                                    ],
                                    "score": 1.0,
                                    "content": "# The generated search query, to be used with a retrieval tool",
                                    "type": "text"
                                }
                            ],
                            "index": 43
                        },
                        {
                            "bbox": [
                                128,
                                694,
                                454,
                                705
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        128,
                                        694,
                                        219,
                                        705
                                    ],
                                    "score": 1.0,
                                    "content": "ToolCallOutput(name",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        219,
                                        695,
                                        227,
                                        703
                                    ],
                                    "score": 0.54,
                                    "content": "\\cdot=\\prime",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        228,
                                        694,
                                        310,
                                        705
                                    ],
                                    "score": 1.0,
                                    "content": "query\", tool_name",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        310,
                                        695,
                                        316,
                                        702
                                    ],
                                    "score": 0.45,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        317,
                                        694,
                                        410,
                                        705
                                    ],
                                    "score": 1.0,
                                    "content": "\"retrieve\", arg_name",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        411,
                                        695,
                                        417,
                                        702
                                    ],
                                    "score": 0.54,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        417,
                                        694,
                                        454,
                                        705
                                    ],
                                    "score": 1.0,
                                    "content": "\"query\")",
                                    "type": "text"
                                }
                            ],
                            "index": 44
                        },
                        {
                            "bbox": [
                                109,
                                708,
                                115,
                                714
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        109,
                                        708,
                                        115,
                                        714
                                    ],
                                    "score": 1.0,
                                    "content": "]",
                                    "type": "text"
                                }
                            ],
                            "index": 45
                        },
                        {
                            "bbox": [
                                91,
                                721,
                                95,
                                726
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        721,
                                        95,
                                        726
                                    ],
                                    "score": 1.0,
                                    "content": ")",
                                    "type": "text"
                                }
                            ],
                            "index": 46
                        }
                    ],
                    "index": 38.5
                }
            ],
            "layout_bboxes": [],
            "page_idx": 26,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        71,
                        27,
                        143,
                        37
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                25,
                                144,
                                38
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        25,
                                        144,
                                        38
                                    ],
                                    "score": 1.0,
                                    "content": "Technical report",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        751,
                        311,
                        760
                    ],
                    "lines": [
                        {
                            "bbox": [
                                299,
                                751,
                                312,
                                762
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        299,
                                        751,
                                        312,
                                        762
                                    ],
                                    "score": 1.0,
                                    "content": "27",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "title",
                    "bbox": [
                        71,
                        80,
                        254,
                        95
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                81,
                                254,
                                97
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        81,
                                        254,
                                        97
                                    ],
                                    "score": 1.0,
                                    "content": "B Agentic RAG Code Examples",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        }
                    ],
                    "index": 0,
                    "page_num": "page_26",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        74,
                        123,
                        494,
                        305
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                123,
                                456,
                                137
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        123,
                                        428,
                                        137
                                    ],
                                    "score": 1.0,
                                    "content": "def add_demos(agent: Agent, tapes: list[Tape], max_n_demos: int, seed: int",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        428,
                                        124,
                                        445,
                                        134
                                    ],
                                    "score": 0.36,
                                    "content": "=~1",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 17
                                },
                                {
                                    "bbox": [
                                        446,
                                        123,
                                        456,
                                        137
                                    ],
                                    "score": 1.0,
                                    "content": "):",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                89,
                                134,
                                384,
                                150
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        134,
                                        384,
                                        150
                                    ],
                                    "score": 1.0,
                                    "content": "\"\"\"Extract demos for function templates from the given tapes.",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                88,
                                148,
                                331,
                                160
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        88,
                                        148,
                                        331,
                                        160
                                    ],
                                    "score": 1.0,
                                    "content": "When there are too many demos, select random ones.",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                90,
                                160,
                                106,
                                168
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        160,
                                        106,
                                        168
                                    ],
                                    "score": 1.0,
                                    "content": "\"\"\"",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                89,
                                172,
                                398,
                                185
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        172,
                                        117,
                                        185
                                    ],
                                    "score": 1.0,
                                    "content": "demos",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        117,
                                        173,
                                        126,
                                        181
                                    ],
                                    "score": 0.75,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        126,
                                        172,
                                        398,
                                        185
                                    ],
                                    "score": 1.0,
                                    "content": " {template_name: [] for template_name in agent.templates}",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                90,
                                184,
                                178,
                                196
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        184,
                                        178,
                                        196
                                    ],
                                    "score": 1.0,
                                    "content": "for tape in tapes:",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                108,
                                196,
                                326,
                                208
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        108,
                                        196,
                                        326,
                                        208
                                    ],
                                    "score": 1.0,
                                    "content": "for node, index in agent.get_node_runs(tape):",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                128,
                                209,
                                307,
                                219
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        128,
                                        209,
                                        307,
                                        219
                                    ],
                                    "score": 1.0,
                                    "content": "if isinstance(node, LLMFunctionNode):",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                146,
                                219,
                                489,
                                233
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        146,
                                        219,
                                        489,
                                        233
                                    ],
                                    "score": 1.0,
                                    "content": "demos[node.template_name].append(node.extract_demo(agent, tape, index))",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                90,
                                232,
                                212,
                                244
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        232,
                                        108,
                                        244
                                    ],
                                    "score": 1.0,
                                    "content": "rng ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        108,
                                        234,
                                        116,
                                        241
                                    ],
                                    "score": 0.57,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        117,
                                        232,
                                        212,
                                        244
                                    ],
                                    "score": 1.0,
                                    "content": " random.Random(seed)",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                90,
                                244,
                                283,
                                257
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        244,
                                        141,
                                        257
                                    ],
                                    "score": 1.0,
                                    "content": "agent_copy",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        141,
                                        245,
                                        150,
                                        253
                                    ],
                                    "score": 0.69,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        150,
                                        244,
                                        252,
                                        257
                                    ],
                                    "score": 1.0,
                                    "content": " agent.model_copy(deep",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        253,
                                        245,
                                        258,
                                        252
                                    ],
                                    "score": 0.31,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 5
                                },
                                {
                                    "bbox": [
                                        259,
                                        244,
                                        283,
                                        257
                                    ],
                                    "score": 1.0,
                                    "content": "True)",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                88,
                                255,
                                379,
                                269
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        88,
                                        255,
                                        379,
                                        269
                                    ],
                                    "score": 1.0,
                                    "content": "for template_name, template in agent_copy.templates.items():",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                108,
                                267,
                                336,
                                280
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        108,
                                        268,
                                        126,
                                        277
                                    ],
                                    "score": 0.57,
                                    "content": "\\begin{array}{r l}{\\mathsf{k}}&{{}=}\\end{array}",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 18
                                },
                                {
                                    "bbox": [
                                        126,
                                        267,
                                        336,
                                        280
                                    ],
                                    "score": 1.0,
                                    "content": " min(max_n_demos, len(demos[template_name]))",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                109,
                                280,
                                360,
                                293
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        109,
                                        280,
                                        179,
                                        293
                                    ],
                                    "score": 1.0,
                                    "content": "template.demos",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        179,
                                        281,
                                        189,
                                        289
                                    ],
                                    "score": 0.78,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 10
                                },
                                {
                                    "bbox": [
                                        189,
                                        280,
                                        360,
                                        293
                                    ],
                                    "score": 1.0,
                                    "content": " rng.sample(demos[template_name], k)",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                90,
                                291,
                                174,
                                305
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        291,
                                        174,
                                        305
                                    ],
                                    "score": 1.0,
                                    "content": "return agent_copy",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        }
                    ],
                    "index": 8,
                    "page_num": "page_26",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        71,
                        123,
                        489,
                        305
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        232,
                        319,
                        380,
                        330
                    ],
                    "lines": [
                        {
                            "bbox": [
                                232,
                                320,
                                379,
                                332
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        232,
                                        320,
                                        379,
                                        332
                                    ],
                                    "score": 1.0,
                                    "content": "Listing 2: LLMFunction templates",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        }
                    ],
                    "index": 16,
                    "page_num": "page_26",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "list",
                    "bbox": [
                        68,
                        334,
                        516,
                        525
                    ],
                    "lines": [
                        {
                            "bbox": [
                                69,
                                334,
                                280,
                                348
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        334,
                                        280,
                                        348
                                    ],
                                    "score": 1.0,
                                    "content": "# Create a template for answering questions",
                                    "type": "text"
                                }
                            ],
                            "index": 17,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                71,
                                347,
                                311,
                                358
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        347,
                                        199,
                                        358
                                    ],
                                    "score": 1.0,
                                    "content": "def make_answer_template() ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        199,
                                        348,
                                        212,
                                        357
                                    ],
                                    "score": 0.37,
                                    "content": "->",
                                    "type": "inline_equation",
                                    "height": 9,
                                    "width": 13
                                },
                                {
                                    "bbox": [
                                        212,
                                        347,
                                        311,
                                        358
                                    ],
                                    "score": 1.0,
                                    "content": " LLMFunctionTemplate:",
                                    "type": "text"
                                }
                            ],
                            "index": 18,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                90,
                                360,
                                221,
                                371
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        90,
                                        360,
                                        221,
                                        371
                                    ],
                                    "score": 1.0,
                                    "content": "return LLMFunctionTemplate(",
                                    "type": "text"
                                }
                            ],
                            "index": 19,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                109,
                                371,
                                354,
                                383
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        109,
                                        371,
                                        128,
                                        383
                                    ],
                                    "score": 1.0,
                                    "content": "desc",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        128,
                                        372,
                                        135,
                                        379
                                    ],
                                    "score": 0.4,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        135,
                                        371,
                                        354,
                                        383
                                    ],
                                    "score": 1.0,
                                    "content": "\"Answer questions with short factoid answers.\"",
                                    "type": "text"
                                }
                            ],
                            "index": 20,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                109,
                                383,
                                149,
                                395
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        109,
                                        383,
                                        149,
                                        395
                                    ],
                                    "score": 1.0,
                                    "content": "inputs=[",
                                    "type": "text"
                                }
                            ],
                            "index": 21,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                127,
                                394,
                                511,
                                407
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        127,
                                        394,
                                        209,
                                        407
                                    ],
                                    "score": 1.0,
                                    "content": "ContextInput(name",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        210,
                                        397,
                                        216,
                                        403
                                    ],
                                    "score": 0.53,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 6,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        217,
                                        394,
                                        286,
                                        407
                                    ],
                                    "score": 1.0,
                                    "content": "\"context\", desc",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        286,
                                        396,
                                        295,
                                        404
                                    ],
                                    "score": 0.65,
                                    "content": "=\"",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        295,
                                        394,
                                        477,
                                        407
                                    ],
                                    "score": 1.0,
                                    "content": "may contain relevant facts\", separator",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        477,
                                        395,
                                        502,
                                        405
                                    ],
                                    "score": 0.3,
                                    "content": "\"=\"1\"\\cdots",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 25
                                },
                                {
                                    "bbox": [
                                        502,
                                        394,
                                        511,
                                        407
                                    ],
                                    "score": 1.0,
                                    "content": "),",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                126,
                                406,
                                271,
                                419
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        126,
                                        406,
                                        271,
                                        419
                                    ],
                                    "score": 1.0,
                                    "content": "# The question to be answered",
                                    "type": "text"
                                }
                            ],
                            "index": 23,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                127,
                                419,
                                240,
                                431
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        127,
                                        419,
                                        176,
                                        431
                                    ],
                                    "score": 1.0,
                                    "content": "Input(name",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        176,
                                        420,
                                        182,
                                        428
                                    ],
                                    "score": 0.36,
                                    "content": "^{1}=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        183,
                                        419,
                                        240,
                                        431
                                    ],
                                    "score": 1.0,
                                    "content": "\"question\"),",
                                    "type": "text"
                                }
                            ],
                            "index": 24,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                109,
                                431,
                                120,
                                442
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        109,
                                        431,
                                        120,
                                        442
                                    ],
                                    "score": 1.0,
                                    "content": "],",
                                    "type": "text"
                                }
                            ],
                            "index": 25,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                109,
                                443,
                                154,
                                455
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        109,
                                        443,
                                        142,
                                        455
                                    ],
                                    "score": 1.0,
                                    "content": "outputs",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        143,
                                        444,
                                        149,
                                        452
                                    ],
                                    "score": 0.29,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        149,
                                        443,
                                        154,
                                        455
                                    ],
                                    "score": 1.0,
                                    "content": "[",
                                    "type": "text"
                                }
                            ],
                            "index": 26,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                126,
                                455,
                                254,
                                466
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        126,
                                        455,
                                        254,
                                        466
                                    ],
                                    "score": 1.0,
                                    "content": "# Rationale for the answer",
                                    "type": "text"
                                }
                            ],
                            "index": 27,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                127,
                                466,
                                305,
                                478
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        127,
                                        466,
                                        305,
                                        478
                                    ],
                                    "score": 1.0,
                                    "content": "RationaleOutput.for_output(\"answer\"),",
                                    "type": "text"
                                }
                            ],
                            "index": 28,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                127,
                                479,
                                222,
                                490
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        127,
                                        479,
                                        222,
                                        490
                                    ],
                                    "score": 1.0,
                                    "content": "# The actual answer",
                                    "type": "text"
                                }
                            ],
                            "index": 29,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                127,
                                490,
                                446,
                                502
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        127,
                                        490,
                                        224,
                                        502
                                    ],
                                    "score": 1.0,
                                    "content": "AssistantOutput(name",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        224,
                                        492,
                                        231,
                                        499
                                    ],
                                    "score": 0.61,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        231,
                                        490,
                                        295,
                                        502
                                    ],
                                    "score": 1.0,
                                    "content": "\"answer\", desc",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        296,
                                        492,
                                        303,
                                        499
                                    ],
                                    "score": 0.57,
                                    "content": "=^{\\prime}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        303,
                                        490,
                                        446,
                                        502
                                    ],
                                    "score": 1.0,
                                    "content": "\"often between 1 and 5 words\")",
                                    "type": "text"
                                }
                            ],
                            "index": 30,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                69,
                                537,
                                412,
                                550
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        537,
                                        412,
                                        550
                                    ],
                                    "score": 1.0,
                                    "content": "# Create a template for generating search queries with a retrieval tool",
                                    "type": "text"
                                }
                            ],
                            "index": 31,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                70,
                                550,
                                307,
                                563
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        550,
                                        307,
                                        563
                                    ],
                                    "score": 1.0,
                                    "content": "def make_query_template() -> LLMFunctionTemplate:",
                                    "type": "text"
                                }
                            ],
                            "index": 32,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                89,
                                563,
                                221,
                                574
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        89,
                                        563,
                                        221,
                                        574
                                    ],
                                    "score": 1.0,
                                    "content": "return LLMFunctionTemplate(",
                                    "type": "text"
                                }
                            ],
                            "index": 33,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                108,
                                574,
                                476,
                                587
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        108,
                                        574,
                                        128,
                                        587
                                    ],
                                    "score": 1.0,
                                    "content": "desc",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        128,
                                        576,
                                        135,
                                        583
                                    ],
                                    "score": 0.57,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        135,
                                        574,
                                        476,
                                        587
                                    ],
                                    "score": 1.0,
                                    "content": "\"Write a simple search query that will help answer a complex question.\",",
                                    "type": "text"
                                }
                            ],
                            "index": 34,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                109,
                                586,
                                150,
                                598
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        109,
                                        586,
                                        150,
                                        598
                                    ],
                                    "score": 1.0,
                                    "content": "inputs=[",
                                    "type": "text"
                                }
                            ],
                            "index": 35,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                128,
                                598,
                                511,
                                610
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        128,
                                        598,
                                        209,
                                        610
                                    ],
                                    "score": 1.0,
                                    "content": "ContextInput(name",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        210,
                                        599,
                                        216,
                                        607
                                    ],
                                    "score": 0.63,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        217,
                                        598,
                                        286,
                                        610
                                    ],
                                    "score": 1.0,
                                    "content": "\"context\", desc",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        286,
                                        599,
                                        295,
                                        607
                                    ],
                                    "score": 0.7,
                                    "content": "=\"",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        295,
                                        598,
                                        477,
                                        610
                                    ],
                                    "score": 1.0,
                                    "content": "may contain relevant facts\", separator",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        477,
                                        598,
                                        502,
                                        608
                                    ],
                                    "score": 0.44,
                                    "content": "\"=\"1\"\\cdots",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 25
                                },
                                {
                                    "bbox": [
                                        502,
                                        598,
                                        511,
                                        610
                                    ],
                                    "score": 1.0,
                                    "content": "),",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                127,
                                610,
                                365,
                                622
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        127,
                                        610,
                                        365,
                                        622
                                    ],
                                    "score": 1.0,
                                    "content": "# The question for which a search query is needed",
                                    "type": "text"
                                }
                            ],
                            "index": 37,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                127,
                                621,
                                239,
                                635
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        127,
                                        621,
                                        176,
                                        635
                                    ],
                                    "score": 1.0,
                                    "content": "Input(name",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        176,
                                        624,
                                        182,
                                        631
                                    ],
                                    "score": 0.37,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        183,
                                        621,
                                        239,
                                        635
                                    ],
                                    "score": 1.0,
                                    "content": "\"question\"),",
                                    "type": "text"
                                }
                            ],
                            "index": 38,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                109,
                                635,
                                119,
                                645
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        109,
                                        635,
                                        119,
                                        645
                                    ],
                                    "score": 1.0,
                                    "content": "],",
                                    "type": "text"
                                }
                            ],
                            "index": 39,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                109,
                                646,
                                155,
                                658
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        109,
                                        646,
                                        155,
                                        658
                                    ],
                                    "score": 1.0,
                                    "content": "outputs=[",
                                    "type": "text"
                                }
                            ],
                            "index": 40,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                126,
                                657,
                                298,
                                671
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        126,
                                        657,
                                        298,
                                        671
                                    ],
                                    "score": 1.0,
                                    "content": "# Rationale for the generated query",
                                    "type": "text"
                                }
                            ],
                            "index": 41,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                127,
                                669,
                                301,
                                683
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        127,
                                        669,
                                        301,
                                        683
                                    ],
                                    "score": 1.0,
                                    "content": "RationaleOutput.for_output(\"query\"),",
                                    "type": "text"
                                }
                            ],
                            "index": 42,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                127,
                                681,
                                426,
                                694
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        127,
                                        681,
                                        426,
                                        694
                                    ],
                                    "score": 1.0,
                                    "content": "# The generated search query, to be used with a retrieval tool",
                                    "type": "text"
                                }
                            ],
                            "index": 43,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                128,
                                694,
                                454,
                                705
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        128,
                                        694,
                                        219,
                                        705
                                    ],
                                    "score": 1.0,
                                    "content": "ToolCallOutput(name",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        219,
                                        695,
                                        227,
                                        703
                                    ],
                                    "score": 0.54,
                                    "content": "\\cdot=\\prime",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        228,
                                        694,
                                        310,
                                        705
                                    ],
                                    "score": 1.0,
                                    "content": "query\", tool_name",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        310,
                                        695,
                                        316,
                                        702
                                    ],
                                    "score": 0.45,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        317,
                                        694,
                                        410,
                                        705
                                    ],
                                    "score": 1.0,
                                    "content": "\"retrieve\", arg_name",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        411,
                                        695,
                                        417,
                                        702
                                    ],
                                    "score": 0.54,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        417,
                                        694,
                                        454,
                                        705
                                    ],
                                    "score": 1.0,
                                    "content": "\"query\")",
                                    "type": "text"
                                }
                            ],
                            "index": 44,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                109,
                                708,
                                115,
                                714
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        109,
                                        708,
                                        115,
                                        714
                                    ],
                                    "score": 1.0,
                                    "content": "]",
                                    "type": "text"
                                }
                            ],
                            "index": 45,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                91,
                                721,
                                95,
                                726
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        721,
                                        95,
                                        726
                                    ],
                                    "score": 1.0,
                                    "content": ")",
                                    "type": "text"
                                }
                            ],
                            "index": 46,
                            "is_list_end_line": true
                        }
                    ],
                    "index": 23.5,
                    "page_num": "page_26",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        334,
                        511,
                        502
                    ]
                },
                {
                    "type": "list",
                    "bbox": [
                        69,
                        539,
                        515,
                        732
                    ],
                    "lines": [],
                    "index": 38.5,
                    "page_num": "page_26",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        537,
                        511,
                        726
                    ],
                    "lines_deleted": true
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "title",
                    "bbox": [
                        72,
                        81,
                        212,
                        95
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                81,
                                211,
                                96
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        81,
                                        211,
                                        96
                                    ],
                                    "score": 1.0,
                                    "content": "C Agent Tree and Tape",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        }
                    ],
                    "index": 0
                },
                {
                    "type": "image",
                    "bbox": [
                        72,
                        119,
                        542,
                        671
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                72,
                                119,
                                542,
                                671
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        72,
                                        119,
                                        542,
                                        671
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                72,
                                                119,
                                                542,
                                                671
                                            ],
                                            "score": 0.914,
                                            "type": "image",
                                            "image_path": "28c0c06c73b215fa6bfa6eadd0127f2a48b40483401ca2560ebf03e39e687d5d.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 2,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        72,
                                        119,
                                        542,
                                        303.0
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        72,
                                        303.0,
                                        542,
                                        487.0
                                    ],
                                    "spans": [],
                                    "index": 2
                                },
                                {
                                    "bbox": [
                                        72,
                                        487.0,
                                        542,
                                        671.0
                                    ],
                                    "spans": [],
                                    "index": 3
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                71,
                                685,
                                542,
                                719
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        71,
                                        687,
                                        541,
                                        699
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                687,
                                                541,
                                                699
                                            ],
                                            "score": 0.994228184223175,
                                            "content": "Figure 7: A multi-agent tree configuration showing nodes (left) and a tape resulting from their collaboration (right)",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                },
                                {
                                    "bbox": [
                                        70,
                                        696,
                                        541,
                                        711
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                696,
                                                541,
                                                711
                                            ],
                                            "score": 1.0,
                                            "content": "with color-coded steps: yellow for external agent thoughts (enabling collaboration), purple for internal agent thoughts,",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 5
                                },
                                {
                                    "bbox": [
                                        71,
                                        708,
                                        535,
                                        722
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                708,
                                                535,
                                                722
                                            ],
                                            "score": 1.0,
                                            "content": "blue for actions, and green for observations. The step’s author is indicated in grey using the “Agent.node” format.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 6
                                }
                            ],
                            "index": 5
                        }
                    ],
                    "index": 3.5
                }
            ],
            "layout_bboxes": [],
            "page_idx": 27,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [
                {
                    "type": "image",
                    "bbox": [
                        72,
                        119,
                        542,
                        671
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                72,
                                119,
                                542,
                                671
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        72,
                                        119,
                                        542,
                                        671
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                72,
                                                119,
                                                542,
                                                671
                                            ],
                                            "score": 0.914,
                                            "type": "image",
                                            "image_path": "28c0c06c73b215fa6bfa6eadd0127f2a48b40483401ca2560ebf03e39e687d5d.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 2,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        72,
                                        119,
                                        542,
                                        303.0
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        72,
                                        303.0,
                                        542,
                                        487.0
                                    ],
                                    "spans": [],
                                    "index": 2
                                },
                                {
                                    "bbox": [
                                        72,
                                        487.0,
                                        542,
                                        671.0
                                    ],
                                    "spans": [],
                                    "index": 3
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                71,
                                685,
                                542,
                                719
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        71,
                                        687,
                                        541,
                                        699
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                687,
                                                541,
                                                699
                                            ],
                                            "score": 0.994228184223175,
                                            "content": "Figure 7: A multi-agent tree configuration showing nodes (left) and a tape resulting from their collaboration (right)",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                },
                                {
                                    "bbox": [
                                        70,
                                        696,
                                        541,
                                        711
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                696,
                                                541,
                                                711
                                            ],
                                            "score": 1.0,
                                            "content": "with color-coded steps: yellow for external agent thoughts (enabling collaboration), purple for internal agent thoughts,",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 5
                                },
                                {
                                    "bbox": [
                                        71,
                                        708,
                                        535,
                                        722
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                708,
                                                535,
                                                722
                                            ],
                                            "score": 1.0,
                                            "content": "blue for actions, and green for observations. The step’s author is indicated in grey using the “Agent.node” format.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 6
                                }
                            ],
                            "index": 5
                        }
                    ],
                    "index": 3.5
                }
            ],
            "tables": [],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        71,
                        27,
                        143,
                        37
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                26,
                                144,
                                38
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        26,
                                        144,
                                        38
                                    ],
                                    "score": 1.0,
                                    "content": "Technical report",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        752,
                        311,
                        760
                    ],
                    "lines": [
                        {
                            "bbox": [
                                299,
                                751,
                                312,
                                762
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        299,
                                        751,
                                        312,
                                        762
                                    ],
                                    "score": 1.0,
                                    "content": "28",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "title",
                    "bbox": [
                        72,
                        81,
                        212,
                        95
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                81,
                                211,
                                96
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        81,
                                        211,
                                        96
                                    ],
                                    "score": 1.0,
                                    "content": "C Agent Tree and Tape",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        }
                    ],
                    "index": 0,
                    "page_num": "page_27",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "image",
                    "bbox": [
                        72,
                        119,
                        542,
                        671
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                72,
                                119,
                                542,
                                671
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        72,
                                        119,
                                        542,
                                        671
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                72,
                                                119,
                                                542,
                                                671
                                            ],
                                            "score": 0.914,
                                            "type": "image",
                                            "image_path": "28c0c06c73b215fa6bfa6eadd0127f2a48b40483401ca2560ebf03e39e687d5d.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 2,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        72,
                                        119,
                                        542,
                                        303.0
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        72,
                                        303.0,
                                        542,
                                        487.0
                                    ],
                                    "spans": [],
                                    "index": 2
                                },
                                {
                                    "bbox": [
                                        72,
                                        487.0,
                                        542,
                                        671.0
                                    ],
                                    "spans": [],
                                    "index": 3
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                71,
                                685,
                                542,
                                719
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        71,
                                        687,
                                        541,
                                        699
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                687,
                                                541,
                                                699
                                            ],
                                            "score": 0.994228184223175,
                                            "content": "Figure 7: A multi-agent tree configuration showing nodes (left) and a tape resulting from their collaboration (right)",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                },
                                {
                                    "bbox": [
                                        70,
                                        696,
                                        541,
                                        711
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                696,
                                                541,
                                                711
                                            ],
                                            "score": 1.0,
                                            "content": "with color-coded steps: yellow for external agent thoughts (enabling collaboration), purple for internal agent thoughts,",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 5
                                },
                                {
                                    "bbox": [
                                        71,
                                        708,
                                        535,
                                        722
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                708,
                                                535,
                                                722
                                            ],
                                            "score": 1.0,
                                            "content": "blue for actions, and green for observations. The step’s author is indicated in grey using the “Agent.node” format.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 6
                                }
                            ],
                            "index": 5
                        }
                    ],
                    "index": 3.5,
                    "page_num": "page_27",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "title",
                    "bbox": [
                        71,
                        81,
                        156,
                        94
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                80,
                                157,
                                95
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        83,
                                        81,
                                        93
                                    ],
                                    "score": 1.0,
                                    "content": "D",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        93,
                                        80,
                                        157,
                                        95
                                    ],
                                    "score": 1.0,
                                    "content": "Tape Tools",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        }
                    ],
                    "index": 0
                },
                {
                    "type": "image",
                    "bbox": [
                        73,
                        114,
                        537,
                        419
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                73,
                                114,
                                537,
                                419
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        73,
                                        114,
                                        537,
                                        419
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                73,
                                                114,
                                                537,
                                                419
                                            ],
                                            "score": 0.955,
                                            "type": "image",
                                            "image_path": "e213fa16cf2f82f51afddcc2cf89d42314942c6d9e0a7712ae0108264a6fac54.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 2,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        73,
                                        114,
                                        537,
                                        215.66666666666669
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        73,
                                        215.66666666666669,
                                        537,
                                        317.33333333333337
                                    ],
                                    "spans": [],
                                    "index": 2
                                },
                                {
                                    "bbox": [
                                        73,
                                        317.33333333333337,
                                        537,
                                        419.00000000000006
                                    ],
                                    "spans": [],
                                    "index": 3
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                73,
                                423,
                                536,
                                434
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        73,
                                        423,
                                        538,
                                        437
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                73,
                                                423,
                                                538,
                                                437
                                            ],
                                            "score": 1.0,
                                            "content": "Figure 8: TapeAgents Studio: Application to help AI Admin to edit Tape, resume and debug Agentic Systems",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                }
                            ],
                            "index": 4
                        }
                    ],
                    "index": 3.0
                }
            ],
            "layout_bboxes": [],
            "page_idx": 28,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [
                {
                    "type": "image",
                    "bbox": [
                        73,
                        114,
                        537,
                        419
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                73,
                                114,
                                537,
                                419
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        73,
                                        114,
                                        537,
                                        419
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                73,
                                                114,
                                                537,
                                                419
                                            ],
                                            "score": 0.955,
                                            "type": "image",
                                            "image_path": "e213fa16cf2f82f51afddcc2cf89d42314942c6d9e0a7712ae0108264a6fac54.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 2,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        73,
                                        114,
                                        537,
                                        215.66666666666669
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        73,
                                        215.66666666666669,
                                        537,
                                        317.33333333333337
                                    ],
                                    "spans": [],
                                    "index": 2
                                },
                                {
                                    "bbox": [
                                        73,
                                        317.33333333333337,
                                        537,
                                        419.00000000000006
                                    ],
                                    "spans": [],
                                    "index": 3
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                73,
                                423,
                                536,
                                434
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        73,
                                        423,
                                        538,
                                        437
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                73,
                                                423,
                                                538,
                                                437
                                            ],
                                            "score": 1.0,
                                            "content": "Figure 8: TapeAgents Studio: Application to help AI Admin to edit Tape, resume and debug Agentic Systems",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                }
                            ],
                            "index": 4
                        }
                    ],
                    "index": 3.0
                }
            ],
            "tables": [],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        72,
                        27,
                        143,
                        37
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                26,
                                144,
                                38
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        26,
                                        144,
                                        38
                                    ],
                                    "score": 1.0,
                                    "content": "Technical report",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        752,
                        311,
                        760
                    ],
                    "lines": [
                        {
                            "bbox": [
                                299,
                                751,
                                312,
                                763
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        299,
                                        751,
                                        312,
                                        763
                                    ],
                                    "score": 1.0,
                                    "content": "29",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "title",
                    "bbox": [
                        71,
                        81,
                        156,
                        94
                    ],
                    "lines": [
                        {
                            "bbox": [
                                72,
                                80,
                                157,
                                95
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        83,
                                        81,
                                        93
                                    ],
                                    "score": 1.0,
                                    "content": "D",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        93,
                                        80,
                                        157,
                                        95
                                    ],
                                    "score": 1.0,
                                    "content": "Tape Tools",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        }
                    ],
                    "index": 0,
                    "page_num": "page_28",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "image",
                    "bbox": [
                        73,
                        114,
                        537,
                        419
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                73,
                                114,
                                537,
                                419
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        73,
                                        114,
                                        537,
                                        419
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                73,
                                                114,
                                                537,
                                                419
                                            ],
                                            "score": 0.955,
                                            "type": "image",
                                            "image_path": "e213fa16cf2f82f51afddcc2cf89d42314942c6d9e0a7712ae0108264a6fac54.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 2,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        73,
                                        114,
                                        537,
                                        215.66666666666669
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        73,
                                        215.66666666666669,
                                        537,
                                        317.33333333333337
                                    ],
                                    "spans": [],
                                    "index": 2
                                },
                                {
                                    "bbox": [
                                        73,
                                        317.33333333333337,
                                        537,
                                        419.00000000000006
                                    ],
                                    "spans": [],
                                    "index": 3
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                73,
                                423,
                                536,
                                434
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        73,
                                        423,
                                        538,
                                        437
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                73,
                                                423,
                                                538,
                                                437
                                            ],
                                            "score": 1.0,
                                            "content": "Figure 8: TapeAgents Studio: Application to help AI Admin to edit Tape, resume and debug Agentic Systems",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                }
                            ],
                            "index": 4
                        }
                    ],
                    "index": 3.0,
                    "page_num": "page_28",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "image",
                    "bbox": [
                        118,
                        105,
                        407,
                        547
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                118,
                                105,
                                407,
                                547
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        118,
                                        105,
                                        407,
                                        547
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                118,
                                                105,
                                                407,
                                                547
                                            ],
                                            "score": 0.922,
                                            "type": "image",
                                            "image_path": "9687c3337502c86c79f424bce87d64a3d2248f9520677505471e039c58784a14.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 16,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        118,
                                        105,
                                        407,
                                        118.5
                                    ],
                                    "spans": [],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        118,
                                        118.5,
                                        407,
                                        132.0
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        118,
                                        132.0,
                                        407,
                                        145.5
                                    ],
                                    "spans": [],
                                    "index": 2
                                },
                                {
                                    "bbox": [
                                        118,
                                        145.5,
                                        407,
                                        159.0
                                    ],
                                    "spans": [],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        118,
                                        159.0,
                                        407,
                                        172.5
                                    ],
                                    "spans": [],
                                    "index": 4
                                },
                                {
                                    "bbox": [
                                        118,
                                        172.5,
                                        407,
                                        186.0
                                    ],
                                    "spans": [],
                                    "index": 5
                                },
                                {
                                    "bbox": [
                                        118,
                                        186.0,
                                        407,
                                        199.5
                                    ],
                                    "spans": [],
                                    "index": 6
                                },
                                {
                                    "bbox": [
                                        118,
                                        199.5,
                                        407,
                                        213.0
                                    ],
                                    "spans": [],
                                    "index": 7
                                },
                                {
                                    "bbox": [
                                        118,
                                        213.0,
                                        407,
                                        226.5
                                    ],
                                    "spans": [],
                                    "index": 8
                                },
                                {
                                    "bbox": [
                                        118,
                                        226.5,
                                        407,
                                        240.0
                                    ],
                                    "spans": [],
                                    "index": 9
                                },
                                {
                                    "bbox": [
                                        118,
                                        240.0,
                                        407,
                                        253.5
                                    ],
                                    "spans": [],
                                    "index": 10
                                },
                                {
                                    "bbox": [
                                        118,
                                        253.5,
                                        407,
                                        267.0
                                    ],
                                    "spans": [],
                                    "index": 11
                                },
                                {
                                    "bbox": [
                                        118,
                                        267.0,
                                        407,
                                        280.5
                                    ],
                                    "spans": [],
                                    "index": 12
                                },
                                {
                                    "bbox": [
                                        118,
                                        280.5,
                                        407,
                                        294.0
                                    ],
                                    "spans": [],
                                    "index": 13
                                },
                                {
                                    "bbox": [
                                        118,
                                        294.0,
                                        407,
                                        307.5
                                    ],
                                    "spans": [],
                                    "index": 14
                                },
                                {
                                    "bbox": [
                                        118,
                                        307.5,
                                        407,
                                        321.0
                                    ],
                                    "spans": [],
                                    "index": 15
                                },
                                {
                                    "bbox": [
                                        118,
                                        321.0,
                                        407,
                                        334.5
                                    ],
                                    "spans": [],
                                    "index": 16
                                },
                                {
                                    "bbox": [
                                        118,
                                        334.5,
                                        407,
                                        348.0
                                    ],
                                    "spans": [],
                                    "index": 17
                                },
                                {
                                    "bbox": [
                                        118,
                                        348.0,
                                        407,
                                        361.5
                                    ],
                                    "spans": [],
                                    "index": 18
                                },
                                {
                                    "bbox": [
                                        118,
                                        361.5,
                                        407,
                                        375.0
                                    ],
                                    "spans": [],
                                    "index": 19
                                },
                                {
                                    "bbox": [
                                        118,
                                        375.0,
                                        407,
                                        388.5
                                    ],
                                    "spans": [],
                                    "index": 20
                                },
                                {
                                    "bbox": [
                                        118,
                                        388.5,
                                        407,
                                        402.0
                                    ],
                                    "spans": [],
                                    "index": 21
                                },
                                {
                                    "bbox": [
                                        118,
                                        402.0,
                                        407,
                                        415.5
                                    ],
                                    "spans": [],
                                    "index": 22
                                },
                                {
                                    "bbox": [
                                        118,
                                        415.5,
                                        407,
                                        429.0
                                    ],
                                    "spans": [],
                                    "index": 23
                                },
                                {
                                    "bbox": [
                                        118,
                                        429.0,
                                        407,
                                        442.5
                                    ],
                                    "spans": [],
                                    "index": 24
                                },
                                {
                                    "bbox": [
                                        118,
                                        442.5,
                                        407,
                                        456.0
                                    ],
                                    "spans": [],
                                    "index": 25
                                },
                                {
                                    "bbox": [
                                        118,
                                        456.0,
                                        407,
                                        469.5
                                    ],
                                    "spans": [],
                                    "index": 26
                                },
                                {
                                    "bbox": [
                                        118,
                                        469.5,
                                        407,
                                        483.0
                                    ],
                                    "spans": [],
                                    "index": 27
                                },
                                {
                                    "bbox": [
                                        118,
                                        483.0,
                                        407,
                                        496.5
                                    ],
                                    "spans": [],
                                    "index": 28
                                },
                                {
                                    "bbox": [
                                        118,
                                        496.5,
                                        407,
                                        510.0
                                    ],
                                    "spans": [],
                                    "index": 29
                                },
                                {
                                    "bbox": [
                                        118,
                                        510.0,
                                        407,
                                        523.5
                                    ],
                                    "spans": [],
                                    "index": 30
                                },
                                {
                                    "bbox": [
                                        118,
                                        523.5,
                                        407,
                                        537.0
                                    ],
                                    "spans": [],
                                    "index": 31
                                },
                                {
                                    "bbox": [
                                        118,
                                        537.0,
                                        407,
                                        550.5
                                    ],
                                    "spans": [],
                                    "index": 32
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                70,
                                553,
                                541,
                                575
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        70,
                                        552,
                                        542,
                                        566
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                552,
                                                542,
                                                566
                                            ],
                                            "score": 1.0,
                                            "content": "Figure 9: Tape Browser: Application to inspect a batch of tapes result. This tape is a GAIA task where the",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 33
                                },
                                {
                                    "bbox": [
                                        71,
                                        564,
                                        372,
                                        577
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                564,
                                                372,
                                                577
                                            ],
                                            "score": 1.0,
                                            "content": "Agent did not provide the right answer. No step failed during the session.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 34
                                }
                            ],
                            "index": 33.5
                        }
                    ],
                    "index": 24.75
                }
            ],
            "layout_bboxes": [],
            "page_idx": 29,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [
                {
                    "type": "image",
                    "bbox": [
                        118,
                        105,
                        407,
                        547
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                118,
                                105,
                                407,
                                547
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        118,
                                        105,
                                        407,
                                        547
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                118,
                                                105,
                                                407,
                                                547
                                            ],
                                            "score": 0.922,
                                            "type": "image",
                                            "image_path": "9687c3337502c86c79f424bce87d64a3d2248f9520677505471e039c58784a14.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 16,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        118,
                                        105,
                                        407,
                                        118.5
                                    ],
                                    "spans": [],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        118,
                                        118.5,
                                        407,
                                        132.0
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        118,
                                        132.0,
                                        407,
                                        145.5
                                    ],
                                    "spans": [],
                                    "index": 2
                                },
                                {
                                    "bbox": [
                                        118,
                                        145.5,
                                        407,
                                        159.0
                                    ],
                                    "spans": [],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        118,
                                        159.0,
                                        407,
                                        172.5
                                    ],
                                    "spans": [],
                                    "index": 4
                                },
                                {
                                    "bbox": [
                                        118,
                                        172.5,
                                        407,
                                        186.0
                                    ],
                                    "spans": [],
                                    "index": 5
                                },
                                {
                                    "bbox": [
                                        118,
                                        186.0,
                                        407,
                                        199.5
                                    ],
                                    "spans": [],
                                    "index": 6
                                },
                                {
                                    "bbox": [
                                        118,
                                        199.5,
                                        407,
                                        213.0
                                    ],
                                    "spans": [],
                                    "index": 7
                                },
                                {
                                    "bbox": [
                                        118,
                                        213.0,
                                        407,
                                        226.5
                                    ],
                                    "spans": [],
                                    "index": 8
                                },
                                {
                                    "bbox": [
                                        118,
                                        226.5,
                                        407,
                                        240.0
                                    ],
                                    "spans": [],
                                    "index": 9
                                },
                                {
                                    "bbox": [
                                        118,
                                        240.0,
                                        407,
                                        253.5
                                    ],
                                    "spans": [],
                                    "index": 10
                                },
                                {
                                    "bbox": [
                                        118,
                                        253.5,
                                        407,
                                        267.0
                                    ],
                                    "spans": [],
                                    "index": 11
                                },
                                {
                                    "bbox": [
                                        118,
                                        267.0,
                                        407,
                                        280.5
                                    ],
                                    "spans": [],
                                    "index": 12
                                },
                                {
                                    "bbox": [
                                        118,
                                        280.5,
                                        407,
                                        294.0
                                    ],
                                    "spans": [],
                                    "index": 13
                                },
                                {
                                    "bbox": [
                                        118,
                                        294.0,
                                        407,
                                        307.5
                                    ],
                                    "spans": [],
                                    "index": 14
                                },
                                {
                                    "bbox": [
                                        118,
                                        307.5,
                                        407,
                                        321.0
                                    ],
                                    "spans": [],
                                    "index": 15
                                },
                                {
                                    "bbox": [
                                        118,
                                        321.0,
                                        407,
                                        334.5
                                    ],
                                    "spans": [],
                                    "index": 16
                                },
                                {
                                    "bbox": [
                                        118,
                                        334.5,
                                        407,
                                        348.0
                                    ],
                                    "spans": [],
                                    "index": 17
                                },
                                {
                                    "bbox": [
                                        118,
                                        348.0,
                                        407,
                                        361.5
                                    ],
                                    "spans": [],
                                    "index": 18
                                },
                                {
                                    "bbox": [
                                        118,
                                        361.5,
                                        407,
                                        375.0
                                    ],
                                    "spans": [],
                                    "index": 19
                                },
                                {
                                    "bbox": [
                                        118,
                                        375.0,
                                        407,
                                        388.5
                                    ],
                                    "spans": [],
                                    "index": 20
                                },
                                {
                                    "bbox": [
                                        118,
                                        388.5,
                                        407,
                                        402.0
                                    ],
                                    "spans": [],
                                    "index": 21
                                },
                                {
                                    "bbox": [
                                        118,
                                        402.0,
                                        407,
                                        415.5
                                    ],
                                    "spans": [],
                                    "index": 22
                                },
                                {
                                    "bbox": [
                                        118,
                                        415.5,
                                        407,
                                        429.0
                                    ],
                                    "spans": [],
                                    "index": 23
                                },
                                {
                                    "bbox": [
                                        118,
                                        429.0,
                                        407,
                                        442.5
                                    ],
                                    "spans": [],
                                    "index": 24
                                },
                                {
                                    "bbox": [
                                        118,
                                        442.5,
                                        407,
                                        456.0
                                    ],
                                    "spans": [],
                                    "index": 25
                                },
                                {
                                    "bbox": [
                                        118,
                                        456.0,
                                        407,
                                        469.5
                                    ],
                                    "spans": [],
                                    "index": 26
                                },
                                {
                                    "bbox": [
                                        118,
                                        469.5,
                                        407,
                                        483.0
                                    ],
                                    "spans": [],
                                    "index": 27
                                },
                                {
                                    "bbox": [
                                        118,
                                        483.0,
                                        407,
                                        496.5
                                    ],
                                    "spans": [],
                                    "index": 28
                                },
                                {
                                    "bbox": [
                                        118,
                                        496.5,
                                        407,
                                        510.0
                                    ],
                                    "spans": [],
                                    "index": 29
                                },
                                {
                                    "bbox": [
                                        118,
                                        510.0,
                                        407,
                                        523.5
                                    ],
                                    "spans": [],
                                    "index": 30
                                },
                                {
                                    "bbox": [
                                        118,
                                        523.5,
                                        407,
                                        537.0
                                    ],
                                    "spans": [],
                                    "index": 31
                                },
                                {
                                    "bbox": [
                                        118,
                                        537.0,
                                        407,
                                        550.5
                                    ],
                                    "spans": [],
                                    "index": 32
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                70,
                                553,
                                541,
                                575
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        70,
                                        552,
                                        542,
                                        566
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                552,
                                                542,
                                                566
                                            ],
                                            "score": 1.0,
                                            "content": "Figure 9: Tape Browser: Application to inspect a batch of tapes result. This tape is a GAIA task where the",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 33
                                },
                                {
                                    "bbox": [
                                        71,
                                        564,
                                        372,
                                        577
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                564,
                                                372,
                                                577
                                            ],
                                            "score": 1.0,
                                            "content": "Agent did not provide the right answer. No step failed during the session.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 34
                                }
                            ],
                            "index": 33.5
                        }
                    ],
                    "index": 24.75
                }
            ],
            "tables": [],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        71,
                        27,
                        143,
                        37
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                25,
                                144,
                                38
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        25,
                                        144,
                                        38
                                    ],
                                    "score": 1.0,
                                    "content": "Technical report",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        751,
                        311,
                        760
                    ],
                    "lines": [
                        {
                            "bbox": [
                                299,
                                751,
                                312,
                                762
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        299,
                                        751,
                                        312,
                                        762
                                    ],
                                    "score": 1.0,
                                    "content": "30",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "image",
                    "bbox": [
                        118,
                        105,
                        407,
                        547
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                118,
                                105,
                                407,
                                547
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        118,
                                        105,
                                        407,
                                        547
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                118,
                                                105,
                                                407,
                                                547
                                            ],
                                            "score": 0.922,
                                            "type": "image",
                                            "image_path": "9687c3337502c86c79f424bce87d64a3d2248f9520677505471e039c58784a14.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 16,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        118,
                                        105,
                                        407,
                                        118.5
                                    ],
                                    "spans": [],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        118,
                                        118.5,
                                        407,
                                        132.0
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        118,
                                        132.0,
                                        407,
                                        145.5
                                    ],
                                    "spans": [],
                                    "index": 2
                                },
                                {
                                    "bbox": [
                                        118,
                                        145.5,
                                        407,
                                        159.0
                                    ],
                                    "spans": [],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        118,
                                        159.0,
                                        407,
                                        172.5
                                    ],
                                    "spans": [],
                                    "index": 4
                                },
                                {
                                    "bbox": [
                                        118,
                                        172.5,
                                        407,
                                        186.0
                                    ],
                                    "spans": [],
                                    "index": 5
                                },
                                {
                                    "bbox": [
                                        118,
                                        186.0,
                                        407,
                                        199.5
                                    ],
                                    "spans": [],
                                    "index": 6
                                },
                                {
                                    "bbox": [
                                        118,
                                        199.5,
                                        407,
                                        213.0
                                    ],
                                    "spans": [],
                                    "index": 7
                                },
                                {
                                    "bbox": [
                                        118,
                                        213.0,
                                        407,
                                        226.5
                                    ],
                                    "spans": [],
                                    "index": 8
                                },
                                {
                                    "bbox": [
                                        118,
                                        226.5,
                                        407,
                                        240.0
                                    ],
                                    "spans": [],
                                    "index": 9
                                },
                                {
                                    "bbox": [
                                        118,
                                        240.0,
                                        407,
                                        253.5
                                    ],
                                    "spans": [],
                                    "index": 10
                                },
                                {
                                    "bbox": [
                                        118,
                                        253.5,
                                        407,
                                        267.0
                                    ],
                                    "spans": [],
                                    "index": 11
                                },
                                {
                                    "bbox": [
                                        118,
                                        267.0,
                                        407,
                                        280.5
                                    ],
                                    "spans": [],
                                    "index": 12
                                },
                                {
                                    "bbox": [
                                        118,
                                        280.5,
                                        407,
                                        294.0
                                    ],
                                    "spans": [],
                                    "index": 13
                                },
                                {
                                    "bbox": [
                                        118,
                                        294.0,
                                        407,
                                        307.5
                                    ],
                                    "spans": [],
                                    "index": 14
                                },
                                {
                                    "bbox": [
                                        118,
                                        307.5,
                                        407,
                                        321.0
                                    ],
                                    "spans": [],
                                    "index": 15
                                },
                                {
                                    "bbox": [
                                        118,
                                        321.0,
                                        407,
                                        334.5
                                    ],
                                    "spans": [],
                                    "index": 16
                                },
                                {
                                    "bbox": [
                                        118,
                                        334.5,
                                        407,
                                        348.0
                                    ],
                                    "spans": [],
                                    "index": 17
                                },
                                {
                                    "bbox": [
                                        118,
                                        348.0,
                                        407,
                                        361.5
                                    ],
                                    "spans": [],
                                    "index": 18
                                },
                                {
                                    "bbox": [
                                        118,
                                        361.5,
                                        407,
                                        375.0
                                    ],
                                    "spans": [],
                                    "index": 19
                                },
                                {
                                    "bbox": [
                                        118,
                                        375.0,
                                        407,
                                        388.5
                                    ],
                                    "spans": [],
                                    "index": 20
                                },
                                {
                                    "bbox": [
                                        118,
                                        388.5,
                                        407,
                                        402.0
                                    ],
                                    "spans": [],
                                    "index": 21
                                },
                                {
                                    "bbox": [
                                        118,
                                        402.0,
                                        407,
                                        415.5
                                    ],
                                    "spans": [],
                                    "index": 22
                                },
                                {
                                    "bbox": [
                                        118,
                                        415.5,
                                        407,
                                        429.0
                                    ],
                                    "spans": [],
                                    "index": 23
                                },
                                {
                                    "bbox": [
                                        118,
                                        429.0,
                                        407,
                                        442.5
                                    ],
                                    "spans": [],
                                    "index": 24
                                },
                                {
                                    "bbox": [
                                        118,
                                        442.5,
                                        407,
                                        456.0
                                    ],
                                    "spans": [],
                                    "index": 25
                                },
                                {
                                    "bbox": [
                                        118,
                                        456.0,
                                        407,
                                        469.5
                                    ],
                                    "spans": [],
                                    "index": 26
                                },
                                {
                                    "bbox": [
                                        118,
                                        469.5,
                                        407,
                                        483.0
                                    ],
                                    "spans": [],
                                    "index": 27
                                },
                                {
                                    "bbox": [
                                        118,
                                        483.0,
                                        407,
                                        496.5
                                    ],
                                    "spans": [],
                                    "index": 28
                                },
                                {
                                    "bbox": [
                                        118,
                                        496.5,
                                        407,
                                        510.0
                                    ],
                                    "spans": [],
                                    "index": 29
                                },
                                {
                                    "bbox": [
                                        118,
                                        510.0,
                                        407,
                                        523.5
                                    ],
                                    "spans": [],
                                    "index": 30
                                },
                                {
                                    "bbox": [
                                        118,
                                        523.5,
                                        407,
                                        537.0
                                    ],
                                    "spans": [],
                                    "index": 31
                                },
                                {
                                    "bbox": [
                                        118,
                                        537.0,
                                        407,
                                        550.5
                                    ],
                                    "spans": [],
                                    "index": 32
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                70,
                                553,
                                541,
                                575
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        70,
                                        552,
                                        542,
                                        566
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                552,
                                                542,
                                                566
                                            ],
                                            "score": 1.0,
                                            "content": "Figure 9: Tape Browser: Application to inspect a batch of tapes result. This tape is a GAIA task where the",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 33
                                },
                                {
                                    "bbox": [
                                        71,
                                        564,
                                        372,
                                        577
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                564,
                                                372,
                                                577
                                            ],
                                            "score": 1.0,
                                            "content": "Agent did not provide the right answer. No step failed during the session.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 34
                                }
                            ],
                            "index": 33.5
                        }
                    ],
                    "index": 24.75,
                    "page_num": "page_29",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "image",
                    "bbox": [
                        81,
                        84,
                        532,
                        316
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                81,
                                84,
                                532,
                                316
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        81,
                                        84,
                                        532,
                                        316
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                81,
                                                84,
                                                532,
                                                316
                                            ],
                                            "score": 0.902,
                                            "type": "image",
                                            "image_path": "0532c7b37653cfa0b64166b382d115dc3c302994dc4c0a986c5ab728afa532ec.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        81,
                                        84,
                                        532,
                                        161.33333333333331
                                    ],
                                    "spans": [],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        81,
                                        161.33333333333331,
                                        532,
                                        238.66666666666663
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        81,
                                        238.66666666666663,
                                        532,
                                        315.99999999999994
                                    ],
                                    "spans": [],
                                    "index": 2
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                165,
                                320,
                                447,
                                330
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        165,
                                        320,
                                        446,
                                        332
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                165,
                                                320,
                                                446,
                                                332
                                            ],
                                            "score": 0.972791850566864,
                                            "content": "Figure 10: Tape Diff: Application to compare two batches of tape.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 3
                                }
                            ],
                            "index": 3
                        }
                    ],
                    "index": 2.0
                }
            ],
            "layout_bboxes": [],
            "page_idx": 30,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [
                {
                    "type": "image",
                    "bbox": [
                        81,
                        84,
                        532,
                        316
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                81,
                                84,
                                532,
                                316
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        81,
                                        84,
                                        532,
                                        316
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                81,
                                                84,
                                                532,
                                                316
                                            ],
                                            "score": 0.902,
                                            "type": "image",
                                            "image_path": "0532c7b37653cfa0b64166b382d115dc3c302994dc4c0a986c5ab728afa532ec.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        81,
                                        84,
                                        532,
                                        161.33333333333331
                                    ],
                                    "spans": [],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        81,
                                        161.33333333333331,
                                        532,
                                        238.66666666666663
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        81,
                                        238.66666666666663,
                                        532,
                                        315.99999999999994
                                    ],
                                    "spans": [],
                                    "index": 2
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                165,
                                320,
                                447,
                                330
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        165,
                                        320,
                                        446,
                                        332
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                165,
                                                320,
                                                446,
                                                332
                                            ],
                                            "score": 0.972791850566864,
                                            "content": "Figure 10: Tape Diff: Application to compare two batches of tape.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 3
                                }
                            ],
                            "index": 3
                        }
                    ],
                    "index": 2.0
                }
            ],
            "tables": [],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        72,
                        27,
                        143,
                        37
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                25,
                                144,
                                38
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        25,
                                        144,
                                        38
                                    ],
                                    "score": 1.0,
                                    "content": "Technical report",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        752,
                        310,
                        760
                    ],
                    "lines": [
                        {
                            "bbox": [
                                299,
                                751,
                                312,
                                762
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        299,
                                        751,
                                        312,
                                        762
                                    ],
                                    "score": 1.0,
                                    "content": "31",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "image",
                    "bbox": [
                        81,
                        84,
                        532,
                        316
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                81,
                                84,
                                532,
                                316
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        81,
                                        84,
                                        532,
                                        316
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                81,
                                                84,
                                                532,
                                                316
                                            ],
                                            "score": 0.902,
                                            "type": "image",
                                            "image_path": "0532c7b37653cfa0b64166b382d115dc3c302994dc4c0a986c5ab728afa532ec.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        81,
                                        84,
                                        532,
                                        161.33333333333331
                                    ],
                                    "spans": [],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        81,
                                        161.33333333333331,
                                        532,
                                        238.66666666666663
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        81,
                                        238.66666666666663,
                                        532,
                                        315.99999999999994
                                    ],
                                    "spans": [],
                                    "index": 2
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                165,
                                320,
                                447,
                                330
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        165,
                                        320,
                                        446,
                                        332
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                165,
                                                320,
                                                446,
                                                332
                                            ],
                                            "score": 0.972791850566864,
                                            "content": "Figure 10: Tape Diff: Application to compare two batches of tape.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 3
                                }
                            ],
                            "index": 3
                        }
                    ],
                    "index": 2.0,
                    "page_num": "page_30",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "title",
                    "bbox": [
                        72,
                        80,
                        218,
                        95
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                81,
                                218,
                                94
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        81,
                                        81,
                                        93
                                    ],
                                    "score": 1.0,
                                    "content": "E",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        92,
                                        81,
                                        218,
                                        94
                                    ],
                                    "score": 1.0,
                                    "content": "GREADTH Form Filler",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        }
                    ],
                    "index": 0
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        105,
                        225,
                        118
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                106,
                                224,
                                119
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        106,
                                        224,
                                        119
                                    ],
                                    "score": 1.0,
                                    "content": "E.1 Virtual Companies Prompts",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        }
                    ],
                    "index": 1
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        127,
                        541,
                        151
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                129,
                                541,
                                141
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        129,
                                        541,
                                        141
                                    ],
                                    "score": 1.0,
                                    "content": "To generate synthetic environments/companies with 10 request forms available in each we use a three-step",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                70,
                                141,
                                239,
                                152
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        141,
                                        239,
                                        152
                                    ],
                                    "score": 1.0,
                                    "content": "prompting method with Llama-3-70B.",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        }
                    ],
                    "index": 2.5
                },
                {
                    "type": "text",
                    "bbox": [
                        89,
                        163,
                        540,
                        313
                    ],
                    "lines": [
                        {
                            "bbox": [
                                93,
                                164,
                                540,
                                178
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        93,
                                        164,
                                        540,
                                        178
                                    ],
                                    "score": 0.9916695952415466,
                                    "content": "1. The first step is to generate a description of a fake company. For this, we use the following prompt:",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                105,
                                185,
                                167,
                                196
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        185,
                                        149,
                                        196
                                    ],
                                    "score": 1.0,
                                    "content": "messages ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        149,
                                        186,
                                        157,
                                        193
                                    ],
                                    "score": 0.29,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        157,
                                        185,
                                        167,
                                        196
                                    ],
                                    "score": 1.0,
                                    "content": " [",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                116,
                                198,
                                124,
                                207
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        116,
                                        198,
                                        124,
                                        207
                                    ],
                                    "score": 1.0,
                                    "content": "{",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                125,
                                208,
                                208,
                                222
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        125,
                                        208,
                                        208,
                                        222
                                    ],
                                    "score": 1.0,
                                    "content": "\"role\": \"system\",",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                126,
                                219,
                                324,
                                233
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        126,
                                        219,
                                        324,
                                        233
                                    ],
                                    "score": 1.0,
                                    "content": "\"content\": \"You are a helpful assistant.\"",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                116,
                                233,
                                127,
                                243
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        116,
                                        233,
                                        127,
                                        243
                                    ],
                                    "score": 1.0,
                                    "content": "},",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                115,
                                244,
                                125,
                                255
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        115,
                                        244,
                                        125,
                                        255
                                    ],
                                    "score": 1.0,
                                    "content": "{",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                124,
                                255,
                                199,
                                269
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        124,
                                        255,
                                        199,
                                        269
                                    ],
                                    "score": 1.0,
                                    "content": "\"role\": \"user\",",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                125,
                                267,
                                511,
                                281
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        125,
                                        267,
                                        511,
                                        281
                                    ],
                                    "score": 1.0,
                                    "content": "\"content\": f\"Give me a description of {real_name} but replace all occurrences of",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                136,
                                280,
                                290,
                                294
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        136,
                                        280,
                                        290,
                                        294
                                    ],
                                    "score": 1.0,
                                    "content": "‘{real_name}‘ by ‘{fake_name}‘.\"",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                126,
                                294,
                                132,
                                301
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        126,
                                        294,
                                        132,
                                        301
                                    ],
                                    "score": 1.0,
                                    "content": "}",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                109,
                                307,
                                113,
                                312
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        109,
                                        307,
                                        113,
                                        312
                                    ],
                                    "score": 1.0,
                                    "content": "]",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        }
                    ],
                    "index": 9.5
                },
                {
                    "type": "text",
                    "bbox": [
                        106,
                        323,
                        541,
                        359
                    ],
                    "lines": [
                        {
                            "bbox": [
                                107,
                                324,
                                540,
                                336
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        324,
                                        540,
                                        336
                                    ],
                                    "score": 0.9813219308853149,
                                    "content": "with real_name and fake_name being set to different company names (e.g. “Starbucks” and “Cof-",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                106,
                                335,
                                542,
                                349
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        335,
                                        542,
                                        349
                                    ],
                                    "score": 1.0,
                                    "content": "feeCorp” respectively). This step produces a DESCRIPTION variable that will be used in the next",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                106,
                                348,
                                129,
                                361
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        348,
                                        129,
                                        361
                                    ],
                                    "score": 1.0,
                                    "content": "step.",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        }
                    ],
                    "index": 17
                },
                {
                    "type": "text",
                    "bbox": [
                        95,
                        365,
                        541,
                        401
                    ],
                    "lines": [
                        {
                            "bbox": [
                                93,
                                365,
                                541,
                                380
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        93,
                                        365,
                                        541,
                                        380
                                    ],
                                    "score": 1.0,
                                    "content": "2. The second step is to generate a list of 10 request forms for each fake company. For now, we only",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                105,
                                378,
                                541,
                                392
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        378,
                                        541,
                                        392
                                    ],
                                    "score": 1.0,
                                    "content": "ask the model to generate a name and a description for each form with the following system and",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                106,
                                391,
                                168,
                                403
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        391,
                                        168,
                                        403
                                    ],
                                    "score": 1.0,
                                    "content": "user prompts:",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        }
                    ],
                    "index": 20
                },
                {
                    "type": "text",
                    "bbox": [
                        105,
                        408,
                        478,
                        721
                    ],
                    "lines": [
                        {
                            "bbox": [
                                105,
                                409,
                                205,
                                423
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        409,
                                        205,
                                        423
                                    ],
                                    "score": 1.0,
                                    "content": "SYSTEM_MESSAGE = \"\"\"",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                115,
                                423,
                                477,
                                434
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        115,
                                        423,
                                        477,
                                        434
                                    ],
                                    "score": 1.0,
                                    "content": "You are a helpful enterprise assistant who is very well integrated into the",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                116,
                                435,
                                462,
                                446
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        116,
                                        435,
                                        462,
                                        446
                                    ],
                                    "score": 1.0,
                                    "content": "internal system of [ENTERPRISE_NAME]. You have access to the database of",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                117,
                                447,
                                473,
                                458
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        447,
                                        473,
                                        458
                                    ],
                                    "score": 1.0,
                                    "content": "[ENTERPRISE_NAME], which contains REQUEST_FORMS. REQUEST_FORMS can be used",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                115,
                                459,
                                443,
                                470
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        115,
                                        459,
                                        443,
                                        470
                                    ],
                                    "score": 1.0,
                                    "content": "by employees and clients to submit requests and trigger automations.",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                116,
                                471,
                                333,
                                482
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        116,
                                        471,
                                        333,
                                        482
                                    ],
                                    "score": 1.0,
                                    "content": "REQUEST_FORMS have the following data format:",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                117,
                                481,
                                162,
                                496
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        481,
                                        162,
                                        496
                                    ],
                                    "score": 1.0,
                                    "content": "‘‘‘python",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                116,
                                494,
                                271,
                                506
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        116,
                                        494,
                                        271,
                                        506
                                    ],
                                    "score": 1.0,
                                    "content": "class FunctionSchema(BaseModel):",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                125,
                                507,
                                214,
                                518
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        125,
                                        507,
                                        214,
                                        518
                                    ],
                                    "score": 1.0,
                                    "content": "name: FunctionName",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                126,
                                519,
                                471,
                                530
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        126,
                                        519,
                                        205,
                                        530
                                    ],
                                    "score": 1.0,
                                    "content": "description: str",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        206,
                                        519,
                                        214,
                                        527
                                    ],
                                    "score": 0.79,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        215,
                                        519,
                                        298,
                                        530
                                    ],
                                    "score": 1.0,
                                    "content": " Field(description",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        298,
                                        519,
                                        304,
                                        527
                                    ],
                                    "score": 0.59,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        305,
                                        519,
                                        471,
                                        530
                                    ],
                                    "score": 1.0,
                                    "content": "\"The description of the function.\")",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                125,
                                531,
                                477,
                                542
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        125,
                                        531,
                                        234,
                                        542
                                    ],
                                    "score": 1.0,
                                    "content": "parameters: JsonSchema",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        235,
                                        531,
                                        243,
                                        539
                                    ],
                                    "score": 0.8,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        243,
                                        531,
                                        393,
                                        542
                                    ],
                                    "score": 1.0,
                                    "content": " Field(default=None, description",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        394,
                                        531,
                                        402,
                                        539
                                    ],
                                    "score": 0.5,
                                    "content": "\\c=\\prime",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        402,
                                        531,
                                        477,
                                        542
                                    ],
                                    "score": 1.0,
                                    "content": "The JSON schema",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                135,
                                543,
                                285,
                                554
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        135,
                                        543,
                                        285,
                                        554
                                    ],
                                    "score": 1.0,
                                    "content": "of the function’s parameters.\")",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                125,
                                554,
                                453,
                                565
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        125,
                                        554,
                                        244,
                                        565
                                    ],
                                    "score": 1.0,
                                    "content": "return_value: JsonSchema",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        244,
                                        555,
                                        253,
                                        563
                                    ],
                                    "score": 0.81,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        253,
                                        554,
                                        317,
                                        565
                                    ],
                                    "score": 1.0,
                                    "content": " Field(default",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        317,
                                        555,
                                        323,
                                        562
                                    ],
                                    "score": 0.56,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        323,
                                        554,
                                        403,
                                        565
                                    ],
                                    "score": 1.0,
                                    "content": "None, description",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        403,
                                        555,
                                        410,
                                        562
                                    ],
                                    "score": 0.65,
                                    "content": "=^{\\prime}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        411,
                                        554,
                                        453,
                                        565
                                    ],
                                    "score": 1.0,
                                    "content": "\"The JSON",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                135,
                                567,
                                327,
                                578
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        135,
                                        567,
                                        327,
                                        578
                                    ],
                                    "score": 1.0,
                                    "content": "schema of the function’s return value.\")",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                108,
                                590,
                                122,
                                597
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        108,
                                        590,
                                        122,
                                        597
                                    ],
                                    "score": 0.5512778162956238,
                                    "content": "II1III",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                106,
                                603,
                                167,
                                613
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        603,
                                        148,
                                        613
                                    ],
                                    "score": 1.0,
                                    "content": "messages",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        149,
                                        603,
                                        157,
                                        611
                                    ],
                                    "score": 0.49,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        158,
                                        603,
                                        167,
                                        613
                                    ],
                                    "score": 1.0,
                                    "content": " [",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                118,
                                615,
                                336,
                                625
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        118,
                                        615,
                                        336,
                                        625
                                    ],
                                    "score": 1.0,
                                    "content": "{\"role\": \"system\", \"content\": SYSTEM_MESSAGE},",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                116,
                                625,
                                271,
                                637
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        116,
                                        625,
                                        271,
                                        637
                                    ],
                                    "score": 1.0,
                                    "content": "{\"role\": \"user\", \"content\": f\"\"\"",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                126,
                                638,
                                293,
                                649
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        126,
                                        638,
                                        293,
                                        649
                                    ],
                                    "score": 1.0,
                                    "content": "[ENTERPRISE_NAME] is ’{fake_name}’.",
                                    "type": "text"
                                }
                            ],
                            "index": 40
                        },
                        {
                            "bbox": [
                                126,
                                650,
                                190,
                                661
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        126,
                                        650,
                                        190,
                                        661
                                    ],
                                    "score": 1.0,
                                    "content": "{DESCRIPTION}",
                                    "type": "text"
                                }
                            ],
                            "index": 41
                        },
                        {
                            "bbox": [
                                125,
                                662,
                                472,
                                673
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        125,
                                        662,
                                        472,
                                        673
                                    ],
                                    "score": 1.0,
                                    "content": "Give me the name and description of 10 REQUEST_FORMS that are often used",
                                    "type": "text"
                                }
                            ],
                            "index": 42
                        },
                        {
                            "bbox": [
                                126,
                                675,
                                467,
                                685
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        126,
                                        675,
                                        467,
                                        685
                                    ],
                                    "score": 1.0,
                                    "content": "at {fake_name}. Make sure the REQUEST_FORMS are specific to {fake_name}",
                                    "type": "text"
                                }
                            ],
                            "index": 43
                        },
                        {
                            "bbox": [
                                125,
                                687,
                                457,
                                696
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        125,
                                        687,
                                        457,
                                        696
                                    ],
                                    "score": 1.0,
                                    "content": "use cases. Format the output as a JSON list of JSON dictionaries with",
                                    "type": "text"
                                }
                            ],
                            "index": 44
                        },
                        {
                            "bbox": [
                                127,
                                698,
                                456,
                                709
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        127,
                                        698,
                                        456,
                                        709
                                    ],
                                    "score": 1.0,
                                    "content": "’name’ and ’description’ keys. Make sure the output is JSON parsable.",
                                    "type": "text"
                                }
                            ],
                            "index": 45
                        },
                        {
                            "bbox": [
                                118,
                                709,
                                140,
                                720
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        118,
                                        709,
                                        140,
                                        720
                                    ],
                                    "score": 1.0,
                                    "content": "\"\"\"},",
                                    "type": "text"
                                }
                            ],
                            "index": 46
                        }
                    ],
                    "index": 34
                }
            ],
            "layout_bboxes": [],
            "page_idx": 31,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        71,
                        26,
                        143,
                        37
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                25,
                                144,
                                38
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        25,
                                        144,
                                        38
                                    ],
                                    "score": 1.0,
                                    "content": "Technical report",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        751,
                        311,
                        760
                    ],
                    "lines": [
                        {
                            "bbox": [
                                299,
                                751,
                                312,
                                762
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        299,
                                        751,
                                        312,
                                        762
                                    ],
                                    "score": 1.0,
                                    "content": "32",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        107,
                        722,
                        113,
                        731
                    ],
                    "lines": [
                        {
                            "bbox": [
                                106,
                                722,
                                114,
                                733
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        722,
                                        114,
                                        733
                                    ],
                                    "score": 1.0,
                                    "content": "]",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "title",
                    "bbox": [
                        72,
                        80,
                        218,
                        95
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                81,
                                218,
                                94
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        81,
                                        81,
                                        93
                                    ],
                                    "score": 1.0,
                                    "content": "E",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        92,
                                        81,
                                        218,
                                        94
                                    ],
                                    "score": 1.0,
                                    "content": "GREADTH Form Filler",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        }
                    ],
                    "index": 0,
                    "page_num": "page_31",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        105,
                        225,
                        118
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                106,
                                224,
                                119
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        106,
                                        224,
                                        119
                                    ],
                                    "score": 1.0,
                                    "content": "E.1 Virtual Companies Prompts",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        }
                    ],
                    "index": 1,
                    "page_num": "page_31",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        127,
                        541,
                        151
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                129,
                                541,
                                141
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        129,
                                        541,
                                        141
                                    ],
                                    "score": 1.0,
                                    "content": "To generate synthetic environments/companies with 10 request forms available in each we use a three-step",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                70,
                                141,
                                239,
                                152
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        141,
                                        239,
                                        152
                                    ],
                                    "score": 1.0,
                                    "content": "prompting method with Llama-3-70B.",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        }
                    ],
                    "index": 2.5,
                    "page_num": "page_31",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        129,
                        541,
                        152
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        89,
                        163,
                        540,
                        313
                    ],
                    "lines": [
                        {
                            "bbox": [
                                93,
                                164,
                                540,
                                178
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        93,
                                        164,
                                        540,
                                        178
                                    ],
                                    "score": 0.9916695952415466,
                                    "content": "1. The first step is to generate a description of a fake company. For this, we use the following prompt:",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                105,
                                185,
                                167,
                                196
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        185,
                                        149,
                                        196
                                    ],
                                    "score": 1.0,
                                    "content": "messages ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        149,
                                        186,
                                        157,
                                        193
                                    ],
                                    "score": 0.29,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        157,
                                        185,
                                        167,
                                        196
                                    ],
                                    "score": 1.0,
                                    "content": " [",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                116,
                                198,
                                124,
                                207
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        116,
                                        198,
                                        124,
                                        207
                                    ],
                                    "score": 1.0,
                                    "content": "{",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                125,
                                208,
                                208,
                                222
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        125,
                                        208,
                                        208,
                                        222
                                    ],
                                    "score": 1.0,
                                    "content": "\"role\": \"system\",",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                126,
                                219,
                                324,
                                233
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        126,
                                        219,
                                        324,
                                        233
                                    ],
                                    "score": 1.0,
                                    "content": "\"content\": \"You are a helpful assistant.\"",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                116,
                                233,
                                127,
                                243
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        116,
                                        233,
                                        127,
                                        243
                                    ],
                                    "score": 1.0,
                                    "content": "},",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                115,
                                244,
                                125,
                                255
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        115,
                                        244,
                                        125,
                                        255
                                    ],
                                    "score": 1.0,
                                    "content": "{",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                124,
                                255,
                                199,
                                269
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        124,
                                        255,
                                        199,
                                        269
                                    ],
                                    "score": 1.0,
                                    "content": "\"role\": \"user\",",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                125,
                                267,
                                511,
                                281
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        125,
                                        267,
                                        511,
                                        281
                                    ],
                                    "score": 1.0,
                                    "content": "\"content\": f\"Give me a description of {real_name} but replace all occurrences of",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                136,
                                280,
                                290,
                                294
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        136,
                                        280,
                                        290,
                                        294
                                    ],
                                    "score": 1.0,
                                    "content": "‘{real_name}‘ by ‘{fake_name}‘.\"",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                126,
                                294,
                                132,
                                301
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        126,
                                        294,
                                        132,
                                        301
                                    ],
                                    "score": 1.0,
                                    "content": "}",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                109,
                                307,
                                113,
                                312
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        109,
                                        307,
                                        113,
                                        312
                                    ],
                                    "score": 1.0,
                                    "content": "]",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        }
                    ],
                    "index": 9.5,
                    "page_num": "page_31",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        93,
                        164,
                        540,
                        312
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        106,
                        323,
                        541,
                        359
                    ],
                    "lines": [
                        {
                            "bbox": [
                                107,
                                324,
                                540,
                                336
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        324,
                                        540,
                                        336
                                    ],
                                    "score": 0.9813219308853149,
                                    "content": "with real_name and fake_name being set to different company names (e.g. “Starbucks” and “Cof-",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                106,
                                335,
                                542,
                                349
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        335,
                                        542,
                                        349
                                    ],
                                    "score": 1.0,
                                    "content": "feeCorp” respectively). This step produces a DESCRIPTION variable that will be used in the next",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                106,
                                348,
                                129,
                                361
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        348,
                                        129,
                                        361
                                    ],
                                    "score": 1.0,
                                    "content": "step.",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        }
                    ],
                    "index": 17,
                    "page_num": "page_31",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        106,
                        324,
                        542,
                        361
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        95,
                        365,
                        541,
                        401
                    ],
                    "lines": [
                        {
                            "bbox": [
                                93,
                                365,
                                541,
                                380
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        93,
                                        365,
                                        541,
                                        380
                                    ],
                                    "score": 1.0,
                                    "content": "2. The second step is to generate a list of 10 request forms for each fake company. For now, we only",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                105,
                                378,
                                541,
                                392
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        378,
                                        541,
                                        392
                                    ],
                                    "score": 1.0,
                                    "content": "ask the model to generate a name and a description for each form with the following system and",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                106,
                                391,
                                168,
                                403
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        391,
                                        168,
                                        403
                                    ],
                                    "score": 1.0,
                                    "content": "user prompts:",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        }
                    ],
                    "index": 20,
                    "page_num": "page_31",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        93,
                        365,
                        541,
                        403
                    ]
                },
                {
                    "type": "list",
                    "bbox": [
                        105,
                        408,
                        478,
                        721
                    ],
                    "lines": [
                        {
                            "bbox": [
                                105,
                                409,
                                205,
                                423
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        105,
                                        409,
                                        205,
                                        423
                                    ],
                                    "score": 1.0,
                                    "content": "SYSTEM_MESSAGE = \"\"\"",
                                    "type": "text"
                                }
                            ],
                            "index": 22,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                115,
                                423,
                                477,
                                434
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        115,
                                        423,
                                        477,
                                        434
                                    ],
                                    "score": 1.0,
                                    "content": "You are a helpful enterprise assistant who is very well integrated into the",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                116,
                                435,
                                462,
                                446
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        116,
                                        435,
                                        462,
                                        446
                                    ],
                                    "score": 1.0,
                                    "content": "internal system of [ENTERPRISE_NAME]. You have access to the database of",
                                    "type": "text"
                                }
                            ],
                            "index": 24,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                117,
                                447,
                                473,
                                458
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        447,
                                        473,
                                        458
                                    ],
                                    "score": 1.0,
                                    "content": "[ENTERPRISE_NAME], which contains REQUEST_FORMS. REQUEST_FORMS can be used",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                115,
                                459,
                                443,
                                470
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        115,
                                        459,
                                        443,
                                        470
                                    ],
                                    "score": 1.0,
                                    "content": "by employees and clients to submit requests and trigger automations.",
                                    "type": "text"
                                }
                            ],
                            "index": 26,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                116,
                                471,
                                333,
                                482
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        116,
                                        471,
                                        333,
                                        482
                                    ],
                                    "score": 1.0,
                                    "content": "REQUEST_FORMS have the following data format:",
                                    "type": "text"
                                }
                            ],
                            "index": 27,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                117,
                                481,
                                162,
                                496
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        481,
                                        162,
                                        496
                                    ],
                                    "score": 1.0,
                                    "content": "‘‘‘python",
                                    "type": "text"
                                }
                            ],
                            "index": 28,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                116,
                                494,
                                271,
                                506
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        116,
                                        494,
                                        271,
                                        506
                                    ],
                                    "score": 1.0,
                                    "content": "class FunctionSchema(BaseModel):",
                                    "type": "text"
                                }
                            ],
                            "index": 29,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                125,
                                507,
                                214,
                                518
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        125,
                                        507,
                                        214,
                                        518
                                    ],
                                    "score": 1.0,
                                    "content": "name: FunctionName",
                                    "type": "text"
                                }
                            ],
                            "index": 30,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                126,
                                519,
                                471,
                                530
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        126,
                                        519,
                                        205,
                                        530
                                    ],
                                    "score": 1.0,
                                    "content": "description: str",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        206,
                                        519,
                                        214,
                                        527
                                    ],
                                    "score": 0.79,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        215,
                                        519,
                                        298,
                                        530
                                    ],
                                    "score": 1.0,
                                    "content": " Field(description",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        298,
                                        519,
                                        304,
                                        527
                                    ],
                                    "score": 0.59,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        305,
                                        519,
                                        471,
                                        530
                                    ],
                                    "score": 1.0,
                                    "content": "\"The description of the function.\")",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                125,
                                531,
                                477,
                                542
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        125,
                                        531,
                                        234,
                                        542
                                    ],
                                    "score": 1.0,
                                    "content": "parameters: JsonSchema",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        235,
                                        531,
                                        243,
                                        539
                                    ],
                                    "score": 0.8,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        243,
                                        531,
                                        393,
                                        542
                                    ],
                                    "score": 1.0,
                                    "content": " Field(default=None, description",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        394,
                                        531,
                                        402,
                                        539
                                    ],
                                    "score": 0.5,
                                    "content": "\\c=\\prime",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        402,
                                        531,
                                        477,
                                        542
                                    ],
                                    "score": 1.0,
                                    "content": "The JSON schema",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                135,
                                543,
                                285,
                                554
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        135,
                                        543,
                                        285,
                                        554
                                    ],
                                    "score": 1.0,
                                    "content": "of the function’s parameters.\")",
                                    "type": "text"
                                }
                            ],
                            "index": 33,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                125,
                                554,
                                453,
                                565
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        125,
                                        554,
                                        244,
                                        565
                                    ],
                                    "score": 1.0,
                                    "content": "return_value: JsonSchema",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        244,
                                        555,
                                        253,
                                        563
                                    ],
                                    "score": 0.81,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 9
                                },
                                {
                                    "bbox": [
                                        253,
                                        554,
                                        317,
                                        565
                                    ],
                                    "score": 1.0,
                                    "content": " Field(default",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        317,
                                        555,
                                        323,
                                        562
                                    ],
                                    "score": 0.56,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 6
                                },
                                {
                                    "bbox": [
                                        323,
                                        554,
                                        403,
                                        565
                                    ],
                                    "score": 1.0,
                                    "content": "None, description",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        403,
                                        555,
                                        410,
                                        562
                                    ],
                                    "score": 0.65,
                                    "content": "=^{\\prime}",
                                    "type": "inline_equation",
                                    "height": 7,
                                    "width": 7
                                },
                                {
                                    "bbox": [
                                        411,
                                        554,
                                        453,
                                        565
                                    ],
                                    "score": 1.0,
                                    "content": "\"The JSON",
                                    "type": "text"
                                }
                            ],
                            "index": 34,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                135,
                                567,
                                327,
                                578
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        135,
                                        567,
                                        327,
                                        578
                                    ],
                                    "score": 1.0,
                                    "content": "schema of the function’s return value.\")",
                                    "type": "text"
                                }
                            ],
                            "index": 35,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                108,
                                590,
                                122,
                                597
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        108,
                                        590,
                                        122,
                                        597
                                    ],
                                    "score": 0.5512778162956238,
                                    "content": "II1III",
                                    "type": "text"
                                }
                            ],
                            "index": 36,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                106,
                                603,
                                167,
                                613
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        603,
                                        148,
                                        613
                                    ],
                                    "score": 1.0,
                                    "content": "messages",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        149,
                                        603,
                                        157,
                                        611
                                    ],
                                    "score": 0.49,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        158,
                                        603,
                                        167,
                                        613
                                    ],
                                    "score": 1.0,
                                    "content": " [",
                                    "type": "text"
                                }
                            ],
                            "index": 37,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                118,
                                615,
                                336,
                                625
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        118,
                                        615,
                                        336,
                                        625
                                    ],
                                    "score": 1.0,
                                    "content": "{\"role\": \"system\", \"content\": SYSTEM_MESSAGE},",
                                    "type": "text"
                                }
                            ],
                            "index": 38,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                116,
                                625,
                                271,
                                637
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        116,
                                        625,
                                        271,
                                        637
                                    ],
                                    "score": 1.0,
                                    "content": "{\"role\": \"user\", \"content\": f\"\"\"",
                                    "type": "text"
                                }
                            ],
                            "index": 39,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                126,
                                638,
                                293,
                                649
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        126,
                                        638,
                                        293,
                                        649
                                    ],
                                    "score": 1.0,
                                    "content": "[ENTERPRISE_NAME] is ’{fake_name}’.",
                                    "type": "text"
                                }
                            ],
                            "index": 40,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                126,
                                650,
                                190,
                                661
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        126,
                                        650,
                                        190,
                                        661
                                    ],
                                    "score": 1.0,
                                    "content": "{DESCRIPTION}",
                                    "type": "text"
                                }
                            ],
                            "index": 41,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                125,
                                662,
                                472,
                                673
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        125,
                                        662,
                                        472,
                                        673
                                    ],
                                    "score": 1.0,
                                    "content": "Give me the name and description of 10 REQUEST_FORMS that are often used",
                                    "type": "text"
                                }
                            ],
                            "index": 42
                        },
                        {
                            "bbox": [
                                126,
                                675,
                                467,
                                685
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        126,
                                        675,
                                        467,
                                        685
                                    ],
                                    "score": 1.0,
                                    "content": "at {fake_name}. Make sure the REQUEST_FORMS are specific to {fake_name}",
                                    "type": "text"
                                }
                            ],
                            "index": 43
                        },
                        {
                            "bbox": [
                                125,
                                687,
                                457,
                                696
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        125,
                                        687,
                                        457,
                                        696
                                    ],
                                    "score": 1.0,
                                    "content": "use cases. Format the output as a JSON list of JSON dictionaries with",
                                    "type": "text"
                                }
                            ],
                            "index": 44,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                127,
                                698,
                                456,
                                709
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        127,
                                        698,
                                        456,
                                        709
                                    ],
                                    "score": 1.0,
                                    "content": "’name’ and ’description’ keys. Make sure the output is JSON parsable.",
                                    "type": "text"
                                }
                            ],
                            "index": 45,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                118,
                                709,
                                140,
                                720
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        118,
                                        709,
                                        140,
                                        720
                                    ],
                                    "score": 1.0,
                                    "content": "\"\"\"},",
                                    "type": "text"
                                }
                            ],
                            "index": 46,
                            "is_list_end_line": true
                        }
                    ],
                    "index": 34,
                    "page_num": "page_31",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        105,
                        409,
                        477,
                        720
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        101,
                        82,
                        541,
                        106
                    ],
                    "lines": [
                        {
                            "bbox": [
                                107,
                                83,
                                540,
                                95
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        83,
                                        540,
                                        95
                                    ],
                                    "score": 0.9893075823783875,
                                    "content": "with fake_name and DEscRIPTIoN defined in the previous step. The output is a list of 10 request form",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                106,
                                94,
                                492,
                                108
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        94,
                                        492,
                                        108
                                    ],
                                    "score": 1.0,
                                    "content": "names and descriptions. We programmatically verify that the output is JSON parsable.",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        }
                    ],
                    "index": 0.5
                },
                {
                    "type": "text",
                    "bbox": [
                        92,
                        114,
                        540,
                        138
                    ],
                    "lines": [
                        {
                            "bbox": [
                                92,
                                114,
                                541,
                                128
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        92,
                                        114,
                                        541,
                                        128
                                    ],
                                    "score": 1.0,
                                    "content": "3. Eventually, for each request form dictionary (FORM) generated previously, we prompt llama3-70B to",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                106,
                                127,
                                274,
                                140
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        127,
                                        274,
                                        140
                                    ],
                                    "score": 1.0,
                                    "content": "generate the FunctionSchema like this:",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        }
                    ],
                    "index": 2.5
                },
                {
                    "type": "text",
                    "bbox": [
                        104,
                        133,
                        520,
                        437
                    ],
                    "lines": [
                        {
                            "bbox": [
                                106,
                                151,
                                167,
                                163
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        151,
                                        149,
                                        162
                                    ],
                                    "score": 1.0,
                                    "content": "messages ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        149,
                                        152,
                                        157,
                                        160
                                    ],
                                    "score": 0.48,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        157,
                                        151,
                                        167,
                                        163
                                    ],
                                    "score": 1.0,
                                    "content": " [",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                117,
                                162,
                                336,
                                174
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        162,
                                        336,
                                        174
                                    ],
                                    "score": 1.0,
                                    "content": "{\"role\": \"system\", \"content\": SYSTEM_MESSAGE},",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                116,
                                174,
                                272,
                                186
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        116,
                                        174,
                                        272,
                                        186
                                    ],
                                    "score": 1.0,
                                    "content": "{\"role\": \"user\", \"content\": f\"\"\"",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                126,
                                187,
                                295,
                                199
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        126,
                                        187,
                                        295,
                                        199
                                    ],
                                    "score": 1.0,
                                    "content": "[ENTERPRISE_NAME] is ’{fake_name}’.",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                126,
                                199,
                                190,
                                211
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        126,
                                        199,
                                        190,
                                        211
                                    ],
                                    "score": 1.0,
                                    "content": "{DESCRIPTION}",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                124,
                                210,
                                400,
                                222
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        124,
                                        210,
                                        400,
                                        222
                                    ],
                                    "score": 1.0,
                                    "content": "Show me the FunctionSchema of the following REQUEST_FORM:",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                126,
                                221,
                                163,
                                237
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        126,
                                        221,
                                        163,
                                        237
                                    ],
                                    "score": 1.0,
                                    "content": "‘‘‘json",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                125,
                                235,
                                157,
                                247
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        125,
                                        235,
                                        157,
                                        247
                                    ],
                                    "score": 1.0,
                                    "content": "{FORM}",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                126,
                                246,
                                141,
                                256
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        126,
                                        246,
                                        141,
                                        256
                                    ],
                                    "score": 1.0,
                                    "content": "‘‘‘",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                125,
                                258,
                                515,
                                270
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        125,
                                        258,
                                        515,
                                        270
                                    ],
                                    "score": 1.0,
                                    "content": "First, rephrase the description to be more specific. The description must include",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                127,
                                272,
                                491,
                                282
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        127,
                                        272,
                                        491,
                                        282
                                    ],
                                    "score": 1.0,
                                    "content": "rules, facts, and policies at {fake_name} about {FORM[’name’]}, such as when",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        },
                        {
                            "bbox": [
                                125,
                                282,
                                506,
                                294
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        125,
                                        282,
                                        506,
                                        294
                                    ],
                                    "score": 1.0,
                                    "content": "to fill this request, who will process the request, etc... The description must",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                125,
                                294,
                                495,
                                306
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        125,
                                        294,
                                        495,
                                        306
                                    ],
                                    "score": 1.0,
                                    "content": "also include information about the parameters to help the user fill the form.",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                125,
                                307,
                                468,
                                319
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        125,
                                        307,
                                        468,
                                        319
                                    ],
                                    "score": 1.0,
                                    "content": "For multiple choice parameters (enum), the description must explain the",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        },
                        {
                            "bbox": [
                                125,
                                318,
                                313,
                                331
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        125,
                                        318,
                                        313,
                                        331
                                    ],
                                    "score": 1.0,
                                    "content": "difference between each possible value.",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                126,
                                343,
                                484,
                                354
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        126,
                                        343,
                                        484,
                                        354
                                    ],
                                    "score": 1.0,
                                    "content": "Once the description is written, remove all colon ( : ) characters from it.",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                125,
                                366,
                                515,
                                379
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        125,
                                        366,
                                        515,
                                        379
                                    ],
                                    "score": 1.0,
                                    "content": "Second, write the yaml format of this FunctionSchema by replacing the description",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                126,
                                379,
                                519,
                                390
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        126,
                                        379,
                                        519,
                                        390
                                    ],
                                    "score": 1.0,
                                    "content": "with your detailed version. Parameters cannot be nested objects, but return values",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                126,
                                391,
                                486,
                                402
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        126,
                                        391,
                                        486,
                                        402
                                    ],
                                    "score": 1.0,
                                    "content": "can. The FunctionSchema must contain both required and optional parameters.",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        },
                        {
                            "bbox": [
                                125,
                                403,
                                514,
                                415
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        125,
                                        403,
                                        514,
                                        415
                                    ],
                                    "score": 1.0,
                                    "content": "Write the output in yaml format. The output must be parsable as a FunctionSchema.",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                117,
                                414,
                                141,
                                426
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        414,
                                        141,
                                        426
                                    ],
                                    "score": 1.0,
                                    "content": "\"\"\"},",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                106,
                                426,
                                113,
                                438
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        426,
                                        113,
                                        438
                                    ],
                                    "score": 1.0,
                                    "content": "]",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        }
                    ],
                    "index": 14.5
                },
                {
                    "type": "text",
                    "bbox": [
                        106,
                        449,
                        541,
                        485
                    ],
                    "lines": [
                        {
                            "bbox": [
                                106,
                                449,
                                540,
                                462
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        449,
                                        540,
                                        462
                                    ],
                                    "score": 0.9851984977722168,
                                    "content": "with SYSTEM_MESSAGE, fake_name, DESCRIPTION, and FORM defined in the previous steps. We ver-",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                106,
                                462,
                                541,
                                474
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        462,
                                        541,
                                        474
                                    ],
                                    "score": 1.0,
                                    "content": "ify programmatically that the output is parsable as a FunctionSchema. An example of generated",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                106,
                                474,
                                493,
                                487
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        474,
                                        493,
                                        487
                                    ],
                                    "score": 1.0,
                                    "content": "FunctionSchema can be seen in Step [5] of the Tapes in Figures 11 & 12 (Appendix E.5).",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        }
                    ],
                    "index": 27
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        499,
                        316,
                        512
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                500,
                                316,
                                513
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        500,
                                        316,
                                        513
                                    ],
                                    "score": 1.0,
                                    "content": "E.2 List of Form-Filler Agent Thoughts and Actions",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        }
                    ],
                    "index": 29
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        520,
                        542,
                        545
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                522,
                                541,
                                535
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        522,
                                        541,
                                        535
                                    ],
                                    "score": 0.986207127571106,
                                    "content": "Form-filler thoughts. Below, we list the available thoughts for our Form-Filler TapeAgent and explain",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                71,
                                534,
                                189,
                                546
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        534,
                                        189,
                                        546
                                    ],
                                    "score": 1.0,
                                    "content": "when they should be used:",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        }
                    ],
                    "index": 30.5
                },
                {
                    "type": "text",
                    "bbox": [
                        95,
                        559,
                        542,
                        732
                    ],
                    "lines": [
                        {
                            "bbox": [
                                95,
                                559,
                                541,
                                573
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        559,
                                        541,
                                        573
                                    ],
                                    "score": 1.0,
                                    "content": "• AnswerFromFunctionSchemaThought: This thought premeditates answering the user’s question that",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        },
                        {
                            "bbox": [
                                106,
                                572,
                                434,
                                585
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        572,
                                        434,
                                        585
                                    ],
                                    "score": 1.0,
                                    "content": "the agent knows how to answer based on the form description. Attributes:",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                114,
                                589,
                                406,
                                602
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        114,
                                        589,
                                        406,
                                        602
                                    ],
                                    "score": 1.0,
                                    "content": "– function: The name of the function to answer a question about.",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        },
                        {
                            "bbox": [
                                95,
                                609,
                                541,
                                623
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        609,
                                        541,
                                        623
                                    ],
                                    "score": 1.0,
                                    "content": "• NoAnswerInFunctionSchemaThought: This thought premeditates informing the user that the agent",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                106,
                                620,
                                352,
                                635
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        620,
                                        352,
                                        635
                                    ],
                                    "score": 1.0,
                                    "content": "does not know the answer to their question. Attributes:",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        },
                        {
                            "bbox": [
                                115,
                                640,
                                285,
                                651
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        115,
                                        640,
                                        285,
                                        651
                                    ],
                                    "score": 1.0,
                                    "content": "– function: The name of the function.",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        },
                        {
                            "bbox": [
                                95,
                                659,
                                541,
                                672
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        659,
                                        541,
                                        672
                                    ],
                                    "score": 1.0,
                                    "content": "• RefuseInexistentFunctionThought: A thought that indicates that the query could not be resolved",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                106,
                                671,
                                167,
                                684
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        671,
                                        167,
                                        684
                                    ],
                                    "score": 1.0,
                                    "content": "to a function.",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                95,
                                691,
                                540,
                                704
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        691,
                                        540,
                                        704
                                    ],
                                    "score": 1.0,
                                    "content": "• RefuseInvalidFunctionParameterValueThought: This thought premeditates informing the user that",
                                    "type": "text"
                                }
                            ],
                            "index": 40
                        },
                        {
                            "bbox": [
                                106,
                                704,
                                324,
                                715
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        704,
                                        324,
                                        715
                                    ],
                                    "score": 1.0,
                                    "content": "a function parameter value is invalid. Attributes:",
                                    "type": "text"
                                }
                            ],
                            "index": 41
                        },
                        {
                            "bbox": [
                                115,
                                720,
                                285,
                                734
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        115,
                                        720,
                                        285,
                                        734
                                    ],
                                    "score": 1.0,
                                    "content": "– function: The name of the function.",
                                    "type": "text"
                                }
                            ],
                            "index": 42
                        }
                    ],
                    "index": 37
                }
            ],
            "layout_bboxes": [],
            "page_idx": 32,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        71,
                        27,
                        143,
                        37
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                26,
                                144,
                                38
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        26,
                                        144,
                                        38
                                    ],
                                    "score": 1.0,
                                    "content": "Technical report",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        751,
                        311,
                        760
                    ],
                    "lines": [
                        {
                            "bbox": [
                                299,
                                751,
                                312,
                                762
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        299,
                                        751,
                                        312,
                                        762
                                    ],
                                    "score": 1.0,
                                    "content": "33",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        101,
                        82,
                        541,
                        106
                    ],
                    "lines": [
                        {
                            "bbox": [
                                107,
                                83,
                                540,
                                95
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        83,
                                        540,
                                        95
                                    ],
                                    "score": 0.9893075823783875,
                                    "content": "with fake_name and DEscRIPTIoN defined in the previous step. The output is a list of 10 request form",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                106,
                                94,
                                492,
                                108
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        94,
                                        492,
                                        108
                                    ],
                                    "score": 1.0,
                                    "content": "names and descriptions. We programmatically verify that the output is JSON parsable.",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        }
                    ],
                    "index": 0.5,
                    "page_num": "page_32",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        106,
                        83,
                        540,
                        108
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        92,
                        114,
                        540,
                        138
                    ],
                    "lines": [
                        {
                            "bbox": [
                                92,
                                114,
                                541,
                                128
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        92,
                                        114,
                                        541,
                                        128
                                    ],
                                    "score": 1.0,
                                    "content": "3. Eventually, for each request form dictionary (FORM) generated previously, we prompt llama3-70B to",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                106,
                                127,
                                274,
                                140
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        127,
                                        274,
                                        140
                                    ],
                                    "score": 1.0,
                                    "content": "generate the FunctionSchema like this:",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        }
                    ],
                    "index": 2.5,
                    "page_num": "page_32",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        92,
                        114,
                        541,
                        140
                    ]
                },
                {
                    "type": "list",
                    "bbox": [
                        104,
                        133,
                        520,
                        437
                    ],
                    "lines": [
                        {
                            "bbox": [
                                106,
                                151,
                                167,
                                163
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        151,
                                        149,
                                        162
                                    ],
                                    "score": 1.0,
                                    "content": "messages ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        149,
                                        152,
                                        157,
                                        160
                                    ],
                                    "score": 0.48,
                                    "content": "=",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        157,
                                        151,
                                        167,
                                        163
                                    ],
                                    "score": 1.0,
                                    "content": " [",
                                    "type": "text"
                                }
                            ],
                            "index": 4,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                117,
                                162,
                                336,
                                174
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        162,
                                        336,
                                        174
                                    ],
                                    "score": 1.0,
                                    "content": "{\"role\": \"system\", \"content\": SYSTEM_MESSAGE},",
                                    "type": "text"
                                }
                            ],
                            "index": 5,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                116,
                                174,
                                272,
                                186
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        116,
                                        174,
                                        272,
                                        186
                                    ],
                                    "score": 1.0,
                                    "content": "{\"role\": \"user\", \"content\": f\"\"\"",
                                    "type": "text"
                                }
                            ],
                            "index": 6,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                126,
                                187,
                                295,
                                199
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        126,
                                        187,
                                        295,
                                        199
                                    ],
                                    "score": 1.0,
                                    "content": "[ENTERPRISE_NAME] is ’{fake_name}’.",
                                    "type": "text"
                                }
                            ],
                            "index": 7,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                126,
                                199,
                                190,
                                211
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        126,
                                        199,
                                        190,
                                        211
                                    ],
                                    "score": 1.0,
                                    "content": "{DESCRIPTION}",
                                    "type": "text"
                                }
                            ],
                            "index": 8,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                124,
                                210,
                                400,
                                222
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        124,
                                        210,
                                        400,
                                        222
                                    ],
                                    "score": 1.0,
                                    "content": "Show me the FunctionSchema of the following REQUEST_FORM:",
                                    "type": "text"
                                }
                            ],
                            "index": 9,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                126,
                                221,
                                163,
                                237
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        126,
                                        221,
                                        163,
                                        237
                                    ],
                                    "score": 1.0,
                                    "content": "‘‘‘json",
                                    "type": "text"
                                }
                            ],
                            "index": 10,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                125,
                                235,
                                157,
                                247
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        125,
                                        235,
                                        157,
                                        247
                                    ],
                                    "score": 1.0,
                                    "content": "{FORM}",
                                    "type": "text"
                                }
                            ],
                            "index": 11,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                126,
                                246,
                                141,
                                256
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        126,
                                        246,
                                        141,
                                        256
                                    ],
                                    "score": 1.0,
                                    "content": "‘‘‘",
                                    "type": "text"
                                }
                            ],
                            "index": 12,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                125,
                                258,
                                515,
                                270
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        125,
                                        258,
                                        515,
                                        270
                                    ],
                                    "score": 1.0,
                                    "content": "First, rephrase the description to be more specific. The description must include",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                127,
                                272,
                                491,
                                282
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        127,
                                        272,
                                        491,
                                        282
                                    ],
                                    "score": 1.0,
                                    "content": "rules, facts, and policies at {fake_name} about {FORM[’name’]}, such as when",
                                    "type": "text"
                                }
                            ],
                            "index": 14,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                125,
                                282,
                                506,
                                294
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        125,
                                        282,
                                        506,
                                        294
                                    ],
                                    "score": 1.0,
                                    "content": "to fill this request, who will process the request, etc... The description must",
                                    "type": "text"
                                }
                            ],
                            "index": 15,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                125,
                                294,
                                495,
                                306
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        125,
                                        294,
                                        495,
                                        306
                                    ],
                                    "score": 1.0,
                                    "content": "also include information about the parameters to help the user fill the form.",
                                    "type": "text"
                                }
                            ],
                            "index": 16,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                125,
                                307,
                                468,
                                319
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        125,
                                        307,
                                        468,
                                        319
                                    ],
                                    "score": 1.0,
                                    "content": "For multiple choice parameters (enum), the description must explain the",
                                    "type": "text"
                                }
                            ],
                            "index": 17,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                125,
                                318,
                                313,
                                331
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        125,
                                        318,
                                        313,
                                        331
                                    ],
                                    "score": 1.0,
                                    "content": "difference between each possible value.",
                                    "type": "text"
                                }
                            ],
                            "index": 18,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                126,
                                343,
                                484,
                                354
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        126,
                                        343,
                                        484,
                                        354
                                    ],
                                    "score": 1.0,
                                    "content": "Once the description is written, remove all colon ( : ) characters from it.",
                                    "type": "text"
                                }
                            ],
                            "index": 19,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                125,
                                366,
                                515,
                                379
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        125,
                                        366,
                                        515,
                                        379
                                    ],
                                    "score": 1.0,
                                    "content": "Second, write the yaml format of this FunctionSchema by replacing the description",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                126,
                                379,
                                519,
                                390
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        126,
                                        379,
                                        519,
                                        390
                                    ],
                                    "score": 1.0,
                                    "content": "with your detailed version. Parameters cannot be nested objects, but return values",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                126,
                                391,
                                486,
                                402
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        126,
                                        391,
                                        486,
                                        402
                                    ],
                                    "score": 1.0,
                                    "content": "can. The FunctionSchema must contain both required and optional parameters.",
                                    "type": "text"
                                }
                            ],
                            "index": 22,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                125,
                                403,
                                514,
                                415
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        125,
                                        403,
                                        514,
                                        415
                                    ],
                                    "score": 1.0,
                                    "content": "Write the output in yaml format. The output must be parsable as a FunctionSchema.",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                117,
                                414,
                                141,
                                426
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        414,
                                        141,
                                        426
                                    ],
                                    "score": 1.0,
                                    "content": "\"\"\"},",
                                    "type": "text"
                                }
                            ],
                            "index": 24,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                106,
                                426,
                                113,
                                438
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        426,
                                        113,
                                        438
                                    ],
                                    "score": 1.0,
                                    "content": "]",
                                    "type": "text"
                                }
                            ],
                            "index": 25,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        }
                    ],
                    "index": 14.5,
                    "page_num": "page_32",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        106,
                        151,
                        519,
                        438
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        106,
                        449,
                        541,
                        485
                    ],
                    "lines": [
                        {
                            "bbox": [
                                106,
                                449,
                                540,
                                462
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        449,
                                        540,
                                        462
                                    ],
                                    "score": 0.9851984977722168,
                                    "content": "with SYSTEM_MESSAGE, fake_name, DESCRIPTION, and FORM defined in the previous steps. We ver-",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                106,
                                462,
                                541,
                                474
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        462,
                                        541,
                                        474
                                    ],
                                    "score": 1.0,
                                    "content": "ify programmatically that the output is parsable as a FunctionSchema. An example of generated",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        },
                        {
                            "bbox": [
                                106,
                                474,
                                493,
                                487
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        474,
                                        493,
                                        487
                                    ],
                                    "score": 1.0,
                                    "content": "FunctionSchema can be seen in Step [5] of the Tapes in Figures 11 & 12 (Appendix E.5).",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        }
                    ],
                    "index": 27,
                    "page_num": "page_32",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        106,
                        449,
                        541,
                        487
                    ]
                },
                {
                    "type": "title",
                    "bbox": [
                        71,
                        499,
                        316,
                        512
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                500,
                                316,
                                513
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        500,
                                        316,
                                        513
                                    ],
                                    "score": 1.0,
                                    "content": "E.2 List of Form-Filler Agent Thoughts and Actions",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        }
                    ],
                    "index": 29,
                    "page_num": "page_32",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        520,
                        542,
                        545
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                522,
                                541,
                                535
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        522,
                                        541,
                                        535
                                    ],
                                    "score": 0.986207127571106,
                                    "content": "Form-filler thoughts. Below, we list the available thoughts for our Form-Filler TapeAgent and explain",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        },
                        {
                            "bbox": [
                                71,
                                534,
                                189,
                                546
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        534,
                                        189,
                                        546
                                    ],
                                    "score": 1.0,
                                    "content": "when they should be used:",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        }
                    ],
                    "index": 30.5,
                    "page_num": "page_32",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        522,
                        541,
                        546
                    ]
                },
                {
                    "type": "list",
                    "bbox": [
                        95,
                        559,
                        542,
                        732
                    ],
                    "lines": [
                        {
                            "bbox": [
                                95,
                                559,
                                541,
                                573
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        559,
                                        541,
                                        573
                                    ],
                                    "score": 1.0,
                                    "content": "• AnswerFromFunctionSchemaThought: This thought premeditates answering the user’s question that",
                                    "type": "text"
                                }
                            ],
                            "index": 32,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                106,
                                572,
                                434,
                                585
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        572,
                                        434,
                                        585
                                    ],
                                    "score": 1.0,
                                    "content": "the agent knows how to answer based on the form description. Attributes:",
                                    "type": "text"
                                }
                            ],
                            "index": 33,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                114,
                                589,
                                406,
                                602
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        114,
                                        589,
                                        406,
                                        602
                                    ],
                                    "score": 1.0,
                                    "content": "– function: The name of the function to answer a question about.",
                                    "type": "text"
                                }
                            ],
                            "index": 34,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                95,
                                609,
                                541,
                                623
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        609,
                                        541,
                                        623
                                    ],
                                    "score": 1.0,
                                    "content": "• NoAnswerInFunctionSchemaThought: This thought premeditates informing the user that the agent",
                                    "type": "text"
                                }
                            ],
                            "index": 35,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                106,
                                620,
                                352,
                                635
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        620,
                                        352,
                                        635
                                    ],
                                    "score": 1.0,
                                    "content": "does not know the answer to their question. Attributes:",
                                    "type": "text"
                                }
                            ],
                            "index": 36,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                115,
                                640,
                                285,
                                651
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        115,
                                        640,
                                        285,
                                        651
                                    ],
                                    "score": 1.0,
                                    "content": "– function: The name of the function.",
                                    "type": "text"
                                }
                            ],
                            "index": 37,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                95,
                                659,
                                541,
                                672
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        659,
                                        541,
                                        672
                                    ],
                                    "score": 1.0,
                                    "content": "• RefuseInexistentFunctionThought: A thought that indicates that the query could not be resolved",
                                    "type": "text"
                                }
                            ],
                            "index": 38,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                106,
                                671,
                                167,
                                684
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        671,
                                        167,
                                        684
                                    ],
                                    "score": 1.0,
                                    "content": "to a function.",
                                    "type": "text"
                                }
                            ],
                            "index": 39,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                95,
                                691,
                                540,
                                704
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        691,
                                        540,
                                        704
                                    ],
                                    "score": 1.0,
                                    "content": "• RefuseInvalidFunctionParameterValueThought: This thought premeditates informing the user that",
                                    "type": "text"
                                }
                            ],
                            "index": 40,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                106,
                                704,
                                324,
                                715
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        704,
                                        324,
                                        715
                                    ],
                                    "score": 1.0,
                                    "content": "a function parameter value is invalid. Attributes:",
                                    "type": "text"
                                }
                            ],
                            "index": 41,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                115,
                                720,
                                285,
                                734
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        115,
                                        720,
                                        285,
                                        734
                                    ],
                                    "score": 1.0,
                                    "content": "– function: The name of the function.",
                                    "type": "text"
                                }
                            ],
                            "index": 42,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                115,
                                83,
                                441,
                                95
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        115,
                                        83,
                                        441,
                                        95
                                    ],
                                    "score": 1.0,
                                    "content": "– parameter: The name of the parameter the user tried to set a value for.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 0,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                117,
                                98,
                                425,
                                109
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        98,
                                        425,
                                        109
                                    ],
                                    "score": 1.0,
                                    "content": "– parameter_value: The value the user tried to set for the parameter.",
                                    "type": "text",
                                    "cross_page": true
                                }
                            ],
                            "index": 1,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        }
                    ],
                    "index": 37,
                    "page_num": "page_32",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        95,
                        559,
                        541,
                        734
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        114,
                        82,
                        442,
                        109
                    ],
                    "lines": [
                        {
                            "bbox": [
                                115,
                                83,
                                441,
                                95
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        115,
                                        83,
                                        441,
                                        95
                                    ],
                                    "score": 1.0,
                                    "content": "– parameter: The name of the parameter the user tried to set a value for.",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        },
                        {
                            "bbox": [
                                117,
                                98,
                                425,
                                109
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        98,
                                        425,
                                        109
                                    ],
                                    "score": 1.0,
                                    "content": "– parameter_value: The value the user tried to set for the parameter.",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        }
                    ],
                    "index": 0.5
                },
                {
                    "type": "text",
                    "bbox": [
                        95,
                        119,
                        542,
                        143
                    ],
                    "lines": [
                        {
                            "bbox": [
                                95,
                                120,
                                541,
                                132
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        120,
                                        541,
                                        132
                                    ],
                                    "score": 1.0,
                                    "content": "• RefuseSkippingParameterThought: This thought premeditates informing the user that a function",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                106,
                                132,
                                388,
                                145
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        132,
                                        388,
                                        145
                                    ],
                                    "score": 1.0,
                                    "content": "parameter cannot be skipped because it is required. Attributes:",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        }
                    ],
                    "index": 2.5
                },
                {
                    "type": "text",
                    "bbox": [
                        114,
                        150,
                        458,
                        177
                    ],
                    "lines": [
                        {
                            "bbox": [
                                116,
                                151,
                                284,
                                162
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        116,
                                        151,
                                        284,
                                        162
                                    ],
                                    "score": 1.0,
                                    "content": "– function: The name of the function.",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                117,
                                166,
                                457,
                                178
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        166,
                                        457,
                                        178
                                    ],
                                    "score": 1.0,
                                    "content": "– parameter: The name of the required parameter that the user tried to skip.",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        }
                    ],
                    "index": 4.5
                },
                {
                    "type": "text",
                    "bbox": [
                        95,
                        187,
                        543,
                        211
                    ],
                    "lines": [
                        {
                            "bbox": [
                                94,
                                188,
                                541,
                                200
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        94,
                                        188,
                                        541,
                                        200
                                    ],
                                    "score": 1.0,
                                    "content": "• GatherValuesThought: This thought records extracted parameters from the user’s message and is",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                106,
                                199,
                                360,
                                213
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        199,
                                        360,
                                        213
                                    ],
                                    "score": 1.0,
                                    "content": "mainly used in the multi-node Teacher agent. Attributes:",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        }
                    ],
                    "index": 6.5
                },
                {
                    "type": "text",
                    "bbox": [
                        112,
                        218,
                        462,
                        245
                    ],
                    "lines": [
                        {
                            "bbox": [
                                116,
                                219,
                                284,
                                231
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        116,
                                        219,
                                        284,
                                        231
                                    ],
                                    "score": 1.0,
                                    "content": "– function: The name of the function.",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                116,
                                235,
                                460,
                                245
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        116,
                                        235,
                                        460,
                                        245
                                    ],
                                    "score": 1.0,
                                    "content": "– parameters: Dictionary mapping parameter names to their extracted values.",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        }
                    ],
                    "index": 8.5
                },
                {
                    "type": "text",
                    "bbox": [
                        96,
                        255,
                        542,
                        279
                    ],
                    "lines": [
                        {
                            "bbox": [
                                95,
                                256,
                                541,
                                268
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        256,
                                        541,
                                        268
                                    ],
                                    "score": 1.0,
                                    "content": "• VerifyValuesThought: This thought records the validity status of parameter values extracted from",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                107,
                                268,
                                472,
                                280
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        268,
                                        472,
                                        280
                                    ],
                                    "score": 1.0,
                                    "content": "the user’s message and is mainly used in the multi-node Teacher agent. Attributes:",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        }
                    ],
                    "index": 10.5
                },
                {
                    "type": "text",
                    "bbox": [
                        113,
                        287,
                        541,
                        325
                    ],
                    "lines": [
                        {
                            "bbox": [
                                117,
                                288,
                                284,
                                298
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        288,
                                        284,
                                        298
                                    ],
                                    "score": 1.0,
                                    "content": "– function: The name of the function.",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                118,
                                302,
                                540,
                                315
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        118,
                                        302,
                                        540,
                                        315
                                    ],
                                    "score": 1.0,
                                    "content": "– parameters: Dictionary mapping parameter names to their value, their validity, and the expla-",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                126,
                                314,
                                217,
                                326
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        126,
                                        314,
                                        217,
                                        326
                                    ],
                                    "score": 1.0,
                                    "content": "nation when invalid.",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        }
                    ],
                    "index": 13
                },
                {
                    "type": "text",
                    "bbox": [
                        98,
                        335,
                        541,
                        371
                    ],
                    "lines": [
                        {
                            "bbox": [
                                97,
                                337,
                                540,
                                349
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        97,
                                        337,
                                        540,
                                        349
                                    ],
                                    "score": 1.0,
                                    "content": "• UpdateFunctionParametersThought: This thought updates the values of the parameters of a function",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                106,
                                347,
                                541,
                                361
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        347,
                                        541,
                                        361
                                    ],
                                    "score": 1.0,
                                    "content": "based only on the user’s last message. It is used when the user provides NEW information about",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                107,
                                360,
                                526,
                                373
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        360,
                                        526,
                                        373
                                    ],
                                    "score": 1.0,
                                    "content": "the parameters of a function or when the user wants to skip an optional parameter. Attributes:",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        }
                    ],
                    "index": 16
                },
                {
                    "type": "text",
                    "bbox": [
                        114,
                        378,
                        541,
                        444
                    ],
                    "lines": [
                        {
                            "bbox": [
                                116,
                                379,
                                284,
                                391
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        116,
                                        379,
                                        284,
                                        391
                                    ],
                                    "score": 1.0,
                                    "content": "– function: The name of the function.",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                122,
                                394,
                                541,
                                407
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        122,
                                        394,
                                        541,
                                        407
                                    ],
                                    "score": 1.0,
                                    "content": " assign: The dictionary assignment of parameter names to their NEW values (optional, default:",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                127,
                                405,
                                366,
                                419
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        127,
                                        405,
                                        352,
                                        419
                                    ],
                                    "score": 1.0,
                                    "content": "{}). If no NEW values are provided, set ‘assign’ to ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        353,
                                        407,
                                        363,
                                        417
                                    ],
                                    "score": 0.91,
                                    "content": "\\{\\}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 10
                                },
                                {
                                    "bbox": [
                                        363,
                                        405,
                                        366,
                                        419
                                    ],
                                    "score": 1.0,
                                    "content": ".",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        },
                        {
                            "bbox": [
                                118,
                                420,
                                540,
                                433
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        118,
                                        420,
                                        540,
                                        433
                                    ],
                                    "score": 1.0,
                                    "content": "– skip: The list of NEW optional parameter names to skip (optional, default: []). If no NEW",
                                    "type": "text"
                                }
                            ],
                            "index": 21
                        },
                        {
                            "bbox": [
                                126,
                                432,
                                298,
                                445
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        126,
                                        432,
                                        298,
                                        445
                                    ],
                                    "score": 1.0,
                                    "content": "parameters are skipped, set ‘skip’ to [].",
                                    "type": "text"
                                }
                            ],
                            "index": 22
                        }
                    ],
                    "index": 20
                },
                {
                    "type": "text",
                    "bbox": [
                        106,
                        451,
                        541,
                        511
                    ],
                    "lines": [
                        {
                            "bbox": [
                                106,
                                451,
                                540,
                                466
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        451,
                                        540,
                                        466
                                    ],
                                    "score": 1.0,
                                    "content": "The ‘assign’ attribute sets or updates parameter values based on the last user message. It is only ap-",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                107,
                                465,
                                540,
                                475
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        465,
                                        540,
                                        475
                                    ],
                                    "score": 0.9949178695678711,
                                    "content": "plied to parameters that are newly filled or have updated values. Parameters that remain unchanged",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                106,
                                475,
                                541,
                                488
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        475,
                                        541,
                                        488
                                    ],
                                    "score": 1.0,
                                    "content": "will not have the ‘assign’ attribute. The ‘skip’ attribute is set for optional parameters when the user",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                107,
                                488,
                                541,
                                500
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        488,
                                        541,
                                        500
                                    ],
                                    "score": 1.0,
                                    "content": "wants to ignore or skip an optional parameter. It is only applied to new optional parameters that",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                107,
                                500,
                                482,
                                511
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        500,
                                        482,
                                        511
                                    ],
                                    "score": 1.0,
                                    "content": "the user wants to skip and will not be used for parameters that were already skipped.",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        }
                    ],
                    "index": 25
                },
                {
                    "type": "text",
                    "bbox": [
                        96,
                        521,
                        541,
                        565
                    ],
                    "lines": [
                        {
                            "bbox": [
                                95,
                                522,
                                540,
                                534
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        522,
                                        540,
                                        534
                                    ],
                                    "score": 1.0,
                                    "content": "• RequestFunctionThought: This thought premeditates requesting the user to select a function. At-",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                106,
                                534,
                                145,
                                546
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        534,
                                        145,
                                        546
                                    ],
                                    "score": 1.0,
                                    "content": "tributes:",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                116,
                                553,
                                389,
                                565
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        116,
                                        553,
                                        389,
                                        565
                                    ],
                                    "score": 1.0,
                                    "content": "– functions: The list of available functions the user can select.",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        }
                    ],
                    "index": 29
                },
                {
                    "type": "text",
                    "bbox": [
                        96,
                        574,
                        541,
                        599
                    ],
                    "lines": [
                        {
                            "bbox": [
                                96,
                                576,
                                541,
                                589
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        96,
                                        576,
                                        541,
                                        589
                                    ],
                                    "score": 1.0,
                                    "content": "• RequestFunctionParametersThought: This thought premeditates requesting the user to provide a",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                106,
                                588,
                                352,
                                600
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        588,
                                        352,
                                        600
                                    ],
                                    "score": 1.0,
                                    "content": "value for one parameter of a given function. Attributes:",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        }
                    ],
                    "index": 31.5
                },
                {
                    "type": "text",
                    "bbox": [
                        113,
                        606,
                        477,
                        633
                    ],
                    "lines": [
                        {
                            "bbox": [
                                116,
                                607,
                                398,
                                619
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        116,
                                        607,
                                        398,
                                        619
                                    ],
                                    "score": 1.0,
                                    "content": "– function: The name of the function to request parameters for.",
                                    "type": "text"
                                }
                            ],
                            "index": 33
                        },
                        {
                            "bbox": [
                                116,
                                622,
                                474,
                                634
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        116,
                                        622,
                                        474,
                                        634
                                    ],
                                    "score": 1.0,
                                    "content": "– parameters: A list containing only one value which is the parameter to request.",
                                    "type": "text"
                                }
                            ],
                            "index": 34
                        }
                    ],
                    "index": 33.5
                },
                {
                    "type": "text",
                    "bbox": [
                        95,
                        642,
                        540,
                        667
                    ],
                    "lines": [
                        {
                            "bbox": [
                                95,
                                644,
                                539,
                                656
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        644,
                                        539,
                                        656
                                    ],
                                    "score": 1.0,
                                    "content": "• RequestFunctionCallConfirmationThought: This thought is a preliminary step before calling a func-",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                107,
                                656,
                                480,
                                668
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        656,
                                        480,
                                        668
                                    ],
                                    "score": 0.9954015612602234,
                                    "content": "tion. This step is ONLY used once ALL parameters are filled or skipped. Attributes:",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        }
                    ],
                    "index": 35.5
                },
                {
                    "type": "text",
                    "bbox": [
                        113,
                        674,
                        284,
                        686
                    ],
                    "lines": [
                        {
                            "bbox": [
                                116,
                                674,
                                284,
                                687
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        116,
                                        674,
                                        284,
                                        687
                                    ],
                                    "score": 1.0,
                                    "content": "– function: The name of the function.",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        }
                    ],
                    "index": 37
                },
                {
                    "type": "text",
                    "bbox": [
                        96,
                        696,
                        541,
                        732
                    ],
                    "lines": [
                        {
                            "bbox": [
                                97,
                                698,
                                538,
                                710
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        97,
                                        698,
                                        538,
                                        710
                                    ],
                                    "score": 1.0,
                                    "content": "• RequestExitConfirmationThought: This thought is a preliminary step before exiting the dialogue.",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                106,
                                709,
                                541,
                                723
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        709,
                                        541,
                                        723
                                    ],
                                    "score": 0.9908290505409241,
                                    "content": "The message MUST be short and concise. The message should contain clear and explicit confirmation",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                106,
                                721,
                                353,
                                735
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        721,
                                        353,
                                        735
                                    ],
                                    "score": 1.0,
                                    "content": "of the acceptance of the last value provided by the user.",
                                    "type": "text"
                                }
                            ],
                            "index": 40
                        }
                    ],
                    "index": 39
                }
            ],
            "layout_bboxes": [],
            "page_idx": 33,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        71,
                        27,
                        143,
                        37
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                25,
                                144,
                                38
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        25,
                                        144,
                                        38
                                    ],
                                    "score": 1.0,
                                    "content": "Technical report",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        751,
                        311,
                        760
                    ],
                    "lines": [
                        {
                            "bbox": [
                                299,
                                751,
                                312,
                                762
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        299,
                                        751,
                                        312,
                                        762
                                    ],
                                    "score": 1.0,
                                    "content": "34",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "list",
                    "bbox": [
                        114,
                        82,
                        442,
                        109
                    ],
                    "lines": [],
                    "index": 0.5,
                    "page_num": "page_33",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        115,
                        83,
                        441,
                        109
                    ],
                    "lines_deleted": true
                },
                {
                    "type": "text",
                    "bbox": [
                        95,
                        119,
                        542,
                        143
                    ],
                    "lines": [
                        {
                            "bbox": [
                                95,
                                120,
                                541,
                                132
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        120,
                                        541,
                                        132
                                    ],
                                    "score": 1.0,
                                    "content": "• RefuseSkippingParameterThought: This thought premeditates informing the user that a function",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                106,
                                132,
                                388,
                                145
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        132,
                                        388,
                                        145
                                    ],
                                    "score": 1.0,
                                    "content": "parameter cannot be skipped because it is required. Attributes:",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        }
                    ],
                    "index": 2.5,
                    "page_num": "page_33",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        95,
                        120,
                        541,
                        145
                    ]
                },
                {
                    "type": "list",
                    "bbox": [
                        114,
                        150,
                        458,
                        177
                    ],
                    "lines": [
                        {
                            "bbox": [
                                116,
                                151,
                                284,
                                162
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        116,
                                        151,
                                        284,
                                        162
                                    ],
                                    "score": 1.0,
                                    "content": "– function: The name of the function.",
                                    "type": "text"
                                }
                            ],
                            "index": 4,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                117,
                                166,
                                457,
                                178
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        166,
                                        457,
                                        178
                                    ],
                                    "score": 1.0,
                                    "content": "– parameter: The name of the required parameter that the user tried to skip.",
                                    "type": "text"
                                }
                            ],
                            "index": 5,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        }
                    ],
                    "index": 4.5,
                    "page_num": "page_33",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        116,
                        151,
                        457,
                        178
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        95,
                        187,
                        543,
                        211
                    ],
                    "lines": [
                        {
                            "bbox": [
                                94,
                                188,
                                541,
                                200
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        94,
                                        188,
                                        541,
                                        200
                                    ],
                                    "score": 1.0,
                                    "content": "• GatherValuesThought: This thought records extracted parameters from the user’s message and is",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                106,
                                199,
                                360,
                                213
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        199,
                                        360,
                                        213
                                    ],
                                    "score": 1.0,
                                    "content": "mainly used in the multi-node Teacher agent. Attributes:",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        }
                    ],
                    "index": 6.5,
                    "page_num": "page_33",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        94,
                        188,
                        541,
                        213
                    ]
                },
                {
                    "type": "list",
                    "bbox": [
                        112,
                        218,
                        462,
                        245
                    ],
                    "lines": [
                        {
                            "bbox": [
                                116,
                                219,
                                284,
                                231
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        116,
                                        219,
                                        284,
                                        231
                                    ],
                                    "score": 1.0,
                                    "content": "– function: The name of the function.",
                                    "type": "text"
                                }
                            ],
                            "index": 8,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                116,
                                235,
                                460,
                                245
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        116,
                                        235,
                                        460,
                                        245
                                    ],
                                    "score": 1.0,
                                    "content": "– parameters: Dictionary mapping parameter names to their extracted values.",
                                    "type": "text"
                                }
                            ],
                            "index": 9,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        }
                    ],
                    "index": 8.5,
                    "page_num": "page_33",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        116,
                        219,
                        460,
                        245
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        96,
                        255,
                        542,
                        279
                    ],
                    "lines": [
                        {
                            "bbox": [
                                95,
                                256,
                                541,
                                268
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        256,
                                        541,
                                        268
                                    ],
                                    "score": 1.0,
                                    "content": "• VerifyValuesThought: This thought records the validity status of parameter values extracted from",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                107,
                                268,
                                472,
                                280
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        268,
                                        472,
                                        280
                                    ],
                                    "score": 1.0,
                                    "content": "the user’s message and is mainly used in the multi-node Teacher agent. Attributes:",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        }
                    ],
                    "index": 10.5,
                    "page_num": "page_33",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        95,
                        256,
                        541,
                        280
                    ]
                },
                {
                    "type": "list",
                    "bbox": [
                        113,
                        287,
                        541,
                        325
                    ],
                    "lines": [
                        {
                            "bbox": [
                                117,
                                288,
                                284,
                                298
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        288,
                                        284,
                                        298
                                    ],
                                    "score": 1.0,
                                    "content": "– function: The name of the function.",
                                    "type": "text"
                                }
                            ],
                            "index": 12,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                118,
                                302,
                                540,
                                315
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        118,
                                        302,
                                        540,
                                        315
                                    ],
                                    "score": 1.0,
                                    "content": "– parameters: Dictionary mapping parameter names to their value, their validity, and the expla-",
                                    "type": "text"
                                }
                            ],
                            "index": 13,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                126,
                                314,
                                217,
                                326
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        126,
                                        314,
                                        217,
                                        326
                                    ],
                                    "score": 1.0,
                                    "content": "nation when invalid.",
                                    "type": "text"
                                }
                            ],
                            "index": 14,
                            "is_list_end_line": true
                        }
                    ],
                    "index": 13,
                    "page_num": "page_33",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        117,
                        288,
                        540,
                        326
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        98,
                        335,
                        541,
                        371
                    ],
                    "lines": [
                        {
                            "bbox": [
                                97,
                                337,
                                540,
                                349
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        97,
                                        337,
                                        540,
                                        349
                                    ],
                                    "score": 1.0,
                                    "content": "• UpdateFunctionParametersThought: This thought updates the values of the parameters of a function",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        },
                        {
                            "bbox": [
                                106,
                                347,
                                541,
                                361
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        347,
                                        541,
                                        361
                                    ],
                                    "score": 1.0,
                                    "content": "based only on the user’s last message. It is used when the user provides NEW information about",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                107,
                                360,
                                526,
                                373
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        360,
                                        526,
                                        373
                                    ],
                                    "score": 1.0,
                                    "content": "the parameters of a function or when the user wants to skip an optional parameter. Attributes:",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        }
                    ],
                    "index": 16,
                    "page_num": "page_33",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        97,
                        337,
                        541,
                        373
                    ]
                },
                {
                    "type": "list",
                    "bbox": [
                        114,
                        378,
                        541,
                        444
                    ],
                    "lines": [
                        {
                            "bbox": [
                                116,
                                379,
                                284,
                                391
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        116,
                                        379,
                                        284,
                                        391
                                    ],
                                    "score": 1.0,
                                    "content": "– function: The name of the function.",
                                    "type": "text"
                                }
                            ],
                            "index": 18,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                122,
                                394,
                                541,
                                407
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        122,
                                        394,
                                        541,
                                        407
                                    ],
                                    "score": 1.0,
                                    "content": " assign: The dictionary assignment of parameter names to their NEW values (optional, default:",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                127,
                                405,
                                366,
                                419
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        127,
                                        405,
                                        352,
                                        419
                                    ],
                                    "score": 1.0,
                                    "content": "{}). If no NEW values are provided, set ‘assign’ to ",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        353,
                                        407,
                                        363,
                                        417
                                    ],
                                    "score": 0.91,
                                    "content": "\\{\\}",
                                    "type": "inline_equation",
                                    "height": 10,
                                    "width": 10
                                },
                                {
                                    "bbox": [
                                        363,
                                        405,
                                        366,
                                        419
                                    ],
                                    "score": 1.0,
                                    "content": ".",
                                    "type": "text"
                                }
                            ],
                            "index": 20,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                118,
                                420,
                                540,
                                433
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        118,
                                        420,
                                        540,
                                        433
                                    ],
                                    "score": 1.0,
                                    "content": "– skip: The list of NEW optional parameter names to skip (optional, default: []). If no NEW",
                                    "type": "text"
                                }
                            ],
                            "index": 21,
                            "is_list_start_line": true
                        },
                        {
                            "bbox": [
                                126,
                                432,
                                298,
                                445
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        126,
                                        432,
                                        298,
                                        445
                                    ],
                                    "score": 1.0,
                                    "content": "parameters are skipped, set ‘skip’ to [].",
                                    "type": "text"
                                }
                            ],
                            "index": 22,
                            "is_list_end_line": true
                        }
                    ],
                    "index": 20,
                    "page_num": "page_33",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        116,
                        379,
                        541,
                        445
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        106,
                        451,
                        541,
                        511
                    ],
                    "lines": [
                        {
                            "bbox": [
                                106,
                                451,
                                540,
                                466
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        451,
                                        540,
                                        466
                                    ],
                                    "score": 1.0,
                                    "content": "The ‘assign’ attribute sets or updates parameter values based on the last user message. It is only ap-",
                                    "type": "text"
                                }
                            ],
                            "index": 23
                        },
                        {
                            "bbox": [
                                107,
                                465,
                                540,
                                475
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        465,
                                        540,
                                        475
                                    ],
                                    "score": 0.9949178695678711,
                                    "content": "plied to parameters that are newly filled or have updated values. Parameters that remain unchanged",
                                    "type": "text"
                                }
                            ],
                            "index": 24
                        },
                        {
                            "bbox": [
                                106,
                                475,
                                541,
                                488
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        475,
                                        541,
                                        488
                                    ],
                                    "score": 1.0,
                                    "content": "will not have the ‘assign’ attribute. The ‘skip’ attribute is set for optional parameters when the user",
                                    "type": "text"
                                }
                            ],
                            "index": 25
                        },
                        {
                            "bbox": [
                                107,
                                488,
                                541,
                                500
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        488,
                                        541,
                                        500
                                    ],
                                    "score": 1.0,
                                    "content": "wants to ignore or skip an optional parameter. It is only applied to new optional parameters that",
                                    "type": "text"
                                }
                            ],
                            "index": 26
                        },
                        {
                            "bbox": [
                                107,
                                500,
                                482,
                                511
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        500,
                                        482,
                                        511
                                    ],
                                    "score": 1.0,
                                    "content": "the user wants to skip and will not be used for parameters that were already skipped.",
                                    "type": "text"
                                }
                            ],
                            "index": 27
                        }
                    ],
                    "index": 25,
                    "page_num": "page_33",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        106,
                        451,
                        541,
                        511
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        96,
                        521,
                        541,
                        565
                    ],
                    "lines": [
                        {
                            "bbox": [
                                95,
                                522,
                                540,
                                534
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        522,
                                        540,
                                        534
                                    ],
                                    "score": 1.0,
                                    "content": "• RequestFunctionThought: This thought premeditates requesting the user to select a function. At-",
                                    "type": "text"
                                }
                            ],
                            "index": 28
                        },
                        {
                            "bbox": [
                                106,
                                534,
                                145,
                                546
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        534,
                                        145,
                                        546
                                    ],
                                    "score": 1.0,
                                    "content": "tributes:",
                                    "type": "text"
                                }
                            ],
                            "index": 29
                        },
                        {
                            "bbox": [
                                116,
                                553,
                                389,
                                565
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        116,
                                        553,
                                        389,
                                        565
                                    ],
                                    "score": 1.0,
                                    "content": "– functions: The list of available functions the user can select.",
                                    "type": "text"
                                }
                            ],
                            "index": 30
                        }
                    ],
                    "index": 29,
                    "page_num": "page_33",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        95,
                        522,
                        540,
                        565
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        96,
                        574,
                        541,
                        599
                    ],
                    "lines": [
                        {
                            "bbox": [
                                96,
                                576,
                                541,
                                589
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        96,
                                        576,
                                        541,
                                        589
                                    ],
                                    "score": 1.0,
                                    "content": "• RequestFunctionParametersThought: This thought premeditates requesting the user to provide a",
                                    "type": "text"
                                }
                            ],
                            "index": 31
                        },
                        {
                            "bbox": [
                                106,
                                588,
                                352,
                                600
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        588,
                                        352,
                                        600
                                    ],
                                    "score": 1.0,
                                    "content": "value for one parameter of a given function. Attributes:",
                                    "type": "text"
                                }
                            ],
                            "index": 32
                        }
                    ],
                    "index": 31.5,
                    "page_num": "page_33",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        96,
                        576,
                        541,
                        600
                    ]
                },
                {
                    "type": "list",
                    "bbox": [
                        113,
                        606,
                        477,
                        633
                    ],
                    "lines": [
                        {
                            "bbox": [
                                116,
                                607,
                                398,
                                619
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        116,
                                        607,
                                        398,
                                        619
                                    ],
                                    "score": 1.0,
                                    "content": "– function: The name of the function to request parameters for.",
                                    "type": "text"
                                }
                            ],
                            "index": 33,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                116,
                                622,
                                474,
                                634
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        116,
                                        622,
                                        474,
                                        634
                                    ],
                                    "score": 1.0,
                                    "content": "– parameters: A list containing only one value which is the parameter to request.",
                                    "type": "text"
                                }
                            ],
                            "index": 34,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        }
                    ],
                    "index": 33.5,
                    "page_num": "page_33",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        116,
                        607,
                        474,
                        634
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        95,
                        642,
                        540,
                        667
                    ],
                    "lines": [
                        {
                            "bbox": [
                                95,
                                644,
                                539,
                                656
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        644,
                                        539,
                                        656
                                    ],
                                    "score": 1.0,
                                    "content": "• RequestFunctionCallConfirmationThought: This thought is a preliminary step before calling a func-",
                                    "type": "text"
                                }
                            ],
                            "index": 35
                        },
                        {
                            "bbox": [
                                107,
                                656,
                                480,
                                668
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        107,
                                        656,
                                        480,
                                        668
                                    ],
                                    "score": 0.9954015612602234,
                                    "content": "tion. This step is ONLY used once ALL parameters are filled or skipped. Attributes:",
                                    "type": "text"
                                }
                            ],
                            "index": 36
                        }
                    ],
                    "index": 35.5,
                    "page_num": "page_33",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        95,
                        644,
                        539,
                        668
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        113,
                        674,
                        284,
                        686
                    ],
                    "lines": [
                        {
                            "bbox": [
                                116,
                                674,
                                284,
                                687
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        116,
                                        674,
                                        284,
                                        687
                                    ],
                                    "score": 1.0,
                                    "content": "– function: The name of the function.",
                                    "type": "text"
                                }
                            ],
                            "index": 37
                        }
                    ],
                    "index": 37,
                    "page_num": "page_33",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        116,
                        674,
                        284,
                        687
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        96,
                        696,
                        541,
                        732
                    ],
                    "lines": [
                        {
                            "bbox": [
                                97,
                                698,
                                538,
                                710
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        97,
                                        698,
                                        538,
                                        710
                                    ],
                                    "score": 1.0,
                                    "content": "• RequestExitConfirmationThought: This thought is a preliminary step before exiting the dialogue.",
                                    "type": "text"
                                }
                            ],
                            "index": 38
                        },
                        {
                            "bbox": [
                                106,
                                709,
                                541,
                                723
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        709,
                                        541,
                                        723
                                    ],
                                    "score": 0.9908290505409241,
                                    "content": "The message MUST be short and concise. The message should contain clear and explicit confirmation",
                                    "type": "text"
                                }
                            ],
                            "index": 39
                        },
                        {
                            "bbox": [
                                106,
                                721,
                                353,
                                735
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        721,
                                        353,
                                        735
                                    ],
                                    "score": 1.0,
                                    "content": "of the acceptance of the last value provided by the user.",
                                    "type": "text"
                                }
                            ],
                            "index": 40
                        }
                    ],
                    "index": 39,
                    "page_num": "page_33",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        97,
                        698,
                        541,
                        735
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        69,
                        81,
                        470,
                        94
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                82,
                                469,
                                96
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        82,
                                        469,
                                        96
                                    ],
                                    "score": 0.9866172671318054,
                                    "content": "Form-filler actions. Here are the available actions our Form-Filler TapeAgent can take.",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        }
                    ],
                    "index": 0
                },
                {
                    "type": "text",
                    "bbox": [
                        92,
                        108,
                        541,
                        164
                    ],
                    "lines": [
                        {
                            "bbox": [
                                96,
                                109,
                                541,
                                121
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        96,
                                        109,
                                        541,
                                        121
                                    ],
                                    "score": 1.0,
                                    "content": "• ResolveFunctionAction: An action that resolves which function candidates are compatible with a",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                106,
                                121,
                                235,
                                134
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        121,
                                        235,
                                        134
                                    ],
                                    "score": 1.0,
                                    "content": "given user query. Attributes:",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                116,
                                139,
                                483,
                                151
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        116,
                                        139,
                                        483,
                                        151
                                    ],
                                    "score": 1.0,
                                    "content": "– query: The query to resolve the function with, by default the user’s last message.",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                116,
                                152,
                                443,
                                165
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        116,
                                        152,
                                        443,
                                        165
                                    ],
                                    "score": 1.0,
                                    "content": "– result: A list of candidate functions that are compatible with the query.",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        }
                    ],
                    "index": 2.5
                },
                {
                    "type": "text",
                    "bbox": [
                        96,
                        172,
                        543,
                        208
                    ],
                    "lines": [
                        {
                            "bbox": [
                                96,
                                173,
                                540,
                                186
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        96,
                                        173,
                                        540,
                                        186
                                    ],
                                    "score": 1.0,
                                    "content": "• InspectFunctionAction An action that inspects the schema of a function given its name. This action",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                106,
                                185,
                                541,
                                198
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        185,
                                        541,
                                        198
                                    ],
                                    "score": 1.0,
                                    "content": "inspects and returns the schema of the function, which contains its description and the names and",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                106,
                                197,
                                313,
                                209
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        197,
                                        313,
                                        209
                                    ],
                                    "score": 1.0,
                                    "content": "types of the function’s parameters. Attributes:",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        }
                    ],
                    "index": 6
                },
                {
                    "type": "text",
                    "bbox": [
                        115,
                        213,
                        285,
                        240
                    ],
                    "lines": [
                        {
                            "bbox": [
                                117,
                                214,
                                284,
                                225
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        214,
                                        284,
                                        225
                                    ],
                                    "score": 1.0,
                                    "content": "– function: The name of the function.",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                121,
                                228,
                                281,
                                239
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        121,
                                        228,
                                        281,
                                        239
                                    ],
                                    "score": 1.0,
                                    "content": " result: The schema of the function.",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        }
                    ],
                    "index": 8.5
                },
                {
                    "type": "text",
                    "bbox": [
                        96,
                        248,
                        542,
                        284
                    ],
                    "lines": [
                        {
                            "bbox": [
                                96,
                                249,
                                540,
                                261
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        96,
                                        249,
                                        540,
                                        261
                                    ],
                                    "score": 1.0,
                                    "content": "• PromptUserForTextMessageAction: An action that asks the user to enter a message in a text input",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                106,
                                261,
                                541,
                                273
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        261,
                                        541,
                                        273
                                    ],
                                    "score": 0.993745744228363,
                                    "content": "feld. This action is used to capture free-form text input from the user through a standard text",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                106,
                                273,
                                466,
                                285
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        273,
                                        466,
                                        285
                                    ],
                                    "score": 0.9925974011421204,
                                    "content": "input field. This action must be used in every single agent's response. Attributes:",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        }
                    ],
                    "index": 11
                },
                {
                    "type": "text",
                    "bbox": [
                        114,
                        289,
                        344,
                        315
                    ],
                    "lines": [
                        {
                            "bbox": [
                                115,
                                290,
                                344,
                                303
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        115,
                                        290,
                                        344,
                                        303
                                    ],
                                    "score": 1.0,
                                    "content": "– prompt: The message from the agent to the user.",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                119,
                                304,
                                219,
                                317
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        119,
                                        304,
                                        219,
                                        317
                                    ],
                                    "score": 1.0,
                                    "content": "– result: User message",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        }
                    ],
                    "index": 13.5
                },
                {
                    "type": "text",
                    "bbox": [
                        99,
                        323,
                        532,
                        336
                    ],
                    "lines": [
                        {
                            "bbox": [
                                97,
                                325,
                                530,
                                336
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        97,
                                        325,
                                        530,
                                        336
                                    ],
                                    "score": 1.0,
                                    "content": "• CallFunctionAction: This action calls a function with all available parameter values. Attributes:",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        }
                    ],
                    "index": 15
                },
                {
                    "type": "text",
                    "bbox": [
                        114,
                        341,
                        316,
                        367
                    ],
                    "lines": [
                        {
                            "bbox": [
                                117,
                                342,
                                315,
                                353
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        342,
                                        315,
                                        353
                                    ],
                                    "score": 1.0,
                                    "content": "– function: The name of the function to call.",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                122,
                                356,
                                273,
                                367
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        122,
                                        356,
                                        273,
                                        367
                                    ],
                                    "score": 1.0,
                                    "content": " result: Result of the function call",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        }
                    ],
                    "index": 16.5
                },
                {
                    "type": "text",
                    "bbox": [
                        95,
                        375,
                        543,
                        418
                    ],
                    "lines": [
                        {
                            "bbox": [
                                94,
                                375,
                                541,
                                390
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        94,
                                        375,
                                        541,
                                        390
                                    ],
                                    "score": 1.0,
                                    "content": "• ExitAction: With this action the agent indicates that the dialogue has ended. No further steps will",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                106,
                                388,
                                280,
                                400
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        388,
                                        280,
                                        400
                                    ],
                                    "score": 1.0,
                                    "content": "be executed after this step. Attributes:",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                117,
                                406,
                                484,
                                419
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        406,
                                        484,
                                        419
                                    ],
                                    "score": 1.0,
                                    "content": "– text: The message from the agent to inform the user that the dialogue has ended.",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        }
                    ],
                    "index": 19
                }
            ],
            "layout_bboxes": [],
            "page_idx": 34,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        71,
                        27,
                        143,
                        37
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                25,
                                144,
                                38
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        25,
                                        144,
                                        38
                                    ],
                                    "score": 1.0,
                                    "content": "Technical report",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        751,
                        311,
                        760
                    ],
                    "lines": [
                        {
                            "bbox": [
                                299,
                                751,
                                312,
                                762
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        299,
                                        751,
                                        312,
                                        762
                                    ],
                                    "score": 1.0,
                                    "content": "35",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "text",
                    "bbox": [
                        69,
                        81,
                        470,
                        94
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                82,
                                469,
                                96
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        82,
                                        469,
                                        96
                                    ],
                                    "score": 0.9866172671318054,
                                    "content": "Form-filler actions. Here are the available actions our Form-Filler TapeAgent can take.",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        }
                    ],
                    "index": 0,
                    "page_num": "page_34",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        70,
                        82,
                        469,
                        96
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        92,
                        108,
                        541,
                        164
                    ],
                    "lines": [
                        {
                            "bbox": [
                                96,
                                109,
                                541,
                                121
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        96,
                                        109,
                                        541,
                                        121
                                    ],
                                    "score": 1.0,
                                    "content": "• ResolveFunctionAction: An action that resolves which function candidates are compatible with a",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                106,
                                121,
                                235,
                                134
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        121,
                                        235,
                                        134
                                    ],
                                    "score": 1.0,
                                    "content": "given user query. Attributes:",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                116,
                                139,
                                483,
                                151
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        116,
                                        139,
                                        483,
                                        151
                                    ],
                                    "score": 1.0,
                                    "content": "– query: The query to resolve the function with, by default the user’s last message.",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                116,
                                152,
                                443,
                                165
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        116,
                                        152,
                                        443,
                                        165
                                    ],
                                    "score": 1.0,
                                    "content": "– result: A list of candidate functions that are compatible with the query.",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        }
                    ],
                    "index": 2.5,
                    "page_num": "page_34",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        96,
                        109,
                        541,
                        165
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        96,
                        172,
                        543,
                        208
                    ],
                    "lines": [
                        {
                            "bbox": [
                                96,
                                173,
                                540,
                                186
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        96,
                                        173,
                                        540,
                                        186
                                    ],
                                    "score": 1.0,
                                    "content": "• InspectFunctionAction An action that inspects the schema of a function given its name. This action",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                106,
                                185,
                                541,
                                198
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        185,
                                        541,
                                        198
                                    ],
                                    "score": 1.0,
                                    "content": "inspects and returns the schema of the function, which contains its description and the names and",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                106,
                                197,
                                313,
                                209
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        197,
                                        313,
                                        209
                                    ],
                                    "score": 1.0,
                                    "content": "types of the function’s parameters. Attributes:",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        }
                    ],
                    "index": 6,
                    "page_num": "page_34",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        96,
                        173,
                        541,
                        209
                    ]
                },
                {
                    "type": "list",
                    "bbox": [
                        115,
                        213,
                        285,
                        240
                    ],
                    "lines": [
                        {
                            "bbox": [
                                117,
                                214,
                                284,
                                225
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        214,
                                        284,
                                        225
                                    ],
                                    "score": 1.0,
                                    "content": "– function: The name of the function.",
                                    "type": "text"
                                }
                            ],
                            "index": 8,
                            "is_list_end_line": true
                        },
                        {
                            "bbox": [
                                121,
                                228,
                                281,
                                239
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        121,
                                        228,
                                        281,
                                        239
                                    ],
                                    "score": 1.0,
                                    "content": " result: The schema of the function.",
                                    "type": "text"
                                }
                            ],
                            "index": 9,
                            "is_list_start_line": true,
                            "is_list_end_line": true
                        }
                    ],
                    "index": 8.5,
                    "page_num": "page_34",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        117,
                        214,
                        284,
                        239
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        96,
                        248,
                        542,
                        284
                    ],
                    "lines": [
                        {
                            "bbox": [
                                96,
                                249,
                                540,
                                261
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        96,
                                        249,
                                        540,
                                        261
                                    ],
                                    "score": 1.0,
                                    "content": "• PromptUserForTextMessageAction: An action that asks the user to enter a message in a text input",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                106,
                                261,
                                541,
                                273
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        261,
                                        541,
                                        273
                                    ],
                                    "score": 0.993745744228363,
                                    "content": "feld. This action is used to capture free-form text input from the user through a standard text",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                106,
                                273,
                                466,
                                285
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        273,
                                        466,
                                        285
                                    ],
                                    "score": 0.9925974011421204,
                                    "content": "input field. This action must be used in every single agent's response. Attributes:",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        }
                    ],
                    "index": 11,
                    "page_num": "page_34",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        96,
                        249,
                        541,
                        285
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        114,
                        289,
                        344,
                        315
                    ],
                    "lines": [
                        {
                            "bbox": [
                                115,
                                290,
                                344,
                                303
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        115,
                                        290,
                                        344,
                                        303
                                    ],
                                    "score": 1.0,
                                    "content": "– prompt: The message from the agent to the user.",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                119,
                                304,
                                219,
                                317
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        119,
                                        304,
                                        219,
                                        317
                                    ],
                                    "score": 1.0,
                                    "content": "– result: User message",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        }
                    ],
                    "index": 13.5,
                    "page_num": "page_34",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        115,
                        290,
                        344,
                        317
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        99,
                        323,
                        532,
                        336
                    ],
                    "lines": [
                        {
                            "bbox": [
                                97,
                                325,
                                530,
                                336
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        97,
                                        325,
                                        530,
                                        336
                                    ],
                                    "score": 1.0,
                                    "content": "• CallFunctionAction: This action calls a function with all available parameter values. Attributes:",
                                    "type": "text"
                                }
                            ],
                            "index": 15
                        }
                    ],
                    "index": 15,
                    "page_num": "page_34",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        97,
                        325,
                        530,
                        336
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        114,
                        341,
                        316,
                        367
                    ],
                    "lines": [
                        {
                            "bbox": [
                                117,
                                342,
                                315,
                                353
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        342,
                                        315,
                                        353
                                    ],
                                    "score": 1.0,
                                    "content": "– function: The name of the function to call.",
                                    "type": "text"
                                }
                            ],
                            "index": 16
                        },
                        {
                            "bbox": [
                                122,
                                356,
                                273,
                                367
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        122,
                                        356,
                                        273,
                                        367
                                    ],
                                    "score": 1.0,
                                    "content": " result: Result of the function call",
                                    "type": "text"
                                }
                            ],
                            "index": 17
                        }
                    ],
                    "index": 16.5,
                    "page_num": "page_34",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        117,
                        342,
                        315,
                        367
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        95,
                        375,
                        543,
                        418
                    ],
                    "lines": [
                        {
                            "bbox": [
                                94,
                                375,
                                541,
                                390
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        94,
                                        375,
                                        541,
                                        390
                                    ],
                                    "score": 1.0,
                                    "content": "• ExitAction: With this action the agent indicates that the dialogue has ended. No further steps will",
                                    "type": "text"
                                }
                            ],
                            "index": 18
                        },
                        {
                            "bbox": [
                                106,
                                388,
                                280,
                                400
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        106,
                                        388,
                                        280,
                                        400
                                    ],
                                    "score": 1.0,
                                    "content": "be executed after this step. Attributes:",
                                    "type": "text"
                                }
                            ],
                            "index": 19
                        },
                        {
                            "bbox": [
                                117,
                                406,
                                484,
                                419
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        117,
                                        406,
                                        484,
                                        419
                                    ],
                                    "score": 1.0,
                                    "content": "– text: The message from the agent to inform the user that the dialogue has ended.",
                                    "type": "text"
                                }
                            ],
                            "index": 20
                        }
                    ],
                    "index": 19,
                    "page_num": "page_34",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        94,
                        375,
                        541,
                        419
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "title",
                    "bbox": [
                        71,
                        82,
                        154,
                        94
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                82,
                                154,
                                95
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        83,
                                        89,
                                        93
                                    ],
                                    "score": 1.0,
                                    "content": "E.3",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        95,
                                        82,
                                        154,
                                        95
                                    ],
                                    "score": 1.0,
                                    "content": "User Agents",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        }
                    ],
                    "index": 0
                },
                {
                    "type": "table",
                    "bbox": [
                        100,
                        169,
                        510,
                        698
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                70,
                                145,
                                536,
                                166
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        144,
                                        537,
                                        160
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                144,
                                                537,
                                                160
                                            ],
                                            "score": 1.0,
                                            "content": "Table 7: The list of user agents implemented for all domains. The User LLM is a prompted Llama-3.1-405B-Instruc",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        70,
                                        157,
                                        99,
                                        169
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                157,
                                                99,
                                                169
                                            ],
                                            "score": 1.0,
                                            "content": "model.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 2
                                }
                            ],
                            "index": 1.5
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                100,
                                169,
                                510,
                                698
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        100,
                                        169,
                                        510,
                                        698
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                100,
                                                169,
                                                510,
                                                698
                                            ],
                                            "score": 0.984,
                                            "html": "<html><body><table><tr><td>Agent Name</td><td>Behavior</td></tr><tr><td>UserInitMessageAmazing</td><td>At the begining of the conversation, the user should request a specific intent and provide values for some of the parameters in that request.</td></tr><tr><td>UserInitMessageShort</td><td>At the beginning of the conversation, the user should request a specific intent in a short message.</td></tr><tr><td>UserInitMessageAsk</td><td>At the beginning of the conversation, the user should ask the agent what it can do.</td></tr><tr><td>UserBadInitMessage</td><td>At the beginning of the conversation, the user should ask to do something impossible.</td></tr><tr><td>UserHappyPath</td><td>The user correctly answers the agent question.</td></tr><tr><td>UserMultislotInstruct</td><td>The user replies to the agent question and provides values for additional parameters in the request.</td></tr><tr><td>UserMultislotFuture</td><td>The user provides values for additional parameters in the request.</td></tr><tr><td>UserChangesSlot</td><td>The user changes the value to a previously set request parameter.</td></tr><tr><td>UserAdjectiveOrPosition</td><td>For categorical parameters, the user answers the agent but instead of giving the choice name, uses an</td></tr><tr><td>UserSkipsOptional</td><td>adjective or a positional number that defines its choice. For optional parameters, the user asks to skip it.</td></tr><tr><td>UserAsksAboutDocs</td><td>The user does not answer the agent, and instead asks a question that can be answered based on the request documentation.</td></tr><tr><td>UserAsksAboutFilledParameters</td><td>The user does not answer the agent, and instead asks a question about the parameters filled,</td></tr><tr><td>UserAsksForHelp</td><td>or still missing. For categorical parameters, the user ask the agent for help in choosing a value based on</td></tr><tr><td>UserCorrectValueInvalidValue</td><td>its problem. The user answers the agent correctly, but also gives an invalid value for a categorical</td></tr><tr><td>UserInvalidValue</td><td>parameter not yet filled. For categorical parameters, the user gives</td></tr><tr><td>UserChangesTopic</td><td>an impossible choice. The user does not answer the agent's question and change the topic of</td></tr><tr><td>UserSkipsUnskipable</td><td>conversation instead. For required parameters, the user asks to skip it.</td></tr><tr><td>UserIncorrectDate</td><td>For date/time parameters, the user gives an invalid date.</td></tr><tr><td>UserIncorrectWeb</td><td>For technical parameters such as url/email, the user gives a invalid value.</td></tr></table></body></html>",
                                            "type": "table",
                                            "image_path": "32d9c99c76e06db0c453b30d209c97e6ca2ba890f8fb3099bd761809b07a1e48.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 4,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        100,
                                        169,
                                        510,
                                        345.33333333333337
                                    ],
                                    "spans": [],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        100,
                                        345.33333333333337,
                                        510,
                                        521.6666666666667
                                    ],
                                    "spans": [],
                                    "index": 4
                                },
                                {
                                    "bbox": [
                                        100,
                                        521.6666666666667,
                                        510,
                                        698.0000000000001
                                    ],
                                    "spans": [],
                                    "index": 5
                                }
                            ]
                        }
                    ],
                    "index": 2.75
                }
            ],
            "layout_bboxes": [],
            "page_idx": 35,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [
                {
                    "type": "table",
                    "bbox": [
                        100,
                        169,
                        510,
                        698
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                70,
                                145,
                                536,
                                166
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        144,
                                        537,
                                        160
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                144,
                                                537,
                                                160
                                            ],
                                            "score": 1.0,
                                            "content": "Table 7: The list of user agents implemented for all domains. The User LLM is a prompted Llama-3.1-405B-Instruc",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        70,
                                        157,
                                        99,
                                        169
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                157,
                                                99,
                                                169
                                            ],
                                            "score": 1.0,
                                            "content": "model.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 2
                                }
                            ],
                            "index": 1.5
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                100,
                                169,
                                510,
                                698
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        100,
                                        169,
                                        510,
                                        698
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                100,
                                                169,
                                                510,
                                                698
                                            ],
                                            "score": 0.984,
                                            "html": "<html><body><table><tr><td>Agent Name</td><td>Behavior</td></tr><tr><td>UserInitMessageAmazing</td><td>At the begining of the conversation, the user should request a specific intent and provide values for some of the parameters in that request.</td></tr><tr><td>UserInitMessageShort</td><td>At the beginning of the conversation, the user should request a specific intent in a short message.</td></tr><tr><td>UserInitMessageAsk</td><td>At the beginning of the conversation, the user should ask the agent what it can do.</td></tr><tr><td>UserBadInitMessage</td><td>At the beginning of the conversation, the user should ask to do something impossible.</td></tr><tr><td>UserHappyPath</td><td>The user correctly answers the agent question.</td></tr><tr><td>UserMultislotInstruct</td><td>The user replies to the agent question and provides values for additional parameters in the request.</td></tr><tr><td>UserMultislotFuture</td><td>The user provides values for additional parameters in the request.</td></tr><tr><td>UserChangesSlot</td><td>The user changes the value to a previously set request parameter.</td></tr><tr><td>UserAdjectiveOrPosition</td><td>For categorical parameters, the user answers the agent but instead of giving the choice name, uses an</td></tr><tr><td>UserSkipsOptional</td><td>adjective or a positional number that defines its choice. For optional parameters, the user asks to skip it.</td></tr><tr><td>UserAsksAboutDocs</td><td>The user does not answer the agent, and instead asks a question that can be answered based on the request documentation.</td></tr><tr><td>UserAsksAboutFilledParameters</td><td>The user does not answer the agent, and instead asks a question about the parameters filled,</td></tr><tr><td>UserAsksForHelp</td><td>or still missing. For categorical parameters, the user ask the agent for help in choosing a value based on</td></tr><tr><td>UserCorrectValueInvalidValue</td><td>its problem. The user answers the agent correctly, but also gives an invalid value for a categorical</td></tr><tr><td>UserInvalidValue</td><td>parameter not yet filled. For categorical parameters, the user gives</td></tr><tr><td>UserChangesTopic</td><td>an impossible choice. The user does not answer the agent's question and change the topic of</td></tr><tr><td>UserSkipsUnskipable</td><td>conversation instead. For required parameters, the user asks to skip it.</td></tr><tr><td>UserIncorrectDate</td><td>For date/time parameters, the user gives an invalid date.</td></tr><tr><td>UserIncorrectWeb</td><td>For technical parameters such as url/email, the user gives a invalid value.</td></tr></table></body></html>",
                                            "type": "table",
                                            "image_path": "32d9c99c76e06db0c453b30d209c97e6ca2ba890f8fb3099bd761809b07a1e48.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 4,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        100,
                                        169,
                                        510,
                                        345.33333333333337
                                    ],
                                    "spans": [],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        100,
                                        345.33333333333337,
                                        510,
                                        521.6666666666667
                                    ],
                                    "spans": [],
                                    "index": 4
                                },
                                {
                                    "bbox": [
                                        100,
                                        521.6666666666667,
                                        510,
                                        698.0000000000001
                                    ],
                                    "spans": [],
                                    "index": 5
                                }
                            ]
                        }
                    ],
                    "index": 2.75
                }
            ],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        71,
                        27,
                        143,
                        37
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                25,
                                144,
                                38
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        25,
                                        144,
                                        38
                                    ],
                                    "score": 1.0,
                                    "content": "Technical report",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        751,
                        311,
                        760
                    ],
                    "lines": [
                        {
                            "bbox": [
                                299,
                                751,
                                312,
                                762
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        299,
                                        751,
                                        312,
                                        762
                                    ],
                                    "score": 1.0,
                                    "content": "36",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "title",
                    "bbox": [
                        71,
                        82,
                        154,
                        94
                    ],
                    "lines": [
                        {
                            "bbox": [
                                71,
                                82,
                                154,
                                95
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        83,
                                        89,
                                        93
                                    ],
                                    "score": 1.0,
                                    "content": "E.3",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        95,
                                        82,
                                        154,
                                        95
                                    ],
                                    "score": 1.0,
                                    "content": "User Agents",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        }
                    ],
                    "index": 0,
                    "page_num": "page_35",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "table",
                    "bbox": [
                        100,
                        169,
                        510,
                        698
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                70,
                                145,
                                536,
                                166
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        144,
                                        537,
                                        160
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                144,
                                                537,
                                                160
                                            ],
                                            "score": 1.0,
                                            "content": "Table 7: The list of user agents implemented for all domains. The User LLM is a prompted Llama-3.1-405B-Instruc",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        70,
                                        157,
                                        99,
                                        169
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                157,
                                                99,
                                                169
                                            ],
                                            "score": 1.0,
                                            "content": "model.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 2
                                }
                            ],
                            "index": 1.5
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                100,
                                169,
                                510,
                                698
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        100,
                                        169,
                                        510,
                                        698
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                100,
                                                169,
                                                510,
                                                698
                                            ],
                                            "score": 0.984,
                                            "html": "<html><body><table><tr><td>Agent Name</td><td>Behavior</td></tr><tr><td>UserInitMessageAmazing</td><td>At the begining of the conversation, the user should request a specific intent and provide values for some of the parameters in that request.</td></tr><tr><td>UserInitMessageShort</td><td>At the beginning of the conversation, the user should request a specific intent in a short message.</td></tr><tr><td>UserInitMessageAsk</td><td>At the beginning of the conversation, the user should ask the agent what it can do.</td></tr><tr><td>UserBadInitMessage</td><td>At the beginning of the conversation, the user should ask to do something impossible.</td></tr><tr><td>UserHappyPath</td><td>The user correctly answers the agent question.</td></tr><tr><td>UserMultislotInstruct</td><td>The user replies to the agent question and provides values for additional parameters in the request.</td></tr><tr><td>UserMultislotFuture</td><td>The user provides values for additional parameters in the request.</td></tr><tr><td>UserChangesSlot</td><td>The user changes the value to a previously set request parameter.</td></tr><tr><td>UserAdjectiveOrPosition</td><td>For categorical parameters, the user answers the agent but instead of giving the choice name, uses an</td></tr><tr><td>UserSkipsOptional</td><td>adjective or a positional number that defines its choice. For optional parameters, the user asks to skip it.</td></tr><tr><td>UserAsksAboutDocs</td><td>The user does not answer the agent, and instead asks a question that can be answered based on the request documentation.</td></tr><tr><td>UserAsksAboutFilledParameters</td><td>The user does not answer the agent, and instead asks a question about the parameters filled,</td></tr><tr><td>UserAsksForHelp</td><td>or still missing. For categorical parameters, the user ask the agent for help in choosing a value based on</td></tr><tr><td>UserCorrectValueInvalidValue</td><td>its problem. The user answers the agent correctly, but also gives an invalid value for a categorical</td></tr><tr><td>UserInvalidValue</td><td>parameter not yet filled. For categorical parameters, the user gives</td></tr><tr><td>UserChangesTopic</td><td>an impossible choice. The user does not answer the agent's question and change the topic of</td></tr><tr><td>UserSkipsUnskipable</td><td>conversation instead. For required parameters, the user asks to skip it.</td></tr><tr><td>UserIncorrectDate</td><td>For date/time parameters, the user gives an invalid date.</td></tr><tr><td>UserIncorrectWeb</td><td>For technical parameters such as url/email, the user gives a invalid value.</td></tr></table></body></html>",
                                            "type": "table",
                                            "image_path": "32d9c99c76e06db0c453b30d209c97e6ca2ba890f8fb3099bd761809b07a1e48.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 4,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        100,
                                        169,
                                        510,
                                        345.33333333333337
                                    ],
                                    "spans": [],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        100,
                                        345.33333333333337,
                                        510,
                                        521.6666666666667
                                    ],
                                    "spans": [],
                                    "index": 4
                                },
                                {
                                    "bbox": [
                                        100,
                                        521.6666666666667,
                                        510,
                                        698.0000000000001
                                    ],
                                    "spans": [],
                                    "index": 5
                                }
                            ]
                        }
                    ],
                    "index": 2.75,
                    "page_num": "page_35",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "title",
                    "bbox": [
                        72,
                        82,
                        226,
                        94
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                82,
                                227,
                                95
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        82,
                                        227,
                                        95
                                    ],
                                    "score": 1.0,
                                    "content": "E.4 Choosing the teacher model",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        }
                    ],
                    "index": 0
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        103,
                        541,
                        271
                    ],
                    "lines": [
                        {
                            "bbox": [
                                69,
                                103,
                                541,
                                118
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        103,
                                        311,
                                        118
                                    ],
                                    "score": 1.0,
                                    "content": "The Teacher agent uses a Llama-405B-Instruct model",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        312,
                                        105,
                                        320,
                                        113
                                    ],
                                    "score": 0.8,
                                    "content": "_{12}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        320,
                                        103,
                                        541,
                                        118
                                    ],
                                    "score": 1.0,
                                    "content": " that is carefully prompted to perform the form-",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                70,
                                117,
                                541,
                                130
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        117,
                                        541,
                                        130
                                    ],
                                    "score": 0.9960446357727051,
                                    "content": "filling task according to all our metrics (Section 5.2). We experimented with various language models such",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                70,
                                128,
                                541,
                                141
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        128,
                                        541,
                                        141
                                    ],
                                    "score": 1.0,
                                    "content": "as GPT4o, and Mistral-Large, but according to human evaluation, Llama 405B was on par or better than",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                71,
                                140,
                                541,
                                154
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        140,
                                        541,
                                        154
                                    ],
                                    "score": 0.9865849018096924,
                                    "content": "other models. We explored two different prompting techniques. The first (referred to as “long-node' in",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                70,
                                152,
                                541,
                                165
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        152,
                                        541,
                                        165
                                    ],
                                    "score": 1.0,
                                    "content": "Table 8) consists of crafting one long and detailed prompt explaining how the agent should make a thought",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                70,
                                164,
                                541,
                                177
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        164,
                                        541,
                                        177
                                    ],
                                    "score": 1.0,
                                    "content": "plan and answer the user (single node TapeAgent). The other prompting technique explored (referred to as",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                72,
                                177,
                                541,
                                189
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        177,
                                        541,
                                        189
                                    ],
                                    "score": 1.0,
                                    "content": "‘multi-node’ in Table 8) consists in decomposing the task into multiple smaller subtasks, each handled by a",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                70,
                                188,
                                541,
                                201
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        188,
                                        541,
                                        201
                                    ],
                                    "score": 0.9847906827926636,
                                    "content": "different node. The multi-node agent is first tasked to identify potential parameter values provided by the",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                70,
                                201,
                                540,
                                212
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        201,
                                        540,
                                        212
                                    ],
                                    "score": 1.0,
                                    "content": "last user message, then it is prompted to verify whether the provided values are correct or not, eventually,",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                70,
                                212,
                                541,
                                225
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        212,
                                        541,
                                        225
                                    ],
                                    "score": 1.0,
                                    "content": "the agent is prompted to note valid information, refuse invalid information, and ask the user for the next",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                70,
                                224,
                                541,
                                237
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        224,
                                        541,
                                        237
                                    ],
                                    "score": 0.9784319996833801,
                                    "content": "parameter to fill. We generated agent messages as a continuation to 1016 unfinished conversations where",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                70,
                                236,
                                540,
                                249
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        236,
                                        540,
                                        249
                                    ],
                                    "score": 0.9887144565582275,
                                    "content": "the last user message behaved according to specific behaviors and sent these messages to human labelers.",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                70,
                                247,
                                541,
                                261
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        247,
                                        541,
                                        261
                                    ],
                                    "score": 1.0,
                                    "content": "Results show that the multi-node approach yields better performance overall, so we decided to keep this",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                70,
                                260,
                                338,
                                272
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        260,
                                        338,
                                        272
                                    ],
                                    "score": 0.9956272840499878,
                                    "content": "prompting strategy as our final Teacher agent in Section 5.3.",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        }
                    ],
                    "index": 7.5
                },
                {
                    "type": "table",
                    "bbox": [
                        149,
                        306,
                        461,
                        576
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                71,
                                281,
                                536,
                                303
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        281,
                                        537,
                                        296
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                281,
                                                537,
                                                296
                                            ],
                                            "score": 1.0,
                                            "content": "Table 8: Evaluation of the Teacher agent with two prompting methods (long-node & multi-node) across all use",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 15
                                },
                                {
                                    "bbox": [
                                        71,
                                        292,
                                        255,
                                        305
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                292,
                                                255,
                                                305
                                            ],
                                            "score": 1.0,
                                            "content": "behaviors on 1016 test domain conversations.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 16
                                }
                            ],
                            "index": 15.5
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                149,
                                306,
                                461,
                                576
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        149,
                                        306,
                                        461,
                                        576
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                149,
                                                306,
                                                461,
                                                576
                                            ],
                                            "score": 0.903,
                                            "html": "<html><body><table><tr><td colspan=\"2\"></td><td colspan=\"2\">GREADTH metric</td></tr><tr><td>Author of last user message</td><td>Count</td><td>long-node</td><td>multi-node</td></tr><tr><td>UserInitMessageAmazing</td><td>46</td><td>60.87%</td><td>86.96%</td></tr><tr><td>UserInitMessageShort</td><td>48</td><td>87.50%</td><td>89.58%</td></tr><tr><td>UserInitMessageAsk</td><td>46</td><td>91.30%</td><td>84.78%</td></tr><tr><td>UserBadInitMessage</td><td>46</td><td>97.83%</td><td>100.00%</td></tr><tr><td>UserHappyPath</td><td>186</td><td>72.58%</td><td>89.25%</td></tr><tr><td>UserMultislotInstruct</td><td>48</td><td>68.75%</td><td>83.33%</td></tr><tr><td>UserMultislotFuture</td><td>46</td><td>58.70%</td><td>76.09%</td></tr><tr><td>UserChangesSlot</td><td>46</td><td>71.74%</td><td>82.61%</td></tr><tr><td>UserAdjectiveOrPosition</td><td>46</td><td>58.70%</td><td>76.09%</td></tr><tr><td>UserSkipsOptional</td><td>46</td><td>71.74%</td><td>71.74%</td></tr><tr><td>UserAsksAboutDocs</td><td>46</td><td>84.78%</td><td>93.48%</td></tr><tr><td>UserAsksAboutFilledParameters</td><td>48</td><td>83.33%</td><td>81.25%</td></tr><tr><td>UserAsksForHelp</td><td>45</td><td>40.00%</td><td>42.22%</td></tr><tr><td>UserCorrectValueInvalidValue</td><td>45</td><td>62.22%</td><td>77.78%</td></tr><tr><td>UserInvalidValue</td><td>46</td><td>63.04%</td><td>91.30%</td></tr><tr><td>UserChangesTopic</td><td>46</td><td>76.09%</td><td>86.96%</td></tr><tr><td>UserSkipsUnskipable</td><td>48</td><td>87.50%</td><td>95.83%</td></tr><tr><td>UserIncorrectDate</td><td>46</td><td>47.83%</td><td>19.57%</td></tr><tr><td>UserIncorrectWeb</td><td>42</td><td>16.67%</td><td>23.81%</td></tr><tr><td>ALL_BEHAVIORS</td><td>1016</td><td>69.39%</td><td>78.54%</td></tr></table></body></html>",
                                            "type": "table",
                                            "image_path": "5a32d5168da4e1799dfa55419fc623ae85d758fc1abfa8ed76302e2c70b8e2a3.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 18,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        149,
                                        306,
                                        461,
                                        396.0
                                    ],
                                    "spans": [],
                                    "index": 17
                                },
                                {
                                    "bbox": [
                                        149,
                                        396.0,
                                        461,
                                        486.0
                                    ],
                                    "spans": [],
                                    "index": 18
                                },
                                {
                                    "bbox": [
                                        149,
                                        486.0,
                                        461,
                                        576.0
                                    ],
                                    "spans": [],
                                    "index": 19
                                }
                            ]
                        }
                    ],
                    "index": 16.75
                }
            ],
            "layout_bboxes": [],
            "page_idx": 36,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [],
            "tables": [
                {
                    "type": "table",
                    "bbox": [
                        149,
                        306,
                        461,
                        576
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                71,
                                281,
                                536,
                                303
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        281,
                                        537,
                                        296
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                281,
                                                537,
                                                296
                                            ],
                                            "score": 1.0,
                                            "content": "Table 8: Evaluation of the Teacher agent with two prompting methods (long-node & multi-node) across all use",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 15
                                },
                                {
                                    "bbox": [
                                        71,
                                        292,
                                        255,
                                        305
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                292,
                                                255,
                                                305
                                            ],
                                            "score": 1.0,
                                            "content": "behaviors on 1016 test domain conversations.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 16
                                }
                            ],
                            "index": 15.5
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                149,
                                306,
                                461,
                                576
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        149,
                                        306,
                                        461,
                                        576
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                149,
                                                306,
                                                461,
                                                576
                                            ],
                                            "score": 0.903,
                                            "html": "<html><body><table><tr><td colspan=\"2\"></td><td colspan=\"2\">GREADTH metric</td></tr><tr><td>Author of last user message</td><td>Count</td><td>long-node</td><td>multi-node</td></tr><tr><td>UserInitMessageAmazing</td><td>46</td><td>60.87%</td><td>86.96%</td></tr><tr><td>UserInitMessageShort</td><td>48</td><td>87.50%</td><td>89.58%</td></tr><tr><td>UserInitMessageAsk</td><td>46</td><td>91.30%</td><td>84.78%</td></tr><tr><td>UserBadInitMessage</td><td>46</td><td>97.83%</td><td>100.00%</td></tr><tr><td>UserHappyPath</td><td>186</td><td>72.58%</td><td>89.25%</td></tr><tr><td>UserMultislotInstruct</td><td>48</td><td>68.75%</td><td>83.33%</td></tr><tr><td>UserMultislotFuture</td><td>46</td><td>58.70%</td><td>76.09%</td></tr><tr><td>UserChangesSlot</td><td>46</td><td>71.74%</td><td>82.61%</td></tr><tr><td>UserAdjectiveOrPosition</td><td>46</td><td>58.70%</td><td>76.09%</td></tr><tr><td>UserSkipsOptional</td><td>46</td><td>71.74%</td><td>71.74%</td></tr><tr><td>UserAsksAboutDocs</td><td>46</td><td>84.78%</td><td>93.48%</td></tr><tr><td>UserAsksAboutFilledParameters</td><td>48</td><td>83.33%</td><td>81.25%</td></tr><tr><td>UserAsksForHelp</td><td>45</td><td>40.00%</td><td>42.22%</td></tr><tr><td>UserCorrectValueInvalidValue</td><td>45</td><td>62.22%</td><td>77.78%</td></tr><tr><td>UserInvalidValue</td><td>46</td><td>63.04%</td><td>91.30%</td></tr><tr><td>UserChangesTopic</td><td>46</td><td>76.09%</td><td>86.96%</td></tr><tr><td>UserSkipsUnskipable</td><td>48</td><td>87.50%</td><td>95.83%</td></tr><tr><td>UserIncorrectDate</td><td>46</td><td>47.83%</td><td>19.57%</td></tr><tr><td>UserIncorrectWeb</td><td>42</td><td>16.67%</td><td>23.81%</td></tr><tr><td>ALL_BEHAVIORS</td><td>1016</td><td>69.39%</td><td>78.54%</td></tr></table></body></html>",
                                            "type": "table",
                                            "image_path": "5a32d5168da4e1799dfa55419fc623ae85d758fc1abfa8ed76302e2c70b8e2a3.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 18,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        149,
                                        306,
                                        461,
                                        396.0
                                    ],
                                    "spans": [],
                                    "index": 17
                                },
                                {
                                    "bbox": [
                                        149,
                                        396.0,
                                        461,
                                        486.0
                                    ],
                                    "spans": [],
                                    "index": 18
                                },
                                {
                                    "bbox": [
                                        149,
                                        486.0,
                                        461,
                                        576.0
                                    ],
                                    "spans": [],
                                    "index": 19
                                }
                            ]
                        }
                    ],
                    "index": 16.75
                }
            ],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        77,
                        723,
                        324,
                        731
                    ],
                    "lines": [
                        {
                            "bbox": [
                                78,
                                721,
                                325,
                                734
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        78,
                                        721,
                                        325,
                                        734
                                    ],
                                    "score": 1.0,
                                    "content": "12https://huggingface.co/meta-llama/Llama-3.1-405B-Instruct-FP8",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        72,
                        27,
                        143,
                        37
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                26,
                                144,
                                38
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        26,
                                        144,
                                        38
                                    ],
                                    "score": 1.0,
                                    "content": "Technical report",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        751,
                        311,
                        760
                    ],
                    "lines": [
                        {
                            "bbox": [
                                299,
                                751,
                                312,
                                762
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        299,
                                        751,
                                        312,
                                        762
                                    ],
                                    "score": 1.0,
                                    "content": "37",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "title",
                    "bbox": [
                        72,
                        82,
                        226,
                        94
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                82,
                                227,
                                95
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        82,
                                        227,
                                        95
                                    ],
                                    "score": 1.0,
                                    "content": "E.4 Choosing the teacher model",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        }
                    ],
                    "index": 0,
                    "page_num": "page_36",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "text",
                    "bbox": [
                        70,
                        103,
                        541,
                        271
                    ],
                    "lines": [
                        {
                            "bbox": [
                                69,
                                103,
                                541,
                                118
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        103,
                                        311,
                                        118
                                    ],
                                    "score": 1.0,
                                    "content": "The Teacher agent uses a Llama-405B-Instruct model",
                                    "type": "text"
                                },
                                {
                                    "bbox": [
                                        312,
                                        105,
                                        320,
                                        113
                                    ],
                                    "score": 0.8,
                                    "content": "_{12}",
                                    "type": "inline_equation",
                                    "height": 8,
                                    "width": 8
                                },
                                {
                                    "bbox": [
                                        320,
                                        103,
                                        541,
                                        118
                                    ],
                                    "score": 1.0,
                                    "content": " that is carefully prompted to perform the form-",
                                    "type": "text"
                                }
                            ],
                            "index": 1
                        },
                        {
                            "bbox": [
                                70,
                                117,
                                541,
                                130
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        117,
                                        541,
                                        130
                                    ],
                                    "score": 0.9960446357727051,
                                    "content": "filling task according to all our metrics (Section 5.2). We experimented with various language models such",
                                    "type": "text"
                                }
                            ],
                            "index": 2
                        },
                        {
                            "bbox": [
                                70,
                                128,
                                541,
                                141
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        128,
                                        541,
                                        141
                                    ],
                                    "score": 1.0,
                                    "content": "as GPT4o, and Mistral-Large, but according to human evaluation, Llama 405B was on par or better than",
                                    "type": "text"
                                }
                            ],
                            "index": 3
                        },
                        {
                            "bbox": [
                                71,
                                140,
                                541,
                                154
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        71,
                                        140,
                                        541,
                                        154
                                    ],
                                    "score": 0.9865849018096924,
                                    "content": "other models. We explored two different prompting techniques. The first (referred to as “long-node' in",
                                    "type": "text"
                                }
                            ],
                            "index": 4
                        },
                        {
                            "bbox": [
                                70,
                                152,
                                541,
                                165
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        152,
                                        541,
                                        165
                                    ],
                                    "score": 1.0,
                                    "content": "Table 8) consists of crafting one long and detailed prompt explaining how the agent should make a thought",
                                    "type": "text"
                                }
                            ],
                            "index": 5
                        },
                        {
                            "bbox": [
                                70,
                                164,
                                541,
                                177
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        164,
                                        541,
                                        177
                                    ],
                                    "score": 1.0,
                                    "content": "plan and answer the user (single node TapeAgent). The other prompting technique explored (referred to as",
                                    "type": "text"
                                }
                            ],
                            "index": 6
                        },
                        {
                            "bbox": [
                                72,
                                177,
                                541,
                                189
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        72,
                                        177,
                                        541,
                                        189
                                    ],
                                    "score": 1.0,
                                    "content": "‘multi-node’ in Table 8) consists in decomposing the task into multiple smaller subtasks, each handled by a",
                                    "type": "text"
                                }
                            ],
                            "index": 7
                        },
                        {
                            "bbox": [
                                70,
                                188,
                                541,
                                201
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        188,
                                        541,
                                        201
                                    ],
                                    "score": 0.9847906827926636,
                                    "content": "different node. The multi-node agent is first tasked to identify potential parameter values provided by the",
                                    "type": "text"
                                }
                            ],
                            "index": 8
                        },
                        {
                            "bbox": [
                                70,
                                201,
                                540,
                                212
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        201,
                                        540,
                                        212
                                    ],
                                    "score": 1.0,
                                    "content": "last user message, then it is prompted to verify whether the provided values are correct or not, eventually,",
                                    "type": "text"
                                }
                            ],
                            "index": 9
                        },
                        {
                            "bbox": [
                                70,
                                212,
                                541,
                                225
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        212,
                                        541,
                                        225
                                    ],
                                    "score": 1.0,
                                    "content": "the agent is prompted to note valid information, refuse invalid information, and ask the user for the next",
                                    "type": "text"
                                }
                            ],
                            "index": 10
                        },
                        {
                            "bbox": [
                                70,
                                224,
                                541,
                                237
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        224,
                                        541,
                                        237
                                    ],
                                    "score": 0.9784319996833801,
                                    "content": "parameter to fill. We generated agent messages as a continuation to 1016 unfinished conversations where",
                                    "type": "text"
                                }
                            ],
                            "index": 11
                        },
                        {
                            "bbox": [
                                70,
                                236,
                                540,
                                249
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        236,
                                        540,
                                        249
                                    ],
                                    "score": 0.9887144565582275,
                                    "content": "the last user message behaved according to specific behaviors and sent these messages to human labelers.",
                                    "type": "text"
                                }
                            ],
                            "index": 12
                        },
                        {
                            "bbox": [
                                70,
                                247,
                                541,
                                261
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        247,
                                        541,
                                        261
                                    ],
                                    "score": 1.0,
                                    "content": "Results show that the multi-node approach yields better performance overall, so we decided to keep this",
                                    "type": "text"
                                }
                            ],
                            "index": 13
                        },
                        {
                            "bbox": [
                                70,
                                260,
                                338,
                                272
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        260,
                                        338,
                                        272
                                    ],
                                    "score": 0.9956272840499878,
                                    "content": "prompting strategy as our final Teacher agent in Section 5.3.",
                                    "type": "text"
                                }
                            ],
                            "index": 14
                        }
                    ],
                    "index": 7.5,
                    "page_num": "page_36",
                    "page_size": [
                        612.0,
                        792.0
                    ],
                    "bbox_fs": [
                        69,
                        103,
                        541,
                        272
                    ]
                },
                {
                    "type": "table",
                    "bbox": [
                        149,
                        306,
                        461,
                        576
                    ],
                    "blocks": [
                        {
                            "type": "table_caption",
                            "bbox": [
                                71,
                                281,
                                536,
                                303
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        281,
                                        537,
                                        296
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                281,
                                                537,
                                                296
                                            ],
                                            "score": 1.0,
                                            "content": "Table 8: Evaluation of the Teacher agent with two prompting methods (long-node & multi-node) across all use",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 15
                                },
                                {
                                    "bbox": [
                                        71,
                                        292,
                                        255,
                                        305
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                292,
                                                255,
                                                305
                                            ],
                                            "score": 1.0,
                                            "content": "behaviors on 1016 test domain conversations.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 16
                                }
                            ],
                            "index": 15.5
                        },
                        {
                            "type": "table_body",
                            "bbox": [
                                149,
                                306,
                                461,
                                576
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        149,
                                        306,
                                        461,
                                        576
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                149,
                                                306,
                                                461,
                                                576
                                            ],
                                            "score": 0.903,
                                            "html": "<html><body><table><tr><td colspan=\"2\"></td><td colspan=\"2\">GREADTH metric</td></tr><tr><td>Author of last user message</td><td>Count</td><td>long-node</td><td>multi-node</td></tr><tr><td>UserInitMessageAmazing</td><td>46</td><td>60.87%</td><td>86.96%</td></tr><tr><td>UserInitMessageShort</td><td>48</td><td>87.50%</td><td>89.58%</td></tr><tr><td>UserInitMessageAsk</td><td>46</td><td>91.30%</td><td>84.78%</td></tr><tr><td>UserBadInitMessage</td><td>46</td><td>97.83%</td><td>100.00%</td></tr><tr><td>UserHappyPath</td><td>186</td><td>72.58%</td><td>89.25%</td></tr><tr><td>UserMultislotInstruct</td><td>48</td><td>68.75%</td><td>83.33%</td></tr><tr><td>UserMultislotFuture</td><td>46</td><td>58.70%</td><td>76.09%</td></tr><tr><td>UserChangesSlot</td><td>46</td><td>71.74%</td><td>82.61%</td></tr><tr><td>UserAdjectiveOrPosition</td><td>46</td><td>58.70%</td><td>76.09%</td></tr><tr><td>UserSkipsOptional</td><td>46</td><td>71.74%</td><td>71.74%</td></tr><tr><td>UserAsksAboutDocs</td><td>46</td><td>84.78%</td><td>93.48%</td></tr><tr><td>UserAsksAboutFilledParameters</td><td>48</td><td>83.33%</td><td>81.25%</td></tr><tr><td>UserAsksForHelp</td><td>45</td><td>40.00%</td><td>42.22%</td></tr><tr><td>UserCorrectValueInvalidValue</td><td>45</td><td>62.22%</td><td>77.78%</td></tr><tr><td>UserInvalidValue</td><td>46</td><td>63.04%</td><td>91.30%</td></tr><tr><td>UserChangesTopic</td><td>46</td><td>76.09%</td><td>86.96%</td></tr><tr><td>UserSkipsUnskipable</td><td>48</td><td>87.50%</td><td>95.83%</td></tr><tr><td>UserIncorrectDate</td><td>46</td><td>47.83%</td><td>19.57%</td></tr><tr><td>UserIncorrectWeb</td><td>42</td><td>16.67%</td><td>23.81%</td></tr><tr><td>ALL_BEHAVIORS</td><td>1016</td><td>69.39%</td><td>78.54%</td></tr></table></body></html>",
                                            "type": "table",
                                            "image_path": "5a32d5168da4e1799dfa55419fc623ae85d758fc1abfa8ed76302e2c70b8e2a3.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 18,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        149,
                                        306,
                                        461,
                                        396.0
                                    ],
                                    "spans": [],
                                    "index": 17
                                },
                                {
                                    "bbox": [
                                        149,
                                        396.0,
                                        461,
                                        486.0
                                    ],
                                    "spans": [],
                                    "index": 18
                                },
                                {
                                    "bbox": [
                                        149,
                                        486.0,
                                        461,
                                        576.0
                                    ],
                                    "spans": [],
                                    "index": 19
                                }
                            ]
                        }
                    ],
                    "index": 16.75,
                    "page_num": "page_36",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "title",
                    "bbox": [
                        72,
                        82,
                        224,
                        93
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                82,
                                224,
                                95
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        82,
                                        224,
                                        95
                                    ],
                                    "score": 1.0,
                                    "content": "E.5 Teacher and Student Tapes",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        }
                    ],
                    "index": 0
                },
                {
                    "type": "image",
                    "bbox": [
                        72,
                        102,
                        547,
                        639
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                72,
                                102,
                                547,
                                639
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        72,
                                        102,
                                        547,
                                        639
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                72,
                                                102,
                                                547,
                                                639
                                            ],
                                            "score": 0.747,
                                            "type": "image",
                                            "image_path": "c975a89c6abb72ff7501a2c934976429eda9fa094460c5e196a611ae74bf5f59.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 2,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        72,
                                        102,
                                        547,
                                        281.0
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        72,
                                        281.0,
                                        547,
                                        460.0
                                    ],
                                    "spans": [],
                                    "index": 2
                                },
                                {
                                    "bbox": [
                                        72,
                                        460.0,
                                        547,
                                        639.0
                                    ],
                                    "spans": [],
                                    "index": 3
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                71,
                                660,
                                542,
                                705
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        70,
                                        661,
                                        542,
                                        674
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                661,
                                                542,
                                                674
                                            ],
                                            "score": 1.0,
                                            "content": "Figure 11: Sample Tape between the Teacher agent and User agents. The user is requesting the creation of",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                },
                                {
                                    "bbox": [
                                        70,
                                        672,
                                        541,
                                        685
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                672,
                                                541,
                                                685
                                            ],
                                            "score": 1.0,
                                            "content": "a digital coupon for their online store. Steps are color-coded: purple for internal agent thoughts, blue for actions,",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 5
                                },
                                {
                                    "bbox": [
                                        71,
                                        684,
                                        541,
                                        695
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                684,
                                                541,
                                                695
                                            ],
                                            "score": 1.0,
                                            "content": "and green for observations. The step’s author is indicated in grey using the “Agent.node” format. User agent names",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 6
                                },
                                {
                                    "bbox": [
                                        71,
                                        695,
                                        198,
                                        706
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                695,
                                                198,
                                                706
                                            ],
                                            "score": 1.0,
                                            "content": "are described in Appendix E.3.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 7
                                }
                            ],
                            "index": 5.5
                        }
                    ],
                    "index": 3.75
                }
            ],
            "layout_bboxes": [],
            "page_idx": 37,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [
                {
                    "type": "image",
                    "bbox": [
                        72,
                        102,
                        547,
                        639
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                72,
                                102,
                                547,
                                639
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        72,
                                        102,
                                        547,
                                        639
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                72,
                                                102,
                                                547,
                                                639
                                            ],
                                            "score": 0.747,
                                            "type": "image",
                                            "image_path": "c975a89c6abb72ff7501a2c934976429eda9fa094460c5e196a611ae74bf5f59.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 2,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        72,
                                        102,
                                        547,
                                        281.0
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        72,
                                        281.0,
                                        547,
                                        460.0
                                    ],
                                    "spans": [],
                                    "index": 2
                                },
                                {
                                    "bbox": [
                                        72,
                                        460.0,
                                        547,
                                        639.0
                                    ],
                                    "spans": [],
                                    "index": 3
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                71,
                                660,
                                542,
                                705
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        70,
                                        661,
                                        542,
                                        674
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                661,
                                                542,
                                                674
                                            ],
                                            "score": 1.0,
                                            "content": "Figure 11: Sample Tape between the Teacher agent and User agents. The user is requesting the creation of",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                },
                                {
                                    "bbox": [
                                        70,
                                        672,
                                        541,
                                        685
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                672,
                                                541,
                                                685
                                            ],
                                            "score": 1.0,
                                            "content": "a digital coupon for their online store. Steps are color-coded: purple for internal agent thoughts, blue for actions,",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 5
                                },
                                {
                                    "bbox": [
                                        71,
                                        684,
                                        541,
                                        695
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                684,
                                                541,
                                                695
                                            ],
                                            "score": 1.0,
                                            "content": "and green for observations. The step’s author is indicated in grey using the “Agent.node” format. User agent names",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 6
                                },
                                {
                                    "bbox": [
                                        71,
                                        695,
                                        198,
                                        706
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                695,
                                                198,
                                                706
                                            ],
                                            "score": 1.0,
                                            "content": "are described in Appendix E.3.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 7
                                }
                            ],
                            "index": 5.5
                        }
                    ],
                    "index": 3.75
                }
            ],
            "tables": [],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        72,
                        27,
                        143,
                        37
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                26,
                                144,
                                38
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        26,
                                        144,
                                        38
                                    ],
                                    "score": 1.0,
                                    "content": "Technical report",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        751,
                        311,
                        760
                    ],
                    "lines": [
                        {
                            "bbox": [
                                299,
                                751,
                                312,
                                762
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        299,
                                        751,
                                        312,
                                        762
                                    ],
                                    "score": 1.0,
                                    "content": "38",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "title",
                    "bbox": [
                        72,
                        82,
                        224,
                        93
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                82,
                                224,
                                95
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        82,
                                        224,
                                        95
                                    ],
                                    "score": 1.0,
                                    "content": "E.5 Teacher and Student Tapes",
                                    "type": "text"
                                }
                            ],
                            "index": 0
                        }
                    ],
                    "index": 0,
                    "page_num": "page_37",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                },
                {
                    "type": "image",
                    "bbox": [
                        72,
                        102,
                        547,
                        639
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                72,
                                102,
                                547,
                                639
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        72,
                                        102,
                                        547,
                                        639
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                72,
                                                102,
                                                547,
                                                639
                                            ],
                                            "score": 0.747,
                                            "type": "image",
                                            "image_path": "c975a89c6abb72ff7501a2c934976429eda9fa094460c5e196a611ae74bf5f59.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 2,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        72,
                                        102,
                                        547,
                                        281.0
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        72,
                                        281.0,
                                        547,
                                        460.0
                                    ],
                                    "spans": [],
                                    "index": 2
                                },
                                {
                                    "bbox": [
                                        72,
                                        460.0,
                                        547,
                                        639.0
                                    ],
                                    "spans": [],
                                    "index": 3
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                71,
                                660,
                                542,
                                705
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        70,
                                        661,
                                        542,
                                        674
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                661,
                                                542,
                                                674
                                            ],
                                            "score": 1.0,
                                            "content": "Figure 11: Sample Tape between the Teacher agent and User agents. The user is requesting the creation of",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                },
                                {
                                    "bbox": [
                                        70,
                                        672,
                                        541,
                                        685
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                672,
                                                541,
                                                685
                                            ],
                                            "score": 1.0,
                                            "content": "a digital coupon for their online store. Steps are color-coded: purple for internal agent thoughts, blue for actions,",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 5
                                },
                                {
                                    "bbox": [
                                        71,
                                        684,
                                        541,
                                        695
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                684,
                                                541,
                                                695
                                            ],
                                            "score": 1.0,
                                            "content": "and green for observations. The step’s author is indicated in grey using the “Agent.node” format. User agent names",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 6
                                },
                                {
                                    "bbox": [
                                        71,
                                        695,
                                        198,
                                        706
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                695,
                                                198,
                                                706
                                            ],
                                            "score": 1.0,
                                            "content": "are described in Appendix E.3.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 7
                                }
                            ],
                            "index": 5.5
                        }
                    ],
                    "index": 3.75,
                    "page_num": "page_37",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                }
            ]
        },
        {
            "preproc_blocks": [
                {
                    "type": "image",
                    "bbox": [
                        72,
                        196,
                        549,
                        561
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                72,
                                196,
                                549,
                                561
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        72,
                                        196,
                                        549,
                                        561
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                72,
                                                196,
                                                549,
                                                561
                                            ],
                                            "score": 0.942,
                                            "type": "image",
                                            "image_path": "6fae9b59b08bf8e3fed95d84e24fd56872e6590aa52f39fa2a530a1188346045.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        72,
                                        196,
                                        549,
                                        317.6666666666667
                                    ],
                                    "spans": [],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        72,
                                        317.6666666666667,
                                        549,
                                        439.33333333333337
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        72,
                                        439.33333333333337,
                                        549,
                                        561.0
                                    ],
                                    "spans": [],
                                    "index": 2
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                70,
                                571,
                                542,
                                615
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        71,
                                        572,
                                        541,
                                        584
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                572,
                                                541,
                                                584
                                            ],
                                            "score": 1.0,
                                            "content": "Figure 12: Sample tape between the Student agent and User agents. The user is requesting the creation of a",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        72,
                                        583,
                                        541,
                                        594
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                72,
                                                583,
                                                541,
                                                594
                                            ],
                                            "score": 1.0,
                                            "content": "digital coupon for their online store. Steps are color-coded: purple for internal agent thoughts, blue for actions, and",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                },
                                {
                                    "bbox": [
                                        69,
                                        593,
                                        542,
                                        606
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                593,
                                                542,
                                                606
                                            ],
                                            "score": 1.0,
                                            "content": "green for observations. The step’s author is indicated in grey using the “Agent.node” format. User agent names are",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 5
                                },
                                {
                                    "bbox": [
                                        72,
                                        605,
                                        182,
                                        616
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                72,
                                                605,
                                                182,
                                                616
                                            ],
                                            "score": 1.0,
                                            "content": "described in Appendix E.3.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 6
                                }
                            ],
                            "index": 4.5
                        }
                    ],
                    "index": 2.75
                }
            ],
            "layout_bboxes": [],
            "page_idx": 38,
            "page_size": [
                612.0,
                792.0
            ],
            "_layout_tree": [],
            "images": [
                {
                    "type": "image",
                    "bbox": [
                        72,
                        196,
                        549,
                        561
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                72,
                                196,
                                549,
                                561
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        72,
                                        196,
                                        549,
                                        561
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                72,
                                                196,
                                                549,
                                                561
                                            ],
                                            "score": 0.942,
                                            "type": "image",
                                            "image_path": "6fae9b59b08bf8e3fed95d84e24fd56872e6590aa52f39fa2a530a1188346045.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        72,
                                        196,
                                        549,
                                        317.6666666666667
                                    ],
                                    "spans": [],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        72,
                                        317.6666666666667,
                                        549,
                                        439.33333333333337
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        72,
                                        439.33333333333337,
                                        549,
                                        561.0
                                    ],
                                    "spans": [],
                                    "index": 2
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                70,
                                571,
                                542,
                                615
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        71,
                                        572,
                                        541,
                                        584
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                572,
                                                541,
                                                584
                                            ],
                                            "score": 1.0,
                                            "content": "Figure 12: Sample tape between the Student agent and User agents. The user is requesting the creation of a",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        72,
                                        583,
                                        541,
                                        594
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                72,
                                                583,
                                                541,
                                                594
                                            ],
                                            "score": 1.0,
                                            "content": "digital coupon for their online store. Steps are color-coded: purple for internal agent thoughts, blue for actions, and",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                },
                                {
                                    "bbox": [
                                        69,
                                        593,
                                        542,
                                        606
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                593,
                                                542,
                                                606
                                            ],
                                            "score": 1.0,
                                            "content": "green for observations. The step’s author is indicated in grey using the “Agent.node” format. User agent names are",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 5
                                },
                                {
                                    "bbox": [
                                        72,
                                        605,
                                        182,
                                        616
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                72,
                                                605,
                                                182,
                                                616
                                            ],
                                            "score": 1.0,
                                            "content": "described in Appendix E.3.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 6
                                }
                            ],
                            "index": 4.5
                        }
                    ],
                    "index": 2.75
                }
            ],
            "tables": [],
            "interline_equations": [],
            "discarded_blocks": [
                {
                    "type": "discarded",
                    "bbox": [
                        71,
                        27,
                        143,
                        37
                    ],
                    "lines": [
                        {
                            "bbox": [
                                70,
                                26,
                                144,
                                38
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        26,
                                        144,
                                        38
                                    ],
                                    "score": 1.0,
                                    "content": "Technical report",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "discarded",
                    "bbox": [
                        300,
                        751,
                        311,
                        760
                    ],
                    "lines": [
                        {
                            "bbox": [
                                299,
                                751,
                                312,
                                762
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        299,
                                        751,
                                        312,
                                        762
                                    ],
                                    "score": 1.0,
                                    "content": "39",
                                    "type": "text"
                                }
                            ]
                        }
                    ]
                }
            ],
            "need_drop": false,
            "drop_reason": [],
            "para_blocks": [
                {
                    "type": "image",
                    "bbox": [
                        72,
                        196,
                        549,
                        561
                    ],
                    "blocks": [
                        {
                            "type": "image_body",
                            "bbox": [
                                72,
                                196,
                                549,
                                561
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        72,
                                        196,
                                        549,
                                        561
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                72,
                                                196,
                                                549,
                                                561
                                            ],
                                            "score": 0.942,
                                            "type": "image",
                                            "image_path": "6fae9b59b08bf8e3fed95d84e24fd56872e6590aa52f39fa2a530a1188346045.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "virtual_lines": [
                                {
                                    "bbox": [
                                        72,
                                        196,
                                        549,
                                        317.6666666666667
                                    ],
                                    "spans": [],
                                    "index": 0
                                },
                                {
                                    "bbox": [
                                        72,
                                        317.6666666666667,
                                        549,
                                        439.33333333333337
                                    ],
                                    "spans": [],
                                    "index": 1
                                },
                                {
                                    "bbox": [
                                        72,
                                        439.33333333333337,
                                        549,
                                        561.0
                                    ],
                                    "spans": [],
                                    "index": 2
                                }
                            ]
                        },
                        {
                            "type": "image_caption",
                            "bbox": [
                                70,
                                571,
                                542,
                                615
                            ],
                            "group_id": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        71,
                                        572,
                                        541,
                                        584
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                572,
                                                541,
                                                584
                                            ],
                                            "score": 1.0,
                                            "content": "Figure 12: Sample tape between the Student agent and User agents. The user is requesting the creation of a",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 3
                                },
                                {
                                    "bbox": [
                                        72,
                                        583,
                                        541,
                                        594
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                72,
                                                583,
                                                541,
                                                594
                                            ],
                                            "score": 1.0,
                                            "content": "digital coupon for their online store. Steps are color-coded: purple for internal agent thoughts, blue for actions, and",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 4
                                },
                                {
                                    "bbox": [
                                        69,
                                        593,
                                        542,
                                        606
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                593,
                                                542,
                                                606
                                            ],
                                            "score": 1.0,
                                            "content": "green for observations. The step’s author is indicated in grey using the “Agent.node” format. User agent names are",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 5
                                },
                                {
                                    "bbox": [
                                        72,
                                        605,
                                        182,
                                        616
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                72,
                                                605,
                                                182,
                                                616
                                            ],
                                            "score": 1.0,
                                            "content": "described in Appendix E.3.",
                                            "type": "text"
                                        }
                                    ],
                                    "index": 6
                                }
                            ],
                            "index": 4.5
                        }
                    ],
                    "index": 2.75,
                    "page_num": "page_38",
                    "page_size": [
                        612.0,
                        792.0
                    ]
                }
            ]
        }
    ],
    "_parse_type": "txt",
    "_version_name": "1.1.0"
}